<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ALSA: Naming rule of codec_name inside snd_soc_dai_link</title>
    <url>/2019-09-01/ALSA-Naming-rule-of-codec-name-inside-snd-soc-dai-link/</url>
    <content><![CDATA[<p>…</p>
<a id="more"></a>

<p>When we define a dai link in machine driver, a structure names “snd_soc_dai_link” will be created. There are two members inside this structure to find the adaptive codec drivers: <strong>codec_name</strong> and <strong>codec_dai_name</strong>. </p>
<p>Normally codec driver will define <strong>codec_dai_name</strong>. You can find it easily inside codec driver source code. To make sure the dai link created properly, the <strong>codec_dai_name</strong> in machine driver and codec driver should be exactly same. As for <strong>codec_name</strong>, the naming rule should be like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">codec_name.bus_number-codec_address</span><br></pre></td></tr></table></figure>

<p>Taking pcm512x as an example, if we connect it to <strong>i2c bus 4</strong> and the i2c address of pcm512x we are using is <strong>0x4e</strong> in device tree, we should define snd_soc_dai_link like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.codec_name     &#x3D; &quot;pcm512x.4-004e&quot;,</span><br><span class="line">.codec_dai_name &#x3D; &quot;pcm512x-hifi&quot;,</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>AWS IoT Getting Started: MQTT sample</title>
    <url>/2020-04-13/AWS-IoT-Getting-Started-MQTT-sample/</url>
    <content><![CDATA[<p>AWS IoT Getting Started: MQTT sample</p>
<a id="more"></a>

<h2 id="AWS-IoT-Console"><a href="#AWS-IoT-Console" class="headerlink" title="AWS IoT Console"></a>AWS IoT Console</h2><p>Using <a href="https://console.aws.amazon.com/iot/home" target="_blank" rel="noopener">AWS IoT Console</a> to manage IoT devices. In MQTT sample, we need to create a thing in console and setup policy, certificate, and keys.</p>
<h2 id="Create-a-Thing"><a href="#Create-a-Thing" class="headerlink" title="Create a Thing"></a>Create a Thing</h2><blockquote>
<p>Devices connected to AWS IoT are represented by things in the AWS IoT registry. A thing represents a specific device or logical entity. It can be a physical device or sensor (for example, a light bulb or a switch on the wall). It can also be a logical entity, like an instance of an application or physical entity that does not connect to AWS IoT, but is related to other devices that do (for example, a car that has engine sensors or a control panel). (From <a href="https://docs.aws.amazon.com/iot/latest/developerguide/create-aws-thing.html" target="_blank" rel="noopener">Amazon docs</a>)</p>
</blockquote>
<p>In AWS IoT Console, go to Manage-&gt;Things to create a thing. After that, in things details page <em>Interact</em> tab we can find the API endpoint for IoT device.</p>
<p><img src="https://blog-image-host.oss-cn-shanghai.aliyuncs.com/lzqblog/AWS-IoT-Getting-Started-MQTT-sample/Screenshot%20from%202020-04-13%2016-23-25.png" alt></p>
<h2 id="Certificates-and-keys"><a href="#Certificates-and-keys" class="headerlink" title="Certificates and keys"></a>Certificates and keys</h2><p>In AWS IoT Console, go to Secure-&gt;Certificates to create a certificate(One-click certificate creation are recommended):</p>
<p><img src="https://blog-image-host.oss-cn-shanghai.aliyuncs.com/lzqblog/AWS-IoT-Getting-Started-MQTT-sample/Screenshot%20from%202020-04-13%2016-32-30.png" alt></p>
<p>Then we need to download certificate, keys and root CA from this page:</p>
<p><img src="https://blog-image-host.oss-cn-shanghai.aliyuncs.com/lzqblog/AWS-IoT-Getting-Started-MQTT-sample/Screenshot%20from%202020-04-13%2016-33-47.png" alt></p>
<h2 id="AWS-IoT-SDK"><a href="#AWS-IoT-SDK" class="headerlink" title="AWS IoT SDK"></a>AWS IoT SDK</h2><p><a href="https://github.com/aws/aws-iot-device-sdk-embedded-C" target="_blank" rel="noopener">AWS IoT SDK</a> is the SDK for connecting to AWS IoT from a device using embedded C. Before porting to embedded platform, we can have a quick trial on a Linux based PC.</p>
<h3 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h3><p>This SDK depends on <a href="https://github.com/ARMmbed/mbedtls" target="_blank" rel="noopener">MbedTLS</a>. Files of MbedTLS need to copy to <em>aws-iot-device-sdk-embedded-C/external_libs/mbedTLS/</em>.</p>
<h3 id="Modifications-before-building"><a href="#Modifications-before-building" class="headerlink" title="Modifications before building"></a>Modifications before building</h3><p>MQTT sample code is under <em>aws-iot-device-sdk-embedded-C/samples/linux/subscribe_publish_sample/</em>. Before building, we need to do some modifications to make it work.</p>
<ul>
<li>Copy the downloaded certificate, keys and root CA into <em>aws-iot-device-sdk-embedded-C/certs/</em>.</li>
<li>Modify <em>/home/alex/data/aws/aws-iot-device-sdk-embedded-C/samples/linux/subscribe_publish_sample/aws_iot_config.h</em>:<ul>
<li>AWS_IOT_MQTT_HOST: Which is the API endpoint we got when created a thing</li>
<li>AWS_IOT_MY_THING_NAME: Should be same as the name we set when created a thing</li>
<li>AWS_IOT_ROOT_CA_FILENAME: File name of the rootCA we downloaded.</li>
<li>AWS_IOT_CERTIFICATE_FILENAME: File name of the device certificate we downloaded.</li>
<li>AWS_IOT_PRIVATE_KEY_FILENAME: File name of the private key we downloaded.</li>
</ul>
</li>
</ul>
<h3 id="make-and-run"><a href="#make-and-run" class="headerlink" title="make and run"></a>make and run</h3><p>Device log:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Subscribing...</span><br><span class="line">--&gt;sleep</span><br><span class="line">Subscribe callback</span><br><span class="line">sdkTest&#x2F;sub	hello from SDK QOS0 : 0 </span><br><span class="line">Subscribe callback</span><br><span class="line">sdkTest&#x2F;sub	hello from SDK QOS1 : 1 </span><br><span class="line">--&gt;sleep</span><br><span class="line">Subscribe callback</span><br><span class="line">sdkTest&#x2F;sub	hello from SDK QOS0 : 2 </span><br><span class="line">Subscribe callback</span><br><span class="line">sdkTest&#x2F;sub	hello from SDK QOS1 : 3 </span><br><span class="line">--&gt;sleep</span><br><span class="line">Subscribe callback</span><br><span class="line">sdkTest&#x2F;sub	hello from SDK QOS0 : 4 </span><br><span class="line">Subscribe callback</span><br></pre></td></tr></table></figure>

<p>AWS IoT Console:<br><img src="/2020-04-13/AWS-IoT-Getting-Started-MQTT-sample/Screenshot%20from%202020-04-13%2017-02-38.png" alt></p>
]]></content>
      <categories>
        <category>IoT</category>
      </categories>
      <tags>
        <tag>MQTT</tag>
        <tag>IoT</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Add two numbers</title>
    <url>/2019-07-14/Algorithm-Puzzles-Add-two-numbers/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Add two numbers</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>You are given two non-empty linked lists representing two non-negative integers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p>
<p>You may assume the two numbers do not contain any leading zero, except the number 0 itself.</p>
<p>Example:</p>
<p>Input: (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>Output: 7 -&gt; 0 -&gt; 8<br>Explanation: 342 + 465 = 807.</p>
<p>The template code provided by leetcode:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>My first came out solution just like how we do sum on draft paper:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        ListNode* result = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">        ListNode* resultHead = result;</span><br><span class="line">        ListNode emptyNode&#123;<span class="number">0</span>&#125;; </span><br><span class="line">        <span class="keyword">int</span> carry = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            carry = addTwoNode(l1, l2, carry, result);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>((carry == <span class="number">0</span>) &amp;&amp; (l1-&gt;next == <span class="literal">nullptr</span>) &amp;&amp; (l2-&gt;next == <span class="literal">nullptr</span>))&#123;</span><br><span class="line">                <span class="keyword">return</span> resultHead;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                result-&gt;next = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">                result = result-&gt;next;</span><br><span class="line">                l1 = l1-&gt;next?l1-&gt;next:&amp;emptyNode;</span><br><span class="line">                l2 = l2-&gt;next?l2-&gt;next:&amp;emptyNode;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addTwoNode</span><span class="params">(ListNode* l1, ListNode* l2, <span class="keyword">int</span> carry, ListNode* result)</span></span>&#123;</span><br><span class="line">        result-&gt;val = (l1-&gt;val + l2-&gt;val + carry);</span><br><span class="line">        <span class="keyword">if</span>(result-&gt;val &gt;= <span class="number">10</span>)&#123;</span><br><span class="line">            result-&gt;val -= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Time complexity: O(n)<br><img src="/2019-07-14/Algorithm-Puzzles-Add-two-numbers/s1.png" alt></p>
<p>It’s do a little optimization:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        ListNode* result = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">        ListNode* resultHead = result;</span><br><span class="line">        ListNode emptyNode&#123;<span class="number">0</span>&#125;; </span><br><span class="line">        <span class="keyword">int</span> carry = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            carry = addTwoNode(l1-&gt;val, l2-&gt;val, result);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>((carry == <span class="number">0</span>) &amp;&amp; (l1-&gt;next == <span class="literal">nullptr</span>) &amp;&amp; (l2-&gt;next == <span class="literal">nullptr</span>))&#123;</span><br><span class="line">                <span class="keyword">return</span> resultHead;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                result-&gt;next = <span class="keyword">new</span> ListNode(carry);</span><br><span class="line">                result = result-&gt;next;</span><br><span class="line">                l1 = l1-&gt;next?l1-&gt;next:&amp;emptyNode;</span><br><span class="line">                l2 = l2-&gt;next?l2-&gt;next:&amp;emptyNode;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addTwoNode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>&amp; l1, <span class="keyword">const</span> <span class="keyword">int</span>&amp; l2, ListNode* result)</span></span>&#123;</span><br><span class="line">        result-&gt;val += (l1 + l2);</span><br><span class="line">        <span class="keyword">if</span>(result-&gt;val &gt;= <span class="number">10</span>)&#123;</span><br><span class="line">            result-&gt;val -= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="/2019-07-14/Algorithm-Puzzles-Add-two-numbers/s2.png" alt></p>
<p>Super! Better than 99.99%!</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Container With Most Water</title>
    <url>/2020-01-26/Algorithm-Puzzles-Container-With-Most-Water/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Container With Most Water</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given n non-negative integers a1, a2, …, an , where each represents a point at coordinate (i, ai). n vertical lines are drawn such that the two endpoints of line i is at (i, ai) and (i, 0). Find two lines, which together with x-axis forms a container, such that the container contains the most water.</p>
<p>Note: You may not slant the container and n is at least 2.</p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>This puzzle can be easily solved by exhaustion method but time complexity is <strong>O(N^2)</strong>. A better approach will be using “compress window“：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">size_t</span> length = height.size();</span><br><span class="line">        <span class="keyword">int</span> currentMax = <span class="number">0</span>, windowLeft = <span class="number">0</span>, windowRight = length - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (windowLeft &lt; windowRight) &#123;</span><br><span class="line">            currentMax = <span class="built_in">std</span>::max(</span><br><span class="line">                currentMax, <span class="built_in">std</span>::min(height[windowLeft], height[windowRight]) *</span><br><span class="line">                                (windowRight - windowLeft));</span><br><span class="line">            <span class="keyword">if</span> (height[windowLeft] &lt; height[windowRight]) &#123;</span><br><span class="line">                ++windowLeft;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                --windowRight;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> currentMax;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Here time complexity is <strong>O(N)</strong><br><img src="/2020-01-26/Algorithm-Puzzles-Container-With-Most-Water/s1.png" alt></p>
<p>Try to use iterator:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> currentMax = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">auto</span> iterL = height.cbegin();</span><br><span class="line">        <span class="keyword">auto</span> iterR = height.cend() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (iterL &lt; iterR) &#123;</span><br><span class="line">            currentMax =</span><br><span class="line">                <span class="built_in">std</span>::max(currentMax, <span class="built_in">std</span>::min(*iterL, *iterR) *</span><br><span class="line">                                         (<span class="keyword">int</span>)<span class="built_in">std</span>::distance(iterL, iterR));</span><br><span class="line">            <span class="keyword">if</span> (*iterL &lt; *iterR) &#123;</span><br><span class="line">                ++iterL;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                --iterR;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> currentMax;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="/2020-01-26/Algorithm-Puzzles-Container-With-Most-Water/s2.png" alt></p>
<p>Bravo!</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Integer to Roman</title>
    <url>/2020-01-27/Algorithm-Puzzles-Integer-to-Roman/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Integer to Roman</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Roman numerals are represented by seven different symbols: I, V, X, L, C, D and M.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Symbol       Value</span><br><span class="line">I             1</span><br><span class="line">V             5</span><br><span class="line">X             10</span><br><span class="line">L             50</span><br><span class="line">C             100</span><br><span class="line">D             500</span><br><span class="line">M             1000</span><br></pre></td></tr></table></figure>
<p>For example, two is written as II in Roman numeral, just two one’s added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II.</p>
<p>Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used:</p>
<p>I can be placed before V (5) and X (10) to make 4 and 9.<br><br>X can be placed before L (50) and C (100) to make 40 and 90.<br><br>C can be placed before D (500) and M (1000) to make 400 and 900.<br><br>Given an integer, convert it to a roman numeral. Input is guaranteed to be within the range from 1 to 3999.<br></p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><h2 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution 1"></a>Solution 1</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">intToRoman</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">string</span> ret = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">int</span> bitRet = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (num &gt;= <span class="number">1000</span>) &#123;</span><br><span class="line">            bitRet = num / <span class="number">1000</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bitRet; ++i) &#123;</span><br><span class="line">                ret += <span class="string">"M"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            num %= <span class="number">1000</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (num &gt;= <span class="number">100</span>) &#123;</span><br><span class="line">            bitRet = num / <span class="number">100</span>;</span><br><span class="line">            <span class="keyword">if</span> (bitRet == <span class="number">9</span>) &#123;</span><br><span class="line">                ret += <span class="string">"CM"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bitRet == <span class="number">4</span>) &#123;</span><br><span class="line">                ret += <span class="string">"CD"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (bitRet &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">                    ret += <span class="string">"D"</span>;</span><br><span class="line">                    bitRet -= <span class="number">5</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bitRet; ++i) &#123;</span><br><span class="line">                    ret += <span class="string">"C"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            num %= <span class="number">100</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (num &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">            bitRet = num / <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">if</span> (bitRet == <span class="number">9</span>) &#123;</span><br><span class="line">                ret += <span class="string">"XC"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bitRet == <span class="number">4</span>) &#123;</span><br><span class="line">                ret += <span class="string">"XL"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (bitRet &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">                    ret += <span class="string">"L"</span>;</span><br><span class="line">                    bitRet -= <span class="number">5</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bitRet; ++i) &#123;</span><br><span class="line">                    ret += <span class="string">"X"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            num %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            bitRet = num;</span><br><span class="line">            <span class="keyword">if</span> (bitRet == <span class="number">9</span>) &#123;</span><br><span class="line">                ret += <span class="string">"IX"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bitRet == <span class="number">4</span>) &#123;</span><br><span class="line">                ret += <span class="string">"IV"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (bitRet &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">                    ret += <span class="string">"V"</span>;</span><br><span class="line">                    bitRet -= <span class="number">5</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bitRet; ++i) &#123;</span><br><span class="line">                    ret += <span class="string">"I"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="/2020-01-27/Algorithm-Puzzles-Integer-to-Roman/s1.png" alt></p>
<h2 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution 2"></a>Solution 2</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">intToRoman</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> M[] = &#123;<span class="string">""</span>, <span class="string">"M"</span>, <span class="string">"MM"</span>, <span class="string">"MMM"</span>&#125;;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> C[] = &#123;<span class="string">""</span>,  <span class="string">"C"</span>,  <span class="string">"CC"</span>,  <span class="string">"CCC"</span>,  <span class="string">"CD"</span>,</span><br><span class="line">                            <span class="string">"D"</span>, <span class="string">"DC"</span>, <span class="string">"DCC"</span>, <span class="string">"DCCC"</span>, <span class="string">"CM"</span>&#125;;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> X[] = &#123;<span class="string">""</span>,  <span class="string">"X"</span>,  <span class="string">"XX"</span>,  <span class="string">"XXX"</span>,  <span class="string">"XL"</span>,</span><br><span class="line">                            <span class="string">"L"</span>, <span class="string">"LX"</span>, <span class="string">"LXX"</span>, <span class="string">"LXXX"</span>, <span class="string">"XC"</span>&#125;;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> I[] = &#123;<span class="string">""</span>,  <span class="string">"I"</span>,  <span class="string">"II"</span>,  <span class="string">"III"</span>,  <span class="string">"IV"</span>,</span><br><span class="line">                            <span class="string">"V"</span>, <span class="string">"VI"</span>, <span class="string">"VII"</span>, <span class="string">"VIII"</span>, <span class="string">"IX"</span>&#125;;</span><br><span class="line">        <span class="keyword">return</span> M[num / <span class="number">1000</span>] + C[(num % <span class="number">1000</span>) / <span class="number">100</span>] + X[(num % <span class="number">100</span>) / <span class="number">10</span>] +</span><br><span class="line">               I[num % <span class="number">10</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="/2020-01-27/Algorithm-Puzzles-Integer-to-Roman/s2.png" alt></p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Longest Palindromic Substring</title>
    <url>/2019-08-04/Algorithm-Puzzles-Longest-Palindromic-Substring/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Longest Palindromic Substring</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.</p>
<p>Example 1:</p>
<p>Input: “babad”<br>Output: “bab”<br>Note: “aba” is also a valid answer.<br>Example 2:</p>
<p>Input: “cbbd”<br>Output: “bb”</p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><h3 id="First-Came-out-solution"><a href="#First-Came-out-solution" class="headerlink" title="First Came out solution:"></a>First Came out solution:</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">longestPalindrome</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> head = <span class="number">0</span>,tail = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> length = s.length();</span><br><span class="line">        <span class="keyword">int</span> longestH = <span class="number">0</span>, longestT = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(head != length)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[head] == s[tail])&#123;</span><br><span class="line">                <span class="keyword">if</span>(isPalindromic(s.substr(head, tail - head + <span class="number">1</span>)))&#123;</span><br><span class="line">                    longestH = head;</span><br><span class="line">                    longestT = tail;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ++tail;</span><br><span class="line">            <span class="keyword">if</span>(tail &gt;= length)&#123;</span><br><span class="line">                ++head;</span><br><span class="line">                tail = head + longestT - longestH + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(tail &gt;= length)&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.substr(longestH, longestT - longestH + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindromic</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dMid = s.length()/<span class="number">2.0</span>;</span><br><span class="line">        <span class="keyword">int</span> mid = s.length()/<span class="number">2</span>;</span><br><span class="line">        <span class="built_in">string</span> sub = s.substr((dMid - mid) &gt; <span class="number">0</span> ? mid + <span class="number">1</span> : mid);</span><br><span class="line">        <span class="built_in">std</span>::reverse(sub.begin(), sub.end());</span><br><span class="line">        <span class="keyword">if</span>(sub == s.substr(<span class="number">0</span>, mid))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Result:</p>
<p><img src="/2019-08-04/Algorithm-Puzzles-Longest-Palindromic-Substring/s1.png" alt></p>
<div align="center"> 
![](Algorithm-Puzzles-Longest-Palindromic-Substring/f1.jpeg)
</div>

<p>Well, that’s the worst result I have ever seen.</p>
<h2 id="Extend-from-the-center"><a href="#Extend-from-the-center" class="headerlink" title="Extend from the center"></a>Extend from the center</h2><p>Checked the solution provided by leetcode, there is one way only have time complexity O(n²), I implemented in it C++ with a little optimization:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="built_in">string</span> <span class="title">longestPalindrome</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> start = <span class="number">0</span>, maxLength = <span class="number">0</span>, halfLength = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s.length() - i + <span class="number">1</span> &lt; halfLength || i + <span class="number">1</span> &lt; halfLength)&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> len1 = extendFromCenter(s, i, i);</span><br><span class="line">            <span class="keyword">int</span> len2 = extendFromCenter(s, i, i+<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">int</span> len = len1 &gt; len2 ? len1 : len2;</span><br><span class="line">            <span class="keyword">if</span>(len &gt; maxLength)&#123;</span><br><span class="line">                start = i - (len - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">                maxLength = len;</span><br><span class="line">                halfLength = maxLength / <span class="number">2</span>; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.substr(start, maxLength);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">extendFromCenter</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(left &gt;= <span class="number">0</span> &amp;&amp; right &lt; s.length() &amp;&amp; s[left] == s[right])&#123;</span><br><span class="line">            --left;</span><br><span class="line">            ++right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> right - left - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Result with this:</p>
<p><img src="/2019-08-04/Algorithm-Puzzles-Longest-Palindromic-Substring/s2.png" alt></p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Longest Substring Without Repeating Characters</title>
    <url>/2019-07-21/Algorithm-Puzzles-Longest-Substring-Without-Repeating-Characters/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Longest Substring Without Repeating Characters</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given a string, find the length of the longest substring without repeating characters.</p>
<p>Example 1:</p>
<p>Input: “abcabcbb”<br>Output: 3<br>Explanation: The answer is “abc”, with the length of 3.<br>Example 2:</p>
<p>Input: “bbbbb”<br>Output: 1<br>Explanation: The answer is “b”, with the length of 1.<br>Example 3:</p>
<p>Input: “pwwkew”<br>Output: 3<br>Explanation: The answer is “wke”, with the length of 3.<br>             Note that the answer must be a substring, “pwke” is a subsequence and not a substring.</p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><h3 id="First-came-out-solution"><a href="#First-came-out-solution" class="headerlink" title="First came out solution"></a>First came out solution</h3><p>Traverse substring(not all of them, with a little bit optimization)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> longest = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.size(); i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; s.size() + <span class="number">1</span>; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>((j-i) &lt;= longest)&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(checkStringUnique(s.substr(i,j-i)))</span><br><span class="line">                    longest = (longest &gt; (j - i)) ? longest : (j - i);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> longest;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">checkStringUnique</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span>&amp;&amp; s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> iter = s.begin(); iter != s.end(); ++iter)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s.find_first_of(*iter, <span class="built_in">std</span>::distance(s.begin(), iter)+<span class="number">1</span>) != <span class="built_in">std</span>::<span class="built_in">string</span>::npos)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Time complexity: O(n^3)</p>
<p><img src="/2019-07-21/Algorithm-Puzzles-Longest-Substring-Without-Repeating-Characters/s1.png" alt></p>
<p>But this solution is not good enough since the time complexity is O(n^3). Only better than 62.78% cpp users.</p>
<h3 id="Sliding-Window"><a href="#Sliding-Window" class="headerlink" title="Sliding Window"></a>Sliding Window</h3><p>Checked the reference answer, there is another solution: using sliding Window. </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">     <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.size();</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; <span class="built_in">map</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, i = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">auto</span> res = <span class="built_in">map</span>.find(s[j]);</span><br><span class="line">            <span class="keyword">if</span> (res != <span class="built_in">map</span>.end()) &#123;</span><br><span class="line">                i = (res-&gt;second &gt; i) ? res-&gt;second : i;</span><br><span class="line">                res-&gt;second = j + <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">map</span>.insert(&#123;s[j], j + <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans &gt; (j - i + <span class="number">1</span>)) ? ans : (j - i + <span class="number">1</span>);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Time complexity: O(n)</p>
<p><img src="/2019-07-21/Algorithm-Puzzles-Longest-Substring-Without-Repeating-Characters/s2.png" alt></p>
<p>It’s better than 85.71% now.</p>
<h3 id="Assuming-ASCII-128"><a href="#Assuming-ASCII-128" class="headerlink" title="Assuming ASCII 128"></a>Assuming ASCII 128</h3><p>The third way to solve this is assuming the string inputs are all ASCII 128 characters… In this case no hash table is needed.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">     <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.length(), ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> index[<span class="number">128</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, i = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            i = index[s[j]] &gt; i ? index[s[j]] : i;</span><br><span class="line">            ans = (ans &gt; (j - i + <span class="number">1</span>)) ? ans : (j - i + <span class="number">1</span>);</span><br><span class="line">            index[s[j]] = j + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="/2019-07-21/Algorithm-Puzzles-Longest-Substring-Without-Repeating-Characters/s3.png" alt></p>
<p>This solution is faster than 95.65%.</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Reverse Integer</title>
    <url>/2019-10-05/Algorithm-Puzzles-Reverse-Integer/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Reverse Integer</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given a 32-bit signed integer, reverse digits of an integer.</p>
<p>Example 1:</p>
<p>Input: 123<br>Output: 321<br>Example 2:</p>
<p>Input: -123<br>Output: -321<br>Example 3:</p>
<p>Input: 120<br>Output: 21</p>
<p>Note:<br>Assume we are dealing with an environment which could only store integers within the 32-bit signed integer range: [−231,  231 − 1]. For the purpose of this problem, assume that your function returns 0 when the reversed integer overflows.</p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>This puzzle is ez to solve if you considered possible overflow at the very beginning. I’d like to using string to do reverse process, which should be no overflow during reverse, after reversing then do overflow check. Considering that the range of int32_t is <em>[-2147483648, 2147483647]</em>, we need to check the value after reversing is in this range or not.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int32_t</span> reverse(<span class="keyword">int32_t</span> x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> ori = <span class="built_in">std</span>::to_string(x);</span><br><span class="line">        <span class="keyword">if</span> (ori[<span class="number">0</span>] == <span class="string">'-'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">std</span>::reverse(++<span class="built_in">std</span>::begin(ori), <span class="built_in">std</span>::end(ori));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">std</span>::reverse(<span class="built_in">std</span>::begin(ori), <span class="built_in">std</span>::end(ori));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ori.length() == <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (ori[<span class="number">0</span>] &gt; <span class="string">'2'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (ori[<span class="number">0</span>] == <span class="string">'2'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (atoi(ori.substr(<span class="number">1</span>, <span class="number">9</span>).c_str()) &gt; <span class="number">147483647</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ori.length() == <span class="number">11</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (ori[<span class="number">1</span>] &gt; <span class="string">'2'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (ori[<span class="number">1</span>] == <span class="string">'2'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (atoi(ori.substr(<span class="number">2</span>, <span class="number">9</span>).c_str()) &gt; <span class="number">147483648</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> atoi(ori.c_str());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Result I got:</p>
<p><img src="/2019-10-05/Algorithm-Puzzles-Reverse-Integer/s1.png" alt></p>
<p>One shot pass~~</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Palindrome Number</title>
    <url>/2019-10-26/Algorithm-Puzzles-Palindrome-Number/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Palindrome Number</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Determine whether an integer is a palindrome. An integer is a palindrome when it reads the same backward as forward.</p>
<p>Example 1:</p>
<p>Input: 121<br>Output: true<br>Example 2:</p>
<p>Input: -121<br>Output: false<br>Explanation: From left to right, it reads -121. From right to left, it becomes 121-. Therefore it is not a palindrome.<br>Example 3:</p>
<p>Input: 10<br>Output: false<br>Explanation: Reads 01 from right to left. Therefore it is not a palindrome.</p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><h3 id="First-came-out-solution"><a href="#First-came-out-solution" class="headerlink" title="First came out solution"></a>First came out solution</h3><p>My first came out solution is using string:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">stringstream</span> stream;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> str;</span><br><span class="line">        stream &lt;&lt; x;</span><br><span class="line">        stream &gt;&gt; str;</span><br><span class="line">        <span class="keyword">size_t</span> length = str.length();</span><br><span class="line">        <span class="keyword">auto</span> iterHead = str.cbegin();</span><br><span class="line">        <span class="keyword">auto</span> iterTail = str.cend() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; length; i+=<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(*iterHead == *iterTail)&#123;</span><br><span class="line">                ++iterHead;</span><br><span class="line">                --iterTail;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>I know it’s not the best solution at very beginning, but it still surprised me when submitted:</p>
<p><img src="/2019-10-26/Algorithm-Puzzles-Palindrome-Number/s1.png" alt></p>
<h3 id="Another-approach"><a href="#Another-approach" class="headerlink" title="Another approach"></a>Another approach</h3><p>Since the performance of transferring to string is so bad, I’d like to try to handle it in integer only.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> reverted = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (x % <span class="number">10</span> == <span class="number">0</span> &amp;&amp; x != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (x &gt; reverted) &#123;</span><br><span class="line">            reverted = reverted * <span class="number">10</span> + x % <span class="number">10</span>;</span><br><span class="line">            x /= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (x == reverted) || (x == reverted / <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="/2019-10-26/Algorithm-Puzzles-Palindrome-Number/s2.png" alt></p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Roman to Integer</title>
    <url>/2020-01-29/Algorithm-Puzzles-Roman-to-Integer/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Roman to Integer</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:<br>Roman numerals are represented by seven different symbols: I, V, X, L, C, D and M.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Symbol       Value</span><br><span class="line">I             1</span><br><span class="line">V             5</span><br><span class="line">X             10</span><br><span class="line">L             50</span><br><span class="line">C             100</span><br><span class="line">D             500</span><br><span class="line">M             1000</span><br></pre></td></tr></table></figure>
<p>For example, two is written as II in Roman numeral, just two one’s added together. Twelve is written as, XII, which is simply X + II. The number twenty seven is written as XXVII, which is XX + V + II.</p>
<p>Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not IIII. Instead, the number four is written as IV. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as IX. There are six instances where subtraction is used:</p>
<p>I can be placed before V (5) and X (10) to make 4 and 9.<br><br>X can be placed before L (50) and C (100) to make 40 and 90.<br><br>C can be placed before D (500) and M (1000) to make 400 and 900.<br><br>Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.<br></p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">romanToInt</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> iter = s.begin(); iter != s.end(); ++iter) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (*iter) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'I'</span>:</span><br><span class="line">                    <span class="keyword">if</span> (*(iter + <span class="number">1</span>) == <span class="string">'V'</span>) &#123;</span><br><span class="line">                        ret += <span class="number">4</span>;</span><br><span class="line">                        ++iter;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (*(iter + <span class="number">1</span>) == <span class="string">'X'</span>) &#123;</span><br><span class="line">                        ret += <span class="number">9</span>;</span><br><span class="line">                        ++iter;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        ret += <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'V'</span>:</span><br><span class="line">                    ret += <span class="number">5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'X'</span>:</span><br><span class="line">                    <span class="keyword">if</span> (*(iter + <span class="number">1</span>) == <span class="string">'L'</span>) &#123;</span><br><span class="line">                        ret += <span class="number">40</span>;</span><br><span class="line">                        ++iter;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (*(iter + <span class="number">1</span>) == <span class="string">'C'</span>) &#123;</span><br><span class="line">                        ret += <span class="number">90</span>;</span><br><span class="line">                        ++iter;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        ret += <span class="number">10</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'L'</span>:</span><br><span class="line">                    ret += <span class="number">50</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'C'</span>:</span><br><span class="line">                    <span class="keyword">if</span> (*(iter + <span class="number">1</span>) == <span class="string">'D'</span>) &#123;</span><br><span class="line">                        ret += <span class="number">400</span>;</span><br><span class="line">                        ++iter;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (*(iter + <span class="number">1</span>) == <span class="string">'M'</span>) &#123;</span><br><span class="line">                        ret += <span class="number">900</span>;</span><br><span class="line">                        ++iter;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        ret += <span class="number">100</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'D'</span>:</span><br><span class="line">                    ret += <span class="number">500</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'M'</span>:</span><br><span class="line">                    ret += <span class="number">1000</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Result:</p>
<p>Runtime beats 98.55% in all cpp submissions:<br><img src="/2020-01-29/Algorithm-Puzzles-Roman-to-Integer/s1.png" alt></p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Median of Two Sorted Arrays</title>
    <url>/2019-07-27/Algorithm-Puzzles-Median-of-Two-Sorted-Arrays/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Median of Two Sorted Arrays</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>There are two sorted arrays nums1 and nums2 of size m and n respectively.</p>
<p>Find the median of the two sorted arrays. The overall run time complexity should be O(log (m+n)).</p>
<p>You may assume nums1 and nums2 cannot be both empty.</p>
<p>Example 1:</p>
<p>nums1 = [1, 3]<br>nums2 = [2]</p>
<p>The median is 2.0<br>Example 2:</p>
<p>nums1 = [1, 2]<br>nums2 = [3, 4]</p>
<p>The median is (2 + 3)/2 = 2.5</p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>The first came out solution is using merge sort since the sub-vectors are already sorted. The funny part is the puzzle requests time complexity should be O(log (m+n)), which is same as merge sort.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1,<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums3;</span><br><span class="line">        nums3.resize(nums1.size()+nums2.size());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">auto</span> iter1 = nums1.begin();</span><br><span class="line">        <span class="keyword">auto</span> iter2 = nums2.begin();</span><br><span class="line">        <span class="keyword">auto</span> iter3 = nums3.begin();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(;; ++iter3)&#123;</span><br><span class="line">            <span class="keyword">if</span>(iter1 == nums1.end())&#123;</span><br><span class="line">                <span class="built_in">std</span>::copy(iter2,nums2.end(),iter3);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(iter2 == nums2.end())&#123;</span><br><span class="line">                <span class="built_in">std</span>::copy(iter1,nums1.end(),iter3);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(*iter1&lt;=*iter2)&#123;</span><br><span class="line">                *iter3 = *iter1;</span><br><span class="line">                ++iter1;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                *iter3 = *iter2;</span><br><span class="line">                ++iter2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(nums3.size()%<span class="number">2</span> == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> nums3[(nums3.size()<span class="number">-1</span>)/<span class="number">2</span>];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (nums3[nums3.size()/<span class="number">2</span>] + nums3[nums3.size()/<span class="number">2</span> - <span class="number">1</span>])/<span class="number">2.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Time complexity: O(log(m+n))</p>
<p>Result I got:<br><img src="/2019-07-27/Algorithm-Puzzles-Median-of-Two-Sorted-Arrays/s1.png" alt></p>
<p>Better than 98.75%. BTW it seems I can get different result with the exactly same code…</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Regular Expression Matching</title>
    <url>/2020-01-05/Algorithm-Puzzles-Regular-Expression-Matching/</url>
    <content><![CDATA[<p><del>每天</del> <del>每周</del> 偶尔一道算法题： 正则表达式匹配</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given an input string (s) and a pattern (p), implement regular expression matching with support for ‘.’ and ‘*’.</p>
<p>‘.’ Matches any single character.<br><br>‘*’ Matches zero or more of the preceding element.<br><br>The matching should cover the entire input string (not partial).</p>
<p>Note:</p>
<p>s could be empty and contains only lowercase letters a-z.<br><br>p could be empty and contains only lowercase letters a-z, and characters like . or *.</p>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>其实一开始我是打算用c++自带的正则表达式库的，敲完<code>#include &lt;regex&gt;</code>后觉得这样不太好，毕竟是在做算法题</p>
<p><img src="/2020-01-05/Algorithm-Puzzles-Regular-Expression-Matching/Onn.png" alt></p>
<p>那就暴力流来一波！首先考虑没有通配符的情况下, 比较完一位再比较下一位，很自然地想到递归：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isMatch</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s, <span class="keyword">const</span> <span class="built_in">string</span>&amp; p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (p.empty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> s.empty();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (s[<span class="number">0</span>] == p[<span class="number">0</span>]) &amp;&amp; isMatch(s.substr(<span class="number">1</span>), p.substr(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>加上通配符<strong>“.”</strong>的情况也比较容易，只需要检查一下字符串在该位有字符即可：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isMatch</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s, <span class="keyword">const</span> <span class="built_in">string</span>&amp; p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (p.empty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> s.empty();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">bool</span> currentMatch = (s[<span class="number">0</span>] == p[<span class="number">0</span>]) || (p[<span class="number">0</span>] == <span class="string">'.'</span> &amp;&amp; !s.empty());</span><br><span class="line">        <span class="keyword">return</span> currentMatch &amp;&amp; isMatch(s.substr(<span class="number">1</span>), p.substr(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>然后是通配符<strong>“*“</strong>,这个有点麻烦需要去搜字符串后面几位，匹配0次的情况即<code>return isMatch(s, p.substr(2))</code>，直接跳过当前字符后后面的”*”, 匹配1次的情况即<code>return (currentMatch &amp;&amp; isMatch(s.substr(1), p))</code>, 把待匹配字符串后移一位，然后继续递归：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isMatch</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s, <span class="keyword">const</span> <span class="built_in">string</span>&amp; p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (p.empty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> s.empty();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">bool</span> currentMatch = (s[<span class="number">0</span>] == p[<span class="number">0</span>]) || (p[<span class="number">0</span>] == <span class="string">'.'</span> &amp;&amp; !s.empty());</span><br><span class="line">        <span class="keyword">if</span> (p[<span class="number">1</span>] == <span class="string">'*'</span> &amp;&amp; p.length() &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> isMatch(s, p.substr(<span class="number">2</span>)) ||</span><br><span class="line">                   (currentMatch &amp;&amp; isMatch(s.substr(<span class="number">1</span>), p));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> currentMatch &amp;&amp; isMatch(s.substr(<span class="number">1</span>), p.substr(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>试了几个测试例，感觉还行哈~~</p>
<p><img src="/2020-01-05/Algorithm-Puzzles-Regular-Expression-Matching/baoli.jpg" alt></p>
<p>然后提交完结果出来了：</p>
<p><img src="/2020-01-05/Algorithm-Puzzles-Regular-Expression-Matching/s1.png" alt></p>
<p>看来我还是too naive…</p>
<p><img src="/2020-01-05/Algorithm-Puzzles-Regular-Expression-Matching/meijianguo.jpeg" alt></p>
<p>看了下提示，大意是用动态规划，先写状态转移方程:<br>定义dp[i][j] 在 s[0,i-1]和p[0,j-1]匹配时为正，反之为假</p>
<ul>
<li>当没有通配符<strong>*</strong>时：dp[i][j] = dp[i-1][j-1] &amp;&amp; (s[i-1] == p[j-1])</li>
<li>当有通配符<strong>*</strong>时:<ul>
<li>重复0次：dp[i][j] = dp[i][j-2]</li>
<li>重复1次：dp[i][j] = dp[i-1][j] &amp;&amp; (s[i-1] == p[j-2])</li>
</ul>
</li>
</ul>
<p>贴一下代码(这里优化了一下，照着上面的写空间复杂度会到O(i*j), 下面的为O(N))</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isMatch</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s, <span class="keyword">const</span> <span class="built_in">string</span>&amp; p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = s.length(), n = p.length();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; dp(n + <span class="number">1</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="keyword">bool</span> pre = dp[<span class="number">0</span>];</span><br><span class="line">            dp[<span class="number">0</span>] = !i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                <span class="keyword">bool</span> temp = dp[j];</span><br><span class="line">                <span class="keyword">if</span> (p[j - <span class="number">1</span>] == <span class="string">'*'</span>) &#123;</span><br><span class="line">                    dp[j] = dp[j - <span class="number">2</span>] || (i &amp;&amp; dp[j] &amp;&amp; (s[i - <span class="number">1</span>] == p[j - <span class="number">2</span>] || p[j - <span class="number">2</span>] == <span class="string">'.'</span>));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    dp[j] = i &amp;&amp; pre &amp;&amp; (s[i - <span class="number">1</span>] == p[j - <span class="number">1</span>] || p[j - <span class="number">1</span>] == <span class="string">'.'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                pre = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="/2020-01-05/Algorithm-Puzzles-Regular-Expression-Matching/s2.png" alt></p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Two Sum</title>
    <url>/2019-07-11/Algorithm-Puzzles-Two-Sum/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Two Sum</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given an array of integers, return <strong>indices</strong> of the two numbers such that they add up to a specific target.</p>
<p>You may assume that each input would have <strong>exactly</strong> one solution, and you may not use the same element twice.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Given nums &#x3D; [2, 7, 11, 15], target &#x3D; 9,</span><br><span class="line"></span><br><span class="line">Because nums[0] + nums[1] &#x3D; 2 + 7 &#x3D; 9,</span><br><span class="line">return [0, 1].</span><br></pre></td></tr></table></figure>

<p>The template code provided by leetcode:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>The first came out solution from my head is for every elements for-loop traverse once to find the result:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; a : nums)&#123;</span><br><span class="line">            <span class="keyword">auto</span> tryToFind = target - a;</span><br><span class="line">            <span class="keyword">for</span>(...)</span><br><span class="line">                <span class="comment">//if tryToFind exist in nums</span></span><br><span class="line">                <span class="comment">//return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>It’s really ez! But time complexity will be <strong>O(n^2)</strong> since there are 2 for-loops inside. There must be a better way, I can’t submit with this solution!</p>
<p><img src="/2019-07-11/Algorithm-Puzzles-Two-Sum/think.jpg" alt></p>
<p>So what kind of search method is better? Maybe hash table?</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; <span class="built_in">map</span>;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; a : nums)&#123;</span><br><span class="line">            <span class="built_in">map</span>.insert(&#123;a,i&#125;);</span><br><span class="line">            <span class="keyword">auto</span> res = <span class="built_in">map</span>.find(target-a);</span><br><span class="line">            <span class="keyword">if</span>(res != <span class="built_in">map</span>.end())&#123;</span><br><span class="line">                <span class="keyword">if</span>(i != res-&gt;second)</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(&#123;i, res-&gt;second&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">std</span>::invalid_argument(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Bravo! Time complexity is <strong>O(n)</strong> now!(but we used more space)<br>results:<br><img src="/2019-07-11/Algorithm-Puzzles-Two-Sum/s1.png" alt><br>What? Only better than 88.56%? OK it still can get improvements by replacing for-each with for-loop(But why I choose for-each at the first time…)</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; <span class="built_in">map</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.size(); i++)&#123;</span><br><span class="line">            <span class="built_in">map</span>.insert(&#123;nums[i],i&#125;);</span><br><span class="line">            <span class="keyword">auto</span> res = <span class="built_in">map</span>.find(target-nums[i]);</span><br><span class="line">            <span class="keyword">if</span>(res != <span class="built_in">map</span>.end())&#123;</span><br><span class="line">                <span class="keyword">if</span>(i != res-&gt;second)</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(&#123;i, res-&gt;second&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>result:<br><img src="/2019-07-11/Algorithm-Puzzles-Two-Sum/s2_1.png" alt></p>
<p><img src="/2019-07-11/Algorithm-Puzzles-Two-Sum/s2_2.png" alt></p>
<p>Cool, better than 99.79% now!</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: String to Integer (atoi)</title>
    <url>/2019-10-13/Algorithm-Puzzles-String-to-Integer-atoi/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: String to Integer (atoi)</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Implement atoi which converts a string to an integer.</p>
<p>The function first discards as many whitespace characters as necessary until the first non-whitespace character is found. Then, starting from this character, takes an optional initial plus or minus sign followed by as many numerical digits as possible, and interprets them as a numerical value.</p>
<p>The string can contain additional characters after those that form the integral number, which are ignored and have no effect on the behavior of this function.</p>
<p>If the first sequence of non-whitespace characters in str is not a valid integral number, or if no such sequence exists because either str is empty or it contains only whitespace characters, no conversion is performed.</p>
<p>If no valid conversion could be performed, a zero value is returned.</p>
<p>Note:</p>
<p>Only the space character ‘ ‘ is considered as whitespace character.<br>Assume we are dealing with an environment which could only store integers within the 32-bit signed integer range: [−231,  231 − 1]. If the numerical value is out of the range of representable values, INT_MAX (231 − 1) or INT_MIN (−231) is returned.<br>Example 1:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Input: &quot;42&quot;</span><br><span class="line">Output: 42</span><br></pre></td></tr></table></figure>
<p>Example 2:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Input: &quot;   -42&quot;</span><br><span class="line">Output: -42</span><br><span class="line">Explanation: The first non-whitespace character is &#39;-&#39;, which is the minus sign.</span><br><span class="line">             Then take as many numerical digits as possible, which gets 42.</span><br></pre></td></tr></table></figure>
<p>Example 3:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Input: &quot;4193 with words&quot;</span><br><span class="line">Output: 4193</span><br><span class="line">Explanation: Conversion stops at digit &#39;3&#39; as the next character is not a numerical digit.</span><br></pre></td></tr></table></figure>
<p>Example 4:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Input: &quot;words and 987&quot;</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: The first non-whitespace character is &#39;w&#39;, which is not a numerical </span><br><span class="line">             digit or a +&#x2F;- sign. Therefore no valid conversion could be performed.</span><br></pre></td></tr></table></figure>
<p>Example 5:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Input: &quot;-91283472332&quot;</span><br><span class="line">Output: -2147483648</span><br><span class="line">Explanation: The number &quot;-91283472332&quot; is out of the range of a 32-bit signed integer.</span><br><span class="line">             Thefore INT_MIN (−231) is returned.</span><br></pre></td></tr></table></figure>
<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>My first solution is using regex to filtrate incorrect inputs and find out the numerical:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">myAtoi</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> intMin = <span class="number">-2147483648</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> intMax = <span class="number">2147483647</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">std</span>::regex_match(str, <span class="built_in">std</span>::regex(<span class="string">"[ ]*[-+]?\\d&#123;1,&#125;[\\s\\S]*"</span>))) &#123;</span><br><span class="line">            <span class="built_in">std</span>::smatch numMatch;</span><br><span class="line">            <span class="built_in">std</span>::regex_search(str, numMatch, <span class="built_in">std</span>::regex(<span class="string">"[-+]?\\d&#123;1,&#125;"</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> index = <span class="number">0</span>, res = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> negative = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (numMatch[<span class="number">0</span>].str()[<span class="number">0</span>] == <span class="string">'-'</span>) &#123;</span><br><span class="line">                negative = <span class="number">-1</span>;</span><br><span class="line">                index = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (numMatch[<span class="number">0</span>].str()[<span class="number">0</span>] == <span class="string">'+'</span>) &#123;</span><br><span class="line">                index = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (; index &lt; numMatch[<span class="number">0</span>].str().length(); ++index) &#123;</span><br><span class="line">                <span class="keyword">if</span> (res &gt; <span class="number">214748364</span> ||</span><br><span class="line">                    (res == <span class="number">214748364</span> &amp;&amp; numMatch[<span class="number">0</span>].str()[index] - <span class="string">'0'</span> &gt; <span class="number">7</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> negative == <span class="number">-1</span> ? intMin : intMax;</span><br><span class="line">                &#125;</span><br><span class="line">                res = res * <span class="number">10</span> + (numMatch[<span class="number">0</span>].str()[index] - <span class="string">'0'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> res * negative;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Then :</p>
<p><img src="/2019-10-13/Algorithm-Puzzles-String-to-Integer-atoi/s1.png" alt></p>
<p><img src="/2019-10-13/Algorithm-Puzzles-String-to-Integer-atoi/p1.jpeg" alt></p>
<p>I realized that maybe using regex is not a good idea since there is no need to traversal string more than once… After some modification, here is my solution 2:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">myAtoi</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> intMin = <span class="number">-2147483648</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> intMax = <span class="number">2147483647</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">size_t</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">size_t</span> length = str.length();</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">bool</span> negative = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        index = str.find_first_not_of(<span class="string">' '</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (index == <span class="built_in">std</span>::<span class="built_in">string</span>::npos) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (str[index] &lt; <span class="string">'0'</span> || str[index] &gt; <span class="string">'9'</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (str[index] == <span class="string">'-'</span>) &#123;</span><br><span class="line">                negative = <span class="literal">true</span>;</span><br><span class="line">                ++index;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str[index] == <span class="string">'+'</span>) &#123;</span><br><span class="line">                ++index;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (; index &lt; length; ++index) &#123;</span><br><span class="line">            <span class="keyword">if</span> (str[index] &lt; <span class="string">'0'</span> || str[index] &gt; <span class="string">'9'</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (res &gt; <span class="number">214748364</span> ||</span><br><span class="line">                (res == <span class="number">214748364</span> &amp;&amp; (str[index] - <span class="string">'0'</span> &gt; <span class="number">7</span>))) &#123;</span><br><span class="line">                <span class="keyword">return</span> negative ? intMin : intMax;</span><br><span class="line">            &#125;</span><br><span class="line">            res = res * <span class="number">10</span> + (str[index] - <span class="string">'0'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> negative ? -res : res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Result I got:</p>
<p><img src="/2019-10-13/Algorithm-Puzzles-String-to-Integer-atoi/s2.png" alt></p>
<p>0 ms and better than 100%…</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Android: BLE Operations</title>
    <url>/2020-07-05/Android-BLE-Operations/</url>
    <content><![CDATA[<p>When I was in university, I had developed a BLE based UAV controller based on an open source Android BLE library. The library itself is quite easy to use but I decided to develop an Android BLE app with native Android BLE API, which can connect and communicate with BLE GATT devices.</p>
<a id="more"></a>

<h2 id="Permissions"><a href="#Permissions" class="headerlink" title="Permissions"></a>Permissions</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.BLUETOOTH"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.BLUETOOTH_ADMIN"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_FINE_LOCATION"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: ACCESS_FINE_LOCATION are required for BT scanning after Android 9</p>
</blockquote>
<h2 id="Request-to-open-Bluetooth"><a href="#Request-to-open-Bluetooth" class="headerlink" title="Request to open Bluetooth"></a>Request to open Bluetooth</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> BluetoothAdapter mBluetoothAdapter;</span><br><span class="line"><span class="keyword">private</span> BluetoothManager mBluetoothManager;</span><br><span class="line"></span><br><span class="line">mBluetoothManager = (BluetoothManager) getActivity().getSystemService(Context.BLUETOOTH_SERVICE);</span><br><span class="line">mBluetoothAdapter = mBluetoothManager.getAdapter();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mBluetoothAdapter == <span class="keyword">null</span> || !mBluetoothAdapter.isEnabled()) &#123;</span><br><span class="line">    Intent enableBtIntent = <span class="keyword">new</span> Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);</span><br><span class="line">    startActivity(enableBtIntent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BLE-Scan"><a href="#BLE-Scan" class="headerlink" title="BLE Scan"></a>BLE Scan</h2><p>If there is no need to set scan filter, we can simply do:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ScanCallback mScanCallback = <span class="keyword">new</span> ScanCallback() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScanResult</span><span class="params">(<span class="keyword">int</span> callbackType, ScanResult result)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onScanResult(callbackType, result);</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="keyword">null</span>) &#123;</span><br><span class="line">           devicesList.add(result.getDevice());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">mBluetoothAdapter.getBluetoothLeScanner().startScan(mScanCallback);</span><br></pre></td></tr></table></figure>

<p>If we want add filter for scanner, i.e. We’d like to search devices with certain service:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> String SERVICE_UUID = <span class="string">"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"</span>;</span><br><span class="line">ParcelUuid parcelUuidMask = ParcelUuid.fromString(SERVICE_UUID);</span><br><span class="line">List&lt;ScanFilter&gt; filters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">ScanFilter.Builder filterBuilder = <span class="keyword">new</span> ScanFilter.Builder().setServiceUuid(parcelUuidMask);</span><br><span class="line">filters.add(filterBuilder.build());</span><br><span class="line">ScanSettings.Builder settingBuilder = <span class="keyword">new</span> ScanSettings.Builder();</span><br><span class="line">mFragmentReference.get().mBluetoothAdapter.getBluetoothLeScanner().startScan(filters, settingBuilder.build(), mScanCallback);</span><br></pre></td></tr></table></figure>

<h2 id="Connect-to-device"><a href="#Connect-to-device" class="headerlink" title="Connect to device"></a>Connect to device</h2><p>Blow code shows how to connect to device and set up callbacks:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> UUID mServiceUuid = UUID.fromString(SERVICE_UUID);</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> REQUEST_MTU = <span class="number">64</span>;</span><br><span class="line"><span class="comment">// Get from ScanCallback: result.getDevice();</span></span><br><span class="line"><span class="keyword">private</span> BluetoothDevice mDevice;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mDeviceGatt = mDevice.connectGatt(mContext, <span class="keyword">false</span>, <span class="keyword">new</span> BluetoothGattCallback() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onConnectionStateChange</span><span class="params">(BluetoothGatt gatt, <span class="keyword">int</span> status, <span class="keyword">int</span> newState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (newState) &#123;</span><br><span class="line">            <span class="keyword">case</span> BluetoothProfile.STATE_CONNECTED:</span><br><span class="line">                <span class="comment">// If connected we start to discover services provided by device</span></span><br><span class="line">                gatt.discoverServices();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> BluetoothProfile.STATE_CONNECTING:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> BluetoothProfile.STATE_DISCONNECTED:</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                gatt.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServicesDiscovered</span><span class="params">(BluetoothGatt gatt, <span class="keyword">int</span> status)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (gatt.getService(mServiceUuid) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// service found, request for increasing MTU</span></span><br><span class="line">            gatt.requestMtu(REQUEST_MTU);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCharacteristicRead</span><span class="params">(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, <span class="keyword">int</span> status)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">            Log.d(TAG, <span class="string">"Read characteristic: "</span> + <span class="keyword">new</span> String(characteristic.getValue()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCharacteristicWrite</span><span class="params">(BluetoothGatt gatt, BluetoothGattCharacteristic characteristic, <span class="keyword">int</span> status)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (status == BluetoothGatt.GATT_SUCCESS) &#123;</span><br><span class="line">            Log.d(TAG, <span class="string">"Write characteristic: "</span> + <span class="keyword">new</span> String(characteristic.getValue()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMtuChanged</span><span class="params">(BluetoothGatt gatt, <span class="keyword">int</span> mtu, <span class="keyword">int</span> status)</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"MTU changed to "</span> + mtu);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The default MTU for ATT is 23 bytes. In those 23 bytes, there are 20 bytes for GATT. To send/receive data more than 20 bytes at once, we need to call <code>requestMtu</code> to increase MTU.</p>
<h2 id="Read-Write-characteristic"><a href="#Read-Write-characteristic" class="headerlink" title="Read/Write characteristic"></a>Read/Write characteristic</h2><p>Blow code shows how to read characteristic:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Here we get all available characteristics in this service</span></span><br><span class="line">List&lt;BluetoothGattCharacteristic&gt; characteristics = gatt.getService(mServiceUuid).getCharacteristics();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Try to read the first characteristic</span></span><br><span class="line"><span class="keyword">if</span> (!mThing.mDeviceGatt.readCharacteristic(characteristics.get(<span class="number">0</span>))) &#123;</span><br><span class="line">    Log.e(<span class="string">"TAG"</span>, <span class="string">"Read characteristic error"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Blow code shows how to write characteristic:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> UUID mCharacteristicUuid = UUID.fromString(<span class="string">"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"</span>);</span><br><span class="line"></span><br><span class="line">BluetoothGattCharacteristic characteristic = gatt.getService(mServiceUuid).getCharacteristic(mCharacteristicUuid);</span><br><span class="line"></span><br><span class="line">characteristic.setValue();</span><br><span class="line">mDeviceGatt.writeCharacteristic(<span class="string">"data to write"</span>.getBytes());</span><br></pre></td></tr></table></figure>

<p>Once operation is done, <code>onCharacteristicRead</code> / <code>onCharacteristicWrite</code> will be called.</p>
<blockquote>
<p>Note: There is only one operation is allowed at a time. If we need to implement a complex logic with a lot of read/write operations, suggestion will be use a message queue.</p>
</blockquote>
]]></content>
      <categories>
        <category>App Development</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Android: Error when execute sdkmanager</title>
    <url>/2019-05-28/Android-Error-when-execute-sdkmanager/</url>
    <content><![CDATA[<p>Quick fix for error that <strong>sdkmanager</strong> throw exception when trying to call <strong>sdkmanager –license</strong> and <strong>sdkmanager –list</strong>.</p>
<a id="more"></a>

<h2 id="Error-messages"><a href="#Error-messages" class="headerlink" title="Error messages"></a>Error messages</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: javax&#x2F;xml&#x2F;bind&#x2F;annotation&#x2F;XmlSchema</span><br><span class="line">    at com.android.repository.api.SchemaModule$SchemaModuleVersion.&lt;init&gt;(SchemaModule.java:156)</span><br><span class="line">    at com.android.repository.api.SchemaModule.&lt;init&gt;(SchemaModule.java:75)</span><br><span class="line">    at com.android.sdklib.repository.AndroidSdkHandler.&lt;clinit&gt;(AndroidSdkHandler.java:81)</span><br><span class="line">    at com.android.sdklib.tool.sdkmanager.SdkManagerCli.main(SdkManagerCli.java:73)</span><br><span class="line">    at com.android.sdklib.tool.sdkmanager.SdkManagerCli.main(SdkManagerCli.java:48)</span><br><span class="line">    Caused by: java.lang.ClassNotFoundException: javax.xml.bind.annotation.XmlSchema</span><br><span class="line">    at java.base&#x2F;jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:582)</span><br><span class="line">    at java.base&#x2F;jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:185)</span><br><span class="line">    at java.base&#x2F;java.lang.ClassLoader.loadClass(ClassLoader.java:496)</span><br><span class="line">    ... 5 more</span><br></pre></td></tr></table></figure>

<h2 id="Quick-fix"><a href="#Quick-fix" class="headerlink" title="Quick fix"></a>Quick fix</h2><p>In Windows:</p>
<ol>
<li>Go to C:\Users\Alex.Li\AppData\Local\Android\Sdk\tools\bin</li>
<li>Open sdkmanager.bat with editor</li>
<li>Add <span style="color:blue">  -XX:+IgnoreUnrecognizedVMOptions –add-modules java.se.ee</span> after <span style="color:red">set DEFAULT_JVM_OPTS=”-Dcom.android.sdklib.toolsdir=%~dp0..”</span>:<figure class="highlight bat"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> DEFAULT_JVM_OPTS="-Dcom.android.sdklib.toolsdir=%~dp0\.." -XX:+IgnoreUnrecognizedVMOptions --add-modules java.se.ee</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>In Linux:</p>
<ol>
<li>Go to <strong><android_sdk_path>/tools/bin</android_sdk_path></strong>, <strong><android_sdk_path></android_sdk_path></strong> is the path where you unzip your Android SDK.</li>
<li>Open sdkmanger with editor</li>
<li>Add <span style="color:blue">  -XX:+IgnoreUnrecognizedVMOptions –add-modules java.se.ee</span> after <span style="color:red">DEFAULT_JVM_OPTS=’”-Dcom.android.sdklib.toolsdir=$APP_HOME”‘“</span>:<figure class="highlight bat"><table><tr><td class="code"><pre><span class="line">DEFAULT_JVM_OPTS='"-Dcom.android.sdklib.toolsdir=$APP_HOME" -XX:+IgnoreUnrecognizedVMOptions --add-modules java.se.ee'</span><br></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: ZigZag Conversion</title>
    <url>/2019-09-28/Algorithm-Puzzles-ZigZag-Conversion/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: ZigZag Conversion</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>The string “PAYPALISHIRING” is written in a zigzag pattern on a given number of rows like this: (you may want to display this pattern in a fixed font for better legibility)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">P   A   H   N</span><br><span class="line">A P L S I I G</span><br><span class="line">Y   I   R</span><br></pre></td></tr></table></figure>
<p>And then read line by line: “PAHNAPLSIIGYIR”</p>
<p>Write the code that will take a string and make this conversion given a number of rows:</p>
<p>string convert(string s, int numRows);<br>Example 1:</p>
<p>Input: s = “PAYPALISHIRING”, numRows = 3<br>Output: “PAHNAPLSIIGYIR”<br>Example 2:</p>
<p>Input: s = “PAYPALISHIRING”, numRows = 4<br>Output: “PINALSIGYAHRPI”<br>Explanation:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">P     I    N</span><br><span class="line">A   L S  I G</span><br><span class="line">Y A   H R</span><br><span class="line">P     I</span><br></pre></td></tr></table></figure>

<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><h3 id="First-came-out-solution"><a href="#First-came-out-solution" class="headerlink" title="First came out solution"></a>First came out solution</h3><table>
<thead>
<tr>
<th align="center">0</th>
<th align="center"></th>
<th align="center"></th>
<th align="center">6</th>
<th align="center"></th>
<th align="center"></th>
<th align="center">12</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center"></td>
<td align="center">5</td>
<td align="center">7</td>
<td align="center"></td>
<td align="center">11</td>
<td align="center">13</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">4</td>
<td align="center"></td>
<td align="center">8</td>
<td align="center">10</td>
<td align="center"></td>
<td align="center">14</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">9</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">15</td>
</tr>
</tbody></table>
<p>It’s obvious that the output is periodic for first row:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0 &#x3D; 2 * (numRows - 1) * 0</span><br><span class="line">6 &#x3D; 2 * (numRows - 1) * 1</span><br><span class="line">12 &#x3D; 2 * (numRows - 1) * 2</span><br></pre></td></tr></table></figure>

<p>Let <span style="color:red"><em>T = 2 * (numRows - 1)</em></span>, for next row(row[1]):</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1 &#x3D; T * 0 + 1 </span><br><span class="line">5 &#x3D; T * 1 - 1</span><br><span class="line">7 &#x3D; T * 1 + 1</span><br><span class="line">11 &#x3D; T * 2 - 1</span><br><span class="line">13 &#x3D; T * 2 + 1</span><br></pre></td></tr></table></figure>

<p>For row[2]:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2 &#x3D; T * 0 + 2</span><br><span class="line">4 &#x3D; T * 1 - 2</span><br><span class="line">8 &#x3D; T * 1 + 2</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>Change 1,2 to <em>rowIndex</em> which start from <em>0</em> to <em>numRows - 1</em> :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0 &#x3D; T * 0 + rowIndex (rowIndex &#x3D; 0)</span><br><span class="line">1 &#x3D; T * 0 + rowIndex (rowIndex &#x3D; 1)</span><br><span class="line">2 &#x3D; T * 0 + rowIndex (rowIndex &#x3D; 2)</span><br></pre></td></tr></table></figure>


<p>Cool, can start coding now</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">convert</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> s, <span class="keyword">int</span> numRows)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (numRows == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> res;</span><br><span class="line">        <span class="keyword">size_t</span> maxLength = s.size();</span><br><span class="line">        <span class="keyword">size_t</span> T = <span class="number">2</span> * (numRows - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> rowIndex = <span class="number">0</span>; rowIndex &lt; numRows; ++rowIndex) &#123;</span><br><span class="line">            <span class="keyword">size_t</span> oriIndex = rowIndex;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (oriIndex &lt; maxLength) &#123;</span><br><span class="line">                res.push_back(s[oriIndex]);</span><br><span class="line">                <span class="keyword">size_t</span> insertOne = oriIndex + T - rowIndex - rowIndex;</span><br><span class="line">                <span class="keyword">if</span> (insertOne &gt; oriIndex &amp;&amp; insertOne &lt; oriIndex + T &amp;&amp;</span><br><span class="line">                    insertOne &lt; maxLength) &#123;</span><br><span class="line">                    res.push_back(s[insertOne]);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                oriIndex += T;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Result:</p>
<p><img src="/2019-09-28/Algorithm-Puzzles-ZigZag-Conversion/s1.png" alt></p>
<p>Let’s do some optimization:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">convert</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s, <span class="keyword">int</span> numRows)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (numRows == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> res;</span><br><span class="line">        <span class="keyword">size_t</span> maxLength = s.size();</span><br><span class="line">        <span class="keyword">size_t</span> T = <span class="number">2</span> * (numRows - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> rowIndex = <span class="number">0</span>; rowIndex &lt; numRows; ++rowIndex) &#123;</span><br><span class="line">            <span class="keyword">size_t</span> oriIndex = rowIndex;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (oriIndex &lt; maxLength) &#123;</span><br><span class="line">                res.push_back(s[oriIndex]);</span><br><span class="line">                <span class="keyword">size_t</span> insertOne = oriIndex + T - rowIndex - rowIndex;</span><br><span class="line">                <span class="keyword">if</span> (insertOne &gt; oriIndex &amp;&amp; insertOne &lt; oriIndex + T &amp;&amp;</span><br><span class="line">                    insertOne &lt; maxLength) &#123;</span><br><span class="line">                    res.push_back(s[insertOne]);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                oriIndex += T;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">std</span>::move(res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Result:</p>
<p><img src="/2019-09-28/Algorithm-Puzzles-ZigZag-Conversion/s2.png" alt></p>
<p>Looks like we also can change <em>size_t T = 2 * (numRows - 1)</em> to <em>size_t T = numRows + numRows -2</em> to use add instead of multiply</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">convert</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s, <span class="keyword">int</span> numRows)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (numRows == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> res;</span><br><span class="line">        <span class="keyword">size_t</span> maxLength = s.size();</span><br><span class="line">        <span class="keyword">size_t</span> T = (numRows + numRows - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> rowIndex = <span class="number">0</span>; rowIndex &lt; numRows; ++rowIndex) &#123;</span><br><span class="line">            <span class="keyword">size_t</span> oriIndex = rowIndex;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (oriIndex &lt; maxLength) &#123;</span><br><span class="line">                res.push_back(s[oriIndex]);</span><br><span class="line">                <span class="keyword">size_t</span> insertOne = oriIndex + T - rowIndex - rowIndex;</span><br><span class="line">                <span class="keyword">if</span> (insertOne &gt; oriIndex &amp;&amp; insertOne &lt; oriIndex + T &amp;&amp;</span><br><span class="line">                    insertOne &lt; maxLength) &#123;</span><br><span class="line">                    res.push_back(s[insertOne]);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                oriIndex += T;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">std</span>::move(res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Result:</p>
<p><img src="/2019-09-28/Algorithm-Puzzles-ZigZag-Conversion/s3.png" alt></p>
<p>Super, better than 99.34% now!</p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Android: Swipe Views With Tabs(TabLayout + ViewPager)</title>
    <url>/2020-05-16/Android-Swipe-Views-With-Tabs-TabLayout-ViewPager/</url>
    <content><![CDATA[<p>In AndroidX, TabLayout has been extended and moved to package com.google.android.material.tabs.TabLayout. This post will describe how to use <strong>TabLayout + ViewPager</strong> to create swipe views with tabs in AndroidX.</p>
<a id="more"></a>

<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><img src="https://blog-image-host.oss-cn-shanghai.aliyuncs.com/lzqblog/Android-Swipe-Views-With-Tabs-TabLayout-ViewPager/swipe.gif" width="50%" height="50%">

<h2 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h2><p>Before AndroidX, <strong>TabLayout</strong> is part of <span style="color:red">support</span> package:</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">'com.android.support:design:28.0.0'</span></span><br></pre></td></tr></table></figure>

<p>But now we need to use <span style="color:red">material</span> package:</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">'com.google.android.material:material:1.0.0'</span></span><br></pre></td></tr></table></figure>

<h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><p>In my scenario I added TabLayout and ViewPager in a fragment(main_fragment.xml):</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/main"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".ui.main.MainFragment"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.tabs.TabLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/tab_layout"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.viewpager.widget.ViewPager</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/viewPager"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Here we added one TabLayout and one ViewPager inside. We will add tab items dynamically, but it’s also doable to add tab items inside layout file by adding <span style="color:red"><em>com.google.android.material.tabs.TabItem</em></span>.</p>
<p>Then we need another fragment(publish_fragment.xml) to display the view in each tab.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/publish"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".ui.main.PublishFragment"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/textView"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Hello"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Here we added a TextView shows “Hello”.</p>
<h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><p>Back to Java code, in <em>MainFragment.java</em> we need to implement <strong>FragmentPagerAdapter</strong>, and <code>setupWithViewPager</code> to <strong>TabLayout</strong> :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MainFragment <span class="title">newInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MainFragment();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Fragment&gt; fragmentList = <span class="keyword">new</span> ArrayList&lt;Fragment&gt;();</span><br><span class="line">    <span class="keyword">private</span> String[] tabString = &#123;<span class="string">"TAB1"</span>, <span class="string">"TAB2"</span>, <span class="string">"TAB3"</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,</span></span></span><br><span class="line"><span class="function"><span class="params">                             @Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.main_fragment, container, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">        TabLayout tabLayout = (TabLayout) getView().findViewById(R.id.tab_layout);</span><br><span class="line">        ViewPager viewPager = (ViewPager) getView().findViewById(R.id.viewPager);</span><br><span class="line">        MyAdapter fragmentAdapter = <span class="keyword">new</span>  MyAdapter(getChildFragmentManager());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(String string:tabString)&#123;</span><br><span class="line">            tabLayout.addTab(tabLayout.newTab().setText(string));</span><br><span class="line">            fragmentList.add(PublishFragment.newInstance());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        viewPager.setAdapter(fragmentAdapter);</span><br><span class="line">        tabLayout.setupWithViewPager(viewPager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAdapter</span> <span class="keyword">extends</span> <span class="title">FragmentPagerAdapter</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MyAdapter</span><span class="params">(FragmentManager fm)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(fm);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fragmentList.size();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Fragment <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fragmentList.get(position);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Nullable</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> CharSequence <span class="title">getPageTitle</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> tabString[position];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>App Development</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Android: Swipe Down To Refresh</title>
    <url>/2020-06-27/Android-Swipe-Down-To-Refresh/</url>
    <content><![CDATA[<p>“Swipe down/Pull down to refresh” is a widely used feature in various kinds of apps. Let’s see how can we do that via SwipeRefreshLayout in AndroidX.</p>
<a id="more"></a>

<h2 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h2><figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">implementation <span class="string">'androidx.swiperefreshlayout:swiperefreshlayout:1.0.0'</span></span><br></pre></td></tr></table></figure>

<h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/mySwipeRefreshLayout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".ui.main.DevicesFragment"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/myRecyclerView"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Here we have a <code>RecyclerView</code> inside <code>SwipeRefreshLayout</code>. We plan to update dataset in <code>RecyclerView</code> when user swipe down.</p>
<h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><p>To implement the logic of refreshing, we need to set refresh listener and override method <code>onRefresh</code>:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">mSwipeRefreshLayout = getView().findViewById(R.id.mySwipeRefreshLayout);</span><br><span class="line">mSwipeRefreshLayout.setOnRefreshListener(<span class="keyword">new</span> SwipeRefreshLayout.OnRefreshListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="comment">// logic implementation start</span></span><br><span class="line">      <span class="comment">// dataSet.add(fetchFromServer());</span></span><br><span class="line">      <span class="comment">// logic implementation end</span></span><br><span class="line">      mSwipeRefreshLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>When refreshing is done, call <code>setRefreshing(false)</code> to stop refreshing animation.</p>
]]></content>
      <categories>
        <category>App Development</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Android添加App载入界面</title>
    <url>/2017-11-09/Android%E6%B7%BB%E5%8A%A0App%E8%BD%BD%E5%85%A5%E7%95%8C%E9%9D%A2/</url>
    <content><![CDATA[<p>当App启动载入时间较长时，我们希望有一个载入界面过渡，当载入完成后再切换到MainActivity。这个载入界面我们称之为SplashActivity。</p>
<a id="more"></a>
<p>首先写一个继承AppCompatActivity的SplashActivity：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplashActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span></span>&#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> SplashTime = <span class="number">3200</span>;<span class="comment">// 期望的Splash时间</span></span><br><span class="line">		WebView wbGif;<span class="comment">// 在这里我使用Webview来加载一个GIF动画</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后Override onCreate方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_splash);</span><br><span class="line">        wbGif = (WebView) findViewById(R.id.webViewGif);<span class="comment">// 在这里我使用Webview来加载一个GIF动画</span></span><br><span class="line">        wbGif.setBackgroundColor(Color.parseColor(<span class="string">"#6a0606"</span>));</span><br><span class="line">        wbGif.loadUrl(<span class="string">"file:///android_res/drawable/loading.gif"</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>在该onCreate方法中创建一个新的Handler对象，它将在SplashTime结束后切换到MainActivity：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> android.os.Handler().postDelayed(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Intent main = <span class="keyword">new</span> Intent(SplashActivity.<span class="keyword">this</span>, MainActivity<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        SplashActivity.<span class="keyword">this</span>.startActivity(main);</span><br><span class="line">        SplashActivity.<span class="keyword">this</span>.finish();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, SplashTime);</span><br></pre></td></tr></table></figure>
<p>最后别忘了在AndroidManifest.xml中将入口Activity设置为SplashActivity：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">".SplashActivity"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:screenOrientation</span>=<span class="string">"portrait"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>App Development</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>C++ standard exceptions</title>
    <url>/2019-02-28/C-standard-exceptions/</url>
    <content><![CDATA[<p>…</p>
<a id="more"></a>

<ul>
<li>logic_error(It reports errors that are a consequence of faulty logic within the program such as violating logical preconditions or class invariants and may be preventable.)<ul>
<li>invalid_argument</li>
<li>domain_error</li>
<li>length_error</li>
<li>out_of_range</li>
<li>future_error(C++11)</li>
</ul>
</li>
<li>bad_optional_access(C++17)</li>
<li>runtime_error(It reports errors that are due to events beyond the scope of the program and can not be easily predicted.)<ul>
<li>range_error</li>
<li>overflow_error</li>
<li>underflow_error</li>
<li>regex_error(C++11)</li>
<li>nonexistent_local_time(C++20)</li>
<li>ambiguous_local_time(C++20)</li>
<li>tx_exception(TM TS)</li>
<li>system_error(C++11)</li>
<li>ios_base::failure(C++11)</li>
<li>filesystem::filesystem_error(C++17)</li>
</ul>
</li>
<li>bad_typeid</li>
<li>bad_cast<ul>
<li>bad_any_cast(C++17)</li>
</ul>
</li>
<li>bad_weak_ptr(C++11)</li>
<li>bad_function_call(C++11)</li>
<li>bad_alloc(report failure to allocate storage)<ul>
<li>bad_array_new_length(C++11)</li>
</ul>
</li>
<li>bad_exception</li>
<li>ios_base::failure(until C++11)</li>
<li>bad_variant_access(C++17)</li>
</ul>
<p>For more details, refer to <a href="https://en.cppreference.com/w/cpp/error/exception" target="_blank" rel="noopener">cppreference</a></p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>C/C++ mixed programming error: undefined reference</title>
    <url>/2019-03-18/C-C-mixed-programming-error-undefined-reference/</url>
    <content><![CDATA[<p>The solution for this issue is very sample, add <span style="color:red">#ifdef __cplusplus extern “C”</span> in your C header files. I have seen a lots of C header files with this code, I also know that those codes will help C code compatible with C++ code, but I had never try to dig in to find out why those codes works until few weeks ago I was trying to call a lib written by C but lib headers didn’t surround with <span style="color:red">#ifdef __cplusplus extern “C”</span>.(Shame on me) This post will tell you why.</p>
<a id="more"></a>

<h2 id="Why-“undefined-reference”"><a href="#Why-“undefined-reference”" class="headerlink" title="Why “undefined reference”?"></a>Why “undefined reference”?</h2><p>Normally, You can see this “undefined reference” error when compiler can’t find your functions’ definition. But if you click into this post, I’m pretty sure that you have checked your code more than once. The reason why you meet this error while mixing programming is C and C++ compilers have different name mangling rules while compiling. In C, one function only can have one definition, but in C++ polymorphism was added so method can have same name but different version definitions with different parameter lists.<br>i.e. you have a function named foo in C:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>Meanwhile you have 2 method in C++:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">char</span> a)</span></span>&#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>C compiler might rename it as <strong>__foo</strong> in assembly. But C++ have to do some changes to make sure method name is unique in assembly, normally in C++ compiler it might be renamed with parameter list like <strong>__Z1_foo_int</strong> and <strong>__Z1_foo_char</strong>. There will be linking error like “undefined reference” when your trying to link a C lib which was compiled by C compiler and your C header files didn’t add <span style="color:red">#ifdef <strong>cplusplus extern “C”</strong></span>, because C++ compiler trying to find a symbol named **Z1_foo_int** but it can’t because it was renamed as <strong>__foo</strong> by C compiler.</p>
<h2 id="Why-extern-“C”-can-solve-this"><a href="#Why-extern-“C”-can-solve-this" class="headerlink" title="Why extern “C” can solve this?"></a>Why extern “C” can solve this?</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**** your declarations *****/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>C compiler will ignore those codes because of marco <strong>#ifdef __cplusplus</strong>, it’s easy to understand. But if you are using a C++ compiler, this <strong>extern “C”</strong> will be active and tell C++ compiler “you should link those functions with C name mangling rules”. In this case, C++ can find function definitions correctly in your C lib.</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>C# 生成Log文件</title>
    <url>/2017-11-16/CSharp-%E7%94%9F%E6%88%90Log%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<p>写了个Log类实现带时间戳的Log out, 代码如下：</p>
<a id="more"></a>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">My_Space</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> System;</span><br><span class="line">    <span class="keyword">using</span> System.IO;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Log</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">string</span> logFile;</span><br><span class="line">        <span class="keyword">private</span> StreamWriter writer;</span><br><span class="line">        <span class="keyword">private</span> FileStream fileStream = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Log</span>(<span class="params"><span class="keyword">string</span> fileName</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            logFile = fileName;</span><br><span class="line">            CreateDirectory(logFile);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LogOut</span>(<span class="params"><span class="keyword">string</span> info</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                FileInfo fileInfo = <span class="keyword">new</span> FileInfo(logFile);</span><br><span class="line">                <span class="keyword">if</span> (!fileInfo.Exists)</span><br><span class="line">                &#123;</span><br><span class="line">                    fileStream = fileInfo.Create();</span><br><span class="line">                    writer = <span class="keyword">new</span> StreamWriter(fileStream);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    fileStream = fileInfo.Open(FileMode.Append, FileAccess.Write);</span><br><span class="line">                    writer = <span class="keyword">new</span> StreamWriter(fileStream);</span><br><span class="line">                &#125;</span><br><span class="line">                writer.WriteLine(<span class="string">"@"</span> + DateTime.Now + <span class="string">"#"</span> + info + <span class="string">";"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (writer != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    writer.Close();</span><br><span class="line">                    writer.Dispose();</span><br><span class="line">                    fileStream.Close();</span><br><span class="line">                    fileStream.Dispose();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CreateDirectory</span>(<span class="params"><span class="keyword">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            DirectoryInfo directoryInfo = Directory.GetParent(filePath);</span><br><span class="line">            <span class="keyword">if</span> (!directoryInfo.Exists)</span><br><span class="line">            &#123;</span><br><span class="line">                directoryInfo.Create();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ReadLog</span>(<span class="params"><span class="keyword">string</span> logPath, <span class="keyword">out</span> <span class="keyword">string</span> dataRead</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            StreamReader sR1 = <span class="keyword">new</span> StreamReader(logPath);</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                dataRead = sR1.ReadToEnd();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C Sharp</tag>
      </tags>
  </entry>
  <entry>
    <title>Chrome: ERR_NETWORK_CHANGED on Ubuntu</title>
    <url>/2019-11-14/Chrome-ERR-NETWORK-CHANGED-on-Ubuntu/</url>
    <content><![CDATA[<p>In my scenario it was caused by some docker containers - All of them have booting issues but they have been set as <strong>–restart=always</strong>, which caused they start to create js requests periodicity. Everything is ok after removing those docker containers.</p>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>CMake: Skip Compiler Check</title>
    <url>/2020-09-13/CMake-Skip-Compiler-Check/</url>
    <content><![CDATA[<p>CMake will try to check compiler is working or not if project language was set to C/CXX. However, sometimes we just want to skip this test…</p>
<a id="more"></a>

<h1 id="Solution-1-Manually-Set-COMPILER-WORKS-Flag"><a href="#Solution-1-Manually-Set-COMPILER-WORKS-Flag" class="headerlink" title="Solution 1: Manually Set COMPILER_WORKS Flag"></a>Solution 1: Manually Set COMPILER_WORKS Flag</h1><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_C_COMPILER_WORKS <span class="number">1</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_COMPILER_WORKS <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h1 id="Solution-2-Set-project-language-to-NONE"><a href="#Solution-2-Set-project-language-to-NONE" class="headerlink" title="Solution 2: Set project language to NONE"></a>Solution 2: Set project language to NONE</h1><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">project</span>(&lt;<span class="keyword">PROJECT</span>-NAME&gt; NONE)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>cmake</tag>
      </tags>
  </entry>
  <entry>
    <title>Comments system has been added</title>
    <url>/2018-12-22/Comments-system-has-been-added/</url>
    <content><![CDATA[<p>现在blog支持使用Github帐号评论啦！<br>You can use your github account to add comments now!<br><img src="/2018-12-22/Comments-system-has-been-added/Screenshot&#32;from&#32;2018-12-22&#32;09-46-07.png" alt></p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>C#自定义Excel导出类</title>
    <url>/2017-11-08/CSharp%E8%87%AA%E5%AE%9A%E4%B9%89Excel%E5%AF%BC%E5%87%BA%E7%B1%BB/</url>
    <content><![CDATA[<p>前段时间写了个debug tool用来自动抓测试数据，该工具需要通过爬取Log数据自动生成带Chart的Excel，但是原生的COM组件非常不好用，于是我重新封装了一个。</p>
<a id="more"></a>
<p>Reference: Microsoft Excel 15.0 Object Library(COM组件)</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.Office.Interop.Excel;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">My_Space</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">ExportExcel</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">string</span> xlsOutPath;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">string</span> xlsInPath;</span><br><span class="line">        <span class="keyword">private</span> Application xlsApp;</span><br><span class="line">        <span class="keyword">private</span> Workbook xlsWorkBook;</span><br><span class="line">        <span class="keyword">private</span> Worksheet xlsWorkSheet;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">object</span> misValue = Missing.Value;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ExportExcel</span>(<span class="params"><span class="keyword">string</span> excelOutPath</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            xlsOutPath = excelOutPath;</span><br><span class="line">            xlsInPath = <span class="literal">null</span>;</span><br><span class="line">            xlsApp = <span class="keyword">new</span> Application();</span><br><span class="line">            <span class="keyword">if</span> (xlsApp == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Please Install Excel 2013 or Newer Verison"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            XlsWorkBook = xlsApp.Workbooks.Add(misValue);</span><br><span class="line">            xlsWorkSheet = XlsWorkBook.Worksheets.get_Item(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ExportExcel</span>(<span class="params"><span class="keyword">string</span> excelInPath, <span class="keyword">string</span> excelOutPath</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            xlsInPath = excelInPath;</span><br><span class="line">            xlsOutPath = excelOutPath;</span><br><span class="line">            xlsApp = <span class="keyword">new</span> Application();</span><br><span class="line">            <span class="keyword">if</span> (xlsApp == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Please Install Excel 2013 or Newer Verison"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            XlsWorkBook = xlsApp.Workbooks.Add(xlsInPath);</span><br><span class="line">            xlsWorkSheet = XlsWorkBook.Worksheets.get_Item(xlsWorkBook.Worksheets.Count);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Worksheet XlsWorkSheet &#123; <span class="keyword">get</span> =&gt; xlsWorkSheet; <span class="keyword">set</span> =&gt; xlsWorkSheet = <span class="keyword">value</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> Workbook XlsWorkBook &#123; <span class="keyword">get</span> =&gt; xlsWorkBook; <span class="keyword">set</span> =&gt; xlsWorkBook = <span class="keyword">value</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddChart</span>(<span class="params">Worksheet worksheet, <span class="keyword">double</span> left, <span class="keyword">double</span> top, <span class="keyword">double</span> weight, <span class="keyword">double</span> height, <span class="keyword">string</span> dataStart, <span class="keyword">string</span> dataEnd</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            ChartObjects xlsCharts = worksheet.ChartObjects(Type.Missing);</span><br><span class="line">            ChartObject myChart = xlsCharts.Add(left, top, weight, height);</span><br><span class="line">            Range chartRange = worksheet.get_Range(dataStart, dataEnd);</span><br><span class="line">            myChart.Chart.SetSourceData(chartRange, misValue);</span><br><span class="line">            myChart.Chart.ChartType = XlChartType.xlXYScatterSmooth;</span><br><span class="line">            myChart.Chart.ChartStyle = <span class="number">245</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddSheet</span>(<span class="params"><span class="keyword">string</span> name</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">bool</span> exist = <span class="literal">false</span>;<span class="keyword">int</span> i;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= XlsWorkBook.Sheets.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (XlsWorkBook.Sheets[i].Name == name)</span><br><span class="line">                &#123;</span><br><span class="line">                    exist = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!exist)</span><br><span class="line">            &#123;</span><br><span class="line">                xlsWorkSheet = XlsWorkBook.Sheets.Add(misValue, xlsWorkSheet, misValue, misValue);</span><br><span class="line">                xlsWorkSheet.Name = name;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                xlsWorkSheet = XlsWorkBook.Sheets[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CopySheet</span>(<span class="params">Worksheet src,Worksheet dst</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            src.Cells.Copy(Type.Missing);</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                dst.Paste(Type.Missing, Type.Missing);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddHyperLink</span>(<span class="params"><span class="keyword">string</span> cellName, <span class="keyword">string</span> link</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Range range = xlsWorkSheet.get_Range(cellName,Type.Missing);</span><br><span class="line">            xlsWorkSheet.Hyperlinks.Add(range, link);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SaveExcel</span>(<span class="params"><span class="keyword">bool</span> flag</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag)</span><br><span class="line">            &#123;</span><br><span class="line">                xlsWorkBook.Close(<span class="literal">true</span>, xlsOutPath, misValue);</span><br><span class="line">            &#125;</span><br><span class="line">            System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsWorkSheet);</span><br><span class="line">            System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsWorkBook);</span><br><span class="line">            System.Runtime.InteropServices.Marshal.ReleaseComObject(xlsApp);</span><br><span class="line">            xlsWorkSheet = <span class="literal">null</span>;</span><br><span class="line">            xlsWorkBook = <span class="literal">null</span>;</span><br><span class="line">            xlsApp = <span class="literal">null</span>;</span><br><span class="line">            GC.Collect();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C Sharp</tag>
      </tags>
  </entry>
  <entry>
    <title>C++ Design Patterns: Singleton</title>
    <url>/2018-09-12/Cpp-Design-Patterns-Singleton/</url>
    <content><![CDATA[<p>Singleton is a widely used design patterns in software engineering. This post will tell you when should we use Singleton and how to design a universal,template based Singleton base class.</p>
<a id="more"></a>

<h2 id="Why-Singleton"><a href="#Why-Singleton" class="headerlink" title="Why Singleton"></a>Why Singleton</h2><p>For some special cases, we want one class only can be instantiated only once to avoid unexpected behavior, for example threadpool and logger. Threadpool and logger normally should be instantiated when we start the program and it should have the same lifetime as program. So we need to make sure those class will not be instantiated more than once and also should not be destroyed until program end.</p>
<h2 id="Differences-Between-Static-Class-And-Singleton"><a href="#Differences-Between-Static-Class-And-Singleton" class="headerlink" title="Differences Between Static Class And Singleton"></a>Differences Between Static Class And Singleton</h2><p>Static class basically is a bunch of static functions, it’s not an OOP design. Singleton can implement interfaces and it’s more OOP like.</p>
<h2 id="How-To-Design-A-Singleton-Base-Class"><a href="#How-To-Design-A-Singleton-Base-Class" class="headerlink" title="How To Design A Singleton Base Class"></a>How To Design A Singleton Base Class</h2><p>One of the most important feature of singleton class is non-copyable. To make it non-copyable, delete copy constructor and override operator “=”:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br></pre></td></tr></table></figure>
<p>Another part is singleton’s constructor and destructor should be private or protected to avoid user call constructor and destructor accidentally. :</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    Singleton() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~Singleton() = <span class="keyword">default</span>;</span><br></pre></td></tr></table></figure>
<p>set destructor as virtual because it’s base class.The only public method is getInstance() which will return static instance of singleton class.</p>
<h2 id="An-example"><a href="#An-example" class="headerlink" title="An example"></a>An example</h2><p>Full source code <a href="https://github.com/codingspirit/VoiceSpirit/blob/develop/include/Singleton.h" target="_blank" rel="noopener"><strong>Singleton.h</strong></a>:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> BaseClass &#123;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> T&amp; <span class="title">getInstance</span><span class="params">(Args&amp;&amp;... args)</span> <span class="keyword">noexcept</span> </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> T instance&#123;<span class="built_in">std</span>::forward&lt;Args&gt;(args)...&#125;;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span>:</span><br><span class="line">    Singleton() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~Singleton() = <span class="keyword">default</span>;</span><br><span class="line">    Singleton(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Singleton&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">&#125;;  <span class="comment">// class Singleton</span></span><br><span class="line"></span><br><span class="line">&#125;  <span class="comment">// namespace BaseClass</span></span><br></pre></td></tr></table></figure>

<p>In this design, return value of getInstance() is a reference and use template to make it universal. When inherit this class, need to define subclass like this:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySingleton</span> :</span> <span class="keyword">public</span> BaseClass::Singleton&lt;MySingleton&gt; &#123;</span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseClass</span>:</span>:Singleton&lt;MySingleton&gt;;</span><br><span class="line">    <span class="comment">//declare as friend class of Singleton to give authority to base class can access private method</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    MySingleton();</span><br><span class="line">    ~MySingleton();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/codingspirit/VoiceSpirit/blob/develop/include/Singleton.h" target="_blank" rel="noopener"><strong>BasicLogger.h</strong></a>: is also a good example for this.</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Cross compile gRPC for ARM</title>
    <url>/2018-11-08/Cross-compile-gRPC-for-ARM/</url>
    <content><![CDATA[<p> This post will tell you how to cross compile gPRC static lib for ARM.<br> 前段时间尝试交叉编译gRPC遇到了不少的麻烦，写篇post记录一下。</p>
<a id="more"></a>
<p>gRPC</p>
<h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><p>First of all, you should have gRPC source code. git clone it from github. Then update submodules:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> grpc</span><br><span class="line">git submodule update --init</span><br></pre></td></tr></table></figure>
<h2 id="Install-zlib-for-your-arm-compiler-Optional"><a href="#Install-zlib-for-your-arm-compiler-Optional" class="headerlink" title="Install zlib for your arm compiler[Optional]"></a>Install zlib for your arm compiler[Optional]</h2><p>libz is one of gRPC dependencies. If you haven’t installed it for your arm compiler yet, you may need to install it. You can get zlib at <a href="http://www.zlib.net/" target="_blank" rel="noopener">zlib Home Site</a>. After download and unzip it, set cross compiler and build it:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> CC=arm-linux-gnueabihf-gcc</span><br><span class="line"><span class="built_in">export</span> AR=arm-linux-gnueabihf-ar</span><br><span class="line">./configure</span><br><span class="line">make -j4</span><br></pre></td></tr></table></figure>
<p>then install it if build succeed:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make install prefix=/usr/arm-linux-gnueabihf</span><br></pre></td></tr></table></figure>

<h2 id="Compile-and-install-protobuf-amp-gRPC-for-HOST"><a href="#Compile-and-install-protobuf-amp-gRPC-for-HOST" class="headerlink" title="Compile and install protobuf &amp; gRPC for HOST"></a>Compile and install protobuf &amp; gRPC for HOST</h2><p>protobuf:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> grpc/third_party/protobuf</span><br><span class="line">./autogen.sh &amp;&amp; ./configure &amp;&amp; make -j4</span><br><span class="line">sudo make install -j4</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
<p>gRPC:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">make -j4 &amp;&amp; sudo make install -j4 &amp;&amp; sudo ldconfig</span><br></pre></td></tr></table></figure>

<h2 id="Cross-compile-static-lib-for-ARM"><a href="#Cross-compile-static-lib-for-ARM" class="headerlink" title="Cross compile static lib for ARM"></a>Cross compile static lib for ARM</h2><p>make plugins first:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make clean</span><br><span class="line">make plugins CC=arm-linux-gnueabihf-gcc -j4</span><br></pre></td></tr></table></figure>
<p>Cross compile gRPC:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> GRPC_CROSS_COMPILE=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> GRPC_CROSS_AROPTS=<span class="string">"cr --target=elf32-little"</span></span><br><span class="line">make -j4 HAS_PKG_CONFIG=<span class="literal">false</span> \</span><br><span class="line">    CC=arm-linux-gnueabihf-gcc \</span><br><span class="line">    CXX=arm-linux-gnueabihf-g++ \</span><br><span class="line">    RANLIB=arm-linux-gnueabihf-ranlib \</span><br><span class="line">    LD=arm-linux-gnueabihf-ld \</span><br><span class="line">    LDXX=arm-linux-gnueabihf-g++ \</span><br><span class="line">    AR=arm-linux-gnueabihf-ar \</span><br><span class="line">    PROTOBUF_CONFIG_OPTS=<span class="string">"--host=arm-linux-gnueabihf --with-protoc=/usr/local/bin/protoc"</span> static</span><br></pre></td></tr></table></figure>
<p><strong>static</strong> is important. I tried to build shared lib but there will be a lot of errors because arm-linux-gnueabihf-ld doesn’t take “-Wl” as a parameter. If build succeed, you can find your static lib at “grpc/libs/opt”.</p>
<p>reference: <a href="https://github.com/grpc/grpc/issues/9719" target="_blank" rel="noopener">https://github.com/grpc/grpc/issues/9719</a></p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>C++</tag>
        <tag>gPRC</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian: nvidia display card driver install</title>
    <url>/2018-11-20/Debian-nvidia-display-card-driver-install/</url>
    <content><![CDATA[<p>Bumblebee aims to provide support for NVIDIA Optimus laptops for GNU/Linux distributions(<a href="https://www.bumblebee-project.org/" target="_blank" rel="noopener">Bumblebee porject</a>, <a href="https://wiki.debian.org/Bumblebee/" target="_blank" rel="noopener">Debian wiki</a>). It can help to solve the overheat problem caused by dual dispaly card, also provide a easy way to install nvidia close source driver as well.</p>
<a id="more"></a>

<h2 id="Update-your-source-list"><a href="#Update-your-source-list" class="headerlink" title="Update your source.list"></a>Update your source.list</h2><p>To install nvidia close source driver, you need to add contrib non-free at every “main” item in your source.list:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo sed -i.bak <span class="string">'s/stretch[^ ]* main$/&amp; contrib non-free/g'</span> /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p>This command will help you to do that meanwhile create a .bak file to backup your origin source.list.<br>Don’t forget to do apt update after that:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>

<h2 id="Install-Bumblebee"><a href="#Install-Bumblebee" class="headerlink" title="Install Bumblebee"></a>Install Bumblebee</h2><p>If you have installed nvidia driver before, you should remove them to continue:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove nvidia*</span><br></pre></td></tr></table></figure>
<p>Then you can start to install bumblebee now:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install bumblebee-nvidia primus</span><br></pre></td></tr></table></figure>
<p>Don’t worry about <strong>nouveau</strong> driver, bumblebee will help you to handle it.<br>Then we need to add your user account to bumlebee group:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo adduser <span class="variable">$USER</span> bumlebee</span><br></pre></td></tr></table></figure>
<p>After that you might need to restart your computer. Application will use your intel card by default. If you want some application use your nvidia card, use</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">optirun $(YOURAPP)</span><br></pre></td></tr></table></figure>

<h2 id="Verify-your-driver"><a href="#Verify-your-driver" class="headerlink" title="Verify your driver"></a>Verify your driver</h2><p>A easy way to verify this is to use <strong>glxspheres</strong>. It’s a part of <a href="https://virtualgl.org/" target="_blank" rel="noopener">virtualgl project</a>. <strong>glxgears</strong> is not recommended because it’s not a tool for benchmarking.<br>We can use Intel display card to run it first:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vblank_mode=0 /opt/VirtualGL/bin/glxspheres64</span><br></pre></td></tr></table></figure>
<p><strong>vblank_mode=0</strong> will temporarily disable vertical synchronization. If you don’t add it, you might only can get 60 fps which is same as your monitor refresh rate. The result I got:</p>
<p><img src="/2018-11-20/Debian-nvidia-display-card-driver-install/1.png" alt></p>
<p>Then run it with nvidia card:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vblank_mode=0 optirun /opt/VirtualGL/bin/glxspheres64</span><br></pre></td></tr></table></figure>

<p><img src="/2018-11-20/Debian-nvidia-display-card-driver-install/2.png" alt></p>
<p>It’s much faster than Intel card.</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>GCC: __attribute__ ((__packed__))</title>
    <url>/2020-02-11/GCC-attribute-packed/</url>
    <content><![CDATA[<blockquote>
<p>It specifies that a member field has the smallest possible alignment. That is, one byte for a variable field, and one bit for a bitfield, unless you specify a larger value with the aligned attribute.</p>
</blockquote>
<a id="more"></a>

<h2 id="Data-alignment-and-data-structure-padding"><a href="#Data-alignment-and-data-structure-padding" class="headerlink" title="Data alignment and data structure padding"></a>Data alignment and data structure padding</h2><p>GCC will enable structure padding by default, i.e. we have a structure like this:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test_struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> a;</span><br><span class="line">    <span class="keyword">char</span> b;</span><br><span class="line">    <span class="keyword">int</span> c;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test_struct</span> <span class="title">test_data</span>;</span></span><br></pre></td></tr></table></figure>

<p><code>sizeof(test_data)</code> will be <span style="color:red">8</span> due to structure padded to to 4-byte alignment: 1(char a) + 1(char b) + <span style="color:red"><strong>2(added)</strong></span>  + 4(int c).</p>
<h2 id="attribute-packed"><a href="#attribute-packed" class="headerlink" title="attribute ((packed))"></a><strong>attribute</strong> ((<strong>packed</strong>))</h2><p>GCC provides us a way to disable structure padding, i.e. we have a structure like this:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test_struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> a;</span><br><span class="line">    <span class="keyword">char</span> b;</span><br><span class="line">    <span class="keyword">int</span> c;</span><br><span class="line">&#125; __attribute__((__packed__));</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test_struct</span> <span class="title">test_data</span>;</span></span><br></pre></td></tr></table></figure>

<p><code>sizeof(test_data)</code> will be <span style="color:red">6</span>: 1(char a) + 1(char b) + 4(int c). With this some memory can be saved.</p>
<p>We also can use <code>__attribute__((packed, aligned(X)))</code> to specify padding size(X should be powers of 2):</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test_struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> a;</span><br><span class="line">    <span class="keyword">char</span> b;</span><br><span class="line">    <span class="keyword">int</span> c;</span><br><span class="line">    <span class="keyword">char</span> d;</span><br><span class="line">&#125; __attribute__((packed, aligned(<span class="number">2</span>)));</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test_struct</span> <span class="title">test_data</span>;</span></span><br></pre></td></tr></table></figure>

<p><code>sizeof(test_data)</code> will be <span style="color:red">8</span>: 1(char a) + 1(char b) + 4(int c) + 1(char d) + <span style="color:red"><strong>1(added)</strong></span></p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>C</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker常用命令</title>
    <url>/2018-01-09/Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<p>Docker常用命令小结<br>Update: Translate to EN</p>
<a id="more"></a>

<h2 id="Gather-info"><a href="#Gather-info" class="headerlink" title="Gather info"></a>Gather info</h2><p>List all containers <br> 列出所有容器：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>

<p>Get container IP <br> 获取容器IP：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker inspect 2d0142bd65a7 | grep IPAddress</span><br></pre></td></tr></table></figure>
<p><em>2d0142bd65a7</em> is a container id. <br> 其中 <em>2d0142bd65a7</em> 为容器ID。 </p>
<p>List all loadable images <br> 列出可以装载的镜像：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<h2 id="Save-Load-Tag-and-cp"><a href="#Save-Load-Tag-and-cp" class="headerlink" title="Save,Load,Tag and cp"></a>Save,Load,Tag and cp</h2><p>Save image to local file <br> 导出镜像：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker save 1865b6805867 &gt; image.tar</span><br></pre></td></tr></table></figure>
<p><em>1865b6805867</em> is a image id. <br> 其中 <em>1865b6805867</em> 为镜像ID。 </p>
<p>Create docker image based on a container <br> 基于容器创建镜像</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker commit <span class="variable">$&#123;container_id&#125;</span> <span class="variable">$&#123;image_name&#125;</span>:<span class="variable">$&#123;image_tag&#125;</span></span><br></pre></td></tr></table></figure>

<p>Load image from local file <br> 导入镜像：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker load &lt; image.tar</span><br></pre></td></tr></table></figure>

<p>Tag a image which id is <em>1865b6805867</em>(Only first 4 digits of ID is acceptable) <br><br>为ID为<em>1865b6805867</em>的镜像打上TAG(没错，只需要ID前几位就可以)：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker tag 1865 gcr.io/tensorflow/tensorflow:latest-devel</span><br></pre></td></tr></table></figure>

<p>Copy a file or folder from container to local host:<br><br>从容器复制文件到主机(如果你忘了从主机挂载文件夹):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker cp <span class="variable">$&#123;containerID&#125;</span>:<span class="variable">$&#123;file_path_in_container&#125;</span> <span class="variable">$&#123;host_path&#125;</span></span><br></pre></td></tr></table></figure>
<p>It’s basically same when you trying to copy a file from host to container, just swap two parameters.</p>
<h2 id="Clean"><a href="#Clean" class="headerlink" title="Clean"></a>Clean</h2><p>Stop all containers <br> 停止所有容器 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">kill</span> $(docker ps -aq)</span><br></pre></td></tr></table></figure>

<p>Delete all containers <br> 删除所有容器</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker rm $(docker ps -aq)</span><br></pre></td></tr></table></figure>
<p>Change <em>$(docker ps -aq)</em> to container id to stop or delete the specific container.</p>
<p>Delete all images <br> 删除所有镜像</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker rmi $(docker images -q)</span><br></pre></td></tr></table></figure>
<p>Change <em>$(docker images -q)</em> to image id to delete the specific image.</p>
<p>Remove unused data to free disk space <br> 删除未使用的数据以释放磁盘空间</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker system prune</span><br></pre></td></tr></table></figure>

<h2 id="Docker-build-without-cache"><a href="#Docker-build-without-cache" class="headerlink" title="Docker build without cache"></a>Docker build without cache</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker build --no-cache .</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Give serial port access to normal user</title>
    <url>/2020-06-22/Give-serial-port-access-to-normal-user/</url>
    <content><![CDATA[<p>When we try to access a serial port device(i.e <strong>/dev/ttyUSB0</strong>) as a normal user, a <em>Permission denied</em> error will occur. Let’s take a look at permissions for those serial port devices:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ll /dev/ttyUSB0</span><br><span class="line">crw-rw---- 1 root dialout 188, 0 6月  22 19:28 /dev/ttyUSB0</span><br></pre></td></tr></table></figure>

<p>As we can see, except root user, <strong>dialout</strong> group also has permissions to those serial port tty devices. Hence, to allow normal user access serial port devices, adding normal user to <strong>dialout</strong> group will suffice:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo usermod -aG dialout <span class="variable">$USER</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>GitHub REST API v3: Use Curl To Upload Artifact To Release</title>
    <url>/2020-08-30/GitHub-REST-API-v3-Use-Curl-To-Upload-Artifacts-To-Release/</url>
    <content><![CDATA[<a id="more"></a>

<h2 id="With-OAuth2-Token-Authentication"><a href="#With-OAuth2-Token-Authentication" class="headerlink" title="With OAuth2 Token Authentication"></a>With OAuth2 Token Authentication</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">curl -H <span class="string">"Authorization: token &lt;OAUTH-TOKEN&gt;"</span> https://api.github.com</span><br></pre></td></tr></table></figure>

<h2 id="Create-A-Release-And-Add-An-Artifact"><a href="#Create-A-Release-And-Add-An-Artifact" class="headerlink" title="Create A Release And Add An Artifact"></a>Create A Release And Add An Artifact</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Create a new release and get upload url</span></span><br><span class="line">upload_url=$(curl -s -H <span class="string">"Authorization: token <span class="variable">$TOKEN</span>"</span>  \</span><br><span class="line">     -d <span class="string">'&#123;"tag_name":"'</span><span class="string">"<span class="variable">$ARTIFACTS_BASE_NAME</span>"</span><span class="string">'", "name":"'</span><span class="string">"<span class="variable">$ARTIFACTS_BASE_NAME</span>"</span><span class="string">'", "body":"'</span><span class="string">"<span class="variable">$ARTIFACTS_BASE_NAME</span>"</span><span class="string">'", "target_commitish":"'</span><span class="string">"<span class="variable">$TARGET_BRANCH</span>"</span><span class="string">'"&#125;'</span>  \</span><br><span class="line">     <span class="string">"https://api.github.com/repos/<span class="variable">$REPO</span>/<span class="variable">$TARGET_BRANCH</span>"</span> | jq -r <span class="string">'.upload_url'</span>)</span><br><span class="line"></span><br><span class="line">upload_url=<span class="string">"<span class="variable">$&#123;upload_url%\&#123;*&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Upload a tarball</span></span><br><span class="line">curl -s -H <span class="string">"Authorization: token <span class="variable">$TOKEN</span>"</span>  \</span><br><span class="line">            -H <span class="string">"Content-Type: application/x-gzip"</span> \</span><br><span class="line">            --data-binary @<span class="variable">$ARTIFACTS_BASE_NAME</span>.tar.gz  \</span><br><span class="line">            <span class="string">"<span class="variable">$upload_url</span>?name=<span class="variable">$ARTIFACTS_BASE_NAME</span>.tar.gz&amp;label=<span class="variable">$ARTIFACTS_BASE_NAME</span>.tar.gz"</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>Install JDK/JRE for Ubuntu</title>
    <url>/2019-11-16/Install-JDK-JRE-for-Ubuntu/</url>
    <content><![CDATA[<p>…</p>
<a id="more"></a>

<p>There are two versions of JDK/JRE can be installed on Ubuntu:</p>
<ul>
<li>Open JDK/JRE</li>
<li>Oracle JDK/JRE</li>
</ul>
<h2 id="Install-Open-JDK-JRE"><a href="#Install-Open-JDK-JRE" class="headerlink" title="Install Open JDK/JRE"></a>Install Open JDK/JRE</h2><p><strong>Open JDK/JRE</strong> can be easily installed by</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install default-jre</span><br><span class="line">sudo apt install default-jdk</span><br></pre></td></tr></table></figure>

<h2 id="Install-Oracle-standalone-JRE"><a href="#Install-Oracle-standalone-JRE" class="headerlink" title="Install Oracle standalone JRE"></a>Install Oracle standalone JRE</h2><ol>
<li>First of all download Oracle JRE from <a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener">Oracle</a></li>
<li>Unpack downloaded package and install it into the path you like(i.e <em>/usr/lib/java</em>) <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/lib/java</span><br><span class="line">sudo tar -zxvf ~/Downloads/jre-8u231-linux-x64.tar.gz</span><br></pre></td></tr></table></figure></li>
<li>Add JRE installation path into <strong>$PATH</strong> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/environment</span><br></pre></td></tr></table></figure>
 Add <span style="color:red"><strong>:/usr/lib/java/jre1.8.0_231</strong></span> into <span style="color:red"><strong>PATH</strong></span></li>
<li>Add installed java as alternative <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /usr/lib/java/jre1.8.0_231/bin/java 1</span><br></pre></td></tr></table></figure>
 To switch to other alternative java. use: <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --config java</span><br></pre></td></tr></table></figure></li>
<li>Check installation <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -version</span><br><span class="line">java version <span class="string">"1.8.0_231"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_231-b11)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.231-b11, mixed mode)</span><br></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>Issue:No such file or directory</title>
    <url>/2018-11-14/Issue-No-such-file-or-directory/</url>
    <content><![CDATA[<h1 id="Clarify-this-issue"><a href="#Clarify-this-issue" class="headerlink" title="Clarify this issue"></a>Clarify this issue</h1><p>If you trying to execute a executable binary, but you see this error “No such file or directory”, it’s normally caused by you trying to run a 32-bits binary on a 64-bits OS.</p>
<a id="more"></a>

<p>First of all you should check your OS:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure>
<p>If you see <strong>x86_64</strong>, we can make sure you are using a 64-bits OS.<br>Then we should check file type of executable binary:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file <span class="variable">$&#123;THE_EXECUTABLE_BIN&#125;</span></span><br></pre></td></tr></table></figure>
<p>If you see <strong>ELF 32-bit LSB executable, Intel 80386</strong>, basically we can make sure you are trying to run a 32-bits binary on a 64-bits OS meanwhile your OS haven’t add <strong>i386</strong> architecture yet.</p>
<h1 id="How-to-fix-it"><a href="#How-to-fix-it" class="headerlink" title="How to fix it"></a>How to fix it</h1><p>We need to add <strong>i386</strong> architecture support on your 64-bits OS.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo dpkg --add-architecture i386</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install multiarch-support</span><br><span class="line">sudo apt-get install libc6:i386 libncurses5:i386 libstdc++6:i386</span><br></pre></td></tr></table></figure>
<p>After that, try to run it again :)</p>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Jenkins+Gerrit: 自动commit//code review//submit</title>
    <url>/2018-03-20/Jenkins-Gerrit-%E8%87%AA%E5%8A%A8commit-code-review-submit/</url>
    <content><![CDATA[<p>  Jenkins+Gerrit的一般工作模式：user commit code to Gerrit-&gt;Jenkins test build success-&gt;other user code review +2-&gt;user submit-&gt;Jenkins release build-&gt;release SW. 我之前写了个release notes generator, 在Jenasdkins server上release build的时候， 可以自动生成release notes并打包并发给开发者。但是这个release notes在下一次build的时候会因为workspace的清空而被删除，因此希望Jenkins能够将release notes commit到Gerrit并保留下来，最后再自动上传到sharepoint上。实现上述过程后，自动化构建的自动化程度会更高一点，开发者只需在Jenkins上press a button, release就自动完成了。</p>
<a id="more"></a>

<h2 id="新建branch"><a href="#新建branch" class="headerlink" title="新建branch"></a>新建branch</h2><p>  通常Gerrit trigger jenkins build的时候, jenkins 只会抓取某一次commit，这会导致抓取的code不在任何一个branch上。此时需要新建一个临时的branch，才能在后面进行push:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git branch <span class="string">"jenkins_temp"</span></span><br><span class="line">git checkout jenkins_temp</span><br></pre></td></tr></table></figure>
<h2 id="Jenkins检测改动并提交"><a href="#Jenkins检测改动并提交" class="headerlink" title="Jenkins检测改动并提交"></a>Jenkins检测改动并提交</h2><p>  首先需要检测文件改动,以一个名为test.txt的文件为例：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$(git diff test.txt)</span>"</span> != <span class="string">""</span> ]; <span class="keyword">then</span></span><br><span class="line"><span class="comment">#if file has been modfied, do something</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Release_Notes.xlsx has been modfied"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Release_Notes.xlsx hasn't been modfied"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>  Staged changes并commit:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git add test.txt</span><br><span class="line"><span class="comment">#if have two files: git add test1.txt text2.txt</span></span><br><span class="line">git commit -m <span class="string">"jenkins update test.txt</span></span><br></pre></td></tr></table></figure>
<p>另：如果提交时没有生成commit id, 可以通过git hooks实现自动添加commit id。</p>
<h2 id="Push-changes"><a href="#Push-changes" class="headerlink" title="Push changes"></a>Push changes</h2><p>  然后需要把改动Push到git远端。之前在Jenkins server上配置过git ssh key，因此我可以在server上直接push changes而不会报错。但是如果在Jenkins execute shell中执行脚本会遇到Permission denied的问题，因为execute shell的运行环境是独立的，并没有配置过ssh key。这时可以通过临时添加key的方式进行push：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ssh-agent sh -c <span class="string">'ssh-add C:/Users/jenkins1/.ssh/id_rsa; git push origin</span></span><br><span class="line"><span class="string">jenkins_temp:refs/for/master'</span></span><br></pre></td></tr></table></figure>
<h2 id="verified-code-review-submit"><a href="#verified-code-review-submit" class="headerlink" title="verified,code review,submit"></a>verified,code review,submit</h2><p>  通常来讲，Push到git remote的commit都需要通过test build,如果成功，将会由jenkins verified +1。只后再通过其他人code review, 在code review +2后才能submit，也就是真正合并到remote branch上。由于jenkins只更改了relase notes这种非代码文件，我们希望jenkins能够自动将changes合并到remote branch上。这里就需要通过shell操作Gerrit。从<a href="https://gerrit-documentation.storage.googleapis.com/Documentation/2.5.1/cmd-review.html" target="_blank" rel="noopener">Gerrit官方文档</a>上，我们可以找到一些可以通过ssh连接完成的操作，包括verified,code review,submit等等。注意，这里同样需要指定ssh key，否则Permission denied。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ssh -i C:/Users/jenkins1/.ssh/id_rsa -p 29418 jenkins1@sw.domian.com gerrit review --verified +1 <span class="string">"<span class="variable">$(git rev-parse --short HEAD)</span>"</span></span><br><span class="line">ssh -i C:/Users/jenkins1/.ssh/id_rsa -p 29418 jenkins1@sw.domian.com gerrit review --code-review +2 <span class="string">"<span class="variable">$(git rev-parse --short HEAD)</span>"</span></span><br><span class="line">ssh -i C:/Users/jenkins1/.ssh/id_rsa -p 29418 jenkins1@sw.domian.com gerrit review -s <span class="string">"<span class="variable">$(git rev-parse --short HEAD)</span>"</span></span><br></pre></td></tr></table></figure>
<p>至此，jenkins完成了自动构建。<br>其他可能有用的git command:<br>git 获取当前branch name</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git symbolic-ref --short -q HEAD</span><br></pre></td></tr></table></figure>
<p>git 获取上一次提交的commit id</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#short</span></span><br><span class="line">git rev-parse --short HEAD</span><br><span class="line"><span class="comment">#long</span></span><br><span class="line">git rev-parse HEAD</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CI</category>
      </categories>
      <tags>
        <tag>shell</tag>
        <tag>Continuous Integration</tag>
      </tags>
  </entry>
  <entry>
    <title>Jenkins (I): Install Jenkins On Ubuntu 18.04/20.04</title>
    <url>/2020-09-15/Jenkins-I-Install-Jenkins-On-Ubuntu-18-04-20-04/</url>
    <content><![CDATA[<p>…</p>
<a id="more"></a>

<h1 id="Jenkins-Install-Jenkins-On-Ubuntu-18-04-20-04"><a href="#Jenkins-Install-Jenkins-On-Ubuntu-18-04-20-04" class="headerlink" title="Jenkins: Install Jenkins On Ubuntu 18.04/20.04"></a>Jenkins: Install Jenkins On Ubuntu 18.04/20.04</h1><h2 id="Install-Java"><a href="#Install-Java" class="headerlink" title="Install Java"></a>Install Java</h2><p>Jenkins requires java in order to run:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install openjdk-11-jdk</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: In current release, Jenkins only supports Java 8/11. For more information, check <a href="https://www.jenkins.io/doc/administration/requirements/java/" target="_blank" rel="noopener">Java requirements</a></p>
</blockquote>
<h2 id="Install-Jenkins-LTS-Release-By-apt"><a href="#Install-Jenkins-LTS-Release-By-apt" class="headerlink" title="Install Jenkins LTS Release By apt"></a>Install Jenkins LTS Release By apt</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -</span><br><span class="line">sudo sh -c <span class="string">'echo deb https://pkg.jenkins.io/debian-stable binary/ &gt; \</span></span><br><span class="line"><span class="string">    /etc/apt/sources.list.d/jenkins.list'</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install jenkins</span><br></pre></td></tr></table></figure>

<h2 id="Start-Jenkins"><a href="#Start-Jenkins" class="headerlink" title="Start Jenkins"></a>Start Jenkins</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl start jenkins</span><br></pre></td></tr></table></figure>

<p>If Jenkins is up and running, you could see similar log at <code>/var/log/jenkins/jenkins.log</code>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-09-15 20:14:14.384+0000 [id&#x3D;21]	INFO	hudson.WebAppMain$3#run: Jenkins is fully up and running</span><br></pre></td></tr></table></figure>

<h2 id="Unlock-Jenkins"><a href="#Unlock-Jenkins" class="headerlink" title="Unlock Jenkins"></a>Unlock Jenkins</h2><p>Use browser to access <code>http://&lt;your-jenkins-ip&gt;:8080</code>:</p>
<p><img src="/2020-09-15/Jenkins-I-Install-Jenkins-On-Ubuntu-18-04-20-04/unlock-jenkins-page.jpg" alt></p>
<p>Get the <code>initialAdminPassword</code> by <code>sudo cat /var/lib/jenkins/secrets/initialAdminPassword</code>, or find it in <code>/var/log/jenkins/jenkins.log</code>.</p>
]]></content>
      <categories>
        <category>CI</category>
      </categories>
      <tags>
        <tag>Continuous Integration</tag>
        <tag>Jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title>Jenkins (II): Configure Jenkins To Run On Port 80</title>
    <url>/2020-09-15/Jenkins-II-Configure-Jenkins-To-Run-On-Port-80/</url>
    <content><![CDATA[<p>Jenkins is running on port 8080 by default, thus user need to manually add <strong>:8080</strong> when access Jenkins. If we make it running on port 80(default http port), user will no longer need to type port number manually.</p>
<a id="more"></a>

<h2 id="Open-ports-and-forwarding"><a href="#Open-ports-and-forwarding" class="headerlink" title="Open ports and forwarding"></a>Open ports and forwarding</h2><p>First of all we need to make sure that ports 8080/80 and 8443/433 have been opened. To check, use <code>sudo iptalbes -L -n</code>. If those ports are not opened to tcp, use following commands to add rules:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo iptables -I INPUT 1 -p tcp --dport 8443 -j ACCEPT</span><br><span class="line">sudo iptables -I INPUT 1 -p tcp --dport 8080 -j ACCEPT</span><br><span class="line">sudo iptables -I INPUT 1 -p tcp --dport 443 -j ACCEPT</span><br><span class="line">sudo iptables -I INPUT 1 -p tcp --dport 80 -j ACCEPT</span><br></pre></td></tr></table></figure>

<p>Then forward 8080 to 80 and 8443 to 443:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 8080</span><br><span class="line">sudo iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 443 -j REDIRECT --to-port 8443</span><br></pre></td></tr></table></figure>

<p>You need to save the configuration:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo sh -c <span class="string">"iptables-save &gt; /etc/iptables.rules"</span></span><br></pre></td></tr></table></figure>

<h2 id="Use-iptables-persistent-to-config-rules-on-boot"><a href="#Use-iptables-persistent-to-config-rules-on-boot" class="headerlink" title="Use iptables-persistent to config rules on boot"></a>Use <code>iptables-persistent</code> to config rules on boot</h2><p>Rules we configured in <code>iptables</code> will not automatically applied again when reboot. To configure to automatically run it on boot, install <code>iptables-persistent</code>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install iptables-persistent</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CI</category>
      </categories>
      <tags>
        <tag>Continuous Integration</tag>
        <tag>Jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title>Kibana: Read only dashboard</title>
    <url>/2020-08-15/Kibana-Read-only-dashboard/</url>
    <content><![CDATA[<p>…</p>
<a id="more"></a>

<h2 id="X-Pack-security-enabled"><a href="#X-Pack-security-enabled" class="headerlink" title="X-Pack security enabled"></a>X-Pack security enabled</h2><p>With X-Pack security enabled, give specific user with <code>kibana_dashboard_only_user</code> role in <strong>Management &gt; Security &gt; Users</strong>. In this case user can access dashboard but there is no edit button in dashboard.</p>
<h2 id="X-Pack-security-is-not-enabled"><a href="#X-Pack-security-is-not-enabled" class="headerlink" title="X-Pack security is not enabled"></a>X-Pack security is not enabled</h2><p>If X-Pack security is not enabled, there is another way to make dashboard “read only” :</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">PUT .kibana/_settings</span><br><span class="line">&#123;</span><br><span class="line">  "index": &#123;</span><br><span class="line">    "blocks.read_only": true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If applied code in <strong>Dev tool</strong>, Edit button still can be seen in dashboard but user can’t save modified dashboard.</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux C/C++ debugging: using adb and gdb</title>
    <url>/2019-02-16/Linux-C-C-debugging-using-adb-and-gdb/</url>
    <content><![CDATA[<p>在大学的时候就一直用gdb + gdbserver 来远程调试C++， 前年开始用VS Code后在板上部署程序后配合VS Code调试更是爽到不行（根本停不下来），有种本地开发的感觉， 再也不用在蛋疼的GDB里面敲‘b’ ‘r’ ‘c’， 哈哈。<br>最近的项目对adb的支持非常不错，usb上传下载速度比ssh不知道高到哪里去了。今天突然想到之前写Android app的时候都能通过usb和adb进行调试， 现在在Linux下调C++应该也可以通过usb+adb实现， 为什么不试一下呢？</p>
<a id="more"></a>

<h2 id="gdb-gdbserver"><a href="#gdb-gdbserver" class="headerlink" title="gdb + gdbserver"></a>gdb + gdbserver</h2><p>既然要调C/C++， 这两兄弟基本上是必备了(VC++程序员表示并不需要)。 在target device上部署待调试程序并启动gdbserver，然后再在host上使用gdb target remote连接， 跨平台调试变得非常容易， 配合VS Code使用的例子可以参考<a href="https://github.com/codingspirit/VoiceSpirit/tree/develop/.vscode" target="_blank" rel="noopener">这里</a></p>
<h2 id="adb-forward"><a href="#adb-forward" class="headerlink" title="adb forward"></a>adb forward</h2><p>gdb和gdbserver可以提供调试的server和client， 只要client能够访问到server的指定端口，调试就能够进行。通常我们使用gdb+gdbserver， target device和host在一个局域网内， 通过socket能很轻松地实现连接。 如果我们要通过usb实现这个连接， 可以通过adb forward实现。 如果你在Android上写过通过socket通信的app（不禁想起了做毕设的时候）， 基本上都会用到这个cmd， 只需一行命令 <strong>adb forward tcp:1234 tcp:5678</strong>, 所有在host端1234端口的通信都会被重定向到target端的5678端口，调试socket时轻松愉快！ 有了它的帮助， 就能通过usb线实现socket连接了</p>
<h2 id="Step-By-Step"><a href="#Step-By-Step" class="headerlink" title="Step By Step"></a>Step By Step</h2><p>Let’s have a quick step by step instruction:</p>
<p>First of all, build your C/C++ app and upload your app binary to target device.</p>
<p>Then we start <strong>gdbserver</strong> on target device:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#target device</span></span><br><span class="line">gdbserver :<span class="variable">$&#123;TARGET_PORT&#125;</span> <span class="variable">$&#123;EXEC_FILE&#125;</span></span><br></pre></td></tr></table></figure>
<p>i.e. :  <strong>gdbserver :1234 /usr/bin/test_app</strong>. gdbserver will listening at port 1234 and waiting for client to connect.</p>
<p>After that we can use <strong>adb forward</strong> on host PC(make sure usb connection is good and adb shell works well):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#host</span></span><br><span class="line">adb forward tcp:<span class="variable">$&#123;HOST_PORT&#125;</span> tcp:<span class="variable">$&#123;TARGET_PORT&#125;</span></span><br></pre></td></tr></table></figure>
<p>All the communication data on specific host port will be redirected to target server port.<br>i.e. : <strong>adb forward tcp:4567 tcp:1234</strong>. Then all the data send to <strong>localhost:4567</strong> on host PC will be redirected to target device <strong>1234</strong> port.</p>
<p>Last step, start gdb on host PC then connect to target gdbserver:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#host</span></span><br><span class="line">$ gdb</span><br><span class="line"><span class="comment">#make sure your gdb and your gdbserver are from one set of toolchain</span></span><br><span class="line">GNU gdb (Debian 7.12-6) 7.12.0.20161007-git</span><br><span class="line">Copyright (C) 2016 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type <span class="string">"show copying"</span></span><br><span class="line">and <span class="string">"show warranty"</span> <span class="keyword">for</span> details.</span><br><span class="line">This GDB was configured as <span class="string">"x86_64-linux-gnu"</span>.</span><br><span class="line">Type <span class="string">"show configuration"</span> <span class="keyword">for</span> configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line">For <span class="built_in">help</span>, <span class="built_in">type</span> <span class="string">"help"</span>.</span><br><span class="line">Type <span class="string">"apropos word"</span> to search <span class="keyword">for</span> commands related to <span class="string">"word"</span>.</span><br><span class="line">(gdb) target remote :<span class="variable">$&#123;HOST_PORT&#125;</span></span><br></pre></td></tr></table></figure>
<p>i.e. : <strong>(gdb) target remote :4567</strong></p>
<p>Now we can start hunting bug!</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux USB gadget configfs</title>
    <url>/2019-12-07/Linux-USB-gadget-configfs/</url>
    <content><![CDATA[<p>Using configs we can easily set up usb gadget in user space. You even can make your board as a compound USB device, just by few commands.</p>
<a id="more"></a>

<h2 id="Enable-and-mount-configfs"><a href="#Enable-and-mount-configfs" class="headerlink" title="Enable and mount configfs"></a>Enable and mount configfs</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">modprobe libcomposite</span><br><span class="line">mount -t configfs configfs /sys/kernel/config</span><br></pre></td></tr></table></figure>

<h2 id="Create-gadget-s"><a href="#Create-gadget-s" class="headerlink" title="Create gadget(s)"></a>Create gadget(s)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir /sys/kernel/config/usb_gadget/g1</span><br></pre></td></tr></table></figure>

<h2 id="Create-English-strings-and-write-to-common-attributes"><a href="#Create-English-strings-and-write-to-common-attributes" class="headerlink" title="Create English strings and write to common attributes"></a>Create English strings and write to common attributes</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /sys/kernel/config/usb_gadget/g1/strings/0x409</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;SERIALNUMBER&#125;</span> &gt; /sys/kernel/config/usb_gadget/g1/strings/0x409/serialnumber</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;MANUFACTURER&#125;</span> &gt; /sys/kernel/config/usb_gadget/g1/strings/0x409/manufacturer</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;PRODUCT_NAME&#125;</span> &gt; /sys/kernel/config/usb_gadget/g1/strings/0x409/product</span><br></pre></td></tr></table></figure>
<h2 id="Create-gadget-configuration-s"><a href="#Create-gadget-configuration-s" class="headerlink" title="Create gadget configuration(s)"></a>Create gadget configuration(s)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /sys/kernel/config/usb_gadget/g1/configs/c1</span><br><span class="line">mkdir -p /sys/kernel/config/usb_gadget/g1/configs/c1/strings/0x409</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Config 1: ADB"</span> &gt; /sys/kernel/config/usb_gadget/g1/configs/c1/strings/0x409/configuration</span><br><span class="line"><span class="built_in">echo</span> 250 &gt; /sys/kernel/config/usb_gadget/g1/configs/c1/MaxPower</span><br></pre></td></tr></table></figure>

<h2 id="Create-gadget-function-s"><a href="#Create-gadget-function-s" class="headerlink" title="Create gadget function(s)"></a>Create gadget function(s)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Here we use ffs adb as an example</span></span><br><span class="line">mkdir -p /sys/kernel/config/usb_gadget/g1/<span class="built_in">functions</span>/ffs.adb</span><br></pre></td></tr></table></figure>

<h2 id="Associate-gadget-functions-with-configuration-s"><a href="#Associate-gadget-functions-with-configuration-s" class="headerlink" title="Associate gadget functions with configuration(s)"></a>Associate gadget functions with configuration(s)</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ln -s /sys/kernel/config/usb_gadget/g1/<span class="built_in">functions</span>/ffs.adb /sys/kernel/config/usb_gadget/g1/configs/c1</span><br></pre></td></tr></table></figure>

<h2 id="Extra-setup-for-gadget-functions"><a href="#Extra-setup-for-gadget-functions" class="headerlink" title="Extra setup for gadget functions"></a>Extra setup for gadget functions</h2><p>Sometime there is some steps need to be done before enabling gadget(i.e. ffs need to be mounted before active)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Create mount point for ffs and start adbd</span></span><br><span class="line">mkdir -p <span class="string">"<span class="variable">$&#123;mount_point&#125;</span>"</span></span><br><span class="line">mount -t functionfs adb <span class="string">"<span class="variable">$&#123;mount_point&#125;</span>"</span> -o uid=0,gid=0</span><br><span class="line">adbd &amp;</span><br></pre></td></tr></table></figure>
<p>If no extra step is needed, we can directly enable gadget</p>
<h2 id="Enable-the-gadget"><a href="#Enable-the-gadget" class="headerlink" title="Enable the gadget"></a>Enable the gadget</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Find the available udc</span></span><br><span class="line">udc=$(ls -1 /sys/class/udc/)</span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$udc</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"No UDC driver registered"</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;udc&#125;</span>"</span> &gt; /sys/kernel/config/usb_gadget/g1/UDC</span><br></pre></td></tr></table></figure>
<h2 id="Compound-USB-Device"><a href="#Compound-USB-Device" class="headerlink" title="Compound USB Device"></a>Compound USB Device</h2><p>To setup a compound USB device, we just need to create several gadget functions and binding them with configuration(s) before enabling the gadget</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux kernel module(1)</title>
    <url>/2018-12-09/Linux-kernel-module-1/</url>
    <content><![CDATA[<p>This post will give a simple introduction to Linux kernel module(Part I.).</p>
<p>Linux kernel module简介(一)</p>
<a id="more"></a>
<p>When your system has a new external chip connected(I2C,SPI,GPIO etc.), you might need to write a driver for it by yourself. Normally this driver will be implemented as a kernel module. </p>
<p>Kernel module development is a complex task and it’s hard to make it clear in one simple post. If you want to learn more, a good choice is taking a look at Linux kernel source code.</p>
<h2 id="The-simplest-example-of-kernel-module"><a href="#The-simplest-example-of-kernel-module" class="headerlink" title="The simplest example of kernel module"></a>The simplest example of kernel module</h2><h3 id="Source-code"><a href="#Source-code" class="headerlink" title="Source code"></a>Source code</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// file:simple_module.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/init.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/printk.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> __<span class="function">init <span class="title">sample_module_init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	printk(KERN_INFO <span class="string">"Hello world!\n"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __<span class="function"><span class="built_in">exit</span> <span class="title">sample_module_exit</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	printk(KERN_INFO <span class="string">"Bye!\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(sample_module_init);</span><br><span class="line"></span><br><span class="line">module_exit(sample_module_exit);</span><br><span class="line"></span><br><span class="line">MODULE_AUTHOR(<span class="string">"Coding Spirit &lt;coding@spirit.com&gt;"</span>);</span><br><span class="line">MODULE_LICENSE(<span class="string">"GPL v2"</span>);</span><br></pre></td></tr></table></figure>

<p>This simple example shows basic structure of kernel module. A <strong>init</strong> function and a <strong>exit</strong> function must be declared, to avoid warnings, <strong>MODULE_AUTHOR</strong> and <strong>MODULE_LICENSE</strong> is needed as well.</p>
<h3 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h3><p>To compile it to kernel module(.ko) file, we need to write a Makefile for it.</p>
<figure class="highlight mk"><table><tr><td class="code"><pre><span class="line">simple-module-objs := simple_module.o</span><br><span class="line"></span><br><span class="line">obj-m := simple-module.o</span><br></pre></td></tr></table></figure>
<p>In this Makefile <strong>$(<executable>-objs)</executable></strong> lists all objects used to link the final executable, <strong>obj-m</strong> means loadable module goals, it will generate a standalone .ko file, then we can use <strong>insmod</strong> to install it. If change it to <strong>obj-y</strong>, it will be compiled into kernel.</p>
<h3 id="Test-this-module"><a href="#Test-this-module" class="headerlink" title="Test this module"></a>Test this module</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># clear debug message first</span></span><br><span class="line">dmesg -c</span><br><span class="line"><span class="comment"># see modules already installed</span></span><br><span class="line">lsmod</span><br><span class="line"><span class="comment"># install simple module</span></span><br><span class="line">insmod simple-module.ko</span><br><span class="line"><span class="comment"># check debug message</span></span><br><span class="line">dmesg</span><br><span class="line"><span class="comment"># remove simple module</span></span><br><span class="line">rmmod simple-module.ko</span><br><span class="line">dmesg</span><br></pre></td></tr></table></figure>

<h3 id="What-are-module-init-exit-and-init-exit"><a href="#What-are-module-init-exit-and-init-exit" class="headerlink" title="What are module_init/exit and __init/exit"></a>What are module_init/exit and __init/exit</h3><p>module_init and module_exit are macros to help register module init and exit functions. Use your F12, go to definition:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __define_initcall(fn, id) \</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">initcall_t</span> __initcall_#<span class="meta">#fn##id __used \</span></span><br><span class="line">	__attribute__((__section__(<span class="string">".initcall"</span> #id <span class="string">".init"</span>))) = fn;</span><br></pre></td></tr></table></figure>

<p><em>fn</em> is your function name, <em>id</em> stand for priority, for module_init, this level will be set as 6.</p>
<p>After using this marco, your init function will be called when <strong>do_initcalls</strong> was called(<em>init/main.c</em>)</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __<span class="function">init <span class="title">do_initcalls</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> level;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (level = <span class="number">0</span>; level &lt; ARRAY_SIZE(initcall_levels) - <span class="number">1</span>; level++)</span><br><span class="line">		do_initcall_level(level);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>as for marco <strong>__init</strong> , It tells the compiler to put this function in a special section, which is declared in vmlinux.lds. <strong>__init</strong> puts the function in the “.init.text” section.</p>
<p>Take a look at where it defined(/linux-4.9/include/linux/init.h):</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* These macros are used to mark some functions or</span></span><br><span class="line"><span class="comment"> * initialized data (doesn't apply to uninitialized data)</span></span><br><span class="line"><span class="comment"> * as `initialization' functions. The kernel can take this</span></span><br><span class="line"><span class="comment"> * as hint that the function is used only during the initialization</span></span><br><span class="line"><span class="comment"> * phase and free up used memory resources after*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* These are for everybody (although not all archs will actually</span></span><br><span class="line"><span class="comment">   discard it in modules) */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __init		__section(.init.text)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __initdata	__section(.init.data)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __exitdata	__section(.exit.data)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __exit_call	__used __section(.exitcall.exit)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> MODULE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __exit		__section(.exit.text)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __exit		__used __section(.exit.text)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>As we can see in comment, if you use <strong>__init</strong> to mark it, memory will be released after initialization.</p>
<h2 id="A-I2C-module"><a href="#A-I2C-module" class="headerlink" title="A I2C module"></a>A I2C module</h2><p>This simple module is useless, let’s take a look at a more useful one: <a href="https://github.com/torvalds/linux/blob/6f0d349d922ba44e4348a17a78ea51b7135965b1/drivers/iio/light/st_uvis25_i2c.c" target="_blank" rel="noopener"><em>linux/drivers/iio/light/st_uvis25_i2c.c</em></a></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * STMicroelectronics uvis25 i2c driver</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Copyright 2017 STMicroelectronics Inc.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Lorenzo Bianconi &lt;lorenzo.bianconi83@gmail.com&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Licensed under the GPL-2.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/acpi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/i2c.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/slab.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/regmap.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"st_uvis25.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UVIS25_I2C_AUTO_INCREMENT	BIT(7)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">regmap_config</span> <span class="title">st_uvis25_i2c_regmap_config</span> = &#123;</span></span><br><span class="line">	.reg_bits = <span class="number">8</span>,</span><br><span class="line">	.val_bits = <span class="number">8</span>,</span><br><span class="line">	.write_flag_mask = UVIS25_I2C_AUTO_INCREMENT,</span><br><span class="line">	.read_flag_mask = UVIS25_I2C_AUTO_INCREMENT,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">st_uvis25_i2c_probe</span><span class="params">(struct i2c_client *client,</span></span></span><br><span class="line"><span class="function"><span class="params">			       <span class="keyword">const</span> struct i2c_device_id *id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">regmap</span> *<span class="title">regmap</span>;</span></span><br><span class="line"></span><br><span class="line">	regmap = devm_regmap_init_i2c(client, &amp;st_uvis25_i2c_regmap_config);</span><br><span class="line">	<span class="keyword">if</span> (IS_ERR(regmap)) &#123;</span><br><span class="line">		dev_err(&amp;client-&gt;dev, <span class="string">"Failed to register i2c regmap %d\n"</span>,</span><br><span class="line">			(<span class="keyword">int</span>)PTR_ERR(regmap));</span><br><span class="line">		<span class="keyword">return</span> PTR_ERR(regmap);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> st_uvis25_probe(&amp;client-&gt;dev, client-&gt;irq, regmap);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">of_device_id</span> <span class="title">st_uvis25_i2c_of_match</span>[] = &#123;</span></span><br><span class="line">	&#123; .compatible = <span class="string">"st,uvis25"</span>, &#125;,</span><br><span class="line">	&#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line">MODULE_DEVICE_TABLE(of, st_uvis25_i2c_of_match);</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">i2c_device_id</span> <span class="title">st_uvis25_i2c_id_table</span>[] = &#123;</span></span><br><span class="line">	&#123; ST_UVIS25_DEV_NAME &#125;,</span><br><span class="line">	&#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line">MODULE_DEVICE_TABLE(i2c, st_uvis25_i2c_id_table);</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">i2c_driver</span> <span class="title">st_uvis25_driver</span> = &#123;</span></span><br><span class="line">	.driver = &#123;</span><br><span class="line">		.name = <span class="string">"st_uvis25_i2c"</span>,</span><br><span class="line">		.pm = &amp;st_uvis25_pm_ops,</span><br><span class="line">		.of_match_table = of_match_ptr(st_uvis25_i2c_of_match),</span><br><span class="line">	&#125;,</span><br><span class="line">	.probe = st_uvis25_i2c_probe,</span><br><span class="line">	.id_table = st_uvis25_i2c_id_table,</span><br><span class="line">&#125;;</span><br><span class="line">module_i2c_driver(st_uvis25_driver);</span><br><span class="line"></span><br><span class="line">MODULE_AUTHOR(<span class="string">"Lorenzo Bianconi &lt;lorenzo.bianconi83@gmail.com&gt;"</span>);</span><br><span class="line">MODULE_DESCRIPTION(<span class="string">"STMicroelectronics uvis25 i2c driver"</span>);</span><br><span class="line">MODULE_LICENSE(<span class="string">"GPL v2"</span>);</span><br></pre></td></tr></table></figure>

<h3 id="What-are-module-i2c-driver-and-MODULE-DEVICE-TABLE"><a href="#What-are-module-i2c-driver-and-MODULE-DEVICE-TABLE" class="headerlink" title="What are module_i2c_driver and MODULE_DEVICE_TABLE"></a>What are module_i2c_driver and MODULE_DEVICE_TABLE</h3><p>Like module_init we mentioned, they are marcos as well. Use your holy F12:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * module_i2c_driver() - Helper macro for registering a modular I2C driver</span></span><br><span class="line"><span class="comment"> * @__i2c_driver: i2c_driver struct</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Helper macro for I2C drivers which do not do anything special in module</span></span><br><span class="line"><span class="comment"> * init/exit. This eliminates a lot of boilerplate. Each module may only</span></span><br><span class="line"><span class="comment"> * use this macro once, and calling it replaces module_init() and module_exit()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> module_i2c_driver(__i2c_driver) \</span></span><br><span class="line">	module_driver(__i2c_driver, i2c_add_driver, \</span><br><span class="line">			i2c_del_driver)</span><br></pre></td></tr></table></figure>
<p>As for <strong>module_driver</strong>, marco AGAIN:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * module_driver() - Helper macro for drivers that don't do anything</span></span><br><span class="line"><span class="comment"> * special in module init/exit. This eliminates a lot of boilerplate.</span></span><br><span class="line"><span class="comment"> * Each module may only use this macro once, and calling it replaces</span></span><br><span class="line"><span class="comment"> * module_init() and module_exit().</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @__driver: driver name</span></span><br><span class="line"><span class="comment"> * @__register: register function for this driver type</span></span><br><span class="line"><span class="comment"> * @__unregister: unregister function for this driver type</span></span><br><span class="line"><span class="comment"> * @...: Additional arguments to be passed to __register and __unregister.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Use this macro to construct bus specific macros for registering</span></span><br><span class="line"><span class="comment"> * drivers, and do not use it on its own.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> module_driver(__driver, __register, __unregister, ...) \</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> __init __driver##_init(<span class="keyword">void</span>) \</span><br><span class="line">&#123; \</span><br><span class="line">	<span class="keyword">return</span> __register(&amp;(__driver) , ##__VA_ARGS__); \</span><br><span class="line">&#125; \</span><br><span class="line">module_init(__driver##_init); \</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __exit __driver##_exit(<span class="keyword">void</span>) \</span><br><span class="line">&#123; \</span><br><span class="line">	__unregister(&amp;(__driver) , ##__VA_ARGS__); \</span><br><span class="line">&#125; \</span><br><span class="line">module_exit(__driver##_exit);</span><br></pre></td></tr></table></figure>

<p>As you can see, those marcos actually are encapsulations of module_init/exit.</p>
<p>And for <strong>MODULE_DEVICE_TABLE</strong>, it’s just help to create an alias, if there is any nodes in <strong>dts</strong> has the same <strong>compatible</strong> with your drivers, <strong>probe</strong> function will be called.<br>As a driver writer, you have no idea how will user enumerate it(By of or i2c), so provide both of them is necessary.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> MODULE</span></span><br><span class="line"><span class="comment">/* Creates an alias so file2alias.c can find device table. */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MODULE_DEVICE_TABLE(type, name)					\</span></span><br><span class="line">extern typeof(name) __mod_##type##__##name##_device_table		\</span><br><span class="line">  __attribute__ ((unused, alias(__stringify(name))))</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span>  <span class="comment">/* !MODULE */</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MODULE_DEVICE_TABLE(type, name)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p><strong>regmap</strong> etc. will be discussed in Part II. </p>
<p>To be continued…</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux kernel module(2)</title>
    <url>/2018-12-16/Linux-kernel-module-2/</url>
    <content><![CDATA[<p>This post will give a simple introduction to Linux kernel module(Part II.).</p>
<p>Linux kernel module简介(二)</p>
<a id="more"></a>
<p>Let’s continue the unfinished parts we left in <a href="https://lzqblog.top/2018-12-08/Linux-kernel-module-1/">Part I.</a>.</p>
<h2 id="A-I2C-module"><a href="#A-I2C-module" class="headerlink" title="A I2C module"></a>A I2C module</h2><h3 id="What-is-regmap"><a href="#What-is-regmap" class="headerlink" title="What is regmap"></a>What is regmap</h3><p><strong>regmap</strong> is a new API added in kernel 3.1. It helps to provide a abstraction for I2C/SPI/IRQ etc. operations. If chips provide both I2C and SPI interfaces, using regmap also can help to reuse part of code. In this example(st_uvis25, a UVI sensor), it provides another SPI driver(st_uvis25_spi.c), and a interfaces-nonrelevant file(st_uvis25_core.c) as well. st_uvis25_core.c will not care which kind of interfaces you are using, every I2C/SPI read/write will be done through regmap. If you put your device on I2C bus in dts file, regmap will call I2C operate functions when you use <strong>regmap_write</strong>, if it’s on SPI bus, regmap will call SPI operate functions instead.</p>
<p>Tos use regmap API, a <strong>regmap_config</strong> should be defined. <strong>reg_bits</strong> and <strong>val_bits</strong> defined the register address length and data length inside this device. write_flag_mask and read_flag_mask will do OR operation with the data you trying to send/read(they are optional):</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// linux-4.9/drivers/base/regmap/regmap.c, Line 2002</span></span><br><span class="line">	u8 = buf;</span><br><span class="line">	*u8 |= <span class="built_in">map</span>-&gt;write_flag_mask;</span><br></pre></td></tr></table></figure>
<p>Then use <strong>devm_regmap_init_i2c</strong> or <strong>devm_regmap_init_spi</strong> to initialize your regmap. It will help you to allocate memory for your regmap and release it when module remove.</p>
<h3 id="How-to-use-regmap-to-control-device"><a href="#How-to-use-regmap-to-control-device" class="headerlink" title="How to use regmap to control device"></a>How to use regmap to control device</h3><p>Let’s take a look at <strong>st_uvis25.h</strong> and <strong>st_uvis25_core.c</strong>:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// st_uvis25.h, Line 26</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">st_uvis25_hw</span> &#123;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">regmap</span> *<span class="title">regmap</span>;</span></span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">iio_trigger</span> *<span class="title">trig</span>;</span></span><br><span class="line">	<span class="keyword">bool</span> enabled;</span><br><span class="line">	<span class="keyword">int</span> irq;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// st_uvis25_core.c Line 55</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">st_uvis25_check_whoami</span><span class="params">(struct st_uvis25_hw *hw)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> err, data;</span><br><span class="line"></span><br><span class="line">	err = regmap_read(hw-&gt;regmap, ST_UVIS25_REG_WHOAMI_ADDR, &amp;data);</span><br><span class="line">	<span class="keyword">if</span> (err &lt; <span class="number">0</span>) &#123;</span><br><span class="line">		dev_err(regmap_get_device(hw-&gt;regmap),</span><br><span class="line">			<span class="string">"failed to read whoami register\n"</span>);</span><br><span class="line">		<span class="keyword">return</span> err;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (data != ST_UVIS25_REG_WHOAMI_VAL) &#123;</span><br><span class="line">		dev_err(regmap_get_device(hw-&gt;regmap),</span><br><span class="line">			<span class="string">"wrong whoami &#123;%02x vs %02x&#125;\n"</span>,</span><br><span class="line">			data, ST_UVIS25_REG_WHOAMI_VAL);</span><br><span class="line">		<span class="keyword">return</span> -ENODEV;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This <strong>st_uvis25_check_whoami</strong> uses regmap_read to read value from register <strong>ST_UVIS25_REG_WHOAMI_ADDR</strong> and compares it to <strong>ST_UVIS25_REG_WHOAMI_VAL</strong>.</p>
<h3 id="i2c-probe-and-probe"><a href="#i2c-probe-and-probe" class="headerlink" title="i2c_probe and probe"></a>i2c_probe and probe</h3><p>In last post we already know that <strong>module_i2c_driver</strong> actually are encapsulations of module_init/exit, so it’s easy to understand that st_uvis25_i2c_probe will be called when install mod. But how about <strong>st_uvis25_probe</strong>, where does it come from?</p>
<h3 id="EXPORT-SYMBOL"><a href="#EXPORT-SYMBOL" class="headerlink" title="EXPORT_SYMBOL"></a>EXPORT_SYMBOL</h3><p>As I mentioned in last section, there are two more files, this <strong>st_uvis25_probe</strong> is export from one of them(st_uvis25_core.c):</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">st_uvis25_probe</span><span class="params">(struct device *dev, <span class="keyword">int</span> irq, struct regmap *regmap)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">/* code */</span></span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(st_uvis25_probe);</span><br></pre></td></tr></table></figure>
<p><strong>EXPORT_SYMBOL</strong> is a marco defined in linux-4.9/include/linux/export.h</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// linux-4.9/include/linux/export.h, Line 56</span></span><br><span class="line"><span class="comment">/* For every exported symbol, place a struct in the __ksymtab section */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ___EXPORT_SYMBOL(sym, sec)					\</span></span><br><span class="line">	<span class="function"><span class="keyword">extern</span> <span class="title">typeof</span><span class="params">(sym)</span> sym</span>;						\</span><br><span class="line">	__CRC_SYMBOL(sym, sec)						\</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> __kstrtab_#<span class="meta">#sym[]				\</span></span><br><span class="line">	__attribute__((section(<span class="string">"__ksymtab_strings"</span>), aligned(<span class="number">1</span>)))	\</span><br><span class="line">	= VMLINUX_SYMBOL_STR(sym);					\</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">kernel_symbol</span> __<span class="title">ksymtab_</span>##<span class="title">sym</span>		\</span></span><br><span class="line"><span class="class">	__<span class="title">used</span>								\</span></span><br><span class="line"><span class="class">	__<span class="title">attribute__</span>((<span class="title">section</span>("___<span class="title">ksymtab</span>" <span class="title">sec</span> "+" #<span class="title">sym</span>), <span class="title">used</span>))	\</span></span><br><span class="line"><span class="class">	= &#123;</span> (<span class="keyword">unsigned</span> <span class="keyword">long</span>)&amp;sym, __kstrtab_#<span class="meta">#sym &#125;</span></span><br></pre></td></tr></table></figure>

<p>In newer kernel 4.19.9, this marco has been simplified to:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* For every exported symbol, place a struct in the __ksymtab section */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ___EXPORT_SYMBOL(sym, sec)					\</span></span><br><span class="line">	<span class="function"><span class="keyword">extern</span> <span class="title">typeof</span><span class="params">(sym)</span> sym</span>;						\</span><br><span class="line">	__CRC_SYMBOL(sym, sec)						\</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> __kstrtab_#<span class="meta">#sym[]				\</span></span><br><span class="line">	__attribute__((section(<span class="string">"__ksymtab_strings"</span>), used, aligned(<span class="number">1</span>)))	\</span><br><span class="line">	= #sym;								\</span><br><span class="line">	__KSYMTAB_ENTRY(sym, sec)</span><br></pre></td></tr></table></figure>

<p>When you use it as <strong>EXPORT_SYMBOL(my_export, GPL)</strong>,it will be expanded like this:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">extern</span> <span class="title">typeof</span><span class="params">(my_export)</span> my_export</span>;						\</span><br><span class="line">__CRC_SYMBOL(my_export, GPL)						\</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> __kstrtab_my_export[]				\</span><br><span class="line">__attribute__((section(<span class="string">"__ksymtab_strings"</span>), aligned(<span class="number">1</span>)))	\</span><br><span class="line">= VMLINUX_SYMBOL_STR(my_export);					\</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">kernel_symbol</span> __<span class="title">ksymtab_my_export</span>		\</span></span><br><span class="line"><span class="class">__<span class="title">used</span>								\</span></span><br><span class="line"><span class="class">__<span class="title">attribute__</span>((<span class="title">section</span>("___<span class="title">ksymtab</span>" <span class="title">GPL</span> "+" <span class="title">my_export</span>), <span class="title">used</span>))	\</span></span><br><span class="line"><span class="class">= &#123;</span> (<span class="keyword">unsigned</span> <span class="keyword">long</span>)&amp;my_export, __kstrtab_my_export &#125;</span><br></pre></td></tr></table></figure>
<p>It will be simpler if ignore <strong>attribute</strong> and __used(there are gcc attributes) and expand again:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> __kstrtab_my_export[] =” my_export”;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">kernel_symbol__ksymtab_my_export</span>=&#123;</span>(<span class="keyword">unsigned</span> <span class="keyword">long</span>)&amp;my_export,_kstrab_my_export&#125;</span><br></pre></td></tr></table></figure>
<p>This part of code declared a static const char array to store symbol name and a static const struct to store address and name of this symbol.</p>
<p>If we add <strong>attribute</strong> back again, this char array will be put into section <strong>__ksymtab_strings</strong> and struct will be put into section <strong>__ksymatab_gpl</strong>.</p>
<p>How to call drivers in user space will be discussed in Part III.<br>To be continued…</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux: ‘adb devices’ can&#39;t find devices</title>
    <url>/2018-11-23/Linux-%E2%80%98adb-devices%E2%80%99-can-t-find-devices/</url>
    <content><![CDATA[<p>A strange issue was found on my Debian PC that <strong>adb devices</strong> can’t find any device meanwhile <strong>lsusb</strong> can find the device I need.</p>
<a id="more"></a>
<h2 id="Issue"><a href="#Issue" class="headerlink" title="Issue"></a>Issue</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ lsusb</span><br><span class="line">Bus 002 Device 006: ID 18d1:4e26 Google Inc. </span><br><span class="line">$ adb devices</span><br><span class="line">List of devices attached</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Copy the first 4 characters of your device ID when you type <strong>lsusb</strong> (mark it as red):</p>
<p>Bus 002 Device 006: ID <span style="color:red">18d1</span>:4e26 Google Inc. </p>
<p>Add it into file <em>~/.android/adb_usb.ini</em> or create it if it doesn’t exist:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ANDROID 3RD PARTY USB VENDOR ID LIST -- DO NOT EDIT.</span><br><span class="line"># USE &#39;android update adb&#39; TO GENERATE.</span><br><span class="line"># 1 USB VENDOR ID PER LINE.</span><br><span class="line">0x18d1</span><br></pre></td></tr></table></figure>
<p>After that, you need to restart your adb server:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ adb <span class="built_in">kill</span>-server </span><br><span class="line">$ adb start-server</span><br><span class="line">$ adb devices</span><br><span class="line">List of devices attached</span><br><span class="line">0123456789ABCDEF	device</span><br></pre></td></tr></table></figure>
<p>Now it can be detected by <strong>adb devices</strong></p>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux kernel module(3)</title>
    <url>/2018-12-23/Linux-kernel-module-3/</url>
    <content><![CDATA[<p>This post will give a simple introduction to Linux kernel module(Part III.).</p>
<p>Linux kernel module简介(三)</p>
<a id="more"></a>
<p>In this post we will discuss how to call kernel driver in user space.</p>
<h2 id="Access-IIO-devices-from-user-space"><a href="#Access-IIO-devices-from-user-space" class="headerlink" title="Access IIO devices from user space"></a>Access IIO devices from user space</h2><p>In last two posts we use a IIO(Linux Industrial I/O Subsystem) device st_uvis25 as a example to show how to write a kernel module. There are a lot of devices fall into this subsystem:</p>
<ul>
<li>ADCs</li>
<li>Accelerometers</li>
<li>Gyros</li>
<li>IMUs</li>
<li>Capacitance to Digital Converters (CDCs)</li>
<li>Pressure Sensors</li>
<li>Color, Light and Proximity Sensors</li>
<li>Temperature Sensors</li>
<li>Magnetometers</li>
<li>DACs</li>
<li>DDS (Direct Digital Synthesis)</li>
<li>PLLs (Phase Locked Loops)</li>
<li>Variable/Programmable Gain Amplifiers (VGA, PGA)</li>
</ul>
<p>In st_uvis25_core.c, a <strong>iio_info</strong> has been defined and assigned to a <strong>iio_dev</strong> in probe function:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// st_uvis25_core.c, Line 267</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">iio_info</span> <span class="title">st_uvis25_info</span> = &#123;</span></span><br><span class="line">	.read_raw = st_uvis25_read_raw,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/* code */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">st_uvis25_probe</span><span class="params">(struct device *dev, <span class="keyword">int</span> irq, struct regmap *regmap)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">st_uvis25_hw</span> *<span class="title">hw</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">iio_dev</span> *<span class="title">iio_dev</span>;</span></span><br><span class="line">	<span class="keyword">int</span> err;</span><br><span class="line"></span><br><span class="line">	iio_dev = devm_iio_device_alloc(dev, <span class="keyword">sizeof</span>(*hw));</span><br><span class="line">	<span class="keyword">if</span> (!iio_dev)</span><br><span class="line">		<span class="keyword">return</span> -ENOMEM;</span><br><span class="line"></span><br><span class="line">	dev_set_drvdata(dev, (<span class="keyword">void</span> *)iio_dev);</span><br><span class="line"></span><br><span class="line">	hw = iio_priv(iio_dev);</span><br><span class="line">	hw-&gt;irq = irq;</span><br><span class="line">	hw-&gt;regmap = regmap;</span><br><span class="line"></span><br><span class="line">	err = st_uvis25_check_whoami(hw);</span><br><span class="line">	<span class="keyword">if</span> (err &lt; <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> err;</span><br><span class="line"></span><br><span class="line">	iio_dev-&gt;modes = INDIO_DIRECT_MODE;</span><br><span class="line">	iio_dev-&gt;dev.parent = dev;</span><br><span class="line">	iio_dev-&gt;channels = st_uvis25_channels;</span><br><span class="line">	iio_dev-&gt;num_channels = ARRAY_SIZE(st_uvis25_channels);</span><br><span class="line">	iio_dev-&gt;name = ST_UVIS25_DEV_NAME;</span><br><span class="line">	iio_dev-&gt;info = &amp;st_uvis25_info;</span><br><span class="line"></span><br><span class="line">	err = st_uvis25_init_sensor(hw);</span><br><span class="line">	<span class="keyword">if</span> (err &lt; <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> err;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (hw-&gt;irq &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		err = st_uvis25_allocate_buffer(iio_dev);</span><br><span class="line">		<span class="keyword">if</span> (err &lt; <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> err;</span><br><span class="line"></span><br><span class="line">		err = st_uvis25_allocate_trigger(iio_dev);</span><br><span class="line">		<span class="keyword">if</span> (err)</span><br><span class="line">			<span class="keyword">return</span> err;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> devm_iio_device_register(dev, iio_dev);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If <strong>devm_iio_device_register</strong> success and iio_info.read_raw has been registered, a file will be created at :<br>/sys/bus/iio/devices/iio:device0/xxx_raw<br>In terminal, you can read it by <strong>cat</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /sys/bus/iio/devices/iio:device0/xxx_raw</span><br></pre></td></tr></table></figure>
<p>In C/C++ applications, you can use <strong>fopen</strong> because it’s a file.</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux配置默认声卡</title>
    <url>/2018-05-02/Linux%E9%85%8D%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%A3%B0%E5%8D%A1/</url>
    <content><![CDATA[<p>树莓派多声卡，尝试配置声卡0为默认输出设备，声卡1为默认输入设备。</p>
<a id="more"></a>

<h2 id="List-all-play-record-device"><a href="#List-all-play-record-device" class="headerlink" title="List all play/record device"></a>List all play/record device</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pi@raspberrypi:~ $ aplay -l</span><br><span class="line">**** List of PLAYBACK Hardware Devices ****</span><br><span class="line">card 0: ALSA [bcm2835 ALSA], device 0: bcm2835 ALSA [bcm2835 ALSA]</span><br><span class="line">  Subdevices: 7/7</span><br><span class="line">  Subdevice <span class="comment">#0: subdevice #0</span></span><br><span class="line">  Subdevice <span class="comment">#1: subdevice #1</span></span><br><span class="line">  Subdevice <span class="comment">#2: subdevice #2</span></span><br><span class="line">  Subdevice <span class="comment">#3: subdevice #3</span></span><br><span class="line">  Subdevice <span class="comment">#4: subdevice #4</span></span><br><span class="line">  Subdevice <span class="comment">#5: subdevice #5</span></span><br><span class="line">  Subdevice <span class="comment">#6: subdevice #6</span></span><br><span class="line">card 0: ALSA [bcm2835 ALSA], device 1: bcm2835 ALSA [bcm2835 IEC958/HDMI]</span><br><span class="line">  Subdevices: 1/1</span><br><span class="line">  Subdevice <span class="comment">#0: subdevice #0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pi@raspberrypi:~ $ arecord -l</span><br><span class="line">**** List of CAPTURE Hardware Devices ****</span><br><span class="line">card 1: Device [USB PnP Sound Device], device 0: USB Audio [USB Audio]</span><br><span class="line">  Subdevices: 1/1</span><br><span class="line">  Subdevice <span class="comment">#0: subdevice #0</span></span><br></pre></td></tr></table></figure>
<h2 id="Set-card-0-as-playback-card-1-as-capture"><a href="#Set-card-0-as-playback-card-1-as-capture" class="headerlink" title="Set card 0 as playback, card 1 as capture"></a>Set card 0 as playback, card 1 as capture</h2><p>Open <strong>.asoundrc</strong> file under <strong>$HOME</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$HOME</span></span><br><span class="line">vim .asoundrc</span><br></pre></td></tr></table></figure>
<p>Modify <strong>.asoundrc</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pcm.!default &#123;</span><br><span class="line">    type asym</span><br><span class="line">    playback.pcm &quot;plughw:0,0&quot;</span><br><span class="line">    capture.pcm  &quot;plughw:1,0&quot;</span><br><span class="line">&#125;</span><br><span class="line">ctl.!default &#123;</span><br><span class="line">        type hw</span><br><span class="line">        card 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>*”plughw:1,0”* means card 1, device 0</p>
<p>Then <strong>save file</strong> and <strong>reboot</strong></p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Raspberry Pi</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown frequently used syntax</title>
    <url>/2018-11-24/Markdown-frequently-used-syntax/</url>
    <content><![CDATA[<p>Markdown 常用语法小结</p>
<p>写了这么久的md, 偶尔还是会忘记一些细节，干脆写篇日志总结一下，以备不时之需</p>
<a id="more"></a>

<h2 id="Highlight-突出显示"><a href="#Highlight-突出显示" class="headerlink" title="Highlight(突出显示)"></a>Highlight(突出显示)</h2><table>
<thead>
<tr>
<th align="center">Item</th>
<th align="center">How to use</th>
<th align="center">Preview</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Bold(加粗)</td>
<td align="center">**Bold Text**</td>
<td align="center"><strong>Bold Text</strong></td>
</tr>
<tr>
<td align="center">Italic(斜体)</td>
<td align="center">*Italic Text*</td>
<td align="center"><em>Italic Text</em></td>
</tr>
<tr>
<td align="center">Strike Through(删除线)</td>
<td align="center">~~Strike Through Text~~</td>
<td align="center"><del>Strike Through Text</del></td>
</tr>
<tr>
<td align="center">Font Color(字体颜色)</td>
<td align="center">&lt;span style=&quot;color:red&quot;&gt;Red Text&lt;/span&gt;</td>
<td align="center"><span style="color:red">Red Text</span></td>
</tr>
</tbody></table>
<p>Markdown本身不支持更改字体颜色，但是支持插入HTML, 上面的&lt;span&gt;其实是HTML的标签。 如果还有其他奇奇怪怪的要求(如更改字体，更改大小，设置指针样式)，也可以使用&lt;span&gt;实现:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"color:blue;font-family:Impact;font-style:italic;cursor:crosshair;font-size:30px"</span>&gt;</span>Impact font blue italic 30px with crosshair pointer<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果如下（鼠标移到上面试试）：</p>
<p><span style="color:blue;font-family:Impact;font-style:italic;cursor:crosshair;font-size:30px">Impact font blue italic 30px with crosshair pointer</span></p>
<h2 id="Table-表格"><a href="#Table-表格" class="headerlink" title="Table(表格)"></a>Table(表格)</h2><p>Markdown 支持插入简单的表格:</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">| Default   | left aligned | right aligned | mid aligned |</span><br><span class="line">| --------- | :----------- | ------------: | :---------: |</span><br><span class="line">| short     | short        | short         | short       |</span><br><span class="line">| long text | long text    | long text     | long text   |</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<table>
<thead>
<tr>
<th>Default</th>
<th align="left">left aligned</th>
<th align="right">right aligned</th>
<th align="center">mid aligned</th>
</tr>
</thead>
<tbody><tr>
<td>short</td>
<td align="left">short</td>
<td align="right">short</td>
<td align="center">short</td>
</tr>
<tr>
<td>long text</td>
<td align="left">long text</td>
<td align="right">long text</td>
<td align="center">long text</td>
</tr>
</tbody></table>
<p>表格内容的对齐方式可以通过更改”&minus;&minus;&minus;”进行调整：</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">-----    //默认，标题居中，内容左对齐</span><br><span class="line">:----    //标题和内容都左对齐</span><br><span class="line">-----:   //标题和内容都右对齐</span><br><span class="line">:----:   //标题和内容都居中对齐</span><br></pre></td></tr></table></figure>

<h2 id="Insert-image-or-super-link-图片和超链接"><a href="#Insert-image-or-super-link-图片和超链接" class="headerlink" title="Insert image or super link(图片和超链接)"></a>Insert image or super link(图片和超链接)</h2><h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><p>  使用<strong>![Background Text](image_path ‘Title’)</strong>可以插入图片, 其中:</p>
<ul>
<li>Background Text: 显示在图片下层的文字，也就是说如果图片显示正常的话一般会被挡住看不见</li>
<li>image_path: 图像源文件的路径。可以是网络链接，也可以是本地路径</li>
<li>Title: 显示在图片下方的标题</li>
</ul>
<p>如：</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">![](Markdown-frequently-used-syntax/IMG<span class="emphasis">_20170621_</span>154100.jpg 'Flying Spirit')</span><br></pre></td></tr></table></figure>

<p><img src="/2018-11-24/Markdown-frequently-used-syntax/IMG_20170621_154100.jpg" alt title="Flying Spirit"></p>
<h3 id="超链接"><a href="#超链接" class="headerlink" title="超链接"></a>超链接</h3><p>使用<strong>[Suerp_Link](url)</strong>的方式插入超链接, 其中:</p>
<ul>
<li>Suerp_Link: 超链接显示的文本</li>
<li>url: 指向的链接</li>
</ul>
<p>如:</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">[<span class="string">一位程序员，比较帅的那种</span>](<span class="link">https://www.lzqblog.top</span>)</span><br></pre></td></tr></table></figure>

<p><a href="https://www.lzqblog.top" target="_blank" rel="noopener">一位程序员，比较帅的那种</a></p>
<h2 id="Check-box"><a href="#Check-box" class="headerlink" title="Check box"></a>Check box</h2><p>Markdown也支持带check box的样式，用户可以通过单击来框选，但是这种样式在静态页面中没什么用</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>[x] item1</span><br><span class="line"><span class="bullet">- </span>[ ] item2</span><br><span class="line"><span class="bullet">- </span>[x] item3</span><br></pre></td></tr></table></figure>

<ul>
<li><input checked disabled type="checkbox"> item1</li>
<li><input disabled type="checkbox"> item2</li>
<li><input checked disabled type="checkbox"> item3</li>
</ul>
<h2 id="Flow-流程图"><a href="#Flow-流程图" class="headerlink" title="Flow(流程图)"></a>Flow(流程图)</h2><p>Markdown 甚至支持直接画流程图</p>
<p><img src="/2018-11-24/Markdown-frequently-used-syntax/006HJgYYgy1fex00ntxymg308c08c74b.png" alt></p>
<p>要创建流程图只需两步：1.声明元素 2.连接元素<br>一个简单的例子：</p>
<p>```flow<br>flow<br>st=&gt;start: Main Start:&gt;<a href="http://www.lzqblog.top" target="_blank" rel="noopener">www.lzqblog.top</a><br>input=&gt;inputoutput: input a<br>op=&gt;operation: a–<br>sb=&gt;subroutine: a = a!<br>cond=&gt;condition: a &gt; 100?<br>output=&gt;inputoutput: print a<br>e=&gt;end<br>st-&gt;input-&gt;op-&gt;cond<br>cond(no,right)-&gt;sb(right)-&gt;output(right)-&gt;op<br>cond(yes,down)-&gt;e<br>```<br>效果如下：</p>
<div id="flowchart-0" class="flow-chart"></div>

<h3 id="流程图的基本语法"><a href="#流程图的基本语法" class="headerlink" title="流程图的基本语法"></a>流程图的基本语法</h3><p><strong>声明元素</strong>:</p>
<p>tag=&gt;type: content:&gt;url</p>
<p>tag 为标签，在连接元素的时候会用到<br>type为元素类型，常用的有 start condition operation inputoutput subroutine end几种<br>content 为显示在元素中的内容<br>url为可添加的超链接</p>
<p><strong>连接元素</strong>：<br>对于非条件元素:<br>tag1-&gt;tag2<br>默认的箭头方向是向下(down)，也可以指定箭头方向：<br>tag1(right)-&gt;tag2<br>对于条件元素(condition)，多了一个yes or no参数:<br>condition_tag(no,right)-&gt;tag2<br>condition_tag(yes,down)-&gt;tag2</p>
<p>注： hexo默认不支持Markdown流程图，要在hexo上显示流程图需要安装hexo-filter-flowchart</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-filter-flowchart</span><br></pre></td></tr></table></figure>

<p>常用的差不多就这些，有想到的以后再补充吧</p>
<p><img src="/2018-11-24/Markdown-frequently-used-syntax/75aecbdeb48f8c5448e454b638292df5e1fe7f70.gif" alt></p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">flow
st=>start: Main Start:>http://www.lzqblog.top
input=>inputoutput: input a
op=>operation: a--
sb=>subroutine: a = a!
cond=>condition: a > 100?
output=>inputoutput: print a
e=>end
st->input->op->cond
cond(no,right)->sb(right)->output(right)->op
cond(yes,down)->e</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script>]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>PyQt5 Getting Started</title>
    <url>/2020-02-07/PyQt5-Getting-Started/</url>
    <content><![CDATA[<p>Recently I start to evaluate the feasibility of porting one old C++ Qt4 project to PyQt5 since Python is more friendly for some engineers.</p>
<a id="more"></a>

<p>The following steps was test on Ubuntu.</p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pip3 install PyQt5</span><br></pre></td></tr></table></figure>

<p>If you haven’t install Qt Designer yet, we’d like to suggest install it as well:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install qttools5-dev-tools</span><br></pre></td></tr></table></figure>

<h2 id="The-first-PyQt5-program"><a href="#The-first-PyQt5-program" class="headerlink" title="The first PyQt5 program"></a>The first PyQt5 program</h2><p>After installation, we can perform a quick check by a simple PyQt5 program:</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtWidgets <span class="keyword">import</span> QApplication, QLabel</span><br><span class="line"></span><br><span class="line">app=QApplication(sys.argv)</span><br><span class="line">label = QLabel(<span class="string">'Hello PyQt5!'</span>)</span><br><span class="line">label.show()</span><br><span class="line">sys.exit(app.exec_())</span><br></pre></td></tr></table></figure>
<p>We could see a simple window with a label on it after executing this simple code:</p>
<p><img src="/2020-02-07/PyQt5-Getting-Started/hello.png" alt></p>
<p>In this code we created a <code>QApplication</code> and run the event loop via <code>exec_()</code> method.</p>
<h2 id="Using-Qt-Designer-to-design-UI"><a href="#Using-Qt-Designer-to-design-UI" class="headerlink" title="Using Qt Designer to design UI"></a>Using Qt Designer to design UI</h2><p>In the first example we “designed” an application UI by coding, but in real project we have much more complicated UI for applications which is hard to design without UI designer. For PyQt5, we could use Qt Designer to design UI as before but we need one tiny utility to transform <span style="color:red">*.ui</span> file into python code.</p>
<p>i.e. If we drawn a simple UI like this in Qt Designer and save it as <span style="color:red">test.ui</span>:</p>
<p><img src="/2020-02-07/PyQt5-Getting-Started/ui.png" alt></p>
<p>Then we use <span style="color:red">pyuic5</span> to generate python code from <span style="color:red">test.ui</span>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pyuic5 test.ui -o test_ui.py</span><br></pre></td></tr></table></figure>

<p>Then we can get <strong>test_ui.py</strong>:</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Form implementation generated from reading ui file 'test.ui'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Created by: PyQt5 UI code generator 5.14.1</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># WARNING! All changes made in this file will be lost!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PyQt5 <span class="keyword">import</span> QtCore, QtGui, QtWidgets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ui_MainWindow</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setupUi</span><span class="params">(self, MainWindow)</span>:</span></span><br><span class="line">        MainWindow.setObjectName(<span class="string">"MainWindow"</span>)</span><br><span class="line">        MainWindow.resize(<span class="number">502</span>, <span class="number">376</span>)</span><br><span class="line">        self.centralwidget = QtWidgets.QWidget(MainWindow)</span><br><span class="line">        self.centralwidget.setObjectName(<span class="string">"centralwidget"</span>)</span><br><span class="line">        self.pushButton = QtWidgets.QPushButton(self.centralwidget)</span><br><span class="line">        self.pushButton.setGeometry(QtCore.QRect(<span class="number">190</span>, <span class="number">150</span>, <span class="number">89</span>, <span class="number">25</span>))</span><br><span class="line">        self.pushButton.setObjectName(<span class="string">"pushButton"</span>)</span><br><span class="line">        MainWindow.setCentralWidget(self.centralwidget)</span><br><span class="line">        self.menubar = QtWidgets.QMenuBar(MainWindow)</span><br><span class="line">        self.menubar.setGeometry(QtCore.QRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">502</span>, <span class="number">22</span>))</span><br><span class="line">        self.menubar.setObjectName(<span class="string">"menubar"</span>)</span><br><span class="line">        self.menuFile = QtWidgets.QMenu(self.menubar)</span><br><span class="line">        self.menuFile.setObjectName(<span class="string">"menuFile"</span>)</span><br><span class="line">        MainWindow.setMenuBar(self.menubar)</span><br><span class="line">        self.statusbar = QtWidgets.QStatusBar(MainWindow)</span><br><span class="line">        self.statusbar.setObjectName(<span class="string">"statusbar"</span>)</span><br><span class="line">        MainWindow.setStatusBar(self.statusbar)</span><br><span class="line">        self.actionasd = QtWidgets.QAction(MainWindow)</span><br><span class="line">        self.actionasd.setObjectName(<span class="string">"actionasd"</span>)</span><br><span class="line">        self.menuFile.addAction(self.actionasd)</span><br><span class="line">        self.menubar.addAction(self.menuFile.menuAction())</span><br><span class="line"></span><br><span class="line">        self.retranslateUi(MainWindow)</span><br><span class="line">        QtCore.QMetaObject.connectSlotsByName(MainWindow)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">retranslateUi</span><span class="params">(self, MainWindow)</span>:</span></span><br><span class="line">        _translate = QtCore.QCoreApplication.translate</span><br><span class="line">        MainWindow.setWindowTitle(_translate(<span class="string">"MainWindow"</span>, <span class="string">"MainWindow"</span>))</span><br><span class="line">        self.pushButton.setText(_translate(<span class="string">"MainWindow"</span>, <span class="string">"PushButton"</span>))</span><br><span class="line">        self.menuFile.setTitle(_translate(<span class="string">"MainWindow"</span>, <span class="string">"File"</span>))</span><br><span class="line">        self.actionasd.setText(_translate(<span class="string">"MainWindow"</span>, <span class="string">"Open"</span>))</span><br></pre></td></tr></table></figure>
<h2 id="Quick-test-with-clicked-event"><a href="#Quick-test-with-clicked-event" class="headerlink" title="Quick test with clicked event"></a>Quick test with clicked event</h2><p>Then we can start coding with this file by inheriting <code>class Ui_MainWindow</code>:</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtWidgets <span class="keyword">import</span> QApplication, QMainWindow</span><br><span class="line"><span class="keyword">from</span> test_ui <span class="keyword">import</span> Ui_MainWindow</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMainWindow</span><span class="params">(QMainWindow, Ui_MainWindow)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        super(MyMainWindow, self).__init__()</span><br><span class="line">        self.setupUi(self)</span><br><span class="line">        self.pushButton.clicked.connect(self.onBtnClicked)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">onBtnClicked</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"Button Clicked:"</span> + self.sender().objectName())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = QApplication([])</span><br><span class="line">mainWindow = MyMainWindow()</span><br><span class="line"></span><br><span class="line">mainWindow.show()</span><br><span class="line"></span><br><span class="line">sys.exit(app.exec_())</span><br></pre></td></tr></table></figure>
<p>Here we defined a <code>class MyMainWindow</code> which inheriting from <code>QMainWindow</code> and <code>Ui_MainWindow</code>, then we defined <code>__init__</code> method which will <code>setupUi</code> and binding button clicked event with <code>onBtnClicked</code>. When <strong>pushButton</strong> was clicked, we can see output in terminal:<br><img src="/2020-02-07/PyQt5-Getting-Started/btn_clicked.png" alt></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>So far we still not sure about the performance differences between Qt(C++) and PyQt5 but as far as I can see PyQt5 could be one of the options for those engineers who is not very good at C++.</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Qt5</tag>
      </tags>
  </entry>
  <entry>
    <title>Python: Use mmap to create shared memory for IPC</title>
    <url>/2020-06-13/Python-Use-mmap-to-create-shared-memory-for-IPC/</url>
    <content><![CDATA[<p>There are several ways to achieve IPC, shared memory is one of those. In this post, we will try to create shared memory via <strong>mmap</strong> module in python.</p>
<a id="more"></a>

<h2 id="Write-to-shared-memory"><a href="#Write-to-shared-memory" class="headerlink" title="Write to shared memory"></a>Write to shared memory</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> mmap</span><br><span class="line"><span class="keyword">import</span> contextlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_mem</span><span class="params">(file, share_data)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> contextlib.closing(mmap.mmap(file.fileno(), <span class="number">1024</span>, access=mmap.ACCESS_WRITE)) <span class="keyword">as</span> mem:</span><br><span class="line">        mem.seek(<span class="number">0</span>)</span><br><span class="line">        mem.write(share_data.encode())</span><br><span class="line">        mem.write(<span class="string">'\x00'</span>.encode() * (<span class="number">1024</span> - len(share_data.encode())))</span><br><span class="line">        mem.flush()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'data.dat'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">'\x00'</span> * <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">file = open(<span class="string">'data.dat'</span>, <span class="string">'r+'</span>)</span><br><span class="line">write_to_mem(file, <span class="string">'hello'</span>)</span><br></pre></td></tr></table></figure>

<p>Here we created a 1026 bytes file, which will be mapped to memory. </p>
<h2 id="Read-from-shared-memory"><a href="#Read-from-shared-memory" class="headerlink" title="Read from shared memory"></a>Read from shared memory</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> mmap</span><br><span class="line"><span class="keyword">import</span> contextlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'data.dat'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">with</span> contextlib.closing(mmap.mmap(f.fileno(), <span class="number">1024</span>, access=mmap.ACCESS_READ)) <span class="keyword">as</span> mem:</span><br><span class="line">        s = mem.read(<span class="number">1024</span>)</span><br><span class="line">        print(s)</span><br></pre></td></tr></table></figure>

<p>Here we mapped <em>data.dat</em> file to memory and read from it.</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Run tshark/wireshark In Docker</title>
    <url>/2020-10-11/Run-tshark-wireshark-In-Docker/</url>
    <content><![CDATA[<p>Last week when I was trying to run tshark in a Docker container to capture http packets, tshark reported following error even with root user:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tshark: Couldn&#39;t run &#x2F;usr&#x2F;bin&#x2F;dumpcap in child process: Operation not permitted</span><br></pre></td></tr></table></figure>

<p>After searching, to access dumcap, we need to add <code>--cap-add</code> options when start container, then add user into <strong>wireshark</strong> group:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run --<span class="built_in">cap</span>-add=NET_RAW --<span class="built_in">cap</span>-add=NET_ADMIN <span class="variable">$IMAGE</span></span><br><span class="line">usermod -a -G wireshark <span class="variable">$USER</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>SSL certificate problem: unable to get local issuer certificate</title>
    <url>/2020-08-26/SSL-certificate-problem-unable-to-get-local-issuer-certificate/</url>
    <content><![CDATA[<p>Yesterday successfully cross compiled curl with mbedTLS, but there was an error when trying to access a https link:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SSL certificate problem: unable to get local issuer certificate</span><br></pre></td></tr></table></figure>

<p>To fix it, download CA certificate to local machine and export environment variable <code>CURL_CA_BUNDLE</code>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://curl.haxx.se/ca/cacert.pem</span><br><span class="line"><span class="built_in">export</span> CURL_CA_BUNDLE=&lt;path of cacert.pem&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>STM32MP1: Boot kernel via TFTP from U-Boot</title>
    <url>/2020-02-16/STM32MP1-Boot-kernel-via-TFTP-from-U-Boot/</url>
    <content><![CDATA[<p>Today I just managed to boot kernel via TFTP on STM32MP1 board but steps I go through are quite different with i.MX8. Thus, I think there is a necessity to have a short note about this 🖋</p>
<a id="more"></a>

<h2 id="Pre-requirements"><a href="#Pre-requirements" class="headerlink" title="Pre-requirements"></a>Pre-requirements</h2><ul>
<li>TFTP server on PC is up and running(<a href="https://lzqblog.top/2019-05-26/i-MX-setup-TFTP-and-NFS/">Check here</a>)</li>
<li>Board and PC are in same LAN</li>
</ul>
<h2 id="TFTP-folder"><a href="#TFTP-folder" class="headerlink" title="TFTP folder"></a>TFTP folder</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~/data/srv/tftp$ tree</span><br><span class="line">.</span><br><span class="line">├── pxelinux.cfg</span><br><span class="line">│   └── 01-e2-a4-06-a5-8f-7f</span><br><span class="line">├── stm32mp157a-cp.dtb</span><br><span class="line">└── uImage</span><br><span class="line"></span><br><span class="line">1 directory, 3 files</span><br></pre></td></tr></table></figure>
<p>U-Boot will use <code>pxe</code> command to load PXE configuration file from TFTP server(PC in my scenario). PXE configuration file has the same format with <em>extlinux.conf</em>, and the file name is related to hardware MAC address. In my case <span style="color:red"><em>01-e2-a4-06-a5-8f-7f</em></span>:</p>
<ul>
<li>01: ARP type 1 for ethernet</li>
<li>e2-a4-06-a5-8f-7f: MAC address</li>
</ul>
<p>Inside my PXE configuration file(01-e2-a4-06-a5-8f-7f):</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">menu title Select the boot mode</span><br><span class="line"> DEFAULT eMMC</span><br><span class="line"> TIMEOUT 20</span><br><span class="line"> LABEL initramfs</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb</span><br><span class="line"> 	INITRD uInitrd</span><br><span class="line"> 	APPEND rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br><span class="line"> LABEL nfs</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb</span><br><span class="line"> 	APPEND root&#x3D;&#x2F;dev&#x2F;nfs nfsroot&#x3D;192.168.0.106:&#x2F;nfsroot ip&#x3D;dhcp rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br><span class="line"> LABEL sdcard</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb</span><br><span class="line"> 	APPEND root&#x3D;&#x2F;dev&#x2F;mmcblk0p6 rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br><span class="line"> LABEL eMMC</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb</span><br><span class="line"> 	APPEND root&#x3D;&#x2F;dev&#x2F;mmcblk1p6 rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br></pre></td></tr></table></figure>
<p>With this configuration file we could choose in U-Boot where to load rootfs when booting.</p>
<h2 id="U-Boot"><a href="#U-Boot" class="headerlink" title="U-Boot"></a>U-Boot</h2><p>After TFTP server and folder are ready, we can proceed on U-Boot. If <code>CONFIG_NET_RANDOM_ETHADDR</code> has not been set in uboot defconfig or MAC address haven’t been configured before, we might need to setup MAC address(<span style="color:red"><em>ethaddr</em></span>) manually. Meanwhile <span style="color:red"><em>serverip</em></span> need to be set as well:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">env set ethaddr e2:a4:06:a5:8f:7f</span><br><span class="line">env set serverip 192.168.0.106</span><br><span class="line">saveenv</span><br></pre></td></tr></table></figure>
<p>After that we only need to <code>run bootcmd_pxe</code> if we want to load kernel from TFTP:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Hit any key to stop autoboot:  0 </span><br><span class="line">STM32MP&gt; run bootcmd_pxe</span><br><span class="line">ethernet@5800a000 Waiting for PHY auto negotiation to complete. done</span><br><span class="line">BOOTP broadcast 1</span><br><span class="line">DHCP client bound to address 192.168.0.101 (2 ms)</span><br><span class="line">missing environment variable: pxeuuid</span><br><span class="line">missing environment variable: bootfile</span><br><span class="line">Retrieving file: pxelinux.cfg&#x2F;01-e2-a4-06-a5-8f-7f</span><br><span class="line">Using ethernet@5800a000 device</span><br><span class="line">TFTP from server 192.168.0.106; our IP address is 192.168.0.101</span><br><span class="line">Filename &#39;pxelinux.cfg&#x2F;01-e2-a4-06-a5-8f-7f&#39;.</span><br><span class="line">Load address: 0xc4200000</span><br><span class="line">Loading: #</span><br><span class="line">         8.8 KiB&#x2F;s</span><br><span class="line">done</span><br><span class="line">Bytes transferred &#x3D; 608 (260 hex)</span><br><span class="line">Config file found</span><br><span class="line">Select the boot mode</span><br><span class="line">1:      initramfs</span><br><span class="line">2:      nfs</span><br><span class="line">3:      sdcard</span><br><span class="line">4:      eMMC</span><br><span class="line">Enter choice: 4:        eMMC</span><br><span class="line">missing environment variable: bootfile</span><br><span class="line">Retrieving file: uImage</span><br><span class="line">Using ethernet@5800a000 device</span><br><span class="line">TFTP from server 192.168.0.106; our IP address is 192.168.0.101</span><br><span class="line">Filename &#39;uImage&#39;.</span><br><span class="line">Load address: 0xc2000000</span><br><span class="line">Loading: #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         ##################T ###############################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         ##############################################################</span><br><span class="line">         265.6 KiB&#x2F;s</span><br><span class="line">done</span><br><span class="line">Bytes transferred &#x3D; 6640192 (655240 hex)</span><br><span class="line">append: root&#x3D;&#x2F;dev&#x2F;mmcblk1p6 rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br><span class="line">missing environment variable: bootfile</span><br><span class="line">Retrieving file: stm32mp157a-cp.dtb</span><br><span class="line">Using ethernet@5800a000 device</span><br><span class="line">TFTP from server 192.168.0.106; our IP address is 192.168.0.101</span><br><span class="line">Filename &#39;stm32mp157a-cp.dtb&#39;.</span><br><span class="line">Load address: 0xc4000000</span><br><span class="line">Loading: #############</span><br><span class="line">         188.5 KiB&#x2F;s</span><br><span class="line">done</span><br><span class="line">Bytes transferred &#x3D; 62891 (f5ab hex)</span><br><span class="line">## Booting kernel from Legacy Image at c2000000 ...</span><br><span class="line">   Image Name:   Linux-4.19.49</span><br><span class="line">   Created:      2019-06-09   7:17:25 UTC</span><br><span class="line">   Image Type:   ARM Linux Kernel Image (uncompressed)</span><br><span class="line">   Data Size:    6640128 Bytes &#x3D; 6.3 MiB</span><br><span class="line">   Load Address: c2000040</span><br><span class="line">   Entry Point:  c2000040</span><br><span class="line">   Verifying Checksum ... OK</span><br><span class="line">## Flattened Device Tree blob at c4000000</span><br><span class="line">   Booting using the fdt blob at 0xc4000000</span><br><span class="line">   XIP Kernel Image ... OK</span><br><span class="line">   Using Device Tree in place at c4000000, end c40125aa</span><br><span class="line"></span><br><span class="line">Starting kernel ...</span><br><span class="line"></span><br><span class="line">[    0.000000] Booting Linux on physical CPU 0x0</span><br><span class="line">[    0.000000] Linux version 4.19.49 (oe-user@oe-host) (gcc version 8.2.0 (GCC)) #1 SMP PREEMPT Sun Jun 9</span><br><span class="line">[    0.000000] CPU: ARMv7 Processor [410fc075] revision 5 (ARMv7), cr&#x3D;10c5387d</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>U-Boot</tag>
      </tags>
  </entry>
  <entry>
    <title>STM32MP1 getting started: setup environments</title>
    <url>/2019-11-16/STM32MP1-getting-started-setup-environments/</url>
    <content><![CDATA[<p>I’m planing to do some research on ST newest MPU series: STM32MP1. It’s a Cortex A7(solo or dual core) + M4 solution, not very powerful but the price might be very competitive. In this post we will setup the development environments.</p>
<a id="more"></a>

<h2 id="Choose-the-suitable-base-software-package"><a href="#Choose-the-suitable-base-software-package" class="headerlink" title="Choose the suitable base software package"></a>Choose the suitable base software package</h2><p>There are 3 basic software packages provided by ST:</p>
<ul>
<li>Starter Package(For evaluation)</li>
<li>Developer Package(For limited modification and application development)</li>
<li>Distribution Package(For creating custom distribution)</li>
</ul>
<p>Similar with Qualcomm solutions, there are two packages are available for development purpose. In my scenario I will use Distribution Package for sure, so the following parts of this post is about how to setup environments for Developer Package based development.</p>
<p>BTW the experiences I got during Qualcomm apq8009 based SoC really sucks… Their packages just like a huge shit mountain.</p>
<h2 id="Initialize-repo"><a href="#Initialize-repo" class="headerlink" title="Initialize repo"></a>Initialize repo</h2><p>If you are new to Yocto, you need to install some packages before start(i.e. <strong>repo</strong>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir openstlinux-4.19-thud-mp1-19-10-09 &amp;&amp; <span class="built_in">cd</span> openstlinux-4.19-thud-mp1-19-10-09</span><br><span class="line">repo init -u https://github.com/STMicroelectronics/oe-manifest.git -b refs/tags/openstlinux-4.19-thud-mp1-19-10-09</span><br><span class="line">repo sync</span><br></pre></td></tr></table></figure>
<h2 id="Package-structure"><a href="#Package-structure" class="headerlink" title="Package structure"></a>Package structure</h2><p>From <a href="https://wiki.st.com/stm32mpu/wiki/STM32MP1_Distribution_Package" target="_blank" rel="noopener">ST WIKI</a>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openstlinux-4.19-thud-mp1-19-10-09  OpenSTLinux distribution</span><br><span class="line">├── layers </span><br><span class="line">│    ├── meta-openembedded                Collection of layers <span class="keyword">for</span> the OpenEmbedded-Core universe (OpenEmbedded standard)</span><br><span class="line">│    ├── meta-qt5                         QT5 layer <span class="keyword">for</span> OpenEmbedded (standard)</span><br><span class="line">│    ├── meta-st</span><br><span class="line">│    │   ├── meta-st-openstlinux          STMicroelectronics layer that contains the frameworks and images settings <span class="keyword">for</span> the OpenSTLinux distribution</span><br><span class="line">│    │   ├── meta-st-stm32mp              STMicroelectronics layer that contains the description of the BSP <span class="keyword">for</span> the STM32 MPU devices</span><br><span class="line">│    │   │   ├── recipes-bsp</span><br><span class="line">│    │   │   │   ├── alsa                 Recipes <span class="keyword">for</span> ALSA control configuration</span><br><span class="line">│    │   │   │   ├── drivers              Recipes <span class="keyword">for</span> Vivante GCNANO GPU kernel drivers</span><br><span class="line">│    │   │   │   ├── trusted-firmware<span class="_">-a</span>   Recipes <span class="keyword">for</span> TF-A</span><br><span class="line">│    │   │   │   └── u-boot               Recipes <span class="keyword">for</span> U-Boot</span><br><span class="line">│    │   │   ├── recipes-extended</span><br><span class="line">│    │   │   │   ├── linux-examples       Recipes <span class="keyword">for</span> Linux examples <span class="keyword">for</span> STM32 MPU devices</span><br><span class="line">│    │   │   │   ├── m4coredump           Recipes <span class="keyword">for</span> script to manage coredump of cortexM4</span><br><span class="line">│    │   │   │   └── m4projects           Recipes <span class="keyword">for</span> firmware examples <span class="keyword">for</span> Cortex M4</span><br><span class="line">│    │   │   ├── recipes-graphics</span><br><span class="line">│    │   │   │   ├── gcnano-userland      Recipes <span class="keyword">for</span> Vivante libraries OpenGL ES, OpenVG and EGL (multi backend)</span><br><span class="line">│    │   │   │   └── [...]</span><br><span class="line">│    │   │   ├── recipes-kernel</span><br><span class="line">│    │   │   │   ├── linux                Recipes <span class="keyword">for</span> Linux kernel</span><br><span class="line">│    │   │   │   └── linux-firmware       Recipes <span class="keyword">for</span> Linux firmwares (example, Bluetooth firmware)</span><br><span class="line">│    │   │   ├── recipes-security</span><br><span class="line">│    │   │   │   └── optee                Recipes <span class="keyword">for</span> OPTEE</span><br><span class="line">│    │   │   ├── recipes-st</span><br><span class="line">│    │   │   │   └── images               Recipes <span class="keyword">for</span> the bootfs and userfs partitions binaries</span><br><span class="line">│    │   │   └── [...]</span><br><span class="line">│    │   ├── meta-st-stm32mp-addons       STMicroelectronics layer that helps managing the STM32CubeMX integration</span><br><span class="line">│    │   └── scripts</span><br><span class="line">│    │       ├── envsetup.sh              Environment setup script <span class="keyword">for</span> Distribution Package</span><br><span class="line">│    │       └── [...]</span><br><span class="line">│    ├── meta-timesys                     Timesys layer <span class="keyword">for</span> OpenEmbedded (standard)</span><br><span class="line">│    └── openembedded-core                Core metadata <span class="keyword">for</span> current versions of OpenEmbedded (standard)</span><br></pre></td></tr></table></figure>

<h2 id="Test-building-image"><a href="#Test-building-image" class="headerlink" title="Test building image"></a>Test building image</h2><h3 id="Environment-setup"><a href="#Environment-setup" class="headerlink" title="Environment setup"></a>Environment setup</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DISTRO=openstlinux-weston MACHINE=stm32mp1 <span class="built_in">source</span> layers/meta-st/scripts/envsetup.sh</span><br></pre></td></tr></table></figure>
<p>If you want to test without wayland or x11 support, using <strong>DISTRO=openstlinux-eglfs MACHINE=st-image-core</strong> instead.</p>
<p>If build folder has been created, using blow command to re-use it:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> layers/meta-st/scripts/envsetup.sh build-openstlinuxweston-stm32mp1/</span><br></pre></td></tr></table></figure>
<h3 id="Trigger-building"><a href="#Trigger-building" class="headerlink" title="Trigger building"></a>Trigger building</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitbake st-image-weston</span><br></pre></td></tr></table></figure>
<p><strong>st-image-core</strong> is also available if you want to create a console only image.</p>
<h2 id="USB-Flash"><a href="#USB-Flash" class="headerlink" title="USB Flash"></a>USB Flash</h2><p>USB flash need to use <a href="https://my.st.com/content/my_st_com/en/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-programmers/stm32cubeprog.html" target="_blank" rel="noopener">STM32CubeProgrammer</a>. Device need to switched as usb flash mode as well.</p>
<p>After installation, using <strong>STM32_Programmer_CLI</strong> to check if device can be detected:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo STM32_Programmer_CLI -l usb</span><br><span class="line">      -------------------------------------------------------------------</span><br><span class="line">                        STM32CubeProgrammer v2.2.1                  </span><br><span class="line">      -------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">=====  DFU Interface   =====</span><br><span class="line"></span><br><span class="line">Total number of available STM32 device <span class="keyword">in</span> DFU mode: 1</span><br><span class="line"></span><br><span class="line">  Device Index           : USB1</span><br><span class="line">  USB Bus Number         : 001</span><br><span class="line">  USB Address Number     : 004</span><br><span class="line">  Product ID             : DFU <span class="keyword">in</span> HS Mode @Device ID /0x500, @Revision ID /0x0000</span><br><span class="line">  Serial number          : 004800293338511139303435</span><br><span class="line">  Firmware version       : 0x0110</span><br><span class="line">  Device ID              : 0x0500</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notice: You may need to create a soft link from <em>$HOME/STMicroelectronics/STM32Cube/STM32CubeProgrammer/bin/STM32_Programmer_CLI</em></p>
</blockquote>
<p>You also can add an udev rule to allow connection without su:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp <span class="variable">$HOME</span>/STMicroelectronics/STM32Cube/STM32CubeProgrammer/Drivers/rules/50-usb-conf.rules /etc/udev/rules.d/</span><br><span class="line">sudo service udev restart</span><br></pre></td></tr></table></figure>
<p>If device can be found in DFU mode, using blow cmd to trigger usb flash:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">STM32_Programmer_CLI -c port=usb1 -w flashlayout_st-image-weston/FlashLayout_xxxxxx.tsv</span><br></pre></td></tr></table></figure>
<p>STM32CubeProgrammer using a <code>.tsv</code> file to specify flash layout and the binaries are going to use.</p>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>STM32MP1 getting started: create machine</title>
    <url>/2019-11-30/STM32MP1-getting-started-create-machine/</url>
    <content><![CDATA[<p>Brief notes about how to create a customized machine based on STM32MP1.</p>
<a id="more"></a>

<h2 id="Device-tree"><a href="#Device-tree" class="headerlink" title="Device tree"></a>Device tree</h2><p>dts files should be created at the very beginning. There are 3 dts files need to implement:</p>
<ul>
<li>TF-A device tree</li>
<li>U-BOOT device tree</li>
<li>Kernel device tree</li>
</ul>
<h2 id="Machine-layer"><a href="#Machine-layer" class="headerlink" title="Machine layer"></a>Machine layer</h2><p>A custom layer can be created outside of <em>meta-st</em>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── conf</span><br><span class="line">│   ├── eula</span><br><span class="line">│   │   └── stm32mp1-cp</span><br><span class="line">│   ├── layer.conf</span><br><span class="line">│   └── machine</span><br><span class="line">│       └── stm32mp1-cp.conf</span><br><span class="line">├── COPYING.MIT</span><br><span class="line">├── README</span><br><span class="line">├── recipes-bsp</span><br><span class="line">│   ├── trusted-firmware-a</span><br><span class="line">│   │   ├── tf-a-stm32mp</span><br><span class="line">│   │   │   └── 0001-tf-a-alex.patch</span><br><span class="line">│   │   └── tf-a-stm32mp_2.0.bbappend</span><br><span class="line">│   └── u-boot</span><br><span class="line">│       ├── u-boot-stm32mp</span><br><span class="line">│       │   └── 0001-u-boot-alex.patch</span><br><span class="line">│       ├── u-boot-stm32mp_2018.11.bbappend</span><br><span class="line">│       ├── u-boot-stm32mp-extlinux</span><br><span class="line">│       │   └── boot.scr.cmd</span><br><span class="line">│       └── u-boot-stm32mp-extlinux.bb</span><br><span class="line">└── recipes-kernel</span><br><span class="line">    └── linux</span><br><span class="line">        ├── linux-stm32mp</span><br><span class="line">        │   └── stm32mp157a-cp.dts</span><br><span class="line">        └── linux-stm32mp_%.bbappend</span><br></pre></td></tr></table></figure>
<p>Here I use patchs and <em>bbappend</em> to add dts files.</p>
<h2 id="Machine-conf"><a href="#Machine-conf" class="headerlink" title="Machine conf"></a>Machine conf</h2><p>Machine conf can be created based on <strong>stm32mp1-disco.conf</strong>. There are some variables are pre-defined in <strong>st-machine-common-stm32mp.inc</strong> which need to be override in your machine conf.</p>
<h2 id="U-Boot-extlinux"><a href="#U-Boot-extlinux" class="headerlink" title="U-Boot extlinux"></a>U-Boot extlinux</h2><p>There are some u-boot related env variables are set by <strong>UBOOT_EXTLINUX_</strong> started configs in machine conf. In ST U-Boot, there path of <strong>extlinux.conf</strong> are related to <strong>UBOOT_EXTLINUX_BOOTPREFIXES</strong>.</p>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Setting up Gitlab CI (I): docker+gitlab-runner</title>
    <url>/2019-09-28/Setting-up-Gitlab-CI-I-docker-gitlab-runner/</url>
    <content><![CDATA[<p>A brief introduction about how to setup Gitlab CI (part I).</p>
<a id="more"></a>

<p>If you are new to docker, this post might help: <a href="https://lzqblog.top/2018-01-09/Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Click this</a></p>
<h2 id="Install-and-setup-gitlab-runner"><a href="#Install-and-setup-gitlab-runner" class="headerlink" title="Install and setup gitlab runner"></a>Install and setup gitlab runner</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Install gitlab runner docker image</span></span><br><span class="line">docker run -d --name gitlab-runner --restart always \</span><br><span class="line">  -v /srv/gitlab-runner/config:/etc/gitlab-runner \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  gitlab/gitlab-runner:latest</span><br><span class="line"><span class="comment"># Config and register runner</span></span><br><span class="line">docker <span class="built_in">exec</span> -it <span class="variable">$&#123;container_id_of_gitlab-runner&#125;</span> gitlab-runner register</span><br></pre></td></tr></table></figure>

<p>If you have installed gitlab-runner binary, you also can do register by one single command:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo gitlab-runner register \</span><br><span class="line">  --non-interactive \</span><br><span class="line">  --url <span class="string">"https://gitlab.com/"</span> \</span><br><span class="line">  --registration-token <span class="string">"PROJECT_REGISTRATION_TOKEN"</span> \</span><br><span class="line">  --executor <span class="string">"docker"</span> \</span><br><span class="line">  --docker-image alpine:latest \</span><br><span class="line">  --description <span class="string">"description_of_runner"</span> \</span><br><span class="line">  --tag-list <span class="string">"docker,aws"</span> \</span><br><span class="line">  --run-untagged=<span class="string">"true"</span> \</span><br><span class="line">  --locked=<span class="string">"false"</span> \</span><br><span class="line">  --access-level=<span class="string">"not_protected"</span></span><br></pre></td></tr></table></figure>

<h2 id="Prepare-your-docker-image-as-CI-environment"><a href="#Prepare-your-docker-image-as-CI-environment" class="headerlink" title="Prepare your docker image as CI environment"></a>Prepare your docker image as CI environment</h2><p>Docker images can be built from a local <strong>Dockerfile</strong>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker build -t <span class="variable">$&#123;image_name&#125;</span>:<span class="variable">$&#123;version_number&#125;</span> .</span><br></pre></td></tr></table></figure>
<p>There is a “.” at the end, don’t forget it.</p>
<h2 id="Create-local-docker-hub"><a href="#Create-local-docker-hub" class="headerlink" title="Create local docker hub"></a>Create local docker hub</h2><p>Normally you can deploy your image to dockerhub.com. But if you don’t want to open your images to public, you also can create a local docker hub instead:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d -p 5000:5000 --restart=always --name registry registry:2</span><br><span class="line">docker tag <span class="variable">$&#123;image_name&#125;</span>:<span class="variable">$&#123;image_tag&#125;</span> localhost:5000/<span class="variable">$&#123;image_name&#125;</span></span><br><span class="line">docker push localhost:5000/<span class="variable">$&#123;image_name&#125;</span></span><br></pre></td></tr></table></figure>
<p>After that gitlab-runner can “download” your images from <em>localhost:5000/${image_name}</em>. </p>
<p>You also can do a quick check if your image repo exist or not by accessing catalog:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://localhost:5000/v2/_catalog</span><br></pre></td></tr></table></figure>

<p>To be continued…</p>
]]></content>
      <categories>
        <category>CI</category>
      </categories>
      <tags>
        <tag>Continuous Integration</tag>
      </tags>
  </entry>
  <entry>
    <title>SWUpdate bring up (I): Install to Yocto Linux and create single copy image</title>
    <url>/2020-04-05/SWUpdate-bring-up-I-Install-to-Yocto-Linux-and-create-single-copy-image/</url>
    <content><![CDATA[<p><a href="https://github.com/sbabic/meta-swupdate-boards" target="_blank" rel="noopener">SWUpdate</a> is a popular embedded system update framework. I’m trying to bring up a OTA update system on stm32mp1, and this OTA system will base on SWUpdate. This post records steps need to be done to install SWUpdate system into Yocto Linux, and create a single copy image to test it.</p>
<a id="more"></a>

<h2 id="meta-swupdate"><a href="#meta-swupdate" class="headerlink" title="meta-swupdate"></a>meta-swupdate</h2><p><a href="https://github.com/sbabic/meta-swupdate-boards" target="_blank" rel="noopener">SWUpdate</a> was provided to help generate SWUpdate supported images. Clone it to the layers path and add it into <span style="color:red"><strong>conf/bblayers.conf</strong></span>.</p>
<blockquote>
<p>Notes:<br>This layer depends on several recipes in meta-openembedded. i.e. <strong>librsync</strong> and <strong>libubootenv</strong>. For STM32MP distribution, the default meta-openembedded version is too old and those recipes are not included yet. To continue, add those recipes manually or reset meta-openembedded to a newer version.</p>
</blockquote>
<h2 id="Boards-related-configs"><a href="#Boards-related-configs" class="headerlink" title="Boards related configs"></a>Boards related configs</h2><h3 id="SWUpdate-defconfig"><a href="#SWUpdate-defconfig" class="headerlink" title="SWUpdate defconfig"></a>SWUpdate defconfig</h3><p><span style="color:red"><strong>defconfig</strong></span> was required by swupdate.inc. Use menuconfig to create one for your boards as defconfig.</p>
<blockquote>
<p>Notes:<br>If <span style="color:blue">CONFIG_WEBSERVER</span> and <span style="color:blue">CONFIG_MONGOOSE</span> was enabled in menuconfig, target boards will run a mongoose webserver so user can access it through <span style="color:red">&lt;target_ip&gt;:8080</span> by default</p>
</blockquote>
<h3 id="SWUpdate-swupdate-cfg"><a href="#SWUpdate-swupdate-cfg" class="headerlink" title="SWUpdate swupdate.cfg"></a>SWUpdate swupdate.cfg</h3><p><span style="color:red"><strong>swupdate.cfg</strong></span> will be copied to target as swupdate runtime configurations. In <strong>swupdate.cfg</strong> we can set <code>board idendity</code>,<code>public-key</code>,<code>suricatta</code>, <code>webserver</code> and even more:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">globals :</span><br><span class="line">&#123;</span><br><span class="line">	verbose &#x3D; true;</span><br><span class="line">	loglevel &#x3D; 5;</span><br><span class="line">	syslog &#x3D; true;</span><br><span class="line">	no-downgrading &#x3D; &quot;1.0.0&quot;;</span><br><span class="line">	postupdatecmd &#x3D; &quot;reboot&quot;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">download :</span><br><span class="line">&#123;</span><br><span class="line">	retries &#x3D; 3;</span><br><span class="line">	timeout &#x3D; 1800;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">identify : (</span><br><span class="line">	&#123; name &#x3D; &quot;stm32mp157a-cp&quot;; value &#x3D; &quot;1.0&quot;; &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">webserver :</span><br><span class="line">&#123;</span><br><span class="line">	document_root &#x3D; &quot;&#x2F;www&quot;;</span><br><span class="line">	userid		&#x3D; 0;</span><br><span class="line">	groupid		&#x3D; 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="09-swupdate-args"><a href="#09-swupdate-args" class="headerlink" title="09-swupdate-args"></a>09-swupdate-args</h3><p>This file defines extra parameters for swupdate daemon.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">HARDWARE=<span class="string">"stm32mp157a-cp:1.0"</span></span><br><span class="line">CFGFILE=<span class="string">"/etc/swupdate.cfg"</span></span><br><span class="line">SWUPDATE_ARGS=<span class="string">"-H <span class="variable">$&#123;HARDWARE&#125;</span> -f <span class="variable">$&#123;CFGFILE&#125;</span>"</span></span><br></pre></td></tr></table></figure>

<p>Here we specific hardware information thus SWUpdate daemon will check swu image hardware compatibility before updating. If user trying to use swu image without specific hardware compatibility, SWUpdate will refuse to update.</p>
<h3 id="Use-bbappend-to-add-board-related-configs-in"><a href="#Use-bbappend-to-add-board-related-configs-in" class="headerlink" title="Use bbappend to add board related configs in"></a>Use <strong>bbappend</strong> to add board related configs in</h3><p>In boards specific layer, create file <code>swupdate_%.bbappend</code>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FILESEXTRAPATHS_append :&#x3D; &quot;$&#123;THISDIR&#125;&#x2F;$&#123;PN&#125;:&quot;</span><br><span class="line"></span><br><span class="line">PACKAGECONFIG_CONFARGS &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">SRC_URI +&#x3D; &quot; \</span><br><span class="line">    file:&#x2F;&#x2F;swupdate.cfg \</span><br><span class="line">    file:&#x2F;&#x2F;09-swupdate-args \</span><br><span class="line">    &quot;</span><br><span class="line"></span><br><span class="line">do_install_append() &#123;</span><br><span class="line">    install -m 0644 $&#123;WORKDIR&#125;&#x2F;09-swupdate-args $&#123;D&#125;$&#123;libdir&#125;&#x2F;swupdate&#x2F;conf.d&#x2F;</span><br><span class="line"></span><br><span class="line">    install -d $&#123;D&#125;$&#123;sysconfdir&#125;</span><br><span class="line">    install -m 0644 $&#123;WORKDIR&#125;&#x2F;swupdate.cfg $&#123;D&#125;$&#123;sysconfdir&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now we have structure like this in boards specific layer:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">└── swupdate</span><br><span class="line">    ├── swupdate</span><br><span class="line">    │   ├── 09-swupdate-args</span><br><span class="line">    │   ├── defconfig</span><br><span class="line">    │   └── swupdate.cfg</span><br><span class="line">    └── swupdate_%.bbappend</span><br></pre></td></tr></table></figure>

<h2 id="Install-to-image"><a href="#Install-to-image" class="headerlink" title="Install to image"></a>Install to image</h2><p>Then we need to add <code>swupdate</code>, <code>swupdate-www</code> and <code>libubootenv-bin</code> into image.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IMAGE_INSTALL_append &#x3D; &quot; swupdate swupdate-www libubootenv-bin&quot;</span><br></pre></td></tr></table></figure>

<p>Flash the built image to target, make sure PC and target board are in same LAN, then we can access <span style="color:red">&lt;target_ip&gt;:8080</span> :</p>
<p><img src="/2020-04-05/SWUpdate-bring-up-I-Install-to-Yocto-Linux-and-create-single-copy-image/webserver.png" alt></p>
<h2 id="Create-a-single-copy-update-image-for-test"><a href="#Create-a-single-copy-update-image-for-test" class="headerlink" title="Create a single copy update image for test"></a>Create a single copy update image for test</h2><p>Now it’s time to create a swu image to test SWUpdate system.</p>
<h3 id="sw-description"><a href="#sw-description" class="headerlink" title="sw-description"></a>sw-description</h3><p><span style="color:red"><strong>sw-description</strong></span> defines the compatibility and usage of <code>swu</code> images. Here we defined a single copy update image, which is compatible with boards <code>stm32mp157a-cp</code> and will update target rootfs:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">software &#x3D;</span><br><span class="line">&#123;</span><br><span class="line">	version &#x3D; &quot;1.0.0&quot;;</span><br><span class="line"></span><br><span class="line">	stm32mp157a-cp &#x3D; &#123;</span><br><span class="line">		hardware-compatibility: [ &quot;1.0&quot; ];</span><br><span class="line">		images: (</span><br><span class="line">			&#123;</span><br><span class="line">				filename &#x3D; &quot;cp-image-core-openstlinux-eglfs-stm32mp1-cp.ext4.gz&quot;;</span><br><span class="line">				type &#x3D; &quot;raw&quot;;</span><br><span class="line">				sha256 &#x3D; &quot;@cp-image-core-openstlinux-eglfs-stm32mp1-cp.ext4.gz&quot;;</span><br><span class="line">				installed-directly &#x3D; true;</span><br><span class="line">				compressed &#x3D; true;</span><br><span class="line">				device &#x3D; &quot;&#x2F;dev&#x2F;mmcblk0p6&quot;;</span><br><span class="line">			&#125;</span><br><span class="line">		);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Recipe-for-update-image"><a href="#Recipe-for-update-image" class="headerlink" title="Recipe for update image"></a>Recipe for update image</h3><p>To generate a <code>swu</code> file from bitbake, we need to create a recipe for update image. In my scenario it was named as <strong>cp-image-update.bb</strong> :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">DESCRIPTION &#x3D; &quot;SWUpdate compound image&quot;</span><br><span class="line"></span><br><span class="line">LICENSE &#x3D; &quot;MIT&quot;</span><br><span class="line">LIC_FILES_CHKSUM &#x3D; &quot;file:&#x2F;&#x2F;$&#123;COMMON_LICENSE_DIR&#125;&#x2F;MIT;md5&#x3D;0835ade698e0bcf8506ecda2f7b4f302&quot;</span><br><span class="line"></span><br><span class="line">inherit swupdate</span><br><span class="line"></span><br><span class="line">SRC_URI &#x3D; &quot; \</span><br><span class="line">    file:&#x2F;&#x2F;sw-description \</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line"># images to build before building swupdate image</span><br><span class="line">IMAGE_DEPENDS &#x3D; &quot;cp-image-core&quot;</span><br><span class="line"></span><br><span class="line"># images and files that will be included in the .swu image</span><br><span class="line">SWUPDATE_IMAGES &#x3D; &quot;cp-image-core-openstlinux-eglfs-stm32mp1-cp&quot;</span><br><span class="line"></span><br><span class="line">SWUPDATE_IMAGES_FSTYPES[cp-image-core-openstlinux-eglfs-stm32mp1-cp] &#x3D; &quot;.ext4.gz&quot;</span><br></pre></td></tr></table></figure>

<p>Now we have structure like this in boards specific layer:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── images</span><br><span class="line">│   ├── cp-image-update</span><br><span class="line">│   │   └── sw-description</span><br><span class="line">│   └── cp-image-update.bb</span><br></pre></td></tr></table></figure>

<p>To generate <code>swu</code> image, call <code>bitbake cp-image-update</code>.</p>
<h3 id="Generate-update-image-without-image-recipe"><a href="#Generate-update-image-without-image-recipe" class="headerlink" title="Generate update image without image recipe"></a>Generate update image without image recipe</h3><p>Sometimes we want to generate a <code>swu</code> image for test purpose, in this scenario we can skip <code>bitbake</code> and use a simple shell script to generate <code>swu</code> image quickly:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">CONTAINER_VER=<span class="string">"1.0"</span></span><br><span class="line">PRODUCT_NAME=<span class="string">"stm32mp157-cp"</span></span><br><span class="line">FILES=<span class="string">"sw-description cp-image-core-openstlinux-eglfs-stm32mp1-cp.ext4.gz"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$FILES</span>;<span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$i</span>;<span class="keyword">done</span> | cpio -ov -H crc &gt;  <span class="variable">$&#123;PRODUCT_NAME&#125;</span>_<span class="variable">$&#123;CONTAINER_VER&#125;</span>.swu</span><br></pre></td></tr></table></figure>

<h3 id="Quick-check-structure-of-generated-swu-image"><a href="#Quick-check-structure-of-generated-swu-image" class="headerlink" title="Quick check structure of generated swu image"></a>Quick check structure of generated swu image</h3><p>Since swu image was cpio based, we can use <code>cat</code> to check structure of it:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cat cp-image-update-openstlinux-eglfs-stm32mp1-cp.swu | cpio -it</span><br><span class="line">sw-description</span><br><span class="line">cp-image-core-openstlinux-eglfs-stm32mp1-cp.ext4.gz</span><br><span class="line">88360 blocks</span><br></pre></td></tr></table></figure>

<h2 id="Test-with-generated-swu-image-on-target"><a href="#Test-with-generated-swu-image-on-target" class="headerlink" title="Test with generated swu image on target"></a>Test with generated swu image on target</h2><h3 id="Use-web-interface"><a href="#Use-web-interface" class="headerlink" title="Use web interface"></a>Use web interface</h3><p>We can trigger update easily by uploading <code>swu</code> image through webserver:</p>
<p><img src="/2020-04-05/SWUpdate-bring-up-I-Install-to-Yocto-Linux-and-create-single-copy-image/uploading.png" alt></p>
<p>We defined     <code>postupdatecmd = &quot;reboot&quot;;</code> in <span style="color:red"><strong>swupdate.cfg</strong></span>, so system will automatically reboot:</p>
<p><img src="/2020-04-05/SWUpdate-bring-up-I-Install-to-Yocto-Linux-and-create-single-copy-image/reboot.png" alt></p>
<h3 id="Use-command-line-interface"><a href="#Use-command-line-interface" class="headerlink" title="Use command line interface"></a>Use command line interface</h3><p>We also can use command line to trigger update if we have an usb drive which contains <strong>swu</strong> image and has connected to target:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">swupdate -i &#x2F;media&#x2F;cp-image-update-openstlinux-eglfs-stm32mp1-cp.swu -H stm32mp157a-cp:1.0</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Travis CI: Android Build Errors</title>
    <url>/2020-08-17/Travis-CI-Android-Build-Errors/</url>
    <content><![CDATA[<p>This post records some errors I have met during set up an Android build pipeline with Travis CI.</p>
<a id="more"></a>

<h2 id="Failed-to-install-the-following-Android-SDK-packages-as-some-licences-have-not-been-accepted"><a href="#Failed-to-install-the-following-Android-SDK-packages-as-some-licences-have-not-been-accepted" class="headerlink" title="Failed to install the following Android SDK packages as some licences have not been accepted."></a>Failed to install the following Android SDK packages as some licences have not been accepted.</h2><p>Error message:</p>
<p>Failed to install the following Android SDK packages as some licences have not been accepted.<br>     platforms;android-29 Android SDK Platform 29<br>  To build this project, accept the SDK license agreements and install the missing components using the Android Studio SDK Manager.</p>
<p>Fix:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">before_install:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="literal">yes</span> <span class="string">|</span> <span class="string">sdkmanager</span> <span class="string">"platforms;android-29"</span></span><br></pre></td></tr></table></figure>

<h2 id="Lint-found-errors-in-the-project-aborting-build"><a href="#Lint-found-errors-in-the-project-aborting-build" class="headerlink" title="Lint found errors in the project; aborting build."></a>Lint found errors in the project; aborting build.</h2><p>Error message:</p>
<p>Execution failed for task ‘:app:lint’.<br><br>&gt; Lint found errors in the project; aborting build.</p>
<p>Quick Fix:</p>
<p>Add following code into <em>app/build.gradle</em> to disable abort when lint error:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">lintOptions &#123;</span><br><span class="line">    abortOnError false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Suggested Fix:</p>
<p>Run <code>./gradlew lint</code> to generate lint report and fix those errors. You can find it under <em>/app/build/outputs/lint-results-debug.html</em>. You also can run <code>./gradlew lintDebug</code> or <code>./gradlew lintRelease</code> to run lint for debug or release version specifically.</p>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Continuous Integration</tag>
      </tags>
  </entry>
  <entry>
    <title>Setting up Gitlab CI (II): pipeline and .gitlab-ci.yml</title>
    <url>/2019-10-19/Setting-up-Gitlab-CI-II-pipeline-and-gitlab-ci-yml/</url>
    <content><![CDATA[<p>A brief introduction about how to setup Gitlab CI (part II).</p>
<a id="more"></a>

<p>In <a href="https://lzqblog.top/2019-09-28/Setting-up-Gitlab-CI-I-docker-gitlab-runner/">Setting up Gitlab CI (I): docker+gitlab-runner</a> we already created a docker image for gitlab-runner, which will be our CI environment. Next step is define the behaviors of your CI processes.</p>
<h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><p><a href="https://docs.gitlab.com/ee/ci/pipelines.html" target="_blank" rel="noopener">Creating and using CI/CD pipelines</a>:</p>
<blockquote>
<p> Pipelines are the top-level component of continuous integration, delivery, and deployment.</p>
</blockquote>
<p>If <strong>.gitlab-ci.yml</strong> has been set up correctly, you could see pipeline flow under <em>CI/CD-&gt;Pipelines</em>. </p>
<h2 id="gitlab-ci-yml"><a href="#gitlab-ci-yml" class="headerlink" title=".gitlab-ci.yml"></a>.gitlab-ci.yml</h2><p>If CI was enabled in your gitlab projects, gitlab-runner will try to find a file named <strong>.gitlab-ci.yml</strong> in your repository root. This file will tell gitlab-runner what should be done during CI process. </p>
<h3 id="image-variables"><a href="#image-variables" class="headerlink" title="image, variables"></a>image, variables</h3><p>You need to specify the docker image and environment variables gitlab-runner are going to use at very beginning:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">image:</span> <span class="string">localhost:5000/$&#123;name_of_your_image&#125;</span></span><br><span class="line"><span class="attr">variables:</span></span><br><span class="line">  <span class="attr">SDK_VERSION:</span> <span class="number">1.2</span><span class="number">.3</span></span><br></pre></td></tr></table></figure>
<p>In our case we use the image from local docker hub.</p>
<h3 id="stages-jobs-and-script"><a href="#stages-jobs-and-script" class="headerlink" title="stages, jobs and script"></a>stages, jobs and script</h3><p>In normal cases, our pipeline should have 3 stages roughly:</p>
<ul>
<li>build</li>
<li>test</li>
<li>deploy</li>
</ul>
<p>Stages can be split into several jobs like:</p>
<ul>
<li>code/commit style check</li>
<li>downloading build dependencies</li>
<li>build code</li>
<li>run unit test</li>
<li>run integration testing</li>
<li>deploy</li>
</ul>
<p>In <strong>.gitlab-ci.yml</strong>, job can be defined as:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">job_name:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">uname</span> <span class="string">-a</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">"hello"</span></span><br></pre></td></tr></table></figure>
<p><strong>script</strong> defines shell scripts which will be executed by gitlab-runner.</p>
<p>Each job must have a unique name, but there are some reserved keywords can’t be used as job name:</p>
<ul>
<li>image</li>
<li>services</li>
<li>stages</li>
<li>types</li>
<li>before_script</li>
<li>after_script</li>
<li>variables</li>
<li>cache</li>
</ul>
<p>Job name also can start with a dot(<strong>.</strong>) like <em>.job</em>. If a job name started with a dot, it will be ignored by gitlab CI(gitlab-runner will skip it).</p>
<h3 id="More"><a href="#More" class="headerlink" title="More"></a>More</h3><p>There are a lot of features can be defined in <strong>.gitlab-ci.yml</strong>. Go to <a href="https://docs.gitlab.com/ee/ci/yaml/README.html" target="_blank" rel="noopener">GitLab CI/CD Pipeline Configuration Reference</a> for more details.</p>
]]></content>
      <categories>
        <category>CI</category>
      </categories>
      <tags>
        <tag>Continuous Integration</tag>
      </tags>
  </entry>
  <entry>
    <title>Under Maintenance</title>
    <url>/2019-12-13/Under-Maintenance/</url>
    <content><![CDATA[<p>Website is currently under maintenance since some new features I have enabled recently might cause some performance issues(i.e. loading too slow)…</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>Use ffmpeg to make kazam recorded mp4 available for Android devices</title>
    <url>/2020-06-13/Use-ffmpeg-to-make-kazam-recorded-mp4-available-for-Android-devices/</url>
    <content><![CDATA[<p><strong>kazam</strong> is an easy to use screen record tool for Linux. User can install it via <code>apt install kazam</code> on Debian based distribution. After recording, <strong>kazam</strong> supports to save as mp4 files, which are 4:4:4 by default. To make it available for typical player on other platform, we can covert it to 4:2:0:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ffmpeg -i <span class="variable">$&#123;original.mp4&#125;</span> -vf format=yuv420p <span class="variable">$&#123;new.mp4&#125;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>Webserver bring up (I): Install lighttpd and fastcgi++</title>
    <url>/2019-06-20/Webserver-bring-up-I-Install-lighttpd-and-fastcgi/</url>
    <content><![CDATA[<p>Webserver bring up(I): Install lighttpd and fastcgi++</p>
<a id="more"></a>

<h1 id="Install-Lighttpd"><a href="#Install-Lighttpd" class="headerlink" title="Install Lighttpd"></a>Install Lighttpd</h1><p><a href="https://www.lighttpd.net/" target="_blank" rel="noopener">Lighttpd</a> is a popular high performance webserver.</p>
<p>If you are using Debian based distributions, you can directly install it by apt install:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install lighttpd</span><br></pre></td></tr></table></figure>

<p>If you are using Yocto, you also can install it easily because poky already provided recipe for it. you can find it at <em>poky/meta/recipes-extended/lighttpd/</em>. </p>
<p>The default installed version(no matter PC or Yocto) only provides basic functions, fastcgi is not included. To enable support for fastcgi you need to :</p>
<ol>
<li>Modify file <strong>lighttpd.conf</strong>(On PC path is /etc/lighttpd/lighttpd.conf) to add <strong>mod_fcgi</strong> into <strong>server.modules</strong>. </li>
<li>If you are using Yocto, you also need to add <strong>lighttpd-module-fastcgi</strong> to <strong>IMAGE_INSTALL_append</strong> or declare dependencies of module fastcgi in your recipes:<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IMAGE_INSTALL_append +&#x3D; &quot;lighttpd-module-fastcgi&quot;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h1 id="Install-fastcgi"><a href="#Install-fastcgi" class="headerlink" title="Install fastcgi++"></a>Install fastcgi++</h1><p><a href="https://fastcgipp.isatec.ca" target="_blank" rel="noopener">fastcgi++(fastcgipp)</a> is a C++ FastCGI and Web development platform. I choose this library because it provides support for C++14 and the official site of <a href="http://www.fastcgi.com/" target="_blank" rel="noopener">fastcgi</a> which provides C/C++ libraries before has been closed for several years.  </p>
<p>Seems there is no yocto recipe for fastcgi++ on internet, but it’s easy to write a recipe by myself because it supports built by cmake. Here comes my recipe for fastcgi++:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SUMMARY &#x3D; &quot;fastcgi++&quot;</span><br><span class="line">DESCRIPTION &#x3D; &quot;C++ FastCGI and Web development platform&quot;</span><br><span class="line">SECTION &#x3D; &quot;libs&quot;</span><br><span class="line">LICENSE &#x3D; &quot;GPL-2.0&quot;</span><br><span class="line">AUTHOR &#x3D; &quot;Alex.Don.Scofield(codingspirit)&quot;</span><br><span class="line">LIC_FILES_CHKSUM &#x3D; &quot;file:&#x2F;&#x2F;$&#123;COMMON_LICENSE_DIR&#125;&#x2F;GPL-2.0;md5&#x3D;801f80980d171dd6425610833a22dbe6&quot;</span><br><span class="line"></span><br><span class="line">$&#123;PN&#125;_REPO &#x3D; &quot;github.com&#x2F;eddic&#x2F;fastcgipp.git&quot;</span><br><span class="line">SRCREV_$&#123;PN&#125; &#x3D; &quot;5a5c3a263595a1792b2867188770bcf4f4df8b83&quot;</span><br><span class="line"></span><br><span class="line">TARGET_CC_ARCH +&#x3D; &quot;$&#123;LDFLAGS&#125;&quot;</span><br><span class="line"></span><br><span class="line">SRC_URI &#x3D; &quot; \</span><br><span class="line">  git:&#x2F;&#x2F;$&#123;$&#123;PN&#125;_REPO&#125;;name&#x3D;$&#123;PN&#125;;protocol&#x3D;https;nobranch&#x3D;1;destsuffix&#x3D;git&#x2F;$&#123;PN&#125; \</span><br><span class="line">  &quot;</span><br><span class="line"></span><br><span class="line">S &#x3D; &quot;$&#123;WORKDIR&#125;&#x2F;git&#x2F;$&#123;PN&#125;&quot;</span><br><span class="line">B &#x3D; &quot;$&#123;WORKDIR&#125;&#x2F;$&#123;BPN&#125;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EXTRA_OECMAKE &#x3D; &quot;-DCMAKE_BUILD_TYPE&#x3D;RELEASE&quot;</span><br><span class="line">inherit cmake</span><br></pre></td></tr></table></figure>

<p>BTW to pass cmake runtime parameters in Yocto, we can use <strong>EXTRA_OECMAKE</strong> :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">EXTRA_OECMAKE +&#x3D; &quot;-DBUILD_SAMPLE&#x3D;ON&quot;</span><br><span class="line">inherit cmake</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu切换python版本</title>
    <url>/2018-04-02/Ubuntu%E5%88%87%E6%8D%A2python%E7%89%88%E6%9C%AC/</url>
    <content><![CDATA[<p>  Ubuntu17.10默认的python version是2.7，如果安装了3.6默认的执行版本仍是2.7。如果想要切换python version，可以通过选择alternatives的方式切换版本。</p>
<a id="more"></a>

<h2 id="检查当前安装的python版本"><a href="#检查当前安装的python版本" class="headerlink" title="检查当前安装的python版本"></a>检查当前安装的python版本</h2><p>  之前遇到一个奇怪的现象，Ubuntu突然不能使用python –version检查版本:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">The program <span class="string">'python'</span> can be found <span class="keyword">in</span> the following packages:</span><br><span class="line"> * python-minimal</span><br><span class="line"> * python3</span><br><span class="line">Try: apt install &lt;selected package&gt;</span><br></pre></td></tr></table></figure>
<p>使用sudo apt install python3后依然出现上述问题。解决办法：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo apt install python-minimal</span><br></pre></td></tr></table></figure>
<p>之后可以使用python –version得到目前系统默认的版本为2.7.14.</p>
<h2 id="切换python版本"><a href="#切换python版本" class="headerlink" title="切换python版本"></a>切换python版本</h2><p>首先使用下面的命令检查当前是否为python设置了alternatives：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">update-alternatives --list python</span><br></pre></td></tr></table></figure>
<p>如果输出:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">update-alternatives: error: no alternatives <span class="keyword">for</span> python</span><br></pre></td></tr></table></figure>
<p>则需要手动添加alternatives。如果我们要切换版本到python3.x，首先我们要使用whereis得到python3的安装位置：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">whereis python3</span><br></pre></td></tr></table></figure>
<p>从输出可以看到，当前安装了多个版本的python3，安装位置都在/usr/bin/python3.x：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">python3: /usr/bin/python3.6m /usr/bin/python3 /usr/bin/python3.6 /usr/lib/python3.7 /usr/lib/python3 /usr/lib/python3.6 /etc/python3 /etc/python3.6 /usr/<span class="built_in">local</span>/lib/python3.6 /usr/include/python3.6m /usr/share/python3 /usr/share/man/man1/python3.1.gz</span><br></pre></td></tr></table></figure>
<p>在知道python安装位置后就可以添加alternatives,以python3.6为例：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2</span><br><span class="line"><span class="comment">#the last "2" stand for priority level</span></span><br></pre></td></tr></table></figure>
<p>其中最后的”2”表示优先级为2。同理，我们也可以把其他版本的python加入alternatives:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1</span><br></pre></td></tr></table></figure>
<p>现在使用update-alternatives –config python就可以看到当前python所有的alternatives并进行版本切换：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">There are 2 choices <span class="keyword">for</span> the alternative python (providing /usr/bin/python).</span><br><span class="line"></span><br><span class="line">  Selection    Path                Priority   Status</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">  0            /usr/bin/python3.6   2         auto mode</span><br><span class="line">* 1            /usr/bin/python2.7   1         manual mode</span><br><span class="line">  2            /usr/bin/python3.6   2         manual mode</span><br><span class="line"></span><br><span class="line">Press &lt;enter&gt; to keep the current choice[*], or <span class="built_in">type</span> selection number:</span><br></pre></td></tr></table></figure>
<p>输入Selection number就可以切换版本啦！</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Webserver bring up (II): Create a demo page(html+fcgi)</title>
    <url>/2019-06-28/Webserver-bring-up-II-Create-a-demo-page-html-fcgi/</url>
    <content><![CDATA[<p>In last post we have installed lighttpd and fastcgi++, it’s create a demo page to have a quick verification.</p>
<a id="more"></a>


<h2 id="A-simple-html"><a href="#A-simple-html" class="headerlink" title="A simple html"></a>A simple html</h2><p>Let’s write a simple html for demo:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">'utf-8'</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"icon"</span> <span class="attr">href</span>=<span class="string">"/img/favicon.ico"</span> <span class="attr">type</span>=<span class="string">"img/x-ico"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Alex Demo page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">background</span>=<span class="string">"/img/back.jpg"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">" background-repeat:no-repeat ;background-size:100% 100%;background-attachment: fixed;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">style</span>=<span class="string">"margin-top: 25%"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"diag"</span> <span class="attr">action</span>=<span class="string">"/cpp_get.fcgi"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">style</span>=<span class="string">"background-color:dimgrey"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">align</span>=<span class="string">"right"</span> <span class="attr">valign</span>=<span class="string">"middle"</span>&gt;</span></span><br><span class="line">                        Product Name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">" text"</span> <span class="attr">name</span>=<span class="string">"product_name"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">                        Product ID:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"product_id"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>This page will show a picture as page background, meanwhile a from will be created for testing GET method. The path we are using in html is relative path, i.e. if you put your pages to <em>/var/www/pages/test.html</em>, the absolute path of back.jpg will be <em>/var/www/pages/img/back.jpg</em> and the relative path will be <em>/img/back.jpg</em>.</p>
<p>Beware of access rights of those files/directories, the user and user group of lighttpd was configured in <strong>lighttpd.conf</strong> by <strong>server.username</strong> and <strong>server.groupname</strong>. Make sure lighttpd can access them.</p>
<h2 id="Write-a-simple-fgci-backend"><a href="#Write-a-simple-fgci-backend" class="headerlink" title="Write a simple fgci backend"></a>Write a simple fgci backend</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fcgi_get.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fastcgi++/request.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetTest</span> :</span> <span class="keyword">public</span> Fastcgipp::Request&lt;<span class="keyword">wchar_t</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">response</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">std</span>::<span class="function">wofstream <span class="title">outPutFile</span><span class="params">(<span class="string">"output.patch"</span>, <span class="built_in">std</span>::ios_base::out | <span class="built_in">std</span>::ios_base::binary)</span></span>;</span><br><span class="line">        <span class="comment">//! [Response definition]</span></span><br><span class="line">        <span class="comment">//! [HTTP header]</span></span><br><span class="line">        out &lt;&lt; <span class="string">L"Content-Type: text/html; charset=utf-8\r\n\r\n"</span>;</span><br><span class="line">        <span class="comment">//! [HTTP header]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//! [Output]</span></span><br><span class="line">        out &lt;&lt; <span class="string">L"&lt;!DOCTYPE html&gt;\n"</span></span><br><span class="line">               <span class="string">L"&lt;html&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;head&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;meta charset='utf-8' /&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;title&gt;Success&lt;/title&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;/head&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;body&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;p&gt;"</span>;</span><br><span class="line">        <span class="keyword">using</span> Fastcgipp::Encoding;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!environment().gets.empty())</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;get : environment().gets)</span><br><span class="line">            &#123;</span><br><span class="line">                out &lt;&lt; <span class="string">L"&lt;b&gt;"</span> &lt;&lt; Encoding::HTML &lt;&lt; get.first &lt;&lt; Encoding::NONE</span><br><span class="line">                    &lt;&lt; <span class="string">L":&lt;/b&gt; "</span> &lt;&lt; Encoding::HTML &lt;&lt; get.second</span><br><span class="line">                    &lt;&lt; Encoding::NONE &lt;&lt; <span class="string">L"&lt;br /&gt;"</span>;</span><br><span class="line">                outPutFile &lt;&lt; get.first &lt;&lt; <span class="string">":"</span> &lt;&lt; get.second;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        out &lt;&lt; <span class="string">L"&lt;/p&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;/body&gt;"</span></span><br><span class="line">               <span class="string">L"&lt;/html&gt;"</span>;</span><br><span class="line">        <span class="comment">//! [Output]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//! [Return]</span></span><br><span class="line">        outPutFile &lt;&lt; <span class="string">"FFF"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        outPutFile.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fastcgi++/manager.hpp&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Fastcgipp::Manager&lt;GetTest&gt; manager;</span><br><span class="line">    <span class="comment">//! [Manager]</span></span><br><span class="line">    <span class="comment">//! [Signals]</span></span><br><span class="line">    manager.setupSignals();</span><br><span class="line">    <span class="comment">//! [Signals]</span></span><br><span class="line">    <span class="comment">//! [Listen]</span></span><br><span class="line">    manager.listen();</span><br><span class="line">    <span class="comment">//! [Listen]</span></span><br><span class="line">    <span class="comment">//! [Start]</span></span><br><span class="line">    manager.start();</span><br><span class="line">    <span class="comment">//! [Start]</span></span><br><span class="line">    <span class="comment">//! [Join]</span></span><br><span class="line">    manager.join();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Use <em>environment().gets</em> to get all data passed by frontend through GET method.</p>
<h2 id="Compile-your-fcgi"><a href="#Compile-your-fcgi" class="headerlink" title="Compile your fcgi"></a>Compile your fcgi</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">g++ fcgi_get.cpp -lfastcgipp -o cpp_get.fcgi</span><br></pre></td></tr></table></figure>

<p>Then copy it to <em>/var/www/fcgi-bin/cpp_get.fcgi</em>. Don’t forget add rights of execution for this fcgi file.</p>
<h2 id="Add-your-fcgi-into-lighttpd-conf"><a href="#Add-your-fcgi-into-lighttpd-conf" class="headerlink" title="Add your fcgi into lighttpd conf"></a>Add your fcgi into lighttpd conf</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;&#x2F;cpp_get.fcgi&quot; &#x3D;&gt; (</span><br><span class="line">  &quot;cpp_get.fastcgi.handler&quot; &#x3D;&gt; (</span><br><span class="line">    &quot;socket&quot; &#x3D;&gt; &quot;&#x2F;var&#x2F;run&#x2F;lighttpd&#x2F;lighttpd-cpp_get-&quot; + PID + &quot;.socket&quot;,,</span><br><span class="line">    &quot;check-local&quot; &#x3D;&gt; &quot;disable&quot;,</span><br><span class="line">    &quot;bin-path&quot; &#x3D;&gt; &quot;&#x2F;var&#x2F;www&#x2F;fcgi-bin&#x2F;cpp_get.fcgi&quot;,</span><br><span class="line">    &quot;max-procs&quot; &#x3D;&gt; 30,</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>This configuration allows you execute your fcgi by access localhost/cpp_get.fcgi.</p>
<h2 id="Apply-changes"><a href="#Apply-changes" class="headerlink" title="Apply changes"></a>Apply changes</h2><p>If lighttpd is already started on your device, you might need to restart lighttpd services to apply changes: </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service lighttpd force-reload</span><br></pre></td></tr></table></figure>

<h2 id="Verification"><a href="#Verification" class="headerlink" title="Verification"></a>Verification</h2><p>Open <em><a href="http://localhost/test.html" target="_blank" rel="noopener">http://localhost/test.html</a></em>, input something in the form then click “提交”, if everything is ok, browser will jump to <em><a href="http://localhost/cpp_get.fcgi" target="_blank" rel="noopener">http://localhost/cpp_get.fcgi</a></em> and show what you have inputted. Meanwhile a file called <em>output.patch</em> will be generated at your page folder which contains the text you inputted as well.</p>
<p>Tips: If error occurred, you can find the path of error log by checking the value of <strong>server.errorlog</strong> in your <strong>lighttpd.conf</strong>.</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>Welcome</title>
    <url>/2017-10-31/Welcome/</url>
    <content><![CDATA[<h3 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h3><center>
<img src="/assets/img/coding_spirit.jpg" width="50%" height="50%">
</center>
这是一个用node.js+hexo+github搭建起来的小站。好记性不如烂键盘，以后多多写blog咯！]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto: Configure kernel with config fragments</title>
    <url>/2019-08-24/Yocto-Configure-kernel-with-config-fragments/</url>
    <content><![CDATA[<p>From my point of view it will be better to use config fragments to configure kernel instead of directly modifying <em>.config</em> file, the former way will be much easier to disable changes when you want to roll back.</p>
<a id="more"></a>

<h2 id="Using-menuconfig-to-get-the-new-config-file-you-want"><a href="#Using-menuconfig-to-get-the-new-config-file-you-want" class="headerlink" title="Using menuconfig to get the new .config file you want"></a>Using menuconfig to get the new .config file you want</h2><p>Taking raspberrypi as an example. Replace <em>linux-raspberrypi</em> to your kernel recipe name. i.e. change it to linux-imx if you are using NXP i.MX SoC. Same modification need to be applied for following steps.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitbake linux-raspberrypi -c menuconfig</span><br></pre></td></tr></table></figure>

<h2 id="Get-differences"><a href="#Get-differences" class="headerlink" title="Get differences"></a>Get differences</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitbake linux-raspberrypi -c diffconfig</span><br></pre></td></tr></table></figure>

<p>Save the generated <em>.cfg</em> fragments file. We gonna use it in next step.</p>
<p>If you can make sure about which <em>CONFIG_XXXX</em> need to be changed, you can write fragments file by yourself as well.</p>
<h2 id="Using-bbappend-to-apply-fragments"><a href="#Using-bbappend-to-apply-fragments" class="headerlink" title="Using bbappend to apply fragments"></a>Using bbappend to apply fragments</h2><p>Yocto provides bbappend for developers to modify constructing steps without modifying the original recipes, and that’s how we apply fragments.</p>
<p>Assuming that you already have a yocto layer works properly, then create recipes with this structure:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">recipes-kernel/</span><br><span class="line">└── linux</span><br><span class="line">    ├── linux-raspberrypi</span><br><span class="line">    │   └── enable_adb-cp.cfg</span><br><span class="line">    └── linux-raspberrypi_%.bbappend</span><br></pre></td></tr></table></figure>

<p>Name of bbappend file should be same as your kernel recipe, here we use wildcard <em>%</em> to make sure bbappend can be applied to any version of linux-raspberrypi recipes.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">FILESEXTRAPATHS_prepend:&#x3D;&quot;$&#123;THISDIR&#125;&#x2F;$&#123;PN&#125;:&quot;</span><br><span class="line"></span><br><span class="line"># Enable adb</span><br><span class="line">SRC_URI_append +&#x3D; &quot;file:&#x2F;&#x2F;enable_adb-cp.cfg&quot;</span><br><span class="line"></span><br><span class="line">do_configure_append() &#123;</span><br><span class="line">    $&#123;S&#125;&#x2F;scripts&#x2F;kconfig&#x2F;merge_config.sh -m -O $&#123;B&#125; $&#123;B&#125;&#x2F;.config $&#123;WORKDIR&#125;&#x2F;*-cp.cfg</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see the path we put <strong>*.cfg</strong> files will not be include by default, so using <strong>FILESEXTRAPATHS_prepend</strong> to specify searching path is required. Then we will add step when do_configure, which will call <strong>merge_config.sh</strong> tool provided by kernel source to automatically merge fragments into kernel config file.</p>
<p>The funny part is I found that I made a mistake when I trying to enable usb adbd on raspberry pi 3: raspberry pi 3 can’t be used as gadget mode because of hardware limitations. But at least I verified the way to apply fragments works.-_-.</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto QA Issue: Files/directories were installed but not shipped in any package</title>
    <url>/2019-05-02/Yocto-QA-Issue-Files-directories-were-installed-but-not-shipped-in-any-package/</url>
    <content><![CDATA[<p>Yocto has much more strict rules than buildroot, one more QA Issue I met today is when I trying to install some regular files into rootfs by cmake <strong>install</strong>.</p>
<a id="more"></a>
<h2 id="Root-cause"><a href="#Root-cause" class="headerlink" title="Root cause"></a>Root cause</h2><p>Yocto/bitbake need to record every file you trying to install into rootfs, so it can easily remove those files when you trying to remove a package. Special case is When you trying to install <strong>TARGET</strong> by cmake like this:</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">install</span>(TARGETS <span class="variable">$&#123;PROJECT_NAME&#125;</span> DESTINATION bin)</span><br></pre></td></tr></table></figure>
<p>Yocto will automatically record <strong>TARGET</strong> in this case if your <strong>inherit cmake</strong> recipe even you didn’t declare it in recipe explicitly. However, if we trying to install some regular files(like some setting files,scripts etc.) by <strong>install(FILES</strong> or <strong>install(DIRECTORY</strong>, yocto will require us to declare those files explicitly.</p>
<h2 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h2><p>Declare those files in recipe:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FILES_$&#123;PN&#125; +&#x3D; &quot;&#x2F;test&#x2F;*&quot;</span><br><span class="line"># Change &quot;&#x2F;test&#x2F;*&quot; to where your regular file installed</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto QA Issue: -dev package contains non-symlink .so</title>
    <url>/2019-04-29/Yocto-QA-Issue-dev-package-contains-non-symlink-so/</url>
    <content><![CDATA[<p>Last week I met an issue when I trying to include a shared lib(built by cmake) written by me into Yocto project, which has already been verified in buildroot.<br>The root cause is recipe trying to directly install a *.so lib into target filesystem, which doesn’t meet Yocto QA request. Lib should be installed with version number(i.e. libabc.so.0.0.3), then use a soft link(i.e. libabc.so) link to it.</p>
<a id="more"></a>

<h2 id="Quick-fix"><a href="#Quick-fix" class="headerlink" title="Quick fix"></a>Quick fix</h2><h3 id="If-your-lib-is-using-cmake"><a href="#If-your-lib-is-using-cmake" class="headerlink" title="If your lib is using cmake"></a>If your lib is using cmake</h3><p>Add below line to add lib version information in cmake:</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set_target_properties</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PROPERTIES VERSION <span class="number">0.0</span>.<span class="number">3</span> SOVERSION <span class="number">0.0</span>.<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>A better way:</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span>_VERSION <span class="string">"0.0.3"</span>)</span><br><span class="line"><span class="keyword">set_target_properties</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PROPERTIES VERSION <span class="variable">$&#123;$&#123;PROJECT_NAME&#125;</span>_VERSION&#125; SOVERSION <span class="variable">$&#123;$&#123;PROJECT_NAME&#125;</span>_VERSION&#125;)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">"Version: $&#123;$&#123;PROJECT_NAME&#125;_VERSION&#125;"</span>)</span><br></pre></td></tr></table></figure>

<p>After that, when you build it with bitbake, version number will be added to extension automatically, a soft link we mentioned will be created as well.</p>
<h3 id="Force-Yocto-ignore-this-warning"><a href="#Force-Yocto-ignore-this-warning" class="headerlink" title="Force Yocto ignore this warning"></a>Force Yocto ignore this warning</h3><p>It’s not recommended but you can add below line into your lib recipe to force Yocto ignore this issue:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INSANE_SKIP_$&#123;PN&#125; &#x3D; &quot;dev-so&quot;</span><br></pre></td></tr></table></figure>

<p>As matter of fact, you can use this line to avoid almost all <em>QA Issues</em>, just replace <strong>“dev-so”</strong> into your error type.</p>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto: Replace sysvinit with systemd</title>
    <url>/2019-08-17/Yocto-Replace-sysvinit-with-systemd/</url>
    <content><![CDATA[<p>There are some Yocto distributions still using sysvinit as their default init manager. To replace it with systemd, some modifications need to be done in <strong>local.conf</strong>:</p>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># build&#x2F;conf&#x2F;local.conf</span><br><span class="line">DISTRO_FEATURES_append +&#x3D; &quot;systemd&quot;</span><br><span class="line">VIRTUAL-RUNTIME_init_manager &#x3D; &quot;systemd&quot;</span><br><span class="line">DISTRO_FEATURES_BACKFILL_CONSIDERED +&#x3D; &quot;sysvinit&quot;</span><br><span class="line">VIRTUAL-RUNTIME_initscripts &#x3D; &quot;&quot;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto debugging commands</title>
    <url>/2020-03-07/Yocto-debugging-commands/</url>
    <content><![CDATA[<p>Notes about some useful Yocto debugging commands</p>
<a id="more"></a>

<h2 id="Checking-owner-of-installed-files"><a href="#Checking-owner-of-installed-files" class="headerlink" title="Checking owner of installed files"></a>Checking owner of installed files</h2><p>Assuming that build environments is ready(which means you can run <code>bitbake</code> normally), using <code>oe-pkgdata-util</code> can help to find the recipe who populated it. i.e:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">oe-pkgdata-util find-path /lib/ld-2.28.so</span><br><span class="line">glibc: /lib/ld-2.28.so</span><br></pre></td></tr></table></figure>
<p><em>/lib/ld-2.28.so</em> was installed by <strong>glibc</strong></p>
<h2 id="Checking-packages-are-going-to-install"><a href="#Checking-packages-are-going-to-install" class="headerlink" title="Checking packages are going to install"></a>Checking packages are going to install</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitbake -g &lt;image&gt; &amp;&amp; cat pn-buildlist | grep -ve <span class="string">"native"</span> | sort | uniq</span><br></pre></td></tr></table></figure>

<h2 id="Checking-packages-installed"><a href="#Checking-packages-installed" class="headerlink" title="Checking packages installed"></a>Checking packages installed</h2><p>There are several <em>.manifest</em> files under the path of built images, which contained packages has been installed.</p>
<h2 id="Checking-variables-inside-recipes"><a href="#Checking-variables-inside-recipes" class="headerlink" title="Checking variables inside recipes"></a>Checking variables inside recipes</h2><p><code>bb.utils.contains</code> can help to check variables inside recipes. i.e. we’d like to install some files base on <strong>MACHINE_FEATURES</strong> :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">do_install() &#123;</span><br><span class="line">    if $&#123;@bb.utils.contains(&#39;MACHINE_FEATURES&#39;,&#39;ethernet&#39;,&#39;true&#39;,&#39;false&#39;,d)&#125;; then</span><br><span class="line">        install -d $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;network&#x2F;</span><br><span class="line">        install -m 0644 $&#123;WORKDIR&#125;&#x2F;10-eth.network $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;network&#x2F;</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    if $&#123;@bb.utils.contains(&#39;MACHINE_FEATURES&#39;,&#39;wifi&#39;,&#39;true&#39;,&#39;false&#39;,d)&#125;; then</span><br><span class="line">        install -d $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;network&#x2F;</span><br><span class="line">        install -m 0644 $&#123;WORKDIR&#125;&#x2F;51-wlan.network $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;network&#x2F;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Below is the python code from openembedded, which explains usage of this function:</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">contains</span><span class="params">(variable, checkvalues, truevalue, falsevalue, d)</span>:</span></span><br><span class="line">   <span class="string">"""Check if a variable contains all the values specified.</span></span><br><span class="line"><span class="string">   Arguments:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   variable -- the variable name. This will be fetched and expanded (using</span></span><br><span class="line"><span class="string">   d.getVar(variable)) and then split into a set().</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   checkvalues -- if this is a string it is split on whitespace into a set(),</span></span><br><span class="line"><span class="string">   otherwise coerced directly into a set().</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   truevalue -- the value to return if checkvalues is a subset of variable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   falsevalue -- the value to return if variable is empty or if checkvalues is</span></span><br><span class="line"><span class="string">   not a subset of variable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   d -- the data store.</span></span><br><span class="line"><span class="string">   """</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto recipe: Git</title>
    <url>/2019-05-27/Yocto-recipe-Git/</url>
    <content><![CDATA[<p>This is a short post give a sample of Yocto recipe which fetches source codes from git server.</p>
<a id="more"></a>


<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SUMMARY &#x3D; &quot;Example&quot;</span><br><span class="line">DESCRIPTION &#x3D; &quot;Recipes for Example&quot;</span><br><span class="line">LICENSE &#x3D; &quot;GPL-2.0&quot;</span><br><span class="line">AUTHOR &#x3D; &quot;Alex Li(Alex.Li@xxxx.com)&quot;</span><br><span class="line">#Path of your LICENSE file and checksum</span><br><span class="line">LIC_FILES_CHKSUM &#x3D; &quot;file:&#x2F;&#x2F;$&#123;COMMON_LICENSE_DIR&#125;&#x2F;GPL-2.0;md5&#x3D;801f80980d171dd6425610833a22dbe6&quot;</span><br><span class="line"></span><br><span class="line">#Build dependencies</span><br><span class="line">DEPENDS +&#x3D; &quot;boost ark-base ark-log&quot;</span><br><span class="line">#Run time dependencies</span><br><span class="line">RDEPENDS_$&#123;PN&#125; &#x3D; &quot;ark-base ark-log boost-program-options&quot;</span><br><span class="line"></span><br><span class="line">#Your git repo address, will be usedby $&#123;SRC_URI&#125;</span><br><span class="line">$&#123;PN&#125;_REPO &#x3D; &quot;github.com&#x2F;codingspirit&#x2F;example.git&quot;</span><br><span class="line">#Set to $&#123;AUTOREV&#125; to automatically fetch the newest commit, you can set specific commit id as well</span><br><span class="line">SRCREV_$&#123;PN&#125; &#x3D; &quot;$&#123;AUTOREV&#125;&quot;</span><br><span class="line"></span><br><span class="line">#Files need to be installed into target need to declare in recipe</span><br><span class="line">FILES_$&#123;PN&#125; +&#x3D; &quot;&#x2F;example&#x2F;*&quot;</span><br><span class="line"></span><br><span class="line">#Set git source, name, protocol, branch, git clone destination. You can use &quot;branch&#x3D;branchname&quot; to  specify branch to require bitbake check after fetching</span><br><span class="line">#&quot;nobranch&#x3D;1&quot; will skip branch check</span><br><span class="line">SRC_URI &#x3D; &quot; \</span><br><span class="line">  git:&#x2F;&#x2F;$&#123;$&#123;PN&#125;_REPO&#125;;name&#x3D;$&#123;PN&#125;;protocol&#x3D;https;nobranch&#x3D;1;destsuffix&#x3D;git&#x2F;$&#123;PN&#125; \ </span><br><span class="line">  &quot;</span><br><span class="line"># Path of source code. We set it to &quot;git&#x2F;$&#123;PN&#125;&quot; in SRC_URI</span><br><span class="line">S &#x3D; &quot;$&#123;WORKDIR&#125;&#x2F;git&#x2F;$&#123;PN&#125;&quot;</span><br><span class="line"># Build path, $&#123;BPN&#125; means &quot;The bare name of the recipe&quot;</span><br><span class="line">B &#x3D; &quot;$&#123;WORKDIR&#125;&#x2F;$&#123;BPN&#125;&quot;</span><br><span class="line"></span><br><span class="line">inherit cmake</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto rtl8811 wifi adapter bring up</title>
    <url>/2019-12-21/Yocto-rtl8811-wifi-adapter-bring-up/</url>
    <content><![CDATA[<p>Brief notes about bring up rtl8811 and wlan0 on STM32MP1</p>
<a id="more"></a>

<h2 id="rtl8811-driver"><a href="#rtl8811-driver" class="headerlink" title="rtl8811 driver"></a>rtl8811 driver</h2><p>There is an open source driver on <a href="https://github.com/abperiasamy/rtl8812AU_8821AU_linux" target="_blank" rel="noopener">Github</a> and I have verified <em>4235b0ec7d7220a6364586d8e25b1e8cb99c36f1</em> works well on my ubuntu PC. But to make it work in yocto, we need a patch to its makefile since it’s not designed as a yocto kernel module:</p>
<p><em>0001-modify-makefile-to-support-yocto.patch</em></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">From 0bc225d55b3e4e2269519b699f972401c227bc0c Mon Sep 17 00:00:00 2001</span><br><span class="line">From: &quot;Alex.Don.Scofield&quot; &lt;lizhiqin46783937@live.com&gt;</span><br><span class="line">Date: Sun, 15 Dec 2019 22:08:04 +0800</span><br><span class="line">Subject: [PATCH] modify makefile to support yocto</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"> Makefile | 9 +++++++--</span><br><span class="line"> 1 file changed, 7 insertions(+), 2 deletions(-)</span><br><span class="line"></span><br><span class="line">diff --git a&#x2F;Makefile b&#x2F;Makefile</span><br><span class="line">index dc027f3..8de8dfd 100644</span><br><span class="line">--- a&#x2F;Makefile</span><br><span class="line">+++ b&#x2F;Makefile</span><br><span class="line">@@ -893,10 +893,12 @@ ifndef KVER</span><br><span class="line"> KVER ?&#x3D; $(shell uname -r)</span><br><span class="line"> endif</span><br><span class="line"> ifndef KSRC</span><br><span class="line">-KSRC :&#x3D; &#x2F;lib&#x2F;modules&#x2F;$(KVER)&#x2F;build</span><br><span class="line">+# KSRC :&#x3D; &#x2F;lib&#x2F;modules&#x2F;$(KVER)&#x2F;build</span><br><span class="line">+KSRC :&#x3D; $(KERNEL_SRC)</span><br><span class="line"> endif</span><br><span class="line"> ifndef MODDESTDIR</span><br><span class="line">-MODDESTDIR :&#x3D; &#x2F;lib&#x2F;modules&#x2F;$(KVER)&#x2F;kernel&#x2F;drivers&#x2F;net&#x2F;wireless&#x2F;</span><br><span class="line">+# MODDESTDIR :&#x3D; &#x2F;lib&#x2F;modules&#x2F;$(KVER)&#x2F;kernel&#x2F;drivers&#x2F;net&#x2F;wireless&#x2F;</span><br><span class="line">+MODDESTDIR :&#x3D; $(O)</span><br><span class="line"> endif</span><br><span class="line"> INSTALL_PREFIX :&#x3D;</span><br><span class="line"> endif</span><br><span class="line">@@ -1621,6 +1623,9 @@ all: modules</span><br><span class="line"> modules:</span><br><span class="line"> 	$(MAKE) ARCH&#x3D;$(ARCH) CROSS_COMPILE&#x3D;$(CROSS_COMPILE) -C $(KSRC) M&#x3D;$(shell pwd)  modules</span><br><span class="line"> </span><br><span class="line">+modules_install:</span><br><span class="line">+	$(MAKE) ARCH&#x3D;$(ARCH) CROSS_COMPILE&#x3D;$(CROSS_COMPILE) -C $(KSRC) M&#x3D;$(shell pwd)  modules_install</span><br><span class="line">+</span><br><span class="line"> strip:</span><br><span class="line"> 	$(CROSS_COMPILE)strip $(MODULE_NAME).ko --strip-unneeded</span><br><span class="line"> </span><br><span class="line">-- </span><br><span class="line">2.17.1</span><br></pre></td></tr></table></figure>
<p>Then we create recipes for it(<em>kernel-module-rtl8812au_0.1.bb</em>):</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SUMMARY &#x3D; &quot;Driver for rtl8811au&#x2F;8812au&#x2F;8821au&quot;</span><br><span class="line">LICENSE &#x3D; &quot;GPL-2.0&quot;</span><br><span class="line">PV &#x3D; &quot;0.1&quot;</span><br><span class="line">LIC_FILES_CHKSUM &#x3D; &quot;file:&#x2F;&#x2F;$&#123;COMMON_LICENSE_DIR&#125;&#x2F;GPL-2.0;md5&#x3D;801f80980d171dd6425610833a22dbe6&quot;</span><br><span class="line"></span><br><span class="line">inherit module</span><br><span class="line"></span><br><span class="line">$&#123;PN&#125;_REPO &#x3D; &quot;github.com&#x2F;abperiasamy&#x2F;rtl8812AU_8821AU_linux.git&quot;</span><br><span class="line">SRCREV_$&#123;PN&#125; &#x3D; &quot;4235b0ec7d7220a6364586d8e25b1e8cb99c36f1&quot;</span><br><span class="line"></span><br><span class="line">SRC_URI &#x3D; &quot; \</span><br><span class="line">  git:&#x2F;&#x2F;$&#123;$&#123;PN&#125;_REPO&#125;;name&#x3D;$&#123;PN&#125;;protocol&#x3D;https;nobranch&#x3D;1;destsuffix&#x3D;git&#x2F;$&#123;PN&#125; \</span><br><span class="line">  file:&#x2F;&#x2F;0001-modify-makefile-to-support-yocto.patch \</span><br><span class="line">  &quot;</span><br><span class="line"></span><br><span class="line">S &#x3D; &quot;$&#123;WORKDIR&#125;&#x2F;git&#x2F;$&#123;PN&#125;&quot;</span><br><span class="line"></span><br><span class="line">RPROVIDES_$&#123;PN&#125; +&#x3D; &quot;kernel-module-rtl8812au&quot;</span><br></pre></td></tr></table></figure>

<p>Add it to image recipe and flash built image into target, kernel module will be installed at <em>/lib/modules/${KERNEL_VERSION}/extra/rtl8812au.ko</em>. If it has been proper init, you can see those logs in <strong>dmesg</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[    8.321575] RTL871X: module init start</span><br><span class="line">[    8.354748] RTL871X: rtl8812au v4.3.14_13455.20150212_BTCOEX20150128-51</span><br><span class="line">[    8.359924] RTL871X: rtl8812au BT-Coex version &#x3D; BTCOEX20150128-51</span><br><span class="line">[    8.586779] RTL871X: rtw_ndev_init(wlan0)</span><br><span class="line">[    8.607811] usbcore: registered new interface driver rtl8812au</span><br><span class="line">[    8.612202] RTL871X: module init ret&#x3D;0</span><br></pre></td></tr></table></figure>
<h2 id="wpa-supplicant"><a href="#wpa-supplicant" class="headerlink" title="wpa-supplicant"></a>wpa-supplicant</h2><p>If we use <strong>wpa-supplicant</strong> to manage and config wifi, we need to have a <strong>*.network</strong> file under <strong>/lib/systemd/network/</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Match]</span><br><span class="line">Name&#x3D;wlan0</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">DHCP&#x3D;ipv4</span><br></pre></td></tr></table></figure>

<p>and a we also need a config file for wpa-supplicant:</p>
<p><em>/etc/wpa_supplicant/wpa_supplicant-wlan0.conf</em></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctrl_interface&#x3D;&#x2F;var&#x2F;run&#x2F;wpa_supplicant</span><br><span class="line">eapol_version&#x3D;1</span><br><span class="line">ap_scan&#x3D;1</span><br><span class="line">fast_reauth&#x3D;1</span><br><span class="line"></span><br><span class="line">network&#x3D;&#123;</span><br><span class="line">    ssid&#x3D;&quot;WIFI SSID&quot;</span><br><span class="line">    psk&#x3D;&quot;WIFI PASSWD&quot;</span><br><span class="line">    priority&#x3D;5</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If we want wlan be ready after system booting, we need to append wpa-supplicant. Create <em>wpa-supplicant_%.bbappend</em>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FILESEXTRAPATHS_prepend :&#x3D; &quot;$&#123;THISDIR&#125;&#x2F;$&#123;PN&#125;:&quot;</span><br><span class="line"></span><br><span class="line">SRC_URI +&#x3D; &quot; \</span><br><span class="line">    file:&#x2F;&#x2F;51-wlan.network \</span><br><span class="line">    file:&#x2F;&#x2F;wpa_supplicant-wlan0.conf \</span><br><span class="line">    &quot;</span><br><span class="line">FILES_$&#123;PN&#125; +&#x3D; &quot; \</span><br><span class="line">    $&#123;systemd_unitdir&#125;&#x2F;network&#x2F;51-wlan.network \</span><br><span class="line">    $&#123;sysconfdir&#125;&#x2F;wpa_supplicant&#x2F;wpa_supplicant-wlan0.conf \</span><br><span class="line">&quot;</span><br><span class="line"></span><br><span class="line">SYSTEMD_AUTO_ENABLE &#x3D; &quot;enable&quot;</span><br><span class="line">SYSTEMD_SERVICE_$&#123;PN&#125;_append &#x3D; &quot; wpa_supplicant@wlan0.service&quot;</span><br><span class="line"></span><br><span class="line">do_install_append() &#123;</span><br><span class="line">    install -d $&#123;D&#125;$&#123;sysconfdir&#125;&#x2F;wpa_supplicant&#x2F;</span><br><span class="line">    install -m 0600 $&#123;WORKDIR&#125;&#x2F;wpa_supplicant-wlan0.conf $&#123;D&#125;$&#123;sysconfdir&#125;&#x2F;wpa_supplicant&#x2F;</span><br><span class="line"></span><br><span class="line">    if $&#123;@bb.utils.contains(&#39;DISTRO_FEATURES&#39;,&#39;systemd&#39;,&#39;true&#39;,&#39;false&#39;,d)&#125;; then</span><br><span class="line">        install -d $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;network&#x2F;</span><br><span class="line">        install -m 0644 $&#123;WORKDIR&#125;&#x2F;51-wlan.network $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;network&#x2F;</span><br><span class="line"></span><br><span class="line">        install -d $&#123;D&#125;$&#123;sysconfdir&#125;&#x2F;systemd&#x2F;system&#x2F;multi-user.target.wants&#x2F;</span><br><span class="line">        ln -s $&#123;systemd_unitdir&#125;&#x2F;system&#x2F;wpa_supplicant@.service \</span><br><span class="line">        $&#123;D&#125;$&#123;sysconfdir&#125;&#x2F;systemd&#x2F;system&#x2F;multi-user.target.wants&#x2F;wpa_supplicant@wlan0.service</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>canvas demo page</title>
    <url>/2019-05-27/canvas-demo-page/</url>
    <content><![CDATA[<p><span style="color:red">This is a demo page for cool html5 canvas demos. Try to click them!</span><br><span style="color:blue">Beware of performance issues if you trying to access those pages through mobile devices. :)</span><br><a href="/fireball.html">Fire Ball</a><br><a href="/blackhole.html">Black Hole</a></p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>html5</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto: systemd</title>
    <url>/2019-06-07/Yocto-systemd/</url>
    <content><![CDATA[<p>As a replacement of System V init, systemd has been supported by Yocto long time ago. Let’s take a look at how to implement a Yocto recipe for systemd services.</p>
<a id="more"></a>

<h2 id="Prepare-service-file"><a href="#Prepare-service-file" class="headerlink" title="Prepare .service file"></a>Prepare .service file</h2><p>An example of service config file <strong>mydaemon.service</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description&#x3D;My Daemon</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User&#x3D;root</span><br><span class="line">Group&#x3D;root</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">ExecStart&#x3D;&#x2F;my_daemon&#x2F;my_daemon_start.sh</span><br><span class="line">StandardOutput&#x3D;null</span><br></pre></td></tr></table></figure>

<h2 id="Write-a-systemd-recipe"><a href="#Write-a-systemd-recipe" class="headerlink" title="Write a systemd recipe"></a>Write a systemd recipe</h2><p>First of all, don’t forget add your service file into source files:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SRC_URI &#x3D; &quot; \</span><br><span class="line">  git:&#x2F;&#x2F;$&#123;$&#123;PN&#125;_REPO&#125;;name&#x3D;$&#123;PN&#125;;protocol&#x3D;http;nobranch&#x3D;1;destsuffix&#x3D;git&#x2F;$&#123;PN&#125; \</span><br><span class="line">  file:&#x2F;&#x2F;mydaemon.service \</span><br><span class="line">  &quot;</span><br></pre></td></tr></table></figure>

<p>As you can see I put service file and application source code separately. You can put service file into your source code git repo as well.</p>
<p>Then to add systemd into Yocto recipe, you need to inherit your recipe from <strong>systemd</strong> class:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inherit systemd</span><br></pre></td></tr></table></figure>

<p>BTW Yocto support multiple inheritance, in my case I was trying to setup a cmake based application as a startup application when system booting up, so :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inherit cmake systemd</span><br></pre></td></tr></table></figure>

<p>Notice: Here is a short introduction from <a href="https://www.yoctoproject.org/docs/2.2/ref-manual/ref-manual.html" target="_blank" rel="noopener">Yocto reference manual</a></p>
<blockquote>
<p>The systemd class provides support for recipes that install systemd unit files.<br>The functionality for this class is disabled unless you have “systemd” in DISTRO_FEATURES.<br>Under this class, the recipe or Makefile (i.e. whatever the recipe is calling during the do_install task) installs unit files into ${D}${systemd_unitdir}/system. If the unit files being installed go into packages other than the main package, you need to set SYSTEMD_PACKAGES in your recipe to identify the packages in which the files will be installed.<br>You should set SYSTEMD_SERVICE to the name of the service file. You should also use a package name override to indicate the package to which the value applies. If the value applies to the recipe’s main package, use ${PN}. Here is an example from the connman recipe:</p>
</blockquote>
<blockquote>
<pre><code>SYSTEMD_SERVICE_${PN} = &quot;connman.service&quot;</code></pre></blockquote>
<blockquote>
<p>Services are set up to start on boot automatically unless you have set SYSTEMD_AUTO_ENABLE to “disable”.</p>
</blockquote>
<blockquote>
<p>For more information on systemd, see the “Selecting an Initialization Manager” section in the Yocto Project Development Manual.</p>
</blockquote>
<p>As you can see, we <em>should set SYSTEMD_SERVICE to the name of the service file</em>. </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SYSTEMD_SERVICE_$&#123;PN&#125; &#x3D; &quot;mydaemon.service&quot;</span><br></pre></td></tr></table></figure>

<p>The last step is write a <strong>do_install</strong> task to install our services into target. The problem is in my scenario, cmake class already provided a <strong>do_install</strong> task, if we just override <strong>do_install</strong> task as below:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">do_install() &#123;</span><br><span class="line">  install -D -p -m0644 $&#123;WORKDIR&#125;&#x2F;mydaemon.service \</span><br><span class="line">    $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;system&#x2F;mydaemon.service</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>cmake install task will not be executed. To fix this, we need to add <strong>cmake_do_install</strong> into overridden <strong>do_install</strong> task:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">do_install() &#123;</span><br><span class="line">  cmake_do_install</span><br><span class="line">  install -D -p -m0644 $&#123;WORKDIR&#125;&#x2F;mydaemon.service \</span><br><span class="line">    $&#123;D&#125;$&#123;systemd_unitdir&#125;&#x2F;system&#x2F;mydaemon.service</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then cmake install task will be executed, mydaemon.service will be installed and setup as well.</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>cmake notes</title>
    <url>/2019-03-04/cmake-notes/</url>
    <content><![CDATA[<p>Take notes!</p>
<a id="more"></a>

<h2 id="Use-pkg-config-in-cmake"><a href="#Use-pkg-config-in-cmake" class="headerlink" title="Use pkg-config in cmake"></a>Use pkg-config in cmake</h2><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment">#require gstreamer and check version, $&#123;GST&#125; is an user defined prefix for _LIBRARIES/_INCLUDE_DIRS/_CFLAGS_OTHER</span></span><br><span class="line">pkg_check_modules(GST REQUIRED gstreamer-<span class="number">1.0</span>&gt;=<span class="number">1.10</span></span><br><span class="line">                  gstreamer-app-<span class="number">1.0</span>&gt;=<span class="number">1.10</span>)</span><br><span class="line"><span class="comment">#Then we can get hidden variables $&#123;GST_LIBRARIES&#125; $&#123;GST_INCLUDE_DIRS&#125; $&#123;GST_CFLAGS_OTHER&#125;</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> boost_log pthread</span><br><span class="line">                  <span class="variable">$&#123;GST_LIBRARIES&#125;</span>)</span><br><span class="line"><span class="keyword">target_include_directories</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC <span class="variable">$&#123;GST_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">target_compile_options</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> PUBLIC <span class="variable">$&#123;GST_CFLAGS_OTHER&#125;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Add-all-files-under-a-folder-i-e-add-all-source-files"><a href="#Add-all-files-under-a-folder-i-e-add-all-source-files" class="headerlink" title="Add all files under a folder(i.e. add all source files)"></a>Add all files under a folder(i.e. add all source files)</h2><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment">#option 1: use file(), store files into variable SRC_FILES</span></span><br><span class="line"><span class="keyword">file</span>(GLOB SRC_FILES <span class="string">"*.cpp"</span>)</span><br><span class="line"><span class="comment">#if there are sub-dirs should be searched, use recursive</span></span><br><span class="line"><span class="keyword">file</span>(GLOB_RECURSE SRC_FILES <span class="string">"*.cpp"</span>)</span><br><span class="line"><span class="comment">#option 2: use aux_source_directory(), store source files into variable SRC_FILES</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(. SRC_FILES)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>cmake</tag>
      </tags>
  </entry>
  <entry>
    <title>i.MX 8 getting started: cmake package</title>
    <url>/2019-03-28/i-MX-8-getting-started-cmake-package/</url>
    <content><![CDATA[<p>We already started to use cmake instead of writing Makefile by our own in buildroot. Let’s see how to have a cmake package in Yocto.</p>
<a id="more"></a>

<h2 id="Add-your-source-file-and-CMakeLists"><a href="#Add-your-source-file-and-CMakeLists" class="headerlink" title="Add your source file and CMakeLists"></a>Add your source file and CMakeLists</h2><p>Here we use a simple cpp source file to test c++11 and pthread.</p>
<p><strong>alexcmaketest.cpp</strong> :</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> thread1 = <span class="built_in">std</span>::make_unique&lt;<span class="built_in">std</span>::thread&gt;([]() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"hello world from thread1"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">auto</span> thread2 = <span class="built_in">std</span>::make_unique&lt;<span class="built_in">std</span>::thread&gt;([]() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"hello world from thread2"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (thread1-&gt;joinable())</span><br><span class="line">        thread1-&gt;join();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (thread2-&gt;joinable())</span><br><span class="line">        thread2-&gt;join();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then prepare your CMakeLists.txt:</p>
<p><strong>CMakeLists.txt</strong>:</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">2.8</span> FATAL_ERROR)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(alexcmaketest)</span><br><span class="line"></span><br><span class="line"><span class="keyword">file</span>(GLOB SRC_FILES <span class="string">"*.cpp"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;SRC_FILES&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> pthread)</span><br><span class="line"></span><br><span class="line"><span class="keyword">install</span>(TARGETS <span class="variable">$&#123;PROJECT_NAME&#125;</span> DESTINATION bin)</span><br></pre></td></tr></table></figure>

<p>Notice : <strong>install</strong> should be added into your <strong>CMakeLists.txt</strong> if you want your binary to be installed into rootfs.</p>
<h2 id="Write-your-recipe"><a href="#Write-your-recipe" class="headerlink" title="Write your recipe"></a>Write your recipe</h2><p><strong>cmakeexample_0.1.bb</strong> :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SUMMARY &#x3D; &quot;cmake example&quot;</span><br><span class="line">DESCRIPTION &#x3D; &quot;Recipe for cmake test&quot;</span><br><span class="line">LICENSE &#x3D; &quot;GPL-2.0&quot;</span><br><span class="line">LIC_FILES_CHKSUM &#x3D; &quot;file:&#x2F;&#x2F;$&#123;COMMON_LICENSE_DIR&#125;&#x2F;GPL-2.0;md5&#x3D;801f80980d171dd6425610833a22dbe6&quot;</span><br><span class="line"></span><br><span class="line">SRC_URI &#x3D; &quot;file:&#x2F;&#x2F;alexcmaketest.cpp \</span><br><span class="line">            file:&#x2F;&#x2F;CMakeLists.txt&quot;</span><br><span class="line"></span><br><span class="line">S &#x3D; &quot;$&#123;WORKDIR&#125;&quot;</span><br><span class="line"></span><br><span class="line">inherit cmake</span><br></pre></td></tr></table></figure>

<p>There is no need to override <strong>do_install</strong> nor <strong>do_config</strong> in this scenario. <strong>cmake.bbclass</strong> has already defined those tasks and we can just inherit from it.<br>If <strong>pkgconfig</strong> is required by your cmake, use <strong>inherit pkgconfig cmake</strong> instead.</p>
<p>Then add your packages into your layer, don’t forget config your package as <span style="color:red">IMAGE_INSTALL_append</span> in <span style="color:red">layer.conf</span>. After that, you should have a folder tree like this:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── bitbake-cookerdaemon.log</span><br><span class="line">├── conf</span><br><span class="line">│   └── layer.conf</span><br><span class="line">├── COPYING.MIT</span><br><span class="line">├── README</span><br><span class="line">├── recipes-cmakeexample</span><br><span class="line">│   └── cmakeexample</span><br><span class="line">│       ├── cmakeexample-0.1</span><br><span class="line">│       │   ├── alexcmaketest.cpp</span><br><span class="line">│       │   └── CMakeLists.txt</span><br><span class="line">│       └── cmakeexample_0.1.bb</span><br></pre></td></tr></table></figure>

<h2 id="Build-your-package"><a href="#Build-your-package" class="headerlink" title="Build your package!"></a>Build your package!</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bitbake cmakeexample</span><br></pre></td></tr></table></figure>
<h2 id="Build-your-image"><a href="#Build-your-image" class="headerlink" title="Build your image"></a>Build your image</h2><p>Of course don’t forget to re-build your image.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bitbake fsl-image-qt5-validation-imx</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>git command备忘录</title>
    <url>/2018-10-21/git-command%E5%A4%87%E5%BF%98%E5%BD%95/</url>
    <content><![CDATA[<p>…</p>
<a id="more"></a>

<h2 id="全局配置用户名和邮箱"><a href="#全局配置用户名和邮箱" class="headerlink" title="全局配置用户名和邮箱:"></a>全局配置用户名和邮箱:</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">"Alex.Li"</span></span><br><span class="line">git config --global user.email <span class="string">"Alex.Li@xxxx.com"</span></span><br></pre></td></tr></table></figure>

<h2 id="ssh密钥生成"><a href="#ssh密钥生成" class="headerlink" title="ssh密钥生成:"></a>ssh密钥生成:</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">"Alex.Li@xxxx.com"</span></span><br></pre></td></tr></table></figure>

<h2 id="储存https-http方式用户名密码"><a href="#储存https-http方式用户名密码" class="headerlink" title="储存https/http方式用户名密码:"></a>储存https/http方式用户名密码:</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global credential.helper store</span><br></pre></td></tr></table></figure>

<h2 id="添加tag并推送到远端"><a href="#添加tag并推送到远端" class="headerlink" title="添加tag并推送到远端:"></a>添加tag并推送到远端:</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git tag -a 1.0.0 -m <span class="string">'add version 1.0.0'</span></span><br><span class="line">git push origin master --tags</span><br></pre></td></tr></table></figure>

<h2 id="更改一个https仓库为ssh仓库："><a href="#更改一个https仓库为ssh仓库：" class="headerlink" title="更改一个https仓库为ssh仓库："></a>更改一个https仓库为ssh仓库：</h2><p><em>.git/config</em>中</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">url &#x3D; https:&#x2F;&#x2F;xxxx.com&#x2F;somebody&#x2F;abcdef.git</span><br></pre></td></tr></table></figure>
<p>改为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">url &#x3D; git@gxxxx.com:somebody&#x2F;abcdef.git</span><br></pre></td></tr></table></figure>
<p>反之则反</p>
<h2 id="删除remotes-origin-branch"><a href="#删除remotes-origin-branch" class="headerlink" title="删除remotes/origin/{branch}"></a>删除remotes/origin/{branch}</h2><p>远端分支已经删除， 但本地仍可见remotes/origin/{branch}</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote prune origin</span><br></pre></td></tr></table></figure>

<h2 id="repo-操作"><a href="#repo-操作" class="headerlink" title="repo 操作"></a>repo 操作</h2><p>对每个子repo进行操作</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">repo forall -vc <span class="string">"git cmd"</span></span><br></pre></td></tr></table></figure>
<p>i.e.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">repo forall -vc <span class="string">"git reset --hard"</span></span><br></pre></td></tr></table></figure>

<h2 id="使用指定private-key"><a href="#使用指定private-key" class="headerlink" title="使用指定private key"></a>使用指定private key</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GIT_SSH_COMMAND&#x3D;&#39;ssh -i private_key.pem -o IdentitiesOnly&#x3D;yes&#39; git clone git@github.com:codingspirit&#x2F;iotlab-kvs-jenkins-build.git</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>Yocto devtool</title>
    <url>/2019-11-30/Yocto-devtool/</url>
    <content><![CDATA[<p>I have got used to create patch and <strong>bbappend</strong> files manually, now I’m switching to use <strong>devtool</strong> - To be honest it’s quite easy to use.</p>
<a id="more"></a>

<h2 id="Export-source-code-to-external-patch"><a href="#Export-source-code-to-external-patch" class="headerlink" title="Export source code to external patch"></a>Export source code to external patch</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">devtool modify &lt;recipe_name&gt; &lt;dst_path_to_export&gt;</span><br></pre></td></tr></table></figure>
<p>Then we can do changes based on exported source code.</p>
<h2 id="Upgrade-changes-to-bbappend"><a href="#Upgrade-changes-to-bbappend" class="headerlink" title="Upgrade changes to bbappend"></a>Upgrade changes to bbappend</h2><p>When changes are verified and we need to add changes into bbapned file as a patch, just use git to commit changes, then:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">devtool update-recipe &lt;recipe_name&gt; -m patch -a &lt;dst_layer_path_to_generate_bbapned&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Exit-dev-mode"><a href="#Exit-dev-mode" class="headerlink" title="Exit dev mode"></a>Exit dev mode</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">devtool reset &lt;recipe_name&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note: devtool will not delete exported source code.</p>
</blockquote>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>i.MX 8 getting started: create your general layer</title>
    <url>/2019-03-22/i-MX-8-getting-started-create-your-general-layer/</url>
    <content><![CDATA[<p>This post will tell you how to create your own general layer with a “hello world” app to be built into your EVK.</p>
<a id="more"></a>
<p>Before start, you should run <strong>setup-environment</strong> first.</p>
<h2 id="Create-your-layer"><a href="#Create-your-layer" class="headerlink" title="Create your layer"></a>Create your layer</h2><h3 id="Create-layer-example-by-bitbake-layers"><a href="#Create-layer-example-by-bitbake-layers" class="headerlink" title="Create layer example by bitbake-layers"></a>Create layer example by bitbake-layers</h3><p>Use <strong>bitbake-layers create-layer &lt;layer name&gt;</strong> to create a general layer example.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> imx-yocto-bsp/<span class="built_in">source</span> <span class="comment"># you also can create your layer in other path</span></span><br><span class="line">$ bitbake-layers create-layer meta-alexlayer</span><br></pre></td></tr></table></figure>

<p>Notice: <strong>yocto-layer</strong> has been deprecated after Yocto 2.5. See <a href="https://www.yoctoproject.org/docs/current/ref-manual/ref-manual.html#detailed-supported-distros" target="_blank" rel="noopener">yocto ref manual</a> for more details.</p>
<blockquote>
<p>The yocto-bsp, yocto-kernel, and yocto-layer scripts previously shipped with poky but not in OpenEmbedded-Core have been removed. These scripts are not maintained and are outdated. In many cases, they are also limited in scope. The bitbake-layers create-layer command is a direct replacement for yocto-layer</p>
</blockquote>
<p>It will help you to create a layer with priority of 6. To change to other priority, add option “‐‐priority” or edit <strong>BBFILE_PRIORITY</strong> after creation.</p>
<h3 id="Modification"><a href="#Modification" class="headerlink" title="Modification"></a>Modification</h3><p>Go to your layer path, add some stuff into your <em>conf/layer.conf</em>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IMAGE_INSTALL_append +&#x3D; &quot;example&quot;</span><br><span class="line">LAYERSERIES_COMPAT_meta-alexlayer &#x3D; &quot;sumo&quot;</span><br></pre></td></tr></table></figure>

<p>IMAGE_INSTALL_append will tell bitbake to install your app into image.<br>Notice: It’s required by Yocto Project Compatible version 2 standard to set <strong>LAYERSERIES_COMPAT</strong>. There will be a warning if you didn’t do so. see <a href="https://www.yoctoproject.org/docs/latest/ref-manual/ref-manual.html" target="_blank" rel="noopener">yocto ref manual</a> for more details.</p>
<blockquote>
<p>Note</p>
<p>Setting LAYERSERIES_COMPAT is required by the Yocto Project Compatible version 2 standard. The OpenEmbedded build system produces a warning if the variable is not set for any given layer.</p>
</blockquote>
<p>Then add your source code:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> meta-alexlayer/recipes-example/example</span><br><span class="line">$ mkdir example-0.1</span><br><span class="line">$ <span class="built_in">cd</span> example-0.1</span><br><span class="line">$ touch alexhello.cpp</span><br></pre></td></tr></table></figure>
<p>my example here :</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// alexhello.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"hello world from alexlayer"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then modify your recipe file <strong>example_0.1.bb</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SUMMARY &#x3D; &quot;bitbake-layers recipe&quot;</span><br><span class="line">DESCRIPTION &#x3D; &quot;Recipe created by bitbake-layers&quot;</span><br><span class="line">LICENSE &#x3D; &quot;MIT&quot;</span><br><span class="line">LIC_FILES_CHKSUM &#x3D; &quot;file:&#x2F;&#x2F;$&#123;COMMON_LICENSE_DIR&#125;&#x2F;MIT;md5&#x3D;0835ade698e0bcf8506ecda2f7b4f302&quot;</span><br><span class="line"></span><br><span class="line">TARGET_CC_ARCH +&#x3D; &quot;$&#123;LDFLAGS&#125;&quot;</span><br><span class="line"></span><br><span class="line">SRC_URI &#x3D; &quot;file:&#x2F;&#x2F;alexhello.cpp&quot;</span><br><span class="line"></span><br><span class="line">S &#x3D; &quot;$&#123;WORKDIR&#125;&quot;</span><br><span class="line"></span><br><span class="line">do_compile() &#123;</span><br><span class="line">    $&#123;CXX&#125; alexhello.cpp -o alexhello</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">do_install() &#123;</span><br><span class="line">    install -d $&#123;D&#125;$&#123;bindir&#125;</span><br><span class="line">    install -m 0755 alexhello $&#123;D&#125;$&#123;bindir&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">python do_build() &#123;</span><br><span class="line">    bb.plain(&quot;***********************************************&quot;);</span><br><span class="line">    bb.plain(&quot;*                                             *&quot;);</span><br><span class="line">    bb.plain(&quot;*  Example recipe created by bitbake-layers   *&quot;);</span><br><span class="line">    bb.plain(&quot;*                                             *&quot;);</span><br><span class="line">    bb.plain(&quot;***********************************************&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Notice: Here we use <span style="color:red"><strong>TARGET_CC_ARCH += “${LDFLAGS}”</strong></span> to avoid <strong>“No GNU_HASH in the elf binary”</strong> error when QA check, see <a href="https://www.yoctoproject.org/docs/current/mega-manual/mega-manual.html" target="_blank" rel="noopener">mega-manual</a> for more details.</p>
<blockquote>
<p>25.10.8. Default Linker Hash Style Changed</p>
<p>The default linker hash style for gcc-cross is now “sysv” in order to catch recipes that are building software without using the OpenEmbedded LDFLAGS. This change could result in seeing some “No GNU_HASH in the elf binary” QA issues when building such recipes. You need to fix these recipes so that they use the expected LDFLAGS. Depending on how the software is built, the build system used by the software (e.g. a Makefile) might need to be patched. However, sometimes making this fix is as simple as adding the following to the recipe:</p>
<pre><code>TARGET_CC_ARCH += &quot;${LDFLAGS}&quot;</code></pre></blockquote>
<p>After those steps, you should have a folder like this:<br><img src="/2019-03-22/i-MX-8-getting-started-create-your-general-layer/folder_tree.png" alt></p>
<h2 id="Add-your-layer-and-build"><a href="#Add-your-layer-and-build" class="headerlink" title="Add your layer and build"></a>Add your layer and build</h2><p>There are two ways to add your layer into build:</p>
<h3 id="Use-bitbake-layers-add-layer"><a href="#Use-bitbake-layers-add-layer" class="headerlink" title="Use bitbake-layers add-layer"></a>Use <strong>bitbake-layers add-layer</strong></h3><p>Use <strong>bitbake-layers add-layer &lt;layer name&gt;</strong> to add a layer and build it. Before this, you should source <strong>setup-environment</strong>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bitbake-layers add-layer meta-alexlayer</span><br><span class="line">$ bitbake example</span><br></pre></td></tr></table></figure>

<h3 id="Modify-script-provided-by-nxp"><a href="#Modify-script-provided-by-nxp" class="headerlink" title="Modify script provided by nxp"></a>Modify script provided by nxp</h3><p>Modify <strong>fsl-setup-release.sh</strong>, add your layer path to “BBLAYERS”:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"BBLAYERS += \" \$&#123;BSPDIR&#125;/sources/meta-qt5 \""</span> &gt;&gt; <span class="variable">$BUILD_DIR</span>/conf/bblayers.conf</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"BBLAYERS += \" \$&#123;BSPDIR&#125;/sources/meta-alexlayer \""</span> &gt;&gt; <span class="variable">$BUILD_DIR</span>/conf/bblayers.conf <span class="comment"># new layer</span></span><br></pre></td></tr></table></figure>
<p>Then source it and <strong>bitbake</strong> your new layer:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ DISTRO=fsl-imx-xwayland MACHINE=imx8mmevk <span class="built_in">source</span> fsl-setup-release.sh -b build-xwayland</span><br><span class="line">$ bitbake example</span><br></pre></td></tr></table></figure>

<h2 id="Rebuild-your-image-file"><a href="#Rebuild-your-image-file" class="headerlink" title="Rebuild your image file"></a>Rebuild your image file</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bitbake fsl-image-qt5-validation-imx</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>i.MX 8 getting started: create your kernel module</title>
    <url>/2019-03-26/i-MX-8-getting-started-create-your-kernel-module/</url>
    <content><![CDATA[<p>The normal way that using yocto to do kernel development is really painful… Maybe try out-of-tree build is a better choice.</p>
<a id="more"></a>

<h2 id="Create-and-add-your-layer"><a href="#Create-and-add-your-layer" class="headerlink" title="Create and add your layer"></a>Create and add your layer</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bitbake-layers create-layer --example-recipe-name alexkernel meta-alexkernel</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bitbake-layers add-layer ../sources/meta-alexkernel/</span><br></pre></td></tr></table></figure>
<p>Or you can use exist layer instead, just create recipe files under your layer.</p>
<h2 id="Add-your-source-code-and-Makefile"><a href="#Add-your-source-code-and-Makefile" class="headerlink" title="Add your source code and Makefile"></a>Add your source code and Makefile</h2><p><strong>alex_module.c</strong>:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/printk.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/init.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> __<span class="function">init <span class="title">alex_module_init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    printk(KERN_INFO <span class="string">"Hello from alex module!\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __<span class="function"><span class="built_in">exit</span> <span class="title">alex_module_exit</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    printk(KERN_INFO <span class="string">"Bye from alex module!\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(alex_module_init);</span><br><span class="line"></span><br><span class="line">module_exit(alex_module_exit);</span><br><span class="line"></span><br><span class="line">MODULE_AUTHOR(<span class="string">"Coding Spirit &lt;coding@spirit.com&gt;"</span>);</span><br><span class="line">MODULE_LICENSE(<span class="string">"GPL v2"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>Makefile</strong>:</p>
<figure class="highlight mk"><table><tr><td class="code"><pre><span class="line">obj-m := alex_module.o</span><br><span class="line"></span><br><span class="line">SRC := <span class="variable">$(<span class="built_in">shell</span> pwd)</span></span><br><span class="line"></span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	<span class="variable">$(MAKE)</span> -C <span class="variable">$(KERNEL_SRC)</span> M=<span class="variable">$(SRC)</span></span><br><span class="line"></span><br><span class="line"><span class="section">modules_install:</span></span><br><span class="line">	<span class="variable">$(MAKE)</span> -C <span class="variable">$(KERNEL_SRC)</span> M=<span class="variable">$(SRC)</span> modules_install</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -f *.o *~ core .depend .*.cmd *.ko *.mod.c</span><br><span class="line">	rm -f Module.markers Module.symvers modules.order</span><br><span class="line">	rm -rf .tmp_versions Modules.symvers</span><br></pre></td></tr></table></figure>

<h2 id="Modify-recipe-files-and-conf-file"><a href="#Modify-recipe-files-and-conf-file" class="headerlink" title="Modify recipe files and conf file"></a>Modify recipe files and conf file</h2><p><strong>alexkernel_0.1.bb</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SUMMARY &#x3D; &quot;kernel module example&quot;</span><br><span class="line">DESCRIPTION &#x3D; &quot;Recipe created by bitbake-layers&quot;</span><br><span class="line">LICENSE &#x3D; &quot;GPL-2.0&quot;</span><br><span class="line">LIC_FILES_CHKSUM &#x3D; &quot;file:&#x2F;&#x2F;$&#123;COMMON_LICENSE_DIR&#125;&#x2F;GPL-2.0;md5&#x3D;801f80980d171dd6425610833a22dbe6&quot;</span><br><span class="line"></span><br><span class="line">inherit module</span><br><span class="line"></span><br><span class="line">SRC_URI &#x3D; &quot;file:&#x2F;&#x2F;Makefile \</span><br><span class="line">            file:&#x2F;&#x2F;alex_module.c&quot;</span><br><span class="line"></span><br><span class="line">S &#x3D; &quot;$&#123;WORKDIR&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>Notice: bitbake support inheritance. Inherit from a exist bbclass will be much easier than rewrite one all by yourself. Take a look at <a href="https://github.com/openembedded/openembedded-core/tree/master/meta/classes" target="_blank" rel="noopener">openembedded github</a> to check how did they implement a base bbclass. BTW <strong>cmake.bbclass</strong> might be useful if you trying to support cmake. </p>
<p><strong>layer.conf</strong>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># We have a conf and classes directory, add to BBPATH</span><br><span class="line">BBPATH .&#x3D; &quot;:$&#123;LAYERDIR&#125;&quot;</span><br><span class="line"></span><br><span class="line"># We have recipes-* directories, add to BBFILES</span><br><span class="line">BBFILES +&#x3D; &quot;$&#123;LAYERDIR&#125;&#x2F;recipes-*&#x2F;*&#x2F;*.bb \</span><br><span class="line">            $&#123;LAYERDIR&#125;&#x2F;recipes-*&#x2F;*&#x2F;*.bbappend&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">IMAGE_INSTALL_append +&#x3D; &quot;alexkernel&quot;</span><br><span class="line">KERNEL_MODULE_AUTOLOAD +&#x3D; &quot;alex_module&quot;</span><br><span class="line"></span><br><span class="line">BBFILE_COLLECTIONS +&#x3D; &quot;meta-alexkernel&quot;</span><br><span class="line">BBFILE_PATTERN_meta-alexkernel &#x3D; &quot;^$&#123;LAYERDIR&#125;&#x2F;&quot;</span><br><span class="line">BBFILE_PRIORITY_meta-alexkernel &#x3D; &quot;6&quot;</span><br><span class="line">LAYERSERIES_COMPAT_meta-alexkernel &#x3D; &quot;sumo&quot;</span><br></pre></td></tr></table></figure>

<p>Notice: Module will automatically get loaded when system booting up if <strong>KERNEL_MODULE_AUTOLOAD</strong> was set.</p>
<p>We should have a folder tree as below:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── conf</span><br><span class="line">│   └── layer.conf</span><br><span class="line">├── COPYING.MIT</span><br><span class="line">├── README</span><br><span class="line">└── recipes-alexkernel</span><br><span class="line">    └── alexkernel</span><br><span class="line">        ├── alexkernel-0.1</span><br><span class="line">        │   ├── alex_module.c</span><br><span class="line">        │   └── Makefile</span><br><span class="line">        └── alexkernel_0.1.bb</span><br></pre></td></tr></table></figure>

<h2 id="rebuild-your-rootfs-and-image"><a href="#rebuild-your-rootfs-and-image" class="headerlink" title="rebuild your rootfs and image"></a>rebuild your rootfs and image</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitbake fsl-image-qt5-validation-imx</span><br></pre></td></tr></table></figure>

<h2 id="Check-your-environment-variables-by-bitbake-e"><a href="#Check-your-environment-variables-by-bitbake-e" class="headerlink" title="Check your environment variables by bitbake -e"></a>Check your environment variables by <strong>bitbake -e</strong></h2><p><strong>bitbake -e</strong> is a very useful command when you trying to debug build problem.</p>
<p>i.e. Check the rootfs folder of your image:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitbake -e &lt;image&gt; | grep ^IMAGE_ROOTFS=</span><br></pre></td></tr></table></figure>
<p>Check the ${WORKDIR} of your recipe:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitbake -e &lt;recipe&gt; | grep ^WORKDIR=</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>i.MX 8 getting started: setup environment</title>
    <url>/2019-03-21/i-MX-8-getting-started-setup-environment/</url>
    <content><![CDATA[<p>This post will show you how to setup environment(Linux) for NXP i.MX 8 and build a image fot i.MX8 Mini EVK. If you trying to build a Android image, close this post.</p>
<a id="more"></a>

<h2 id="Before-start"><a href="#Before-start" class="headerlink" title="Before start"></a>Before start</h2><p>Check your host environment:</p>
<ul>
<li>Fedora, openSUSE, CentOS, Debian, or Ubuntu(newer then 14.04, I test with 18.04)</li>
<li>120G disk space if graphical support is need</li>
<li>Git is already setup on your machine</li>
</ul>
<h2 id="Install-tools"><a href="#Install-tools" class="headerlink" title="Install tools"></a>Install tools</h2><p>There are some packages you might haven’t installed but required by Yocto:</p>
<ul>
<li>chrpath</li>
<li>gawk</li>
<li>u-boot-tools</li>
</ul>
<p>use <strong>apt install</strong> install all of them.</p>
<p>Also for <strong>repo</strong>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ curl https://storage.googleapis.com/git-repo-downloads/repo  &gt; /usr/<span class="built_in">local</span>/bin/repo</span><br><span class="line">$ chmod a+x /usr/<span class="built_in">local</span>/bin/repo</span><br></pre></td></tr></table></figure>
<p>You can choose your own repo install path, but make sure this path was added into <strong>PATH</strong>.</p>
<h2 id="Yocto-project-setup"><a href="#Yocto-project-setup" class="headerlink" title="Yocto project setup"></a>Yocto project setup</h2><p>We will use i.MX official repo to init.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mkdir imx-yocto-bsp </span><br><span class="line">$ <span class="built_in">cd</span> imx-yocto-bsp </span><br><span class="line">$ repo init -u https://source.codeaurora.org/external/imx/imx-manifest  -b imx-linux-sumo -m imx-4.14.78-1.0.0_ga.xml </span><br><span class="line">$ repo sync</span><br></pre></td></tr></table></figure>
<p>Use <strong>-b &lt;branch-name&gt;</strong> to switch to use other branch if you want. Check on <a href="https://source.codeaurora.org/external/imx/imx-manifest" target="_blank" rel="noopener">https://source.codeaurora.org/external/imx/imx-manifest</a> to find all available branches.</p>
<h2 id="Start-build"><a href="#Start-build" class="headerlink" title="Start build"></a>Start build</h2><h3 id="Choose-one-graphical-backend-for-your-image"><a href="#Choose-one-graphical-backend-for-your-image" class="headerlink" title="Choose one graphical backend for your image"></a>Choose one graphical backend for your image</h3><ul>
<li>fsl-imx-x11 </li>
<li>fsl-imx-wayland</li>
<li>fsl-imx-xwayland</li>
<li>fsl-imx-fb<br>For i.MX8, only fsl-imx-wayland and fsl-imx-xwayland are supported.<br>Then run:<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ DISTRO=fsl-imx-xwayland MACHINE=imx8mmevk <span class="built_in">source</span> fsl-setup-release.sh -b build-xwayland </span><br><span class="line">$ bitbake fsl-image-qt5-validation-imx</span><br></pre></td></tr></table></figure>
Set <strong>MACHINE</strong> to other variable if you are not using i.MX8 Mini EVK. Use <strong>-b</strong> in <strong>fsl-setup-release</strong> to specify build dir.</li>
</ul>
<p>Summaries of my build details:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Build Configuration:</span><br><span class="line">BB_VERSION           = <span class="string">"1.38.0"</span></span><br><span class="line">BUILD_SYS            = <span class="string">"x86_64-linux"</span></span><br><span class="line">NATIVELSBSTRING      = <span class="string">"ubuntu-18.04"</span></span><br><span class="line">TARGET_SYS           = <span class="string">"aarch64-poky-linux"</span></span><br><span class="line">MACHINE              = <span class="string">"imx8mmevk"</span></span><br><span class="line">DISTRO               = <span class="string">"fsl-imx-xwayland"</span></span><br><span class="line">DISTRO_VERSION       = <span class="string">"4.14-sumo"</span></span><br><span class="line">TUNE_FEATURES        = <span class="string">"aarch64"</span></span><br><span class="line">TARGET_FPU           = <span class="string">""</span></span><br><span class="line">meta                 </span><br><span class="line">meta-poky            = <span class="string">"HEAD:64a257fa22126c4a40ff7e03424a404e360ebe1e"</span></span><br><span class="line">meta-oe              </span><br><span class="line">meta-multimedia      = <span class="string">"HEAD:2bb21ef27c4b0c9d52d30b3b2c5a0160fd02b966"</span></span><br><span class="line">meta-freescale       = <span class="string">"HEAD:407c6cf408969445031a492e2d25e0e2749582ea"</span></span><br><span class="line">meta-freescale-3rdparty = <span class="string">"HEAD:88a29631809d1af0df618245430db29f2a7012b5"</span></span><br><span class="line">meta-freescale-distro = <span class="string">"HEAD:f7e2216e93aff14ac32728a13637a48df436b7f4"</span></span><br><span class="line">meta-bsp             </span><br><span class="line">meta-sdk             = <span class="string">"HEAD:9867dae67c158e0820bf226bd18b792623e99b25"</span></span><br><span class="line">meta-browser         = <span class="string">"HEAD:75640e14e325479c076b6272b646be7a239c18aa"</span></span><br><span class="line">meta-gnome           </span><br><span class="line">meta-networking      </span><br><span class="line">meta-python          </span><br><span class="line">meta-filesystems     = <span class="string">"HEAD:2bb21ef27c4b0c9d52d30b3b2c5a0160fd02b966"</span></span><br><span class="line">meta-qt5             = <span class="string">"HEAD:d4e7f73d04e8448d326b6f89908701e304e37d65"</span></span><br></pre></td></tr></table></figure>

<h2 id="Restart-a-build-environment"><a href="#Restart-a-build-environment" class="headerlink" title="Restart a build environment"></a>Restart a build environment</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">source</span> setup-environment &lt;build-dir&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Flash"><a href="#Flash" class="headerlink" title="Flash"></a>Flash</h2><p>Using <a href="https://github.com/NXPmicro/mfgtools" target="_blank" rel="noopener">mfgtools</a> provided by nxp to flash.</p>
<p>Flash to emmc:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo uuu -b emmc_all imx-boot-imx8mmevk-sd.bin-flash_evk fsl-image-validation-imx-imx8mmevk.sdcard.bz2/*</span><br></pre></td></tr></table></figure>

<p>In develop stage, suggest to use TFTP and NFS for a longer flash life span. See <a href="https://lzqblog.top/2019-05-26/i-MX-setup-TFTP-and-NFS/">i.MX setup TFTP and NFS</a> for more details.</p>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>i.MX setup auto login</title>
    <url>/2019-06-06/i-MX-setup-auto-login/</url>
    <content><![CDATA[<p>The default BSP provided by NXP requires login in UART after booting up, which seems “unfriendly” to some users.</p>
<a id="more"></a>

<p>In i.MX Yocto BSP, Login is provided by a systemd service called systemd-serialgetty:<br><strong>sources/poky/meta/recipes-core/systemd/systemd-serialgetty/serial-getty@.service</strong><br>This service will execute <strong>agetty</strong> when system booting up and require login.</p>
<p>So there are two ways to disable login:</p>
<h2 id="Replace-agetty-with-bin-login"><a href="#Replace-agetty-with-bin-login" class="headerlink" title="Replace agetty with /bin/login"></a>Replace agetty with <strong>/bin/login</strong></h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ExecStart&#x3D;&#x2F;bin&#x2F;login -f root</span><br></pre></td></tr></table></figure>

<h2 id="Provide-username-to-agetty"><a href="#Provide-username-to-agetty" class="headerlink" title="Provide username to agetty"></a>Provide username to agetty</h2><p>Add option <strong>-a</strong> to provide username to agetty.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Service]</span><br><span class="line">Environment&#x3D;&quot;TERM&#x3D;xterm&quot;</span><br><span class="line">#ExecStart&#x3D;-&#x2F;sbin&#x2F;agetty -8 -L %I @BAUDRATE@ $TERM</span><br><span class="line">ExecStart&#x3D;-&#x2F;sbin&#x2F;agetty -8 -a root -L %I @BAUDRATE@ $TERM</span><br><span class="line">Type&#x3D;idle</span><br><span class="line">Restart&#x3D;always</span><br><span class="line">RestartSec&#x3D;0</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>i.MX8 adb bring up</title>
    <url>/2019-07-27/i-MX8-adb-bring-up/</url>
    <content><![CDATA[<p>The default BSP provided by NXP doesn’t support <strong>adb</strong>, we have to port it by ourselves. Our goal is making <strong>adbd</strong> running on SoC meanwhile we can use <strong>adb</strong> through USB port.<br>Let’s have a quick summary before I forget it(I already done this 3 months ago…)</p>
<a id="more"></a>

<h2 id="Source-code-of-adb-amp-adbd"><a href="#Source-code-of-adb-amp-adbd" class="headerlink" title="Source code of adb &amp; adbd"></a>Source code of adb &amp; adbd</h2><p>You can find adb &amp; adbd source codes easily, but I found that there is a recipe in openembedded already provided adb &amp; adbd:<br><em>meta-openembedded/meta-oe/recipes-devtools/android-tools</em><br>But the default recipes can’t work on imx8mm through USB. We need do some modifications later.</p>
<h2 id="Adding-support-for-login-adb-as-root"><a href="#Adding-support-for-login-adb-as-root" class="headerlink" title="Adding support for login adb as root"></a>Adding support for login adb as root</h2><p>There is a function called <strong>should_drop_privileges</strong> in adbd source code, modify this function that makes it always return 0 to disallow drop privileges. It has been added into newer openembedded but not the i.mx BSP.</p>
<figure class="highlight patch"><table><tr><td class="code"><pre><span class="line">From 3a788e9168c9b9eac66c4fa479413f4a95c61be4 Mon Sep 17 00:00:00 2001</span><br><span class="line">From: Florent Revest &lt;revestflo@gmail.com&gt;</span><br><span class="line">Date: Mon, 30 Oct 2017 21:05:46 +0100</span><br><span class="line">Subject: [PATCH] adb: Allow adbd to be ran as root</span><br><span class="line"></span><br><span class="line"><span class="comment">---</span></span><br><span class="line"> adb/adb.c | 1 +</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"></span><br><span class="line">diff --git a/adb/adb.c b/adb/adb.c</span><br><span class="line">index 027edd9359..e0f7ecde45 100644</span><br><span class="line"><span class="comment">--- a/adb/adb.c</span></span><br><span class="line"><span class="comment">+++ b/adb/adb.c</span></span><br><span class="line">@@ -1271,6 +1271,7 @@ static int should_drop_privileges() &#123;</span><br><span class="line">     int secure = 0;</span><br><span class="line">     char value[PROPERTY_VALUE_MAX];</span><br><span class="line"> </span><br><span class="line"><span class="addition">+    return 0;</span></span><br><span class="line">    /* run adbd in secure mode if ro.secure is set and</span><br><span class="line">     ** we are not in the emulator</span><br><span class="line">     */</span><br></pre></td></tr></table></figure>
<p>You need to add this patch into recipe sources as well:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SRC_URI +&#x3D; &quot; \</span><br><span class="line">    file:&#x2F;&#x2F;0008-adb-Allow-adbd-to-be-ran-as-root.patch;patchdir&#x3D;system&#x2F;core \</span><br><span class="line">&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Adding-support-for-USB-adb"><a href="#Adding-support-for-USB-adb" class="headerlink" title="Adding support for USB adb"></a>Adding support for USB adb</h2><p>To connect adbd through USB, we need support from usb function filesystem. To enable it in kernel:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">│ Symbol: USB_FUNCTIONFS [&#x3D;m]                                                                      │  </span><br><span class="line">│ Type  : tristate                                                                                 │  </span><br><span class="line">│ Prompt: Function Filesystem                                                                      │  </span><br><span class="line">│   Location:                                                                                      │  </span><br><span class="line">│     -&gt; Device Drivers                                                                            │  </span><br><span class="line">│       -&gt; USB support (USB_SUPPORT [&#x3D;y])                                                          │  </span><br><span class="line">│         -&gt; USB Gadget Support (USB_GADGET [&#x3D;y])                                                  │  </span><br><span class="line">│ (4)       -&gt; USB Gadget precomposed configurations (&lt;choice&gt; [&#x3D;m])                               │  </span><br><span class="line">│   Defined at drivers&#x2F;usb&#x2F;gadget&#x2F;legacy&#x2F;Kconfig:196                                               │  </span><br><span class="line">│   Depends on: &lt;choice&gt;                                                                           │  </span><br><span class="line">│   Selects: USB_LIBCOMPOSITE [&#x3D;y] &amp;&amp; USB_F_FS [&#x3D;y] &amp;&amp; USB_FUNCTIONFS_GENERIC [&#x3D;y]</span><br></pre></td></tr></table></figure>

<p>After installation of <strong>USB_FUNCTIONFS</strong>, we need to <em>modprobe</em> and <em>mount</em> functionfs before adbd start(initialization):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">modprobe g_ffs idVendor=0x18d1 idProduct=0x4e42 iSerialNumber=<span class="string">"codingspirit"</span></span><br><span class="line">mkdir -p /dev/usb-ffs/adb</span><br><span class="line">mount -t functionfs adb /dev/usb-ffs/adb -o uid=0,gid=0</span><br></pre></td></tr></table></figure>

<p>Then we can start adbd now.</p>
<p>In my case I’m using systemd to do this initialization(as a <strong>ExecStartPre</strong>), then set <em>/usr/bin/adbd</em> as <strong>ExecStart</strong>.</p>
<p>After all of those steps, we can do quick test by <strong>adb devices</strong>! If everything goes well, you can see your device has been recognized. Then use <strong>adb shell</strong> to login, a <strong>#</strong> symbol should be shown which means you are in root.</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Yocto</tag>
      </tags>
  </entry>
  <entry>
    <title>i.MX setup TFTP and NFS</title>
    <url>/2019-05-26/i-MX-setup-TFTP-and-NFS/</url>
    <content><![CDATA[<p>Using TFTP(Trivial File Transfer Protocol) and NFS(Network File System) to load kernel and rootfs can help to reduce operations of flash write efficiently, which can make you EVK board live longer…</p>
<p>This summary is based on <a href="https://github.com/Alexey-Abdulov-Tymphany" target="_blank" rel="noopener">Alexey</a>‘s version, with some modifications according to my experiment.</p>
<a id="more"></a>

<h2 id="TFTP"><a href="#TFTP" class="headerlink" title="TFTP"></a>TFTP</h2><h3 id="Install-necessary-tools"><a href="#Install-necessary-tools" class="headerlink" title="Install necessary tools"></a>Install necessary tools</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install xinetd tftpd tftp</span><br></pre></td></tr></table></figure>

<h3 id="Setup-TFTP"><a href="#Setup-TFTP" class="headerlink" title="Setup TFTP"></a>Setup TFTP</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /etc/xinetd.d/</span><br><span class="line">nano /etc/xinetd.d/tftp</span><br><span class="line">service tftp</span><br><span class="line">&#123;</span><br><span class="line">    protocol        = udp</span><br><span class="line">    port            = 69</span><br><span class="line">    socket_type     = dgram</span><br><span class="line">    <span class="built_in">wait</span>            = yes</span><br><span class="line">    user            = nobody</span><br><span class="line">    server          = /usr/sbin/in.tftpd</span><br><span class="line">    server_args     = /srv/tftp</span><br><span class="line">    <span class="built_in">disable</span>         = no</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>create folder to store tftp files:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir /srv/tftp</span><br><span class="line">sudo chmod -R 777 /srv/tftp</span><br><span class="line">sudo chown -R nobody /srv/tftp</span><br></pre></td></tr></table></figure>

<p>restart tftpd by xinetd:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /etc/init.d/xinetd restart</span><br></pre></td></tr></table></figure>

<p>copy device trees/kernel image to tftp folder:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp Image /srv/tftp</span><br><span class="line">cp Image-fsl-imx8mq-evk.dtb /srv/tftp/fsl-imx8mq-evk.dtb</span><br></pre></td></tr></table></figure>

<h2 id="NFS"><a href="#NFS" class="headerlink" title="NFS"></a>NFS</h2><h3 id="Install-necessary-tools-1"><a href="#Install-necessary-tools-1" class="headerlink" title="Install necessary tools"></a>Install necessary tools</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install nfs-kernel-server nfs-common portmap</span><br></pre></td></tr></table></figure>

<h3 id="Setup-NFS"><a href="#Setup-NFS" class="headerlink" title="Setup NFS"></a>Setup NFS</h3><p>Add below line at end of <em>/etc/exports</em></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;home&#x2F; *(rw,insecure,no_root_squash,no_subtree_check)</span><br></pre></td></tr></table></figure>

<p>restart nfs server:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /etc/init.d/nfs-kernel-server restart</span><br></pre></td></tr></table></figure>
<p>create copy of your rootfs:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">mkdir imx8-evk-dummy</span><br><span class="line"><span class="comment"># goto your yocto image build dir, i.e. imx-yocto-bsp/imx8mmevk_build/tmp/work/imx8mmevk-poky-linux/fsl-image-validation-imx/1.0-r0</span></span><br><span class="line"><span class="built_in">cd</span> &lt;your_yocto_image_build_folder&gt;</span><br><span class="line">cp -r rootfs ~/imx8-evk-dummy</span><br></pre></td></tr></table></figure>

<p><span style="color:red">Notice:</span> Seems long path of rootfs will cause rootfs mounting error, suggest copy your rootfs to a short path</p>
<h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Interrupt board booting up then type into u-boot terminal:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setenv nfsroot &lt;path-to-your-rootfs&gt;</span><br><span class="line">setenv image &lt;kernel-image-name-in-tftp-folder&gt;</span><br><span class="line">setenv fdt_file &lt;devid-tree-file-name-in-tftp-folder&gt;</span><br><span class="line">setenv serverip &lt;pc-ip-address&gt;</span><br><span class="line">setenv bootcmd &#39;run netboot&#39;</span><br><span class="line">sav</span><br><span class="line">reset</span><br></pre></td></tr></table></figure>

<p>i.e.:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setenv nfsroot &#x2F;home&#x2F;alex&#x2F;imx8-evk-dummy&#x2F;rootfs</span><br><span class="line">setenv image Image</span><br><span class="line">setenv fdt_file fsl-imx8mm-evk.dtb</span><br><span class="line">setenv serverip 10.0.1.17</span><br><span class="line">setenv bootcmd &#39;run netboot&#39;</span><br><span class="line">sav</span><br><span class="line">reset</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>makefile summarize</title>
    <url>/2018-06-05/makefile-summarize/</url>
    <content><![CDATA[<p>  …</p>
<a id="more"></a>

<h2 id="Variable-Assignment-变量赋值"><a href="#Variable-Assignment-变量赋值" class="headerlink" title="Variable Assignment(变量赋值)"></a>Variable Assignment(变量赋值)</h2><h3 id="comparison-of-“-“-“-“-“-“-and-“-“"><a href="#comparison-of-“-“-“-“-“-“-and-“-“" class="headerlink" title="comparison of “=“, “:=“ , “?=“ and “+=“"></a>comparison of “<strong>=</strong>“, “<strong>:=</strong>“ , “<strong>?=</strong>“ and “<strong>+=</strong>“</h3><h4 id="“-“"><a href="#“-“" class="headerlink" title="“=“"></a>“<strong>=</strong>“</h4><p>Variables defined with ‘=’ are recursively expanded variables. It means that value of this variable will be the last value gived by ‘=’ in makefile. For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">a = foo</span><br><span class="line">b = <span class="variable">$(a)</span> abc</span><br><span class="line">a = oof</span><br></pre></td></tr></table></figure>
<p>In this case, the value of <strong>b</strong> will be <strong>oof abc</strong>.</p>
<h4 id="“-“-1"><a href="#“-“-1" class="headerlink" title="“:=“"></a>“<strong>:=</strong>“</h4><p>Variables defined with ‘:=’ are simply expanded variables. Just like “<strong>=</strong>“ in other language(C/C++/C#/Java). For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">a := foo</span><br><span class="line">b := <span class="variable">$(a)</span> abc</span><br><span class="line">a := oof</span><br></pre></td></tr></table></figure>
<p>In this case, the value of <strong>b</strong> will be <strong>foo abc</strong>.</p>
<h4 id="“-“-2"><a href="#“-“-2" class="headerlink" title="“?=“"></a>“<strong>?=</strong>“</h4><p>We can use ‘?=’ to set a value to a variable only if this variable is not set yet. For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">a ?= foo</span><br></pre></td></tr></table></figure>
<p>It is similar to:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(<span class="built_in">origin</span> a)</span>, undefined)</span><br><span class="line">a = bar</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<h4 id="“-“-3"><a href="#“-“-3" class="headerlink" title="“+=“"></a>“<strong>+=</strong>“</h4><p>‘+=’ is using for appending text. It will appending a <strong>space</strong> between two text.For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">a = first</span><br><span class="line">a += second</span><br></pre></td></tr></table></figure>
<p>In this case, the value of <strong>a</strong> will be <strong>first second</strong>.</p>
<h2 id="Useful-Makefile-Functions"><a href="#Useful-Makefile-Functions" class="headerlink" title="Useful Makefile Functions"></a>Useful Makefile Functions</h2><p>  In makefile, functions should be called like this:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">var = <span class="variable">$(functionname arg1,arg2,arg3...)</span></span><br></pre></td></tr></table></figure>

<h3 id="wildcard"><a href="#wildcard" class="headerlink" title="wildcard"></a>wildcard</h3><p><strong>wildcard</strong> will help you get specific file name list in a dir.For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">SRC_DIR := src</span><br><span class="line">SOURCES := <span class="variable">$(<span class="built_in">wildcard</span> <span class="variable">$(SRC_DIR)</span>/*.cpp)</span></span><br></pre></td></tr></table></figure>
<p>In this case, SUORCES will be set like this(if *.cpp exists in SRC_DIR):</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">src/a.cpp src/b.cpp src/c.cpp</span><br></pre></td></tr></table></figure>
<h3 id="addprefix"><a href="#addprefix" class="headerlink" title="addprefix"></a>addprefix</h3><p><strong>addprefix</strong> is using for add one value to the front of another value. For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">a = <span class="variable">$(<span class="built_in">addsuffix</span> .o,foo bar)</span></span><br></pre></td></tr></table></figure>
<p><strong>a</strong> will be set as ‘<strong>foo.o bar.o</strong>‘</p>
<h3 id="patsubst"><a href="#patsubst" class="headerlink" title="patsubst"></a>patsubst</h3><p><strong>$(patsubst pattern,replacement,text)</strong>:Finds whitespace-separated words in text that match pattern and replaces them with replacement(<a href="https://www.gnu.org/software/make/manual/html_node/Text-Functions.html#index-_0025_002c-quoting-in-patsubst" target="_blank" rel="noopener">gnu.org</a>)<br>For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">a = <span class="variable">$(<span class="built_in">patsubst</span> %.cpp,%.o,a.cpp b.h c.cpp)</span></span><br></pre></td></tr></table></figure>
<p><strong>a</strong> will be set as ‘<strong>a.o b.h c.o</strong>‘</p>
<h3 id="notdir"><a href="#notdir" class="headerlink" title="notdir"></a>notdir</h3><p><strong>$(notdir names…)</strong>:remove dir in names.For example:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">a = <span class="variable">$(<span class="built_in">notdir</span> src/foo.c src/bar.c)</span></span><br></pre></td></tr></table></figure>
<p><strong>a</strong> will be set as ‘<strong>foo.c bar.c</strong>‘</p>
<h3 id="Using-those-functions-to-genreate-o-file-and-exec-files-in-specific-dir"><a href="#Using-those-functions-to-genreate-o-file-and-exec-files-in-specific-dir" class="headerlink" title="Using those functions to genreate *.o file and exec files in specific dir"></a>Using those functions to genreate *.o file and exec files in specific dir</h3><figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">SRC_DIR:=src</span><br><span class="line">OBJ_DIR:=obj</span><br><span class="line">OUT_DIR:=out</span><br><span class="line">SOURCES:=<span class="variable">$(<span class="built_in">wildcard</span> <span class="variable">$(SRC_DIR)</span>/*.cpp)</span></span><br><span class="line">OBJECTS:=<span class="variable">$(<span class="built_in">addprefix</span> <span class="variable">$(OBJ_DIR)</span>/,$(<span class="built_in">patsubst</span> %.cpp,%.o,$(<span class="built_in">notdir</span> <span class="variable">$(SOURCES)</span>)</span>))</span><br></pre></td></tr></table></figure>

<h2 id="Phony-Targets-伪目标"><a href="#Phony-Targets-伪目标" class="headerlink" title="Phony Targets(伪目标)"></a>Phony Targets(伪目标)</h2><p>If we have a recipe :</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -rf <span class="variable">$(OBJ_DIR)</span> <span class="variable">$(OUT_DIR)</span></span><br></pre></td></tr></table></figure>
<p>It will works well until one day you add one file called <strong>clean</strong>. In this case, you need add .PHONY:</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">.PHONY</span>:clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	rm -rf <span class="variable">$(OBJ_DIR)</span> <span class="variable">$(OUT_DIR)</span></span><br></pre></td></tr></table></figure>
<p>If we do this, ‘make clean’ will run the recipe regardless of whether there is a file named clean.</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>makefile</tag>
      </tags>
  </entry>
  <entry>
    <title>make: warning: Clock skew detected</title>
    <url>/2018-05-24/make-warning-Clock-skew-detected/</url>
    <content><![CDATA[<p>Sometimes <strong>make</strong> will output warning like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">make: warning:  Clock skew detected.  Your build may be incomplete.</span><br></pre></td></tr></table></figure>

<p>It was caused by file time-stamps are ahead of clients’ clock.</p>
<a id="more"></a>

<p>It can be fixed by update time-stamps:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">find . -<span class="built_in">exec</span> touch &#123;&#125; \;</span><br></pre></td></tr></table></figure>
<p>Then <strong>make clean</strong> and <strong>make</strong> again</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Makefile</tag>
      </tags>
  </entry>
  <entry>
    <title>vscode settings for zephyr</title>
    <url>/2019-11-10/vscode-settings-for-zephyr/</url>
    <content><![CDATA[<p>This is an example <a href="https://code.visualstudio.com/" target="_blank" rel="noopener">vscode</a> settings to provide supports for <a href="https://zephyrproject.org/" target="_blank" rel="noopener">zephyr</a> based projects build/debug:</p>
<p><a href="https://github.com/codingspirit/vscode-zephyr" target="_blank" rel="noopener">vscode-zepjyr</a></p>
<p>I’m not planing to discuss details about those json files here since I know you lazy guys just want to know how to use it(Or maybe I’m too lazy to write those details down, who knows).</p>
<a id="more"></a>

<h2 id="Quick-start"><a href="#Quick-start" class="headerlink" title="Quick start"></a>Quick start</h2><ul>
<li>Copy this <em>.vscode</em> folder into your project root folder.</li>
<li>Modify the environment variables at the end of <em>task.json</em> and <em>launch.json</em> base on your own settings:<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">//task.json</span></span><br><span class="line">"options": &#123;</span><br><span class="line">    "env": &#123;</span><br><span class="line">        "ZEPHYR_TOOLCHAIN_VARIANT": "zephyr",</span><br><span class="line">        "ZEPHYR_SDK_INSTALL_DIR": "/home/alex/zephyr-sdk-0.10.3",</span><br><span class="line">        "ZEPHYR_BASE": "$&#123;workspaceFolder&#125;/zephyrproject/zephyr",</span><br><span class="line">        "VS_CODE_BOARD_TO_BUILD": "reel_board",</span><br><span class="line">        "VS_CODE_ZEPHYR_BIN_NAME": "zephyr.elf",</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">    <span class="comment">//launch.json</span></span><br><span class="line">            "miDebuggerPath": "/home/alex/zephyr-sdk-0.10.3/arm-zephyr-eabi/bin/arm-zephyr-eabi-gdb"</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Press <strong>Ctrl+Shit+B</strong> to trigger build task(You also can run task “<strong>zephyr build ninja</strong>“ alternatively if you want to use <strong>ninja</strong> to build).</li>
<li>Press the holy <strong>F5</strong> button(which is on the right side of the <strong>F4</strong> button) to start debugging.</li>
<li>An selecting list will jump out when terminated debug process, don’t forget to select it.</li>
</ul>
<h2 id="Known-issues"><a href="#Known-issues" class="headerlink" title="Known issues"></a>Known issues</h2><ul>
<li><p>An exception will occur when stop at <strong>main()</strong>. Not sure where the root cause is, but debug process still can proceed, just ignore it.</p>
</li>
<li><p>Breakpoints can’t be added into some lines but you can run code step by step to those lines. Disable zephyr build optimization doesn’t help on this, it might related to zephyr toolchain.</p>
</li>
</ul>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>nfsroot boot crash after systemd-networkd starts</title>
    <url>/2020-03-08/nfsroot-boot-crash-after-systemd-networkd-starts/</url>
    <content><![CDATA[<p>Yesterday we found that nfsroot will get crash after systemd-networkd starts:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nfs: server 192.168.0.101 not responding, still trying</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h2 id="Root-cause"><a href="#Root-cause" class="headerlink" title="Root cause"></a>Root cause</h2><p>Crash was happened after we importing <em>eth.network</em> for systemd-networkd, which will set ethernet as DHCP mode after system booting. We doubting that this setting will release the IP we set when boards was mounting nfsroot.</p>
<h2 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h2><p>As far as I know there are two solutions to avoid systemd-networkd breaking nfs connection:</p>
<ul>
<li><strong>KernelCommandLine=!nfsroot</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Match]</span><br><span class="line">Name&#x3D;eth0</span><br><span class="line">KernelCommandLine&#x3D;!nfsroot</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">DHCP&#x3D;ipv4</span><br></pre></td></tr></table></figure>

<p>According to Linux manual page:</p>
<blockquote>
<pre><code>KernelCommandLine=
    Checks whether a specific kernel command line option is set (or
    if prefixed with the exclamation mark unset). See
    &quot;ConditionKernelCommandLine=&quot; in systemd.unit(5) for details.</code></pre></blockquote>
<p>So <strong>KernelCommandLine=!nfsroot</strong> will prevent this config to be applied if we have set nfsroot in kernel command line.</p>
<ul>
<li><strong>CriticalConnection=true</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Match]</span><br><span class="line">Name&#x3D;eth0</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">DHCP&#x3D;ipv4</span><br><span class="line"></span><br><span class="line">[DHCP]</span><br><span class="line">CriticalConnection&#x3D;true</span><br></pre></td></tr></table></figure>

<p>According to Linux manual page:</p>
<blockquote>
<pre><code>CriticalConnection=
   When true, the connection will never be torn down even if the
   DHCP lease expires. This is contrary to the DHCP specification,
   but may be the best choice if, say, the root filesystem relies on
   this connection. Defaults to false.</code></pre></blockquote>
<p>So with <strong>CriticalConnection=true</strong> the connection will not be dropped, which prevent nfs from disconnecting as well.</p>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>使用@IntDef替代Enum</title>
    <url>/2017-11-27/%E4%BD%BF%E7%94%A8-IntDef%E6%9B%BF%E4%BB%A3Enum/</url>
    <content><![CDATA[<p>  <a href="https://developer.android.com/topic/performance/memory.html#Overhead" target="_blank" rel="noopener">有篇Android官方文档</a>提到：”For example, enums often require more than twice as much memory as static constants. You should strictly avoid using enums on Android.” 于是我们使用自定义annotation来代替Enum。</p>
<a id="more"></a>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="meta">@IntDef</span>(&#123;RATE_120HZ, RATE_64HZ, RATE_32HZ, RATE_16HZ, RATE_8HZ, RATE_4HZ, RATE_2HZ, RATE_1HZ&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SamplingRate &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_120HZ = <span class="number">0b0000</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_64HZ  = <span class="number">0b0001</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_32HZ  = <span class="number">0b0010</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_16HZ  = <span class="number">0b0011</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_8HZ   = <span class="number">0b0100</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_4HZ   = <span class="number">0b0101</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_2HZ   = <span class="number">0b0110</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RATE_1HZ   = <span class="number">0b0111</span>;</span><br></pre></td></tr></table></figure>
<p>@Retention 表示在什么级别保存该注解信息。可选的 RetentionPolicy 参数包括：<br>    RetentionPolicy.SOURCE 注解将被编译器丢弃<br>    RetentionPolicy.CLASS 注解在class文件中可用，但会被VM丢弃<br>    RetentionPolicy.RUNTIME VM将在运行期也保留注释，因此可以通过反射机制读取注解的信息。<br>@IntDef内输入原来的枚举变量，最后使用@interface声明注解名称。当需要使用时：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SamplingRate</span> <span class="keyword">int</span> rate = RATE_64HZ;</span><br></pre></td></tr></table></figure>
<p>真是不方便啊。。。</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>使用Gparted扩展分区</title>
    <url>/2018-01-03/%E4%BD%BF%E7%94%A8Gparted%E6%89%A9%E5%B1%95%E5%88%86%E5%8C%BA/</url>
    <content><![CDATA[<p>  前段时间跑机器学习，使用docker下了几个tensorflow的镜像，突然发现磁盘不够用了。相关的命令行不太熟，就想找找是不是有类似于分区精灵的带GUI的分区工具，还真找到一个Gparted。</p>
<a id="more"></a>
<p>  首先安装Gparted，然后运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># apt-get install gparted</span></span><br><span class="line"><span class="comment"># gparted</span></span><br></pre></td></tr></table></figure>
<p>  如果是Ubuntu 17.10或以上版本，可能会报错：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># gparted</span></span><br><span class="line">Created symlink /run/systemd/system/-.mount → /dev/null.</span><br><span class="line">Created symlink /run/systemd/system/run-user-1000.mount → /dev/null.</span><br><span class="line">Created symlink /run/systemd/system/run-user-121.mount → /dev/null.</span><br><span class="line">Created symlink /run/systemd/system/run-vmblock\x2dfuse.mount → /dev/null.</span><br><span class="line">Created symlink /run/systemd/system/tmp.mount → /dev/null.</span><br><span class="line">Created symlink /run/systemd/system/var-lib-docker-overlay2.mount → /dev/null.</span><br><span class="line">Created symlink /run/systemd/system/var-lib-docker-plugins.mount → /dev/null.</span><br><span class="line">No protocol specified</span><br><span class="line"></span><br><span class="line">(gpartedbin:3041): Gtk-WARNING **: cannot open display: :0</span><br><span class="line">Removed /run/systemd/system/-.mount.</span><br><span class="line">Removed /run/systemd/system/run-user-1000.mount.</span><br><span class="line">Removed /run/systemd/system/run-user-121.mount.</span><br><span class="line">Removed /run/systemd/system/run-vmblock\x2dfuse.mount.</span><br><span class="line">Removed /run/systemd/system/tmp.mount.</span><br><span class="line">Removed /run/systemd/system/var-lib-docker-overlay2.mount.</span><br><span class="line">Removed /run/systemd/system/var-lib-docker-plugins.mount.</span><br></pre></td></tr></table></figure>
<p>  google了一下，原因是应用没有完全支持Wayland。但是有workaround:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ xhost +SI:localuser:root</span><br></pre></td></tr></table></figure>
<p>  之后就可以正常运行了。首先将当前分区扩容。之后添加一个扩展分区，再在扩展分区下添加linux-swap。最后别忘了应用修改。<br>  <img src="/2018-01-03/%E4%BD%BF%E7%94%A8Gparted%E6%89%A9%E5%B1%95%E5%88%86%E5%8C%BA/gparted.png" alt></p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>使用TensorFlow训练自己的语音识别AI</title>
    <url>/2018-01-11/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%ABAI/</url>
    <content><![CDATA[<p>  这次来训练一个基于CNN的语音识别模型。训练完成后，我们将尝试将此模型用于Hotword detection。</p>
<a id="more"></a>
<p>  人类是怎样听懂一句话的呢？以汉语为例，当听到“wo shi”的录音时，我们会想，有哪两个字是读作“wo shi”的，有人想到的是“我是”，也有人觉得是“我市”。<br>我们可以通过”wo shi”的频率的特征，匹配到一些结果，我们这次要训练的模型，也是基于频率特征的CNN模型。单纯的基于频率特征的识别有很大的局限性，比如前面提到的例子，光是听到“wo shi”可能会导致产生歧义，但是如果能有上下文，我们就可以大大提高“识别”的成功率。因此，类似Google Assistant那样的识别，不光是考虑到字词的发音，还联系了语义，就算有一两个字发音不清，我们还是能得到正确的信息。<br>但是基于频率特征的模型用作Hotword detection还是比较合适的，因为Horword通常是一两个特定的词，不需要联系语境进行语义分析。</p>
<h2 id="准备训练数据集"><a href="#准备训练数据集" class="headerlink" title="准备训练数据集"></a>准备训练数据集</h2><p>  开源的语言数据集比较少，这里我们使用TensorFlow和AIY团队推出的一个数据集，包含30个基本的英文单词的大量录音：<br><a href="https://download.tensorflow.org/data/speech_commands_v0.01.tar.gz" target="_blank" rel="noopener">下载地址</a><br>这个数据集只有1G多，非常小的语音数据集，不过用来实验是完全够的。</p>
<h2 id="运行docker并挂载工作目录"><a href="#运行docker并挂载工作目录" class="headerlink" title="运行docker并挂载工作目录"></a>运行docker并挂载工作目录</h2><p>新建一个speech_train文件夹，并在其中创建子文件夹dataset,logs,train,它们将用于存放数据集，log和训练文件。解压数据集到dataset，然后运行docker：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -it -v $(<span class="built_in">pwd</span>)/speech_train:/speech_train \</span><br><span class="line">  gcr.io/tensorflow/tensorflow:latest-devel</span><br></pre></td></tr></table></figure>
<h2 id="使用默认的conv模型开始训练"><a href="#使用默认的conv模型开始训练" class="headerlink" title="使用默认的conv模型开始训练"></a>使用默认的conv模型开始训练</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tensorflow/</span><br><span class="line">python tensorflow/examples/speech_commands/train.py \</span><br><span class="line">--data_dir=/speech_train/dataset/ \</span><br><span class="line">--summaries_dir=/speech_train/logs/ \</span><br><span class="line">--train_dir=/speech_train/train/ \</span><br><span class="line">--wanted_words=one,two,three,four,five,marvin</span><br></pre></td></tr></table></figure>
<p>在这里我们指定希望识别的label: one,two,three,four,five,marvin。数据集的其他部分将被归为<em>unknown</em></p>
<h2 id="使用TensorBoard使训练可视化"><a href="#使用TensorBoard使训练可视化" class="headerlink" title="使用TensorBoard使训练可视化"></a>使用TensorBoard使训练可视化</h2><p>我们可以通过分析生成的log使训练过程可视化：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tensorboard --logdir /speech_train/logs</span><br></pre></td></tr></table></figure>
<p>运行指令后，可以通过浏览器访问本地的6006端口进入TensorBoard。下图是使用conv模型完成18000 steps 训练的过程图：<br><img src="/2018-01-11/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%ABAI/2018-01-16-08-48-12.png" alt><br>训练花了差不多15个小时。</p>
<h2 id="生成pb文件"><a href="#生成pb文件" class="headerlink" title="生成pb文件"></a>生成pb文件</h2><p>训练完成后，我们需要将其转化为pb文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python tensorflow/examples/speech_commands/freeze.py \</span><br><span class="line">--start_checkpoint=/speech_train/train/conv.ckpt-18000 \</span><br><span class="line">--output_file=/speech_train/conv.pb \</span><br><span class="line">--wanted_words=one,two,three,four,five,marvin</span><br></pre></td></tr></table></figure>
<p>完成后，我们将得到一个名为conv.pb的文件，配合包含可识别label的txt文件就可以直接使用了。</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>使用测试脚本进行测试：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python tensorflow/examples/speech_commands/label_wav.py \</span><br><span class="line">--graph=/speech_train/conv.pb \</span><br><span class="line">--labels=/speech_train/conv_labels.txt \</span><br><span class="line">--wav=/speech_train/dataset/marvin/0b40aa8e_nohash_0.wav</span><br></pre></td></tr></table></figure>
<p>训练的模型应能正确识别出marvin。</p>
<h2 id="使用准确度较低但是预测更快的low-latency-conv模型"><a href="#使用准确度较低但是预测更快的low-latency-conv模型" class="headerlink" title="使用准确度较低但是预测更快的low_latency_conv模型"></a>使用准确度较低但是预测更快的low_latency_conv模型</h2><p>  我们可以使用另外一种准确度较低但是预测更快的low_latency_conv模型进行训练：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python tensorflow/examples/speech_commands/train.py \</span><br><span class="line">--data_dir=/speech_train/dataset/ \</span><br><span class="line">--summaries_dir=/speech_train/logs/ \</span><br><span class="line">--train_dir=/speech_train/train/ \</span><br><span class="line">--model_architecture=low_latency_conv \</span><br><span class="line">--how_many_training_steps=20000,6000 \</span><br><span class="line">--learning_rate=0.01,0.001 \</span><br><span class="line">--wanted_words=one,two,three,four,marvin,wow</span><br></pre></td></tr></table></figure>
<p>当使用该模型时，可以适当增加training steps和learning rate。在这种情况下，训练的时间大大缩短了：<br><img src="/2018-01-11/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%ABAI/2018-01-12-08-57-07.png" alt><br>只花了不到3小时.</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>也可以使用gpu版本的tensorflow进行训练，速度可以提升不少哦。</p>
]]></content>
      <categories>
        <category>机器学习</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>TensorFlow</tag>
      </tags>
  </entry>
  <entry>
    <title>使用qemu运行Linux-kernel</title>
    <url>/2017-11-12/%E4%BD%BF%E7%94%A8qemu%E8%BF%90%E8%A1%8CLinux-kernel/</url>
    <content><![CDATA[<p>之前想买块MTK的开发板，结果根本没有卖。。。 树莓派今年又不会出4，于是想用qemu边学边玩。</p>
<a id="more"></a>
<p>宿主OS：Ubuntu 17.04</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>由于某些众所周知的原因，访问一些国外的服务器非常慢，因此推荐使用国内的镜像，我这里用的是阿里的：<br><img src="/2017-11-12/%E4%BD%BF%E7%94%A8qemu%E8%BF%90%E8%A1%8CLinux-kernel/a.png" alt><br>换完更新源后，个人习惯装一个vim：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install vim</span><br></pre></td></tr></table></figure>
<h2 id="安装arm交叉编译链"><a href="#安装arm交叉编译链" class="headerlink" title="安装arm交叉编译链"></a>安装arm交叉编译链</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install gcc-arm-linux-gnueabi</span><br></pre></td></tr></table></figure>
<p>也可以装一个arm-linux-gnueabihf，如果硬件带fpu，可以使用该工具。</p>
<h2 id="安装qemu"><a href="#安装qemu" class="headerlink" title="安装qemu"></a>安装qemu</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install qemu</span><br></pre></td></tr></table></figure>
<h2 id="下载Linux-kernal并编译"><a href="#下载Linux-kernal并编译" class="headerlink" title="下载Linux kernal并编译"></a>下载Linux kernal并编译</h2><p>从<a href="https://www.kernel.org/" target="_blank" rel="noopener">kernel.org</a>下载源码包。下载完成后解包到任意目录。cd过去后，使用vim新建一个build脚本build.sh,内容如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span>  ARCH=arm </span><br><span class="line"><span class="built_in">export</span> CROSS_COMPILE=arm-linux-gnueabi- </span><br><span class="line">make vexpress_defconfig</span><br><span class="line">make zImage -j8</span><br><span class="line">make modules -j8</span><br><span class="line">make dtbs</span><br><span class="line">mkdir extra_folder</span><br><span class="line">cp arch/arm/boot/zImage extra_folder/</span><br><span class="line">cp arch/arm/boot/dts/*ca9.dtb extra_folder/</span><br><span class="line">cp .config extra_folder/</span><br></pre></td></tr></table></figure>
<p>运行脚本会使用arm-linux-gnueabi进行编译，并把生成的zImage和dtb文件copy到extra_folder（不然的话每次都手动copy好累。。）</p>
<h2 id="下载busybox"><a href="#下载busybox" class="headerlink" title="下载busybox"></a>下载busybox</h2><p>busybox能够提供一些基本的指令，如umount,sh,vi等等。在<a href="https://busybox.net/" target="_blank" rel="noopener">busybox.net</a>下载源代码包，当然使用wget或者git clone也是可以的。解包后，cd到代码目录，再写一个build.sh：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make defconfig</span><br><span class="line">make CROSS_COMPILE=arm-linux-gnueabi-</span><br><span class="line">make install CROSS_COMPILE=arm-linux-gnueabi-</span><br></pre></td></tr></table></figure>
<p>运行脚本将在该目录下生成一个_install文件夹。</p>
<h2 id="制作根文件系统和镜像"><a href="#制作根文件系统和镜像" class="headerlink" title="制作根文件系统和镜像"></a>制作根文件系统和镜像</h2><h3 id="创建rootfs"><a href="#创建rootfs" class="headerlink" title="创建rootfs"></a>创建rootfs</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir rootfs</span><br><span class="line">sudo mkdir rootfs/lib</span><br></pre></td></tr></table></figure>
<h3 id="复制busybox命令"><a href="#复制busybox命令" class="headerlink" title="复制busybox命令"></a>复制busybox命令</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp _install/* -r rootfs/</span><br></pre></td></tr></table></figure>
<h3 id="复制运行库"><a href="#复制运行库" class="headerlink" title="复制运行库"></a>复制运行库</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp -P /usr/arm-linux-gnueabi/lib/* rootfs/lib/</span><br></pre></td></tr></table></figure>
<h3 id="创建字符设备用于测试"><a href="#创建字符设备用于测试" class="headerlink" title="创建字符设备用于测试"></a>创建字符设备用于测试</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p rootfs/dev</span><br><span class="line">sudo mknod rootfs/dev/tty1 c 4 1</span><br><span class="line">sudo mknod rootfs/dev/tty2 c 4 2</span><br><span class="line">sudo mknod rootfs/dev/tty2 c 4 3</span><br><span class="line">sudo mknod rootfs/dev/tty2 c 4 4</span><br></pre></td></tr></table></figure>
<p>c：字符型<br>4：主设备号<br>1，2：次设备号</p>
<h3 id="生成镜像并格式化生成ext3文件系统"><a href="#生成镜像并格式化生成ext3文件系统" class="headerlink" title="生成镜像并格式化生成ext3文件系统"></a>生成镜像并格式化生成ext3文件系统</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dd <span class="keyword">if</span>=/dev/zero of=a9rootfs.ext3 bs=1M count=32</span><br><span class="line">mkfs.ext3 a9rootfs.ext3</span><br></pre></td></tr></table></figure>
<h3 id="复制文件到镜像中"><a href="#复制文件到镜像中" class="headerlink" title="复制文件到镜像中"></a>复制文件到镜像中</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir tmpfs</span><br><span class="line">sudo mount -t ext3 a9rootfs.ext3 tmpfs/ -o loop</span><br><span class="line">sudo cp -r rootfs/*  tmpfs/</span><br><span class="line">sudo umount tmpfs</span><br></pre></td></tr></table></figure>
<h2 id="启动qemu并运行系统"><a href="#启动qemu并运行系统" class="headerlink" title="启动qemu并运行系统"></a>启动qemu并运行系统</h2><p>写一个runOS.sh并运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">qemu-system-arm -M vexpress-a9 -m 256M -dtb extra_folder/vexpress-v2p-ca9.dtb -kernel extra_folder/zImage -append <span class="string">"root=/dev/mmcblk0 rw"</span> -sd a9rootfs.ext3</span><br></pre></td></tr></table></figure>
<p><img src="/2017-11-12/%E4%BD%BF%E7%94%A8qemu%E8%BF%90%E8%A1%8CLinux-kernel/b.png" alt><br>然后熟悉的企鹅出现了!<br><img src="/2017-11-12/%E4%BD%BF%E7%94%A8qemu%E8%BF%90%E8%A1%8CLinux-kernel/c.png" alt><br>拷个hello world试一下:<br><img src="/2017-11-12/%E4%BD%BF%E7%94%A8qemu%E8%BF%90%E8%A1%8CLinux-kernel/d.png" alt></p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>关闭程序窗口后仍有线程残留的解决办法</title>
    <url>/2017-11-07/%E5%85%B3%E9%97%AD%E7%A8%8B%E5%BA%8F%E7%AA%97%E5%8F%A3%E5%90%8E%E4%BB%8D%E6%9C%89%E7%BA%BF%E7%A8%8B%E6%AE%8B%E7%95%99%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
    <content><![CDATA[<p>我原来一直喜欢用backgroundworker搞多线程，反而是Thread类使用较少。最近更新debug tool的时候使用了一些同事的代码，遇到了线程泄漏的问题。</p>
<a id="more"></a>
<p>同事的代码中使用了Thread类而且内部是一个while(true)的死循环。这导致除了thread.Abort()外似乎没有其他终止线程的方法。。。<br>但是thread.Abort()不一定能够直接杀死线程，在某些情况下，即使在formclosing中调用了thread.Abort()，关闭程序窗口后仍然有线程残留。<br>如果不想修改原来的thread方法，可以通过</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">Application.Exit();</span><br></pre></td></tr></table></figure>
<p>来退出应用程序。但是此方法并不会对后台线程和资源进行强制回收。于是用了下面这种更粗暴的方法：</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">Environment.Exit(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>问题解决。不过这次的经历再次提醒了我，最好别在Thread中写while(true)，也不要使用thread.Abort()这种不安全的方法。<br>如果实在担心出现野线程，还是使用backgroundworker吧。</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C Sharp</tag>
        <tag>多线程</tag>
      </tags>
  </entry>
  <entry>
    <title>在Android Things上使用TTS及使用Google Assistant遇到的问题</title>
    <url>/2017-12-06/%E5%9C%A8Android-Things%E4%B8%8A%E4%BD%BF%E7%94%A8TTS%E5%8F%8A%E4%BD%BF%E7%94%A8Google-Assistant%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>  智能音响有两个重要功能:“说”和“听”。在Android Things上我们可以通过TextToSpeech和Google Assistant来实现上述功能。TTS的实现比较容易，而Google Assistant就比较麻烦了，目前我遇到的问题是Google Assistant能听懂我说什么，却不能给出答案。。还是写个日志记录一下吧。</p>
<a id="more"></a>
<h2 id="TTS的实现"><a href="#TTS的实现" class="headerlink" title="TTS的实现"></a>TTS的实现</h2><p>  TTS实现起来十分容易，创建TextToSpeech并重写OnInitListener的onInit方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ttsEngine = <span class="keyword">new</span> TextToSpeech(MainActivity.<span class="keyword">this</span>, <span class="keyword">new</span> TextToSpeech.OnInitListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInit</span><span class="params">(<span class="keyword">int</span> status)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (status==TextToSpeech.SUCCESS)&#123;</span><br><span class="line">            ttsEngine.setLanguage(Locale.US);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            Log.w(TAG,<span class="string">"Can not init tts engine"</span>);</span><br><span class="line">            ttsEngine = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>再通过</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (ttsEngine != <span class="keyword">null</span>) &#123;</span><br><span class="line">    ttsEngine.speak(<span class="string">"Hi master. What can I do for you?"</span>, TextToSpeech.QUEUE_ADD, <span class="keyword">null</span>, <span class="string">"UTTERANCE_ID"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>即可实现音频输出。完整的代码已上传到github：<a href="https://github.com/codingspirit/Android_Things_TTS" target="_blank" rel="noopener">Roach</a></p>
<h2 id="Google-Assistant"><a href="#Google-Assistant" class="headerlink" title="Google Assistant"></a>Google Assistant</h2><p>  要使用Google Assistant，必须要使用Google Assistant API并创建相应的加密凭据。同时，申请的Google账号还要给予app权限以允许访问一些敏感内容。先贴张测试结果图：<br><img src="/2017-12-06/%E5%9C%A8Android-Things%E4%B8%8A%E4%BD%BF%E7%94%A8TTS%E5%8F%8A%E4%BD%BF%E7%94%A8Google-Assistant%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/1.png" alt><br>在测试中，app似乎成功上传了录音并能正确识别，但是却不能根据问题进行正确的解答，初步怀疑可能还有一些权限没有申请。</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Android Things</tag>
      </tags>
  </entry>
  <entry>
    <title>在Android Things上使用远程屏幕</title>
    <url>/2017-11-25/%E5%9C%A8Android-Things%E4%B8%8A%E4%BD%BF%E7%94%A8%E8%BF%9C%E7%A8%8B%E5%B1%8F%E5%B9%95/</url>
    <content><![CDATA[<p>当完成连接的配置后，我们可以通过Vysor在远程屏幕上显示和控制Things Device。</p>
<a id="more"></a>

<p>  1.<a href="https://chrome.google.com/webstore/detail/vysor/gidgenkbbabolejbgbpnhbimgjbffefm?utm_source=chrome-app-launcher-info-dialog" target="_blank" rel="noopener">Vysor</a>是一款基于Chrome的扩展程序，下载后在Chorme中启用。<br>  2.使用adb连接到Things<br>  3.启动Vysor并连接，第一次使用需要在Things上安装apk。<br>  4.Enjoy(还可以截图和录像哦！)</p>
<p>  <img src="/2017-11-25/%E5%9C%A8Android-Things%E4%B8%8A%E4%BD%BF%E7%94%A8%E8%BF%9C%E7%A8%8B%E5%B1%8F%E5%B9%95/screenshot-1511577772947.jpg" alt></p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Android Things</tag>
      </tags>
  </entry>
  <entry>
    <title>在Raspberry Pi上初试Android Things</title>
    <url>/2017-11-24/%E5%9C%A8Raspberry-Pi%E4%B8%8A%E5%88%9D%E8%AF%95Android-Things/</url>
    <content><![CDATA[<p>  Google推出Android Things都快一年了，现在还在preview阶段，而且现在支持的平台也很少，但是这些都无法阻挡我们试水的热情…</p>
<a id="more"></a>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>  1.Raspberry Pi 3<br>  2.HDMI cable and monitor(据说有类似于VNC的工具，但是显示分辨率有问题)<br>  3.Ethernet cable(第一次连接需要)<br>  4.Micro SD card</p>
<h2 id="生成IMAGE"><a href="#生成IMAGE" class="headerlink" title="生成IMAGE"></a>生成IMAGE</h2><p>  首先在<a href="https://partner.android.com/things/console/" target="_blank" rel="noopener">Android Things Console</a>上生成Image。新建一个product,输入Product name,选择SOM Type。之后可以添加Bundle自定义开机动画等设置，也可以直接使用Empty bundle。之后选择一个Android Things versions, Create build configuration后，可以进行在线的build和Image生成(之前据说最开始本地build用服务器级的至强cpu都要build 5个小时)，下载生成的zip file。</p>
<h2 id="烧录Image"><a href="#烧录Image" class="headerlink" title="烧录Image"></a>烧录Image</h2><p>  解压下载的zip file，解压得到使用烧录工具(比如Etcher)将iot_rpi3.img烧录至SD card。</p>
<h2 id="启动并连接设备"><a href="#启动并连接设备" class="headerlink" title="启动并连接设备"></a>启动并连接设备</h2><p>  接好HDMI和Ethernet，插入SD card就可以开机了！</p>
<p>  <img src="/2017-11-24/%E5%9C%A8Raspberry-Pi%E4%B8%8A%E5%88%9D%E8%AF%95Android-Things/1.jpg" alt></p>
<p>  接下来我们测试一下Ethernet的连接性。如果连接正常，屏幕上是会显示当前的ip地址的。使用adb尝试连接一下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">adb connect 192.168.1.66</span><br></pre></td></tr></table></figure>
<p>当你看见如下内容，表明adb连接成功：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">connected to 192.168.1.66:5555</span><br></pre></td></tr></table></figure>
<p>在连接上adb后，我们可以设置通过wifi连接以摆脱网线的束缚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">adb shell</span><br><span class="line">am startservice \</span><br><span class="line">    -n com.google.wifisetup/.WifiSetupService \</span><br><span class="line">    -a WifiSetupService.Connect \</span><br><span class="line">    -e ssid network_ssid \</span><br><span class="line">    -e passphrase network_pass \</span><br></pre></td></tr></table></figure>
<p>其中network_ssid尝试连接的wifi ssid，network_pass为密码（开放网络中该参数可以不填）。然后我们需要验证一下无线连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">logcat -d | grep Wifi</span><br></pre></td></tr></table></figure>
<p>当看见WifiWatcher: Network state changed to CONNECTED时，表明连接成功。这时可以尝试断开adb,拔掉网线,使用adb连接无线ip,连接成功后可以ping一下百度：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ping baidu.com</span><br></pre></td></tr></table></figure>
<p>如果想清除所有保存的wifi连接设置：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">am startservice \</span><br><span class="line">    -n com.google.wifisetup/.WifiSetupService \</span><br><span class="line">    -a WifiSetupService.Reset</span><br></pre></td></tr></table></figure>

<h2 id="UI-DEMO"><a href="#UI-DEMO" class="headerlink" title="UI DEMO"></a>UI DEMO</h2><p>  这里以官方的UI DEMO(om.example.androidthings.simpleui)为例，跑个带UI的app试一下。</p>
<h3 id="程序结构"><a href="#程序结构" class="headerlink" title="程序结构"></a>程序结构</h3><p>  Things工程的结构和普通Android app结构很相似，Things的更加简单。还是熟悉的AndroidManifest.xml + java + res。</p>
<p>  <img src="/2017-11-24/%E5%9C%A8Raspberry-Pi%E4%B8%8A%E5%88%9D%E8%AF%95Android-Things/2.png" alt></p>
<p>  在Manifest中声明主题、入口Activity、权限等，在layout中，Android基本的控件都有。。。总而言之，和普通Android开发相似度极高，以致于我都不想写下去了。。。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>  贴段几段代码，分析下值得注意的地方。首先import了几个在Android开发中没见过的包：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.android.things.pio.Gpio;</span><br><span class="line"><span class="keyword">import</span> com.google.android.things.pio.PeripheralManagerService;</span><br></pre></td></tr></table></figure>
<p>非常明显的things包，提供了gpio类，以及一个很重要的PeripheralManagerService. 我们通过PeripheralManager来操作外设。树莓派3的gpio name可以通过getGpioList获得，要对某个gpio进行控制，需要先openGpio(init)，然后可以通过setDirection设置io方向及初始电平，setEdgeTriggerType设置边缘触发模式(中断)，setActiveType设置高电平为true还是低电平为true，setValue来更改电平。当setActiveType(Gpio.ACTIVE_LOW)时，setValue(true)会输出低电平，反之亦然。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleUiActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = SimpleUiActivity<span class="class">.<span class="keyword">class</span>.<span class="title">getSimpleName</span>()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Gpio&gt; mGpioMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        LinearLayout gpioPinsView = (LinearLayout) findViewById(R.id.gpio_pins);</span><br><span class="line">        LayoutInflater inflater = getLayoutInflater();</span><br><span class="line">        PeripheralManagerService pioService = <span class="keyword">new</span> PeripheralManagerService();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String name : pioService.getGpioList()) &#123;</span><br><span class="line">            View child = inflater.inflate(R.layout.list_item_gpio, gpioPinsView, <span class="keyword">false</span>);</span><br><span class="line">            Switch button = (Switch) child.findViewById(R.id.gpio_switch);</span><br><span class="line">            button.setText(name);</span><br><span class="line">            gpioPinsView.addView(button);</span><br><span class="line">            Log.d(TAG, <span class="string">"Added button for GPIO: "</span> + name);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">final</span> Gpio ledPin = pioService.openGpio(name);</span><br><span class="line">                ledPin.setEdgeTriggerType(Gpio.EDGE_NONE);</span><br><span class="line">                ledPin.setActiveType(Gpio.ACTIVE_HIGH);</span><br><span class="line">                ledPin.setDirection(Gpio.DIRECTION_OUT_INITIALLY_LOW);</span><br><span class="line"></span><br><span class="line">                button.setOnCheckedChangeListener(<span class="keyword">new</span> CompoundButton.OnCheckedChangeListener() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCheckedChanged</span><span class="params">(CompoundButton buttonView, <span class="keyword">boolean</span> isChecked)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            ledPin.setValue(isChecked);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                            Log.e(TAG, <span class="string">"error toggling gpio:"</span>, e);</span><br><span class="line">                            buttonView.setOnCheckedChangeListener(<span class="keyword">null</span>);</span><br><span class="line">                            <span class="comment">// reset button to previous state.</span></span><br><span class="line">                            buttonView.setChecked(!isChecked);</span><br><span class="line">                            buttonView.setOnCheckedChangeListener(<span class="keyword">this</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                mGpioMap.put(name, ledPin);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                Log.e(TAG, <span class="string">"Error initializing GPIO: "</span> + name, e);</span><br><span class="line">                <span class="comment">// disable button</span></span><br><span class="line">                button.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Gpio&gt; entry : mGpioMap.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                entry.getValue().close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                Log.e(TAG, <span class="string">"Error closing GPIO "</span> + entry.getKey(), e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mGpioMap.clear();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><p>  <img src="/2017-11-24/%E5%9C%A8Raspberry-Pi%E4%B8%8A%E5%88%9D%E8%AF%95Android-Things/3.jpg" alt></p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Raspberry Pi</tag>
        <tag>Android Things</tag>
      </tags>
  </entry>
  <entry>
    <title>在树莓派上使用Google Assistant</title>
    <url>/2017-12-28/%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B8%8A%E4%BD%BF%E7%94%A8Google-Assistant/</url>
    <content><![CDATA[<p>前段时间尝试在树莓派上使用Google Assistant, 系统能够捕捉音频并识别，使用USB声卡也能正常工作，但使用3.5mm jack时没有音频输出。经过摸索终于有输出了！写篇post记录一下关键步骤吧！</p>
<a id="more"></a>
<p>  首先配置输入输出设备：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">audioInputDevice = findAudioDevice(AudioManager.GET_DEVICES_INPUTS, AudioDeviceInfo.TYPE_USB_DEVICE);</span><br><span class="line">audioOutputDevice = findAudioDevice(AudioManager.GET_DEVICES_OUTPUTS, AudioDeviceInfo.TYPE_BUILTIN_SPEAKER);</span><br></pre></td></tr></table></figure>
<p>此处TYPE_BUILTIN_SPEAKER即为3.5mm输出口。之前尝试TYPE_AUX_LINE、TYPE_LINE_ANALOG、TYPE_WIRED_HEADPHONES等全都不能发现设备返回null;<br>  然后生成凭据：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    userCredentials =</span><br><span class="line">            EmbeddedAssistant.generateCredentials(<span class="keyword">this</span>, R.raw.credentials);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException | JSONException e) &#123;</span><br><span class="line">    Log.e(TAG, <span class="string">"error getting user credentials"</span>, e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  最后使用mEmbeddedAssistant = new EmbeddedAssistant.Builder(), 绑定完RequestCallback、ConversationCallback、凭据、初始音量、采样率、输入输出设备就可以啦！<br>  现在的sample还有点蠢，不能使用HotWord唤醒。而且在没有前置语言处理模块的情况下，识别稍微有点慢。</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Raspberry Pi</tag>
        <tag>Android Things</tag>
      </tags>
  </entry>
  <entry>
    <title>在Windows下安装gpu版的TensorFlow</title>
    <url>/2018-01-23/%E5%9C%A8Windows%E4%B8%8B%E5%AE%89%E8%A3%85gpu%E7%89%88%E7%9A%84TensorFlow/</url>
    <content><![CDATA[<p>  使用非gpu版本的TensorFlow进行训练实在是太慢了，于是尝试在Windows下安装gpu版本的TensorFlow，写篇日志记录一下。</p>
<a id="more"></a>
<h2 id="工作环境"><a href="#工作环境" class="headerlink" title="工作环境"></a>工作环境</h2><p>  OS：Win10<br>  Python:3.5(目前TensorFlow仍不支持3.6)</p>
<h2 id="安装CUDA"><a href="#安装CUDA" class="headerlink" title="安装CUDA"></a>安装CUDA</h2><p>  首先确定想要安装的TensorFlow版本需要哪个版本的CUDA支持。我这里安装的TF版本是1.5.0，需要CUDA 9.0的支持。</p>
<h3 id="下载并安装CUDA"><a href="#下载并安装CUDA" class="headerlink" title="下载并安装CUDA"></a>下载并安装CUDA</h3><p>  前往<a href="https://developer.nvidia.com/cuda-downloads" target="_blank" rel="noopener">developer.nvidia.com</a>下载CUDA 9.0。一直下一步就行。<br>  完成之后验证一下是否已经正确安装，运行cmd：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nvcc  -V</span><br></pre></td></tr></table></figure>
<p>如果正确安装，将会显示版本信息：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Windows\system32&gt;nvcc  -V</span><br><span class="line">nvcc: NVIDIA (R) Cuda compiler driver</span><br><span class="line">Copyright (c) 2005-2017 NVIDIA Corporation</span><br><span class="line">Built on Fri_Sep__1_21:08:32_Central_Daylight_Time_2017</span><br><span class="line">Cuda compilation tools, release 9.0, V9.0.176</span><br></pre></td></tr></table></figure>
<h2 id="安装CUDNN"><a href="#安装CUDNN" class="headerlink" title="安装CUDNN"></a>安装CUDNN</h2><p>  同样需要确认需要哪个版本的CUDNN。我这里需要CUDNN 9.0。前往<a href="https://developer.nvidia.com/cuda-toolkit-archive" target="_blank" rel="noopener">developer.nvidia.com</a>下载指定版本，下载完成是一个压缩包，解压到C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v9.0</p>
<h2 id="安装TensorFlow"><a href="#安装TensorFlow" class="headerlink" title="安装TensorFlow"></a>安装TensorFlow</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install tensorflow-gpu==1.5.0</span><br></pre></td></tr></table></figure>
<p>此处使用==指定版本。另外可以在<a href="https://pypi.python.org/pypi" target="_blank" rel="noopener">pypi.python.org</a>查询到某个包的版本信息。</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line">tf.__version__</span><br><span class="line">sess = tf.Session()</span><br><span class="line">a = tf.constant(<span class="number">20</span>)</span><br><span class="line">b = tf.constant(<span class="number">99</span>)</span><br><span class="line">print(sess.run(a + b))</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Windows\system32&gt;python</span><br><span class="line">Python 3.5.4 (v3.5.4:3f56838, Aug  8 2017, 02:17:05) [MSC v.1900 64 bit (AMD64)] on win32</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import tensorflow as tf</span><br><span class="line">&gt;&gt;&gt; tf.__version__</span><br><span class="line"><span class="string">'1.5.0'</span></span><br><span class="line">&gt;&gt;&gt; sess = tf.Session()</span><br><span class="line">2018-02-05 10:21:19.674014: I C:\tf_jenkins\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\platform\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2</span><br><span class="line">2018-02-05 10:21:20.177086: I C:\tf_jenkins\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\common_runtime\gpu\gpu_device.cc:1105] Found device 0 with properties:</span><br><span class="line">name: GeForce 940MX major: 5 minor: 0 memoryClockRate(GHz): 1.2415</span><br><span class="line">pciBusID: 0000:02:00.0</span><br><span class="line">totalMemory: 2.00GiB freeMemory: 1.66GiB</span><br><span class="line">2018-02-05 10:21:20.177537: I C:\tf_jenkins\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\common_runtime\gpu\gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) -&gt; (device: 0, name: GeForce 940MX, pci bus id: 0000:02:00.0, compute capability: 5.0)</span><br><span class="line">&gt;&gt;&gt; a = tf.constant(20)</span><br><span class="line">&gt;&gt;&gt; b = tf.constant(99)</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(sess.run(a + b))</span><br><span class="line">119</span><br></pre></td></tr></table></figure>
<h2 id="如何更新"><a href="#如何更新" class="headerlink" title="如何更新"></a>如何更新</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install --upgrade tensorflow-gpu</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>机器学习</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>TensorFlow</tag>
      </tags>
  </entry>
  <entry>
    <title>现在支持HTTPS啦</title>
    <url>/2018-06-11/%E7%8E%B0%E5%9C%A8%E6%94%AF%E6%8C%81HTTPS%E5%95%A6/</url>
    <content><![CDATA[<p>从今天开始，本站支持HTTPS访问啦！</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>常用命令行字符串操作指令</title>
    <url>/2018-02-09/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[<p>不定期更新。。</p>
<a id="more"></a>

<h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>在指定文件中查找字符串：</p>
<figure class="highlight bat"><table><tr><td class="code"><pre><span class="line"><span class="built_in">findstr</span> "#define BUILD_VERSION" main.c</span><br></pre></td></tr></table></figure>
<p>将某条指令返回值的第一行存在一个名为temp的变量中：</p>
<figure class="highlight bat"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> /f "delims=" <span class="variable">%%1</span> <span class="keyword">in</span> ('<span class="built_in">findstr</span> "#define BUILD_VERSION" main.c')<span class="keyword">do</span> <span class="built_in">set</span> temp=<span class="variable">%%1</span></span><br></pre></td></tr></table></figure>
<p>将temp中”BUILD_VERSION “左侧字符替换为空字符串，然后保留到version中：</p>
<figure class="highlight bat"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> "version=%temp:*BUILD_VERSION =%"</span><br></pre></td></tr></table></figure>

<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><p>在指定文件中查找字符串：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">grep <span class="string">"#define BUILD_VERSION"</span> main.c</span><br></pre></td></tr></table></figure>
<p>将某条指令返回值的第一行存在一个名为temp的变量中：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">temp=$(grep <span class="string">"#define BUILD_VERSION"</span> main.c)</span><br></pre></td></tr></table></figure>
<p>将temp中”BUILD_VERSION “左侧字符替换为空字符串，然后保留到version中(从左到右非贪婪匹配使用#,从右到左非贪婪匹配使用%)：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">version=<span class="variable">$&#123;temp#*BUILD_VERSION &#125;</span></span><br></pre></td></tr></table></figure>
<p>3/19/2018更新：<br>判断字符串变量sw_version的长度：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$&#123;#sw_version&#125;</span>"</span> = <span class="string">"5"</span> ]; <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>读取文件某一行：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat url.txt|sed -n <span class="string">'1p'</span></span><br></pre></td></tr></table></figure>
<p>把字符串中的<code>\n</code>替换为换行:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">eol=$<span class="string">'\n'</span></span><br><span class="line">str=<span class="string">"<span class="variable">$&#123;str//\\n/$eol&#125;</span>"</span></span><br></pre></td></tr></table></figure>
<p><code>//</code>同样适用于其他替换的场合</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>常用的Regex</title>
    <url>/2017-11-01/%E5%B8%B8%E7%94%A8%E7%9A%84Regex/</url>
    <content><![CDATA[<p>当进行数据分析时，我们常使用正则表达式爬取字符串得到目标数据。（有点爬虫的感觉）</p>
<a id="more"></a>

<h2 id="目标数据为单行的情况"><a href="#目标数据为单行的情况" class="headerlink" title="目标数据为单行的情况"></a>目标数据为单行的情况</h2><p>最简单的情况，字符串可能是这样的：<br>!@#$%[mark1]data[mark2]!@#$%<br>!@#$%[mark1]data[mark2]!@#$%<br>…</p>
<p>其中“!@#$%”为一大段不关心的字符，[mark1]和[mark2]为特定字符用于标记数据。我们的目标是将这个data得到。<br>以源字符串、[mark1]和[mark2]分别为srcData、”#”、”!”为例，可以这样匹配：</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">string</span> <span class="keyword">value</span> = Regex.Match(srcData, <span class="string">"(?&lt;=#).*?(?=!)"</span>).Value;</span><br></pre></td></tr></table></figure>
<p>此段代码将对#和!之间的除\n之外的字符进行非贪婪匹配。<br>注意，由于使用了通配符”.”,如果目标数据是多行,该正则表达式将不能正确匹配。</p>
<h2 id="目标数据为多行"><a href="#目标数据为多行" class="headerlink" title="目标数据为多行"></a>目标数据为多行</h2><p>前段时间的一个项目中要求从.c文件中获得某一struct的全部成员变量，一般而言struct内部都是多行的，因此上一种方式无法正确匹配。</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">string</span> <span class="keyword">value</span> = Regex.Match(srcData, <span class="string">@"(?&lt;=[START])[\s\S]+?(?=[END])"</span>).Value;</span><br></pre></td></tr></table></figure>
<p>这种方式就比较粗暴了，直接非贪婪匹配所有字符（非空格和空格字符），所以得到的数据通常包括\r\n。</p>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C#</tag>
        <tag>Regex</tag>
      </tags>
  </entry>
  <entry>
    <title>转载：常用的正则表达式</title>
    <url>/2018-03-12/%E8%BD%AC%E8%BD%BD%EF%BC%9A%E5%B8%B8%E7%94%A8%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<p><a href="http://www.jb51.net/article/72867.htm" target="_blank" rel="noopener">原文地址</a></p>
<a id="more"></a>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">一、校验数字的表达式</span><br><span class="line"> <span class="number">1</span> 数字：^[<span class="number">0</span><span class="number">-9</span>]*$</span><br><span class="line"> <span class="number">2</span> n位的数字：^\d&#123;n&#125;$</span><br><span class="line"> <span class="number">3</span> 至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line"> <span class="number">4</span> m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line"> <span class="number">5</span> 零和非零开头的数字：^(<span class="number">0</span>|[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)$</span><br><span class="line"> <span class="number">6</span> 非零开头的最多带两位小数的数字：^([<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)+(.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$</span><br><span class="line"> <span class="number">7</span> 带<span class="number">1</span><span class="number">-2</span>位小数的正数或负数：^(\-)?\d+(\.\d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$</span><br><span class="line"> <span class="number">8</span> 正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$</span><br><span class="line"> <span class="number">9</span> 有两位小数的正实数：^[<span class="number">0</span><span class="number">-9</span>]+(.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">2</span>&#125;)?$</span><br><span class="line"><span class="number">10</span> 有<span class="number">1</span>~<span class="number">3</span>位小数的正实数：^[<span class="number">0</span><span class="number">-9</span>]+(.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;)?$</span><br><span class="line"><span class="number">11</span> 非零的正整数：^[<span class="number">1</span><span class="number">-9</span>]\d*$ 或 ^([<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)&#123;<span class="number">1</span>,<span class="number">3</span>&#125;$ 或 ^\+?[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*$</span><br><span class="line"><span class="number">12</span> 非零的负整数：^\-[<span class="number">1</span><span class="number">-9</span>][]<span class="number">0</span><span class="number">-9</span><span class="string">"*$ 或 ^-[1-9]\d*$</span></span><br><span class="line"><span class="string">13 非负整数：^\d+$ 或 ^[1-9]\d*|0$</span></span><br><span class="line"><span class="string">14 非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</span></span><br><span class="line"><span class="string">15 非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$</span></span><br><span class="line"><span class="string">16 非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$</span></span><br><span class="line"><span class="string">17 正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</span></span><br><span class="line"><span class="string">18 负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span></span><br><span class="line"><span class="string">19 浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</span></span><br><span class="line"><span class="string">二、校验字符的表达式</span></span><br><span class="line"><span class="string"> 1 汉字：^[\u4e00-\u9fa5]&#123;0,&#125;$</span></span><br><span class="line"><span class="string"> 2 英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]&#123;4,40&#125;$</span></span><br><span class="line"><span class="string"> 3 长度为3-20的所有字符：^.&#123;3,20&#125;$</span></span><br><span class="line"><span class="string"> 4 由26个英文字母组成的字符串：^[A-Za-z]+$</span></span><br><span class="line"><span class="string"> 5 由26个大写英文字母组成的字符串：^[A-Z]+$</span></span><br><span class="line"><span class="string"> 6 由26个小写英文字母组成的字符串：^[a-z]+$</span></span><br><span class="line"><span class="string"> 7 由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</span></span><br><span class="line"><span class="string"> 8 由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w&#123;3,20&#125;$</span></span><br><span class="line"><span class="string"> 9 中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$</span></span><br><span class="line"><span class="string">10 中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]&#123;2,20&#125;$</span></span><br><span class="line"><span class="string">11 可以输入含有^%&amp;',;=?$\"等字符：[^%&amp;',;=?$\x22]+</span></span><br><span class="line"><span class="string">12 禁止输入含有~的字符：[^~\x22]+</span></span><br><span class="line"><span class="string">三、特殊需求表达式</span></span><br><span class="line"><span class="string"> 1 Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span></span><br><span class="line"><span class="string"> 2 域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</span></span><br><span class="line"><span class="string"> 3 InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$</span></span><br><span class="line"><span class="string"> 4 手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$</span></span><br><span class="line"><span class="string"> 5 电话号码("</span>XXX-XXXXXXX<span class="string">"、"</span>XXXX-XXXXXXXX<span class="string">"、"</span>XXX-XXXXXXX<span class="string">"、"</span>XXX-XXXXXXXX<span class="string">"、"</span>XXXXXXX<span class="string">"和"</span>XXXXXXXX)：^(\(\d&#123;<span class="number">3</span>,<span class="number">4</span>&#125;-)|\d&#123;<span class="number">3.4</span>&#125;-)?\d&#123;<span class="number">7</span>,<span class="number">8</span>&#125;$ </span><br><span class="line"> <span class="number">6</span> 国内电话号码(<span class="number">0511</span><span class="number">-4405222</span>、<span class="number">021</span><span class="number">-87888822</span>)：\d&#123;<span class="number">3</span>&#125;-\d&#123;<span class="number">8</span>&#125;|\d&#123;<span class="number">4</span>&#125;-\d&#123;<span class="number">7</span>&#125;</span><br><span class="line"> <span class="number">7</span> 身份证号(<span class="number">15</span>位、<span class="number">18</span>位数字)：^\d&#123;<span class="number">15</span>&#125;|\d&#123;<span class="number">18</span>&#125;$</span><br><span class="line"> <span class="number">8</span> 短身份证号码(数字、字母x结尾)：^([<span class="number">0</span><span class="number">-9</span>])&#123;<span class="number">7</span>,<span class="number">18</span>&#125;(x|X)?$ 或 ^\d&#123;<span class="number">8</span>,<span class="number">18</span>&#125;|[<span class="number">0</span><span class="number">-9</span>x]&#123;<span class="number">8</span>,<span class="number">18</span>&#125;|[<span class="number">0</span><span class="number">-9</span>X]&#123;<span class="number">8</span>,<span class="number">18</span>&#125;?$</span><br><span class="line"> <span class="number">9</span> 帐号是否合法(字母开头，允许<span class="number">5</span><span class="number">-16</span>字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0<span class="number">-9</span>_]&#123;<span class="number">4</span>,<span class="number">15</span>&#125;$</span><br><span class="line"><span class="number">10</span> 密码(以字母开头，长度在<span class="number">6</span>~<span class="number">18</span>之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w&#123;<span class="number">5</span>,<span class="number">17</span>&#125;$</span><br><span class="line"><span class="number">11</span> 强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在<span class="number">8</span><span class="number">-10</span>之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).&#123;<span class="number">8</span>,<span class="number">10</span>&#125;$  </span><br><span class="line"><span class="number">12</span> 日期格式：^\d&#123;<span class="number">4</span>&#125;-\d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;-\d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;</span><br><span class="line"><span class="number">13</span> 一年的<span class="number">12</span>个月(<span class="number">01</span>～<span class="number">09</span>和<span class="number">1</span>～<span class="number">12</span>)：^(<span class="number">0</span>?[<span class="number">1</span><span class="number">-9</span>]|<span class="number">1</span>[<span class="number">0</span><span class="number">-2</span>])$</span><br><span class="line"><span class="number">14</span> 一个月的<span class="number">31</span>天(<span class="number">01</span>～<span class="number">09</span>和<span class="number">1</span>～<span class="number">31</span>)：^((<span class="number">0</span>?[<span class="number">1</span><span class="number">-9</span>])|((<span class="number">1</span>|<span class="number">2</span>)[<span class="number">0</span><span class="number">-9</span>])|<span class="number">30</span>|<span class="number">31</span>)$ </span><br><span class="line"><span class="number">15</span> 钱的输入格式：</span><br><span class="line"><span class="number">16</span>    <span class="number">1.</span>有四种钱的表示形式我们可以接受:<span class="string">"10000.00"</span> 和 <span class="string">"10,000.00"</span>, 和没有 <span class="string">"分"</span> 的 <span class="string">"10000"</span> 和 <span class="string">"10,000"</span>：^[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*$ </span><br><span class="line"><span class="number">17</span>    <span class="number">2.</span>这表示任意一个不以<span class="number">0</span>开头的数字,但是,这也意味着一个字符<span class="string">"0"</span>不通过,所以我们采用下面的形式：^(<span class="number">0</span>|[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)$ </span><br><span class="line"><span class="number">18</span>    <span class="number">3.</span>一个<span class="number">0</span>或者一个不以<span class="number">0</span>开头的数字.我们还可以允许开头有一个负号：^(<span class="number">0</span>|-?[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]*)$ </span><br><span class="line"><span class="number">19</span>    <span class="number">4.</span>这表示一个<span class="number">0</span>或者一个可能为负的开头不为<span class="number">0</span>的数字.让用户以<span class="number">0</span>开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[<span class="number">0</span><span class="number">-9</span>]+(.[<span class="number">0</span><span class="number">-9</span>]+)?$ </span><br><span class="line"><span class="number">20</span>    <span class="number">5.</span>必须说明的是,小数点后面至少应该有<span class="number">1</span>位数,所以<span class="string">"10."</span>是不通过的,但是 <span class="string">"10"</span> 和 <span class="string">"10.2"</span> 是通过的：^[<span class="number">0</span><span class="number">-9</span>]+(.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">2</span>&#125;)?$ </span><br><span class="line"><span class="number">21</span>    <span class="number">6.</span>这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[<span class="number">0</span><span class="number">-9</span>]+(.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$ </span><br><span class="line"><span class="number">22</span>    <span class="number">7.</span>这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;(,[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">3</span>&#125;)*(.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$ </span><br><span class="line"><span class="number">23</span>    <span class="number">8.1</span>到<span class="number">3</span>个数字,后面跟着任意个 逗号+<span class="number">3</span>个数字,逗号成为可选,而不是必须：^([<span class="number">0</span><span class="number">-9</span>]+|[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;(,[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">3</span>&#125;)*)(.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">2</span>&#125;)?$ </span><br><span class="line"><span class="number">24</span>    备注：这就是最终结果了,别忘了<span class="string">"+"</span>可以用<span class="string">"*"</span>替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</span><br><span class="line"><span class="number">25</span> xml文件：^([a-zA-Z]+-?)+[a-zA-Z0<span class="number">-9</span>]+\\.[x|X][m|M][l|L]$</span><br><span class="line"><span class="number">26</span> 中文字符的正则表达式：[\u4e00-\u9fa5]</span><br><span class="line"><span class="number">27</span> 双字节字符：[^\x00-\xff]    (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计<span class="number">2</span>，ASCII字符计<span class="number">1</span>))</span><br><span class="line"><span class="number">28</span> 空白行的正则表达式：\n\s*\r    (可以用来删除空白行)</span><br><span class="line"><span class="number">29</span> HTML标记的正则表达式：&lt;(\S*?)[^&gt;]*&gt;.*?&lt;/\<span class="number">1</span>&gt;|&lt;.*? /&gt;    (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line"><span class="number">30</span> 首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$)    (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line"><span class="number">31</span> 腾讯QQ号：[<span class="number">1</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">4</span>,&#125;    (腾讯QQ号从<span class="number">10000</span>开始)</span><br><span class="line"><span class="number">32</span> 中国邮政编码：[<span class="number">1</span><span class="number">-9</span>]\d&#123;<span class="number">5</span>&#125;(?!\d)    (中国邮政编码为<span class="number">6</span>位数字)</span><br><span class="line"><span class="number">33</span> IP地址：\d+\.\d+\.\d+\.\d+    (提取IP地址时有用)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>C Sharp</tag>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>项目总结（一）：平衡车的设计概述</title>
    <url>/2017-11-05/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%B9%B3%E8%A1%A1%E8%BD%A6%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A6%82%E8%BF%B0/</url>
    <content><![CDATA[<p>写篇post总结一下当年做平衡车的一些经验。这篇post是概述性质的，详细的软硬件设计以后有时间再写吧。</p>
<a id="more"></a>

<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>其实大二大三的时候都有参加智能车竞赛(原来叫飞思卡尔智能车竞赛，简称飞赛，后来飞思卡尔被nxp收购，改名恩智浦智能车竞赛..)，但是学院有个政策，不允许同一年既参加电子设计竞赛（简称电赛）又参加飞赛，理由是要让更多的同学有机会参加到比赛中（至少老师是这么告诉我们的），于是大二那一年做智能车做到一半就弃权参加电赛去了。不过后来我和我的小伙伴们发现，居然有些同学两个比赛都参加了，这TM就很尴尬了。。</p>
<h2 id="硬件基本架构"><a href="#硬件基本架构" class="headerlink" title="硬件基本架构"></a>硬件基本架构</h2><p>概括来讲，需要关心的是三个部份:</p>
<h3 id="1-电源"><a href="#1-电源" class="headerlink" title="1.电源"></a>1.电源</h3><p>首先稳压电路是一定会有的，我们选用了LM1117，外围电路简单，使用十分方便，可替代的LDO也不少。另外如果使用MOS管自己搭H桥，就需要boost电路了。</p>
<h3 id="2-主控部分"><a href="#2-主控部分" class="headerlink" title="2.主控部分"></a>2.主控部分</h3><p>这个部分包括MCU最小系统以及各种传感器。对于平衡车而言，陀螺仪、角度传感器和编码器、图像传感器都算是核心传感器，一个用于获取角加速度，一个获取当前角度，一个获取电机转速，最后一个当然是识别赛道啦。除此之外，我们还使用了蓝牙模块，自己写了个上位机，无线调车、实时图传简直不能再爽。</p>
<h3 id="3-驱动桥（H桥）"><a href="#3-驱动桥（H桥）" class="headerlink" title="3.驱动桥（H桥）"></a>3.驱动桥（H桥）</h3><p>平衡车是有两个电机的，而且两个电机都要求能够正反转，因此需要两个全桥，需要4片BTS7970或者8片mos。大二图方便，使用的是BTS7970，淘宝上一片二三十。。。<br>大三总裁用mos管搭了一个，效果差不多，成本却低了不少。后来我毕设要用到电机控制又自己画了一块，虽然只是双面板并且为了过大电流大面积开窗，但是花点时间优化layout还是可以把板子做得很小。大三的电路图由于硬盘挂了找不到了:( 贴个毕设搭的MOSH Layout图：</p>
<p><img src="/2017-11-05/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%B9%B3%E8%A1%A1%E8%BD%A6%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A6%82%E8%BF%B0/MOSH1.png" alt="Top" title="Top"><br><img src="/2017-11-05/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E5%B9%B3%E8%A1%A1%E8%BD%A6%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A6%82%E8%BF%B0/MOSH2.png" alt="Bottom" title="Bottom"></p>
<p>设计文件挺早的时候就上传了：<br><a href="https://github.com/codingspirit/MOS_H" target="_blank" rel="noopener">Coding Spirit:MOS_H</a></p>
<h2 id="MCU选型"><a href="#MCU选型" class="headerlink" title="MCU选型"></a>MCU选型</h2><p>大二用的是coldfire，大三用的是K60。Coldfire是freescale自己的架构，当时我们用的mcf52255, 最高80MHz，K60是Cortex-M4，最高100MHz，另外带FPU。<br>就我的个人感觉来说，K60的综合性能是要好于mcf52255的。另外coldfire资料不如k60多，这点对于初学者来说比较关键，因为从准备到参赛只有几个月的时间，从头开始学一款没接触过的架构的MCU会花掉大量时间。但是Coldfire配合Codewarrior有种STM32CUBEMX的感觉，代码生成感觉还不错。</p>
<h2 id="软件基本架构"><a href="#软件基本架构" class="headerlink" title="软件基本架构"></a>软件基本架构</h2><p>首先贴个代码：<a href="https://github.com/codingspirit/Balance_Car" target="_blank" rel="noopener">Coding Spirit:Balance_Car</a></p>
<h3 id="是否跑RTOS"><a href="#是否跑RTOS" class="headerlink" title="是否跑RTOS"></a>是否跑RTOS</h3><p>裸奔和RTOS其实都能做，但由于PID控制的周期性，使用定时器中断控制周期，进行采样、计算、输出显得非常和谐，任务不多的情况下裸奔其实更合理一点。我们也使用了这种方式，通过1ms的定时器中断进行状态机的切换。</p>
<h3 id="PID控制"><a href="#PID控制" class="headerlink" title="PID控制"></a>PID控制</h3><p>对于自动化专业的学生来说，这种控制还是蛮简单的。首先平衡车需要实现三个闭环：<br>1.角度闭环：建议使用PD控制。如果有陀螺仪的话不用计算差分，直接把Kd*陀螺仪测量值作为D项就可以了。我尝试过加入I项，要么系统滞后非常严重，要么没什么用。。。<br>2.速度闭环：建议使用PI控制。建议不加入D项的原因是系统不需要预测速度，速度是我们直接给定的，比较稳定。<br>3.转向闭环: 当时使用的是PD控制。D项来源于纵向的陀螺仪测量值，我们担心会出现转向过猛的情况，加入D负反馈限制了转向加速度，不然容易出现P参数过大时车体原地打转的<br>情况。<br>另外增量式和位置式PID的选择不用过多纠结，只有速度环有I项，积分饱和的情况很少见。不过积分限幅和输出限幅很有必要，不然车很容易撞坏。。</p>
<h3 id="上位机"><a href="#上位机" class="headerlink" title="上位机"></a>上位机</h3><p>我设计了个简陋的通信协议，并且写了两个配套的上位机，一个是初代没有图传功能，用VC++写的，V2.0就用C#写了一个可以实时传输图像的上位机，另外使用了自创的蜜汁压缩，稳定30fps哦！这里吹一波，比那些每4秒1帧的好到不知道哪里去了。但是当时着急用，代码写得很乱。。。<br>V2.0源代码在此：<a href="https://github.com/codingspirit/CarDebugger_V2.0" target="_blank" rel="noopener">Coding Spirit:Car_Debugger_V2.0</a></p>
]]></content>
      <categories>
        <category>项目总结</category>
      </categories>
      <tags>
        <tag>智能车</tag>
      </tags>
  </entry>
  <entry>
    <title>STM32MP1: NFS rootfs</title>
    <url>/2020-03-01/STM32MP1-NFS-rootfs/</url>
    <content><![CDATA[<p>Last and this weekend I spend some time on mounting NFS rootfs on STM32MP1… There are some PHY driver issues and permission issues troubled me a lot…</p>
<a id="more"></a>

<h2 id="Pre-requirements"><a href="#Pre-requirements" class="headerlink" title="Pre-requirements"></a>Pre-requirements</h2><ul>
<li><span style="color:red">nfs-kernel-server</span> has been installed on server side</li>
<li>Board and PC are in same LAN</li>
</ul>
<h2 id="Exports-settings"><a href="#Exports-settings" class="headerlink" title="Exports settings"></a>Exports settings</h2><p>Assuming that we will put board rootfs under <em>/home/alex/data/srv/nfs</em>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /etc/exports</span><br><span class="line"><span class="comment"># /etc/exports: the access control list for filesystems which may be exported</span></span><br><span class="line"><span class="comment">#		to NFS clients.  See exports(5).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv2 and NFSv3:</span></span><br><span class="line"><span class="comment"># /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv4:</span></span><br><span class="line"><span class="comment"># /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/home/alex/data/srv/nfs 192.168.0.*(rw,sync,no_subtree_check,no_root_squash)</span><br></pre></td></tr></table></figure>

<ul>
<li>Wildcard in ip address(192.168.0.*) is supported, which is helpful for multiple boards</li>
<li><span style="color:red">no_root_squash</span> will map NFS client root user as NFS server root user</li>
</ul>
<p>After modifying <em>/etc/exports</em>, we can restart nfs server and check server exports:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart nfs-kernel-server</span><br><span class="line">sudo exportfs</span><br><span class="line"></span><br><span class="line">/home/alex/data/srv/nfs</span><br><span class="line">		192.168.0.*</span><br></pre></td></tr></table></figure>

<h2 id="PXE-configuration-file"><a href="#PXE-configuration-file" class="headerlink" title="PXE configuration file"></a>PXE configuration file</h2><p>Create PXE configuration file for nfs booting. U-boot will pass chosen parameters to kernel.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">menu title Select the boot mode</span><br><span class="line"> DEFAULT eMMC</span><br><span class="line"> TIMEOUT 20</span><br><span class="line"> LABEL initramfs</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb</span><br><span class="line"> 	INITRD uInitrd</span><br><span class="line"> 	APPEND rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br><span class="line"> LABEL nfs</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb</span><br><span class="line"> 	APPEND root&#x3D;&#x2F;dev&#x2F;nfs ip&#x3D;192.168.0.102 nfsroot&#x3D;192.168.0.101:&#x2F;home&#x2F;alex&#x2F;data&#x2F;srv&#x2F;nfs,nfsvers&#x3D;3 rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br><span class="line"> LABEL sdcard</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb</span><br><span class="line"> 	APPEND root&#x3D;&#x2F;dev&#x2F;mmcblk0p6 rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br><span class="line"> LABEL eMMC</span><br><span class="line"> 	KERNEL uImage</span><br><span class="line"> 	FDT stm32mp157a-cp.dtb </span><br><span class="line"> 	APPEND root&#x3D;&#x2F;dev&#x2F;mmcblk1p6 rootwait rw earlyprintk console&#x3D;ttySTM0,115200</span><br></pre></td></tr></table></figure>

<p><strong>LABEL nfs</strong> was set for nfs rootfs:</p>
<ul>
<li><strong>root=/dev/nfs</strong> Set nfs as rootfs</li>
<li><strong>ip=192.168.0.102</strong> Set board ip address, also can be <strong>dhcp</strong></li>
<li><strong>nfsroot=192.168.0.101:/home/alex/data/srv/nfs,nfsvers=3</strong> Specify nfs server ip, rootfs dir and nfs version</li>
</ul>
<h2 id="Unpack-boards-rootfs-and-modify-permissions"><a href="#Unpack-boards-rootfs-and-modify-permissions" class="headerlink" title="Unpack boards rootfs and modify permissions"></a>Unpack boards rootfs and modify permissions</h2><p>Unpack board rootfs under the path we set at exports setting, then we need to modify permissions for some folders and files:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">TARGET_RFS_PATH=<span class="string">"/home/alex/data/srv/nfs"</span></span><br><span class="line"></span><br><span class="line">sudo chown -R <span class="variable">$&#123;USER&#125;</span> <span class="string">"<span class="variable">$&#123;TARGET_RFS_PATH&#125;</span>/var/lib/systemd"</span></span><br><span class="line">sudo chown -R <span class="variable">$&#123;USER&#125;</span> <span class="string">"<span class="variable">$&#123;TARGET_RFS_PATH&#125;</span>/var/lib/machines"</span></span><br><span class="line">suidfiles=$(sudo find <span class="variable">$&#123;TARGET_RFS_PATH&#125;</span> -perm /u=s)</span><br><span class="line"><span class="keyword">if</span> [ -n <span class="string">"<span class="variable">$suidfiles</span>"</span> ] ; <span class="keyword">then</span></span><br><span class="line">    sudo chown root:root <span class="variable">$&#123;suidfiles&#125;</span></span><br><span class="line">    sudo chmod u+s <span class="variable">$&#123;suidfiles&#125;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Reference: <a href="https://git.kontron-electronics.de/yocto-ktn/yocto-ktn/blob/master/scripts/init-remote2" target="_blank" rel="noopener">kontron-electronics</a></p>
</blockquote>
<h2 id="Booting-the-board"><a href="#Booting-the-board" class="headerlink" title="Booting the board"></a>Booting the board</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">U-Boot 2018.11-stm32mp-r3 (Nov 14 2018 - 16:10:06 +0000)</span><br><span class="line"></span><br><span class="line">CPU: STM32MP157AAA Rev.B</span><br><span class="line">Model: CP STM32MP157A Dev Board V1</span><br><span class="line">Board: stm32mp1 in basic mode (cp,stm32mp157a-cp)</span><br><span class="line">DRAM:  512 MiB</span><br><span class="line">Clocks:</span><br><span class="line">- MPU : 650 MHz</span><br><span class="line">- MCU : 208.878 MHz</span><br><span class="line">- AXI : 266.500 MHz</span><br><span class="line">- PER : 24 MHz</span><br><span class="line">- DDR : 533 MHz</span><br><span class="line">NAND:  0 MiB</span><br><span class="line">MMC:   STM32 SDMMC2: 0, STM32 SDMMC2: 1</span><br><span class="line">Loading Environment from EXT4... OK</span><br><span class="line">In:    serial</span><br><span class="line">Out:   serial</span><br><span class="line">Err:   serial</span><br><span class="line">invalid MAC address in OTP 00:00:00:00:00:00Net:   eth0: ethernet@5800a000</span><br><span class="line">Hit any key to stop autoboot:  0 </span><br><span class="line">STM32MP&gt; </span><br><span class="line">STM32MP&gt; </span><br><span class="line">STM32MP&gt; run bootcmd_pxe</span><br><span class="line">ethernet@5800a000 Waiting for PHY auto negotiation to complete. done</span><br><span class="line">BOOTP broadcast 1</span><br><span class="line">BOOTP broadcast 2</span><br><span class="line">DHCP client bound to address 192.168.0.102 (990 ms)</span><br><span class="line">missing environment variable: pxeuuid</span><br><span class="line">missing environment variable: bootfile</span><br><span class="line">Retrieving file: pxelinux.cfg&#x2F;01-e2-a4-06-a5-8f-7f</span><br><span class="line">Using ethernet@5800a000 device</span><br><span class="line">TFTP from server 192.168.0.101; our IP address is 192.168.0.102</span><br><span class="line">Filename &#39;pxelinux.cfg&#x2F;01-e2-a4-06-a5-8f-7f&#39;.</span><br><span class="line">Load address: 0xc4200000</span><br><span class="line">Loading: #</span><br><span class="line">         11.7 KiB&#x2F;s</span><br><span class="line">done</span><br><span class="line">Bytes transferred &#x3D; 658 (292 hex)</span><br><span class="line">Config file found</span><br><span class="line">Select the boot mode</span><br><span class="line">1:      initramfs</span><br><span class="line">2:      nfs</span><br><span class="line">3:      sdcard</span><br><span class="line">4:      eMMC</span><br><span class="line">Enter choice: 2</span><br><span class="line">2:      nfs</span><br><span class="line">missing environment variable: bootfile</span><br><span class="line">Retrieving file: uImage</span><br><span class="line">Using ethernet@5800a000 device</span><br><span class="line">TFTP from server 192.168.0.101; our IP address is 192.168.0.102</span><br><span class="line">Filename &#39;uImage&#39;.</span><br><span class="line">Load address: 0xc2000000</span><br><span class="line">Loading: #################################################################</span><br><span class="line">         ################################################################T #</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #####################################################T ############</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         ###################T ##############################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         #################################################################</span><br><span class="line">         ########</span><br><span class="line">         76.2 KiB&#x2F;s</span><br><span class="line">done</span><br><span class="line">Bytes transferred &#x3D; 6693440 (662240 hex)</span><br><span class="line">append: root&#x3D;&#x2F;dev&#x2F;nfs ip&#x3D;192.168.0.102 nfsrootdebug nfsroot&#x3D;192.168.0.101:&#x2F;home&#x2F;alex&#x2F;data&#x2F;srv&#x2F;nfs,nfsver0</span><br><span class="line">missing environment variable: bootfile</span><br><span class="line">Retrieving file: stm32mp157a-cp.dtb</span><br><span class="line">Using ethernet@5800a000 device</span><br><span class="line">TFTP from server 192.168.0.101; our IP address is 192.168.0.102</span><br><span class="line">Filename &#39;stm32mp157a-cp.dtb&#39;.</span><br><span class="line">Load address: 0xc4000000</span><br><span class="line">Loading: #############</span><br><span class="line">         86.9 KiB&#x2F;s</span><br><span class="line">done</span><br><span class="line">Bytes transferred &#x3D; 62891 (f5ab hex)</span><br><span class="line">## Booting kernel from Legacy Image at c2000000 ...</span><br><span class="line">   Image Name:   Linux-4.19.49</span><br><span class="line">   Created:      2019-06-09   7:17:25 UTC</span><br><span class="line">   Image Type:   ARM Linux Kernel Image (uncompressed)</span><br><span class="line">   Data Size:    6693376 Bytes &#x3D; 6.4 MiB</span><br><span class="line">   Load Address: c2000040</span><br><span class="line">   Entry Point:  c2000040</span><br><span class="line">   Verifying Checksum ... OK</span><br><span class="line">## Flattened Device Tree blob at c4000000</span><br><span class="line">   Booting using the fdt blob at 0xc4000000</span><br><span class="line">   XIP Kernel Image ... OK</span><br><span class="line">   Using Device Tree in place at c4000000, end c40125aa</span><br><span class="line"></span><br><span class="line">Starting kernel ...</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">[    2.174568] stm32_rtc 5c004000.rtc: setting system clock to 2000-01-01 00:01:41 UTC (946684901)</span><br><span class="line">[    2.183611] Generic PHY stmmac-0:00: attached PHY driver [Generic PHY] (mii_bus:phy_addr&#x3D;stmmac-0:00,)</span><br><span class="line">[    2.197201] usb 1-1: new high-speed USB device number 2 using ehci-platform</span><br><span class="line">[    2.214199] dwmac4: Master AXI performs any burst length</span><br><span class="line">[    2.218189] stm32-dwmac 5800a000.ethernet eth0: No Safety Features support found</span><br><span class="line">[    2.225501] stm32-dwmac 5800a000.ethernet eth0: IEEE 1588-2008 Advanced Timestamp supported</span><br><span class="line">[    2.234275] stm32-dwmac 5800a000.ethernet eth0: registered PTP clock</span><br><span class="line">[    2.398628] hub 1-1:1.0: USB hub found</span><br><span class="line">[    2.401140] hub 1-1:1.0: 4 ports detected</span><br><span class="line">[    3.277927] stm32-dwmac 5800a000.ethernet eth0: Link is Up - 100Mbps&#x2F;Full - flow control rx&#x2F;tx</span><br><span class="line">[    3.317195] IP-Config: Guessing netmask 255.255.255.0</span><br><span class="line">[    3.320790] IP-Config: Complete:</span><br><span class="line">[    3.324024]      device&#x3D;eth0, hwaddr&#x3D;e2:a4:06:a5:8f:7f, ipaddr&#x3D;192.168.0.102, mask&#x3D;255.255.255.0, gw&#x3D;5</span><br><span class="line">[    3.334612]      host&#x3D;192.168.0.102, domain&#x3D;, nis-domain&#x3D;(none)</span><br><span class="line">[    3.340520]      bootserver&#x3D;255.255.255.255, rootserver&#x3D;192.168.0.101, rootpath&#x3D;</span><br><span class="line">[    3.349127] ALSA device list:</span><br><span class="line">[    3.350873]   No soundcards found.</span><br><span class="line">[    3.519504] VFS: Mounted root (nfs filesystem) on device 0:15.</span><br><span class="line">[    3.529231] devtmpfs: mounted</span><br><span class="line">[    3.532594] Freeing unused kernel memory: 1024K</span><br><span class="line">[    3.535990] Run &#x2F;sbin&#x2F;init as init process</span><br><span class="line">[    5.499422] systemd[1]: System time before build time, advancing clock.</span><br><span class="line">[    6.079843] NET: Registered protocol family 10</span><br><span class="line">[    9.012545] Segment Routing with IPv6</span><br><span class="line">[    9.200958] systemd[1]: systemd 239 running in system mode. (+PAM -AUDIT -SELINUX +IMA -APPARMOR +SMA)</span><br><span class="line">[    9.222756] systemd[1]: Detected architecture arm.</span><br><span class="line"></span><br><span class="line">Welcome to ST OpenSTLinux - EGLfs - (A Yocto Project Based Distro) 2.6-snapshot-20191124 (thud)!</span><br><span class="line"></span><br><span class="line">[    9.371860] systemd[1]: Set hostname to &lt;stm32mp1-cp&gt;.</span><br><span class="line">[    9.476160] systemd[1]: Hardware watchdog &#39;STM32 Independent Watchdog&#39;, version 0</span><br><span class="line">[    9.483357] systemd[1]: Set hardware watchdog to 30s.</span><br><span class="line">[   15.306868] systemd[1]: Unnecessary job for dev-ttySTM0.device was removed.</span><br><span class="line">[   15.315395] systemd[1]: Started Dispatch Password Requests to Console Directory Watch.</span><br><span class="line">[  OK  ] Started Dispatch Password Requests to Console Directory Watch.</span><br><span class="line">[   15.374193] systemd[1]: Listening on Journal Socket (&#x2F;dev&#x2F;log).</span><br><span class="line">[  OK  ] Listening on Journal Socket (&#x2F;dev&#x2F;log).</span><br><span class="line">[   15.407969] systemd[1]: Listening on initctl Compatibility Named Pipe.</span><br><span class="line">[  OK  ] Listening on initctl Compatibility Named Pipe.</span><br><span class="line">[   15.479167] systemd[1]: Listening on udev Control Socket.</span><br><span class="line">[  OK  ] Listening on udev Control Socket.</span><br><span class="line">[   15.653309] systemd[1]: Reached target Remote File Systems.</span><br><span class="line">[  OK  ] Reached target Remote File Systems.</span><br><span class="line">[   15.696091] systemd[1]: Listening on Network Service Netlink Socket.</span><br><span class="line">[  OK  ] Listening on Network Service Netlink Socket.</span><br><span class="line">[   15.764924] systemd[1]: Listening on Syslog Socket.</span><br><span class="line">[  OK  ] Listening on Syslog Socket.</span><br><span class="line">[   15.802155] systemd[1]: Created slice system-getty.slice.</span><br><span class="line">[  OK  ] Created slice system-getty.slice.</span><br><span class="line">[   15.837597] systemd[1]: Reached target Swap.</span><br><span class="line">[  OK  ] Reached target Swap.</span><br><span class="line">[  OK  ] Started Forward Password Requests to Wall Directory Watch.</span><br><span class="line">[  OK  ] Reached target Paths.</span><br><span class="line">[  OK  ] Listening on udev Kernel Socket.</span><br><span class="line">[  OK  ] Created slice User and Session Slice.</span><br><span class="line">[  OK  ] Reached target Slices.</span><br><span class="line">[  OK  ] Listening on Journal Socket.</span><br><span class="line">         Mounting Kernel Debug File System...</span><br><span class="line">         Starting Journal Service...</span><br><span class="line">         Mounting POSIX Message Queue File System...</span><br><span class="line">         Starting Mount partitions...</span><br><span class="line">         Starting Create list of required st��…ce nodes for the current kernel...</span><br><span class="line">         Starting udev Coldplug all Devices...</span><br><span class="line">         Starting Apply Kernel Variables...</span><br><span class="line">         Mounting FUSE Control File System...</span><br><span class="line">         Mounting Kernel Configuration File System...</span><br><span class="line">         Starting Remount Root and Kernel File Systems...</span><br><span class="line">         Mounting Temporary Directory (&#x2F;tmp)...</span><br><span class="line">[  OK  ] Listening on Process Core Dump Socket.</span><br><span class="line">[  OK  ] Created slice system-serial\x2dgetty.slice.</span><br><span class="line">[  OK  ] Started Journal Service.</span><br><span class="line">[  OK  ] Mounted Kernel Debug File System.</span><br><span class="line">[  OK  ] Mounted POSIX Message Queue File System.</span><br><span class="line">[  OK  ] Started Mount partitions.</span><br><span class="line">[  OK  ] Started Create list of required sta��…vice nodes for the current kernel.</span><br><span class="line">[  OK  ] Started Apply Kernel Variables.</span><br><span class="line">[  OK  ] Mounted FUSE Control File System.</span><br><span class="line">[  OK  ] Mounted Kernel Configuration File System.</span><br><span class="line">[  OK  ] Started Remount Root and Kernel File Systems.</span><br><span class="line">[  OK  ] Mounted Temporary Directory (&#x2F;tmp).</span><br><span class="line">         Starting Create Static Device Nodes in &#x2F;dev...</span><br><span class="line">         Starting Flush Journal to Persistent Storage...</span><br><span class="line">[   18.106096] systemd-journald[130]: Received request to flush runtime journal from PID 1</span><br><span class="line">[  OK  ] Started Flush Journal to Persistent Storage.</span><br><span class="line">[  OK  ] Started udev Coldplug all Devices.</span><br><span class="line">[  OK  ] Started Create Static Device Nodes in &#x2F;dev.</span><br><span class="line">         Starting udev Kernel Device Manager...</span><br><span class="line">[  OK  ] Reached target Local File Systems (Pre).</span><br><span class="line">[  OK  ] Reached target Containers.</span><br><span class="line">         Mounting &#x2F;var&#x2F;volatile...</span><br><span class="line">[  OK  ] Mounted &#x2F;var&#x2F;volatile.</span><br><span class="line">         Starting Load&#x2F;Save Random Seed...</span><br><span class="line">[  OK  ] Reached target Local File Systems.</span><br><span class="line">         Starting Create Volatile Files and Directories...</span><br><span class="line">[  OK  ] Started Load&#x2F;Save Random Seed.</span><br><span class="line">[  OK  ] Started udev Kernel Device Manager.</span><br><span class="line">[  OK  ] Started Create Volatile Files and Directories.</span><br><span class="line"></span><br><span class="line">ST OpenSTLinux - EGLfs - (A Yocto Project Based Distro) 2.6-snapshot stm32mp1-cp ttySTM0</span><br><span class="line"></span><br><span class="line">stm32mp1-cp login: root (automatic login)</span><br><span class="line"></span><br><span class="line">root@stm32mp1-cp:~#</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>系统构建</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>使用TensorFlow训练自己的图像识别AI</title>
    <url>/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/</url>
    <content><![CDATA[<p>  摸索了几天，终于用TensorFlow成功训练了一个能够识别三种动漫人物的AI。写篇post记录一下。由于训练是在虚拟机上跑的，没有办法使用显卡，所以这次的训练只用到了CPU。GPU版本的训练下次再写。</p>
<a id="more"></a>
<p>训练环境：<br>  OS: Ubuntu 17.10(VMWare)<br>  CPU:i5-6300HQ(开了两个核给虚拟机)<br>  RAM:4G(16G只开了4G给虚拟机)</p>
<h2 id="配置开发环境"><a href="#配置开发环境" class="headerlink" title="配置开发环境"></a>配置开发环境</h2><p>  安装TensorFlow是一件十分麻烦的事情。你需要python(推荐python3以上)及各种扩展模块，bazel等等，这些安装操作会频繁地更改环境变量，稍有不慎就可能导致崩溃，还极难恢复。因此推荐使用Docker来进行环境搭建。</p>
<h3 id="什么是Docker"><a href="#什么是Docker" class="headerlink" title="什么是Docker"></a>什么是Docker</h3><p>  Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。你可以把容器看成一个沙箱。Docker提供了一些已经装完TensorFlow开发所需的各种依赖包的image。我们只需要使用Docker下载这些image，就可以在Docker的容器中进行开发，而不用担心安装各种扩展包导致系统崩溃。更重要的是，你可以基于一个image创建多个互不干扰的容器，我们可以在容器里进行各种变态的实验而不需要反复下载image。(特别是这些image由于某些众所周知的原因在大陆下载极其缓慢甚至不能下载)</p>
<h3 id="如何安装Docker"><a href="#如何安装Docker" class="headerlink" title="如何安装Docker"></a>如何安装Docker</h3><p>  参考Docker的<a href="https://docs.docker.com/engine/installation/linux/docker-ce/ubuntu/#extra-steps-for-aufs" target="_blank" rel="noopener">官方安装指南</a>可以非常轻松地完成Docker安装。</p>
<h3 id="下载集成TensorFlow开发环境的镜像"><a href="#下载集成TensorFlow开发环境的镜像" class="headerlink" title="下载集成TensorFlow开发环境的镜像"></a>下载集成TensorFlow开发环境的镜像</h3><p>  接下来的步骤需要root权限并需要访问Google服务器。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># docker run -it gcr.io/tensorflow/tensorflow:latest-devel</span></span><br></pre></td></tr></table></figure>
<p>执行该指令，Docker会自动下载镜像。你也可以选择下载不同版本的镜像：<br>CPU版：gcr.io/tensorflow/tensorflow<br>CPU版带开发环境：gcr.io/tensorflow/tensorflow:latest-devel<br>GPU版：gcr.io/tensorflow/tensorflow:latest-gpu<br>GPU版带开发环境：gcr.io/tensorflow/tensorflow:latest-devel-gpu</p>
<h3 id="搭建完成"><a href="#搭建完成" class="headerlink" title="搭建完成"></a>搭建完成</h3><p>  经过漫长的等待，如果命令行变成root@xxxxxxxxxxxx 说明下载安装完成，用户已经在Docker容器中了(xxxxxxxxx为当前容器ID)。</p>
<h2 id="准备训练样本"><a href="#准备训练样本" class="headerlink" title="准备训练样本"></a>准备训练样本</h2><p>  机器学习需要大量样本。这里我直接使用了Google图片的搜索结果作为样本，这样的方式方便快捷，但样本质量不一定高。当你尝试在Google图片中搜索“蜡笔小新”，搜索结果很有可能出现一幅没有包含蜡笔小新的图，该图可能只包含有动感超人甚至小白。这些错误的“正样本”会对训练结果产生影响。<br>  分别在Google图片中搜索“Crayon Shin-chan”、“spongebob”、“minions”可以找到大量图片。可以使用Chrome的一个名为“Fatkun Batch Download Image”的扩展程序进行图片批量下载。新建一个cartoon文件夹，将图片分别放在其子文件夹cartoon/crayon cartoon/minions cartoon/spongebob下。每个目录有800~900张图。</p>
<h2 id="开始训练"><a href="#开始训练" class="headerlink" title="开始训练"></a>开始训练</h2><p>  接下来的步骤需要root权限并需要访问Google服务器。</p>
<h3 id="创建工作目录"><a href="#创建工作目录" class="headerlink" title="创建工作目录"></a>创建工作目录</h3><p>  新建一个名为tf_files的文件夹，并将cartoon文件夹copy进来。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">mkdir tf_files</span><br><span class="line">cp cartoon tf_files</span><br></pre></td></tr></table></figure>
<h3 id="运行容器并挂载工作目录"><a href="#运行容器并挂载工作目录" class="headerlink" title="运行容器并挂载工作目录"></a>运行容器并挂载工作目录</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -it -v $(<span class="built_in">pwd</span>)/tf_files:/tf_files \</span><br><span class="line">  gcr.io/tensorflow/tensorflow:latest-devel</span><br></pre></td></tr></table></figure>
<h3 id="使用迁移学习进行训练"><a href="#使用迁移学习进行训练" class="headerlink" title="使用迁移学习进行训练"></a>使用迁移学习进行训练</h3><h4 id="什么是迁移学习"><a href="#什么是迁移学习" class="headerlink" title="什么是迁移学习"></a>什么是迁移学习</h4><p>  迁移学习(Transfer Learning)试图使用已经训练好的模型参数帮助新模型训练新的数据集。当数个训练任务及数据有一定程度的相关性，使用迁移学习可以加快新模型的学习而不用花费大量时间和样本从头开始训练。我们的任务是一个图像识别任务，这与Google训练好的Inception模型有较大的相关性，而我们的样本又较少，因此基于Inception模型进行迁移学习是个不错的选择。</p>
<h4 id="什么是Inception模型"><a href="#什么是Inception模型" class="headerlink" title="什么是Inception模型"></a>什么是Inception模型</h4><p>  Inception模型是一种用于图像分类的卷积神经网络模型。这是一个多层、有着极其复杂结构的卷积神经网络。该模型可以识别超过1000种物品，但并不包括我们想要的动漫人物。Github上有提到Inception模型训练是在一台有128GB RAM和8块Tesla K40的电脑上进行的(We targeted a desktop with 128GB of CPU ram connected to 8 NVIDIA Tesla K40 GPU)。如果你想在你的个人电脑上尝试从零开始训练一个这种量级的神经网络，你可能需要数个星期才能完成训练，还有很大的可能性出现run out of GPU memory或run out of CPU memory导致训练失败。在这里我们将尝试使用Tensorflow提供的retrain.py训练整个神经网络的最后一层，即决策层/分类层，而倒数第二层被称为Bottlenecks(瓶颈层)。我们将利用Bottlenecks产生的有效数据，供给最后的决策层/分类层做出最后的分类预测。</p>
<h4 id="开始训练-1"><a href="#开始训练-1" class="headerlink" title="开始训练"></a>开始训练</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tensorflow/</span><br><span class="line">python tensorflow/tensorflow/examples/image_retraining/retrain.py \</span><br><span class="line">  --bottleneck_dir=/tf_files/bottlenecks \</span><br><span class="line">  --how_many_training_steps 4000 \</span><br><span class="line">  --model_dir=/tf_files/inception \</span><br><span class="line">  --output_graph=/tf_files/cartoon.pb \</span><br><span class="line">  --output_labels=/tf_files/cartoon.txt \</span><br><span class="line">  --image_dir /tf_files/cartoon</span><br></pre></td></tr></table></figure>
<p>在这里我们设置了bottleneck的输出目录，training_steps，模型位置，pb文件及label输出位置，样本图片位置。一般而言training_steps越多，训练时间越长，效果越好，反之则反。如果模型位置没有需要的模型，该脚本会尝试自动下载。pb文件就是训练完成的模型，label是一个txt文件，里面包含了我们训练完成的模型能识别的对象名称。不出意外的话，几十分钟后训练就可以完成。</p>
<p><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/0.png" alt></p>
<p>可以看到我们的模型的测试识别准确率达到了95.5%。</p>
<p>tf_files下生成了我们训练的模型cartoon.pb以及label文件cartoon.txt。打开cartoon.txt可以看到，该模型可以识别的对象有crayon(蜡笔小新)、minions(小黄人)、spongebob(海绵宝宝)三种(就是cartoon文件夹下子文件夹的名字)。我这里生成的pb文件有87.4MB。</p>
<p><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/1.png" alt></p>
<h2 id="优化与压缩"><a href="#优化与压缩" class="headerlink" title="优化与压缩"></a>优化与压缩</h2><h3 id="为什么要进行优化和压缩"><a href="#为什么要进行优化和压缩" class="headerlink" title="为什么要进行优化和压缩"></a>为什么要进行优化和压缩</h3><p>  对于移动设备(例如智能手机)和嵌入式设备(例如跑Android Things或Linux的设备)来说，这个模型文件太大了。如果你尝试把其打包为apk文件，你可能会得到一个将近100MB的apk，这对用户来说可能体验并不太友好。因此我们需要对该模型进行优化和压缩以减小其体积。<br>如果你尝试直接将该pb文件压缩为zip文件，你会发现压缩文件大小只比原来小了几MB。我尝试使用优化脚本对pb文件进行优化，优化后的压缩效果还不错。</p>
<h3 id="使用optimize-for-inference优化工具"><a href="#使用optimize-for-inference优化工具" class="headerlink" title="使用optimize_for_inference优化工具"></a>使用optimize_for_inference优化工具</h3><p>  optimize_for_inference脚本将会帮助我们删除当前模型中输入输出之前不需要的节点，并进行一些其他优化以提高运行性能。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python tensorflow/python/tools/optimize_for_inference.py \</span><br><span class="line">  --input=/tf_files/cartoon.pb \</span><br><span class="line">  --output=/tf_files/optimized_cartoon.pb \</span><br><span class="line">  --input_names=<span class="string">"Mul"</span> \</span><br><span class="line">  --output_names=<span class="string">"final_result"</span></span><br></pre></td></tr></table></figure>
<p>优化完成后我们可以得到一个名为optimized_cartoon.pb的优化过的模型文件。但是只比原来小了0.2MB。压缩为zip文件也小不了多少:(</p>
<h3 id="使用quantize-graph工具进行进一步优化"><a href="#使用quantize-graph工具进行进一步优化" class="headerlink" title="使用quantize_graph工具进行进一步优化"></a>使用quantize_graph工具进行进一步优化</h3><p>  看来是时候放大招了。我们将使用quantize_graph对模型文件中的权重参数进行四舍五入。这一方式将会降低预测准确率(但是通常只降低1%左右)。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python tensorflow/tools/quantization/quantize_graph.py \</span><br><span class="line">  --input=/tf_files/optimized_cartoon.pb \</span><br><span class="line">  --output=/tf_files/rounded_cartoon.pb \</span><br><span class="line">  --output_node_names=<span class="string">"final_result"</span> \</span><br><span class="line">  --mode=weights_rounded</span><br></pre></td></tr></table></figure>
<p>  通常来说，新生成的rounded_cartoon.pb大小并不会发生太大变化，但是当我尝试将其压缩为zip文件时，我得到了一个令人满意的压缩包大小：23.9MB</p>
<p><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/2.png" alt></p>
<p>  现在如果我们尝试将其作为资源文件打包进apk，可以得到一个小得多的安装包，用户下载的时间大大减少了。</p>
<h2 id="测试与验证"><a href="#测试与验证" class="headerlink" title="测试与验证"></a>测试与验证</h2><p>  首先我们将测试经过optimize_for_inference优化的optimized_cartoon.pb。为了方便测试，我使用了TensorFlow在Android上的demo app，你可以在Github上找到其源码。要让我们的模型文件能够在这个demo上正常工作，我们需要做一点微小的工作。<br>1.复制optimized_cartoon.pb及cartoon.txt文件至app/src/main/assets<br>2.在ClassifierActivity.java中修改如下部分：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> INPUT_SIZE = <span class="number">299</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> IMAGE_MEAN = <span class="number">128</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> IMAGE_STD = <span class="number">128</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INPUT_NAME = <span class="string">"Mul"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String OUTPUT_NAME = <span class="string">"final_result"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String MODEL_FILE = <span class="string">"file:///android_asset/optimized_cartoon.pb"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String LABEL_FILE = <span class="string">"file:///android_asset/cartoon.txt"</span>;</span><br></pre></td></tr></table></figure>
<p>这里我们限制输入图像为299x299, 并更改INPUT_NAME和OUTPUT_NAME。当然还有MODEL_FILE和LABEL_FILE的位置。测试样例我直接用手机拍的，由于限制了输入图像大小为299x299，所以图片质量比较差，但是还是得到了不错的运行结果：<br><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/res1.png" alt><br><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/res2.png" alt><br><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/res3.png" alt><br>再看看经过quantize_graph优化的：<br><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/res4.png" alt><br><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/res5.png" alt><br><img src="/2018-01-03/%E4%BD%BF%E7%94%A8TensorFlow%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%ABAI/res6.png" alt></p>
<h2 id="下一步"><a href="#下一步" class="headerlink" title="下一步"></a>下一步</h2><p>  接下来我们可以尝试进行音频方向的机器学习探索。目前还在研究中，等有了有趣的发现后再写篇post吧。</p>
]]></content>
      <categories>
        <category>机器学习</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>TensorFlow</tag>
      </tags>
  </entry>
  <entry>
    <title>个人博客搭建简明教程(特供版)</title>
    <url>/2020-01-31/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B-%E7%89%B9%E4%BE%9B%E7%89%88/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="您好, 这里需要密码." /><label>您好, 这里需要密码.</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="c2008421ebc76b07feab014583d6c5eb2f53686f60bb2fefa6152af2d34cf1e0">ac9b41ed7b0fabd762865dc9e24f581d547ce33336c9d5079f9931cadc7a6b9851b39329361c352b3c22382d5c4c3a22bc384a5e5708f5f1fb0fd12dac936f4232885f8e74e5151f71087dd34f94a521f29272f7deee8c0bb139fc1f28aad8ec039d1a84510d14bff3589d9d3d45de022c1a000b5190cbc9fce5af595c3a27621cb1c3e611d23b43fa6d88a2fc9c2f92fbc020f7d596c1f45edb548ab11d4aded9f62cb6084f6e6de29307241e05b58b84a20942df48d7d17ce0b91731b9a862a2137cf156a3d181c3ba3c4ff9e3b0e82703ab2748f6865842c7871014c052440e4b976ac3af269d5d96f1e00116e1276f645d7b7899a603cb84a4355264f25b9f4436e83fbf03643332fa89cb8ef0c54e540472351ca3bb5a507d3727e660d285fc998b08c69bc24f42e554b11b8440f99452725a1fc2b3f12f1210d7777259e594f700d1205fb7e7b1ffb728fde021bb739834288e7327db819cdd182b0448a39626d21eec53fa5c2030fd2016fa0a0e8509258a4fe3dc16387a92973964ed2cc92aad40c48ec287d9363026505ef6f4f271c89bdcee752c6d453253ba7fee936cec7b2e8811adcf946d31c8c81b7ecae04e7f8fef6ec47e07df43755c1dcfad34f8e9b40c65c60bc5ff85df4494c6b5f686f6c8238d05d654b7ef70835ad20c721304e4ea2b8a65d11d8cd54c5de2728e50d38f114834e49388e023e739541ad34447dcc6120c3bca1b0f1a4316466609601fbd2cc88a383c66a134b057bff19159e41c135959fb7267711eef6518e96a2db888e8deaf57a66a8219c7cf388bb1f473a8ae9365c787ba106fa5a2df6c33269a8fca1f92304f9e887a76fa8e82f9bfa56ed501e9554d8bd2e995c88892072e1286e43c0f58004d83cb45637b082cb6b786093f5dd2a6c4386b41ad85579ffa4b1819ab6b511e606ed5abcf76aedbf306c97a95a50b7d5d3d65abebe4b6b4f74cc7e7bedccca1a52af548e68cf8e17b0b2738c7a95fb2e61bd4845e1a8c6c72d0075485c2206ead3d07fb21b06887411a2318f1a7464252e04d84ba98cdf2252fcf93e16c5ba178228063f6613222a6f76a6b3dc26ec368a804c841ea46cd421aed93669248d994b12d26b9ab5b8b46a270e1c927ac4102fb8622691b46ca84abb91d404d066e68caf56481d2d85c656b266d4c4bd0e0312b5da2a62f5cbfdfe68b386b1a35d087310c12f08414e27180300d82b8e1be3e192e3032fd78e6ca7cdeab36c7448ca66063ef18c2e3166aa8259bc10850ced64b400b4cfe98018120e9f5d89c62716712c6b3d96788286193d14e17fc82d6e3fe38d897f167afcfc445919c5daf7348eb70dca2ae0c912f06649964aa7c0492982a13001871f8ee776367272abe1dccaebef1ecd504db4747d671472315a662edf6f07ab7b5269987f42de4be2b6cbd3593a008fbb0922b474a448b0d1d29640dc6d5ae76c9d9a0384a83597d3c5374ff6c1c4140a272795abb018f5116ddce00f8a19f624362a2c4a1a4fba19c266eb59f1c6f609ad565f8863b943c564f88190a08350fd7025e91d06613220356be372009c7c3d63f4cecd52bc32226ca7956124095e4ce624dd1098b73f6ea1e67dac33020546f8c6b07cf62f45f7da66d7d4f884feb84c4f2b5b8dd44f5b9c0c7f7f4ccd96387485ccb648cfd6786ba2dd5469f10c42d6274791c9d46cbfd8b5c7ee449300e8930225bf04633ed67585cc8f1f1c1c48d3cba8b3324265846b55d0fb76aa68231c6d7939a2dc4f8d4fb095347a93d24bc36e44f17e2dbe561707788207d2aacb4797a69e68d89c474b4650c013a2b6f5443f92c56a6f9848380a1723fdff54b9585c94c3b5c7d4c28b75d42512ec06eb7601e9dc109357c4a7e14fec627f42418e14ce81e34a7cbebd989799b969ea3b5f10f0a2e1d1b1b7cd1fcaa87f1350814ca7e227b72f7b067fcdb68ce63b685f22e8b3897c19523a8553b41b987682c40bc3c17fdb4607cc2408b80afe8271da366f31d504464bea2a99a20aadd6b9112fc55aa6ca4e3c9b77113df0fe9e34864491d54e5e5a3bc612a7fa5068293c5667a6da5f41fadb768df0ae24e224e6ae0cf4d398d1b185f520fad3006cd2bb358daa1448409fc8e3db8a303cf9e6d995d1c1ce3dd3887cb371e90270d2437517afdf86d41a3b1a85ef0ad325d049a10efda1fb3c11f1797e253f0efa1674df2c7b88928ddfc9f6905dfd7f8e35745a55b62b5b65cafc61897fd5f518258342db61575bf78673b8e2fdd43b3edb53cde111dea676feea9fefa608b1f1df32eed050f95144ff88a80708118dc75de31ca71961f54ced66659e84cbac2905732c0687b54fec96e31970ae2e7ff4f255646f732e87d9b8d05dae9605481602038f9b3a10aa0a4f4ebe69c4fd56c0d17edefe7fe543b896d335c6448103927739e0b1ec517f78f391a16dbb878f6934676fdb9531e5bc105b5590ab0d0af9825f6189bc52ef72d33612a128be171e4ac19127552fbaaa4cf7abd3f134d1b4b8ab990a5943ec51979c194b97da7788693dfbe3a9e0f0cb5df51267edc98b89048676907360dbeef140b973ad20a21b91d053acd878f774da180cdbd89a51957abade1d4072cebfb02f572ba5e54838d95317e0070548d7bec857f4216f8b39b0bf9dc0330995de92a422192915bf46ede42ef44d91fbd5d9704c65ab906df69602a088dcf9d135a1e2ea3d71bb81b4054c2e0f35e29caa946bcc45938ca084890706f12134cb7114caf5b899161ed1591c77b03f688d4c2f8b35eb15367b84734758da116c67aa52118bcd01a722510ffb38ce65accb4926e4e192af2afa2c681f5f564059b9cd85c65524f16a80bb0f6071e1aac63216c5c2223fe188c26f5a879e7d4caac0df2cd75541753bdd42caca274f9e00b0b7c8fb07a02a0a45e899029c4bfba05098c5a7e2d4658195a2f0db4648a01b585670526dbab8e8300c363eb65f6acabc3855ef6e3973c1a42999914f13f47f96a6e4198b700f2c2513ccd6a89aa7915920465e43fcbdfeb453fd0bcad96906f13add7ba9b06a653efb48927af8c4f13c9004df24b9aab9f61714a489cfd0e8163ed825614bce117ebfab45d3c2606b9bf577f936ff2dcf834504c58a186a8abdfa1622730083aa5ae626f0ca81693267800d68287b3f36206a1fb2c5f25ea8c7a74a665bfd381a3dd8314c1235ba1aa3f3bfc820418a48896d75a743fd91f64f45a1beeabb518a2ef2c8de5f99de006be99a64cf6651fcb374223f37ecdbe56cc2e9a07fcec5fa3356d3b206d7e7f9b1deaa5cedcb8abea5852d24d6834769b04b4968e9ce9fc501f38513754485a92b8d3a5879ca69817c459811320060ece770a7295b18e977019410ce6a78fb6ef16d322dea479a098fd308380f4a9b4a126e96335c951378f721c5b94a6f51b6d50fb3290ac5d52056ad0437c74eac45cd66c6027490aba2664b74ce8d298f4bb5cf3d1cb8ea458318450da62d9ec76d968c8c6f2d3ea369083d43c93a32286b24cc4457d91045bfef12b779a7dcc66ee74b324a2c756eb64cb57efb9f32935264550ab93cb793b33d0f86ec875a20cb88e2e3794ece30412210af8a18341420daac12b8a34a16fac8a45603d15653cb654d32b10a0b7d6bdcb2471719babdac9f896609260ee2b26e9793464d23923e435b5757bc127a1fd2ef3aa72e2a33ea1d0296261639dbf9186a65e301fc8438febe5953a803b02fe7dba63bb9ff3afa01794df9aa4a1e493c8d27a72ad816c75f1b3cfa695d2b889e7b76cd3ce6552932dd6f3a37cd12b90b20d4884bfb026d6570999859cb0513f6864ee1865eac8f8ec3e6a31febac67f76df1578bb33cd7a8900c92593f83902c14596083e9ab082fca40f0db4b15a007dde996970003e072208cc23c9fab8e154e73de3126a3acb18c173db492704ec13ac7753ee111657b4850a69f08059eedb90ea99db095fee6902e804fad5b614eaa19b73f3778bdd02f0e3a502eb4841cadcb1b5aa748dbdbe1ca6043a511c3d0485a6223d1a94aa592723a8c7c49570b8f0bac1994c6205ee49138bc20b7ed537f89b572f3abe53b8d6dec6a07edc40b48dd65e5efa8dfc44e2c51643df0c59ab971f9e0eff99bf09ef11008a4dcbb0b30b2387d5cae3da4542931c6b4dbeb52a56a394581ab4fd13a56e961f9afa9f4f29c8b6e87b43750aa1be5e86c33bfbec6058be94c15bb17008c4ac899897337f46445d192e7cc1d0a2130d4b98ad52f52eb40232a5f5174daa469c1c3d3872d45e4ef27c03d3be663226934ab3cb494822bc62142ed8200fa3597a8328b4ab7659450364d0d7a58286ba35daa12c5e9e8f33f85865eab4145044e2788364c19c94e3c599ff2b626cc0741c69c105664319f0d1f9165566ee941ec2dabc798d030a37eac9b9df345b388d8be93c28d77168ade5d48eb94a546dde32d2a51b68cce64437c1337202ba16c7441e3f5d8d417e35397042bd2759fc56fe593e51449316afd42ff89b055a390b6941f74cd71f9864279549ad1789ebbdcf801cfa0116c0e0fc9a82c3648d20a50eb172da5164b7fd4ce64746d9061f79af07225597ac5e74b957147fe448f35c2b55e966920d255215b0ef7a860bcc47c44c2ce87b6a03a63a63dfaf52b9b55e04fc0ed561d6a839f49ebd17a840ca7f5f5bfd5c8d1f5d0a10ec486095ede0c8904791b9f137f52cd0840a5d5a249a02486cca8503ffd60e47ed3fef7e1eba0fb0db375e033252ec8bb6893a94e072e435c81b20b3de88a981e29c78ae710e0b9b8582e836cca475ae1df4113c48951d1495f87b5766a4057458b13f3fe16f778e058c6b097e4eee33f0fe471d9fe2d91e05f95517b8639971f0abebd8ef04e461ee56e6cfb4e776fe8b6401bd0124fd4a4d74963fd4e2797bb78d0e237eb060b030308cc854ec766506e1ab9217df7271113329e783c6fbbb5ac57a4689e58236bdc567766cbd4c6b4a88375ff3d899b20a7ad4c4e698e36b0cf29ff7481345dd12feaab1867eeefc748ac6b714806013c5cbb22ac5f0fb8cd7c1b0c73c900f5cf96e7cff7d3f64e604bbaca78211088b942dd80e68b7a098783bc0026f4a5d29f30fde2207a4250b9ecab571bb2b7344eb384957a5503ed8fa53751fe1c7c51eef25b0cd872a9073c1cca713d841c8f79b6b8cf5b5058822fe95a2334186d14cdacf8ecd26e444cc7610f54db2099f92e2ea29879dca0d51deb5e21668954987d2ea5a9ad9581e32a6ae0da1d554b819699d7ba2db8e1120e18f7fe806450da18bbbaa507b18b58116bd901546b4869da742b4a2aa3771b612b78a067de2dcd29c0ebf64363d79ad88a5699c4a677aa2f8edc08efec7fd8d4e7a0efe976e79c94a730943beb4010659f4adf2cd7e0405fc28232403b043ed0d0cd17cfcc9409dd3dceff7cd89143d3306f05380bb475f1f381e87d230c6f7dcaf7c6ef9995d7837ad4b06434e0f597854cd59a7cd91b4955898a5cc02fed256c9792d5ba1509fdccfd16ecd2413bfbef32be065239e705169c1ee0dedeb443816e375b93f6ab64d481a18d4befe67cd4166f181c4d692b26a83b76ec335adc048e6cd6fd35798e7cf204889c0396ed3334248b4fbe6868334d825ef6003984a02a797a6e1a5353dad3c44183fb7329410635a5bf6f7dc03e633c46cf30c69da612cf810f32f7807e16d98fa00793679aed02c7a66e3c96fa3c72da7433bff92737cf9238493205792c92c7b68bc6fbfb92fa88b5092287961b1c0720aa32ec9b6e1c57c075a539eb1f0bf9e1e88dcf4fa04d581ef6d941b75a7df298948ea41db619afb4b7598eef01d505d59475e7c0bef3412f72e85158d2b7c9511d2a45059bb107ae2c27afe1e3b2c4141b8c0cd24de68cc726795044e071fe05432d41d14560ea511b485a41e762195bddd74f2cabf1beaff242cf023ebcc6d63a2f90406ab4ad9de63ae382c0f335dbab82473fe5a87cf6559b64b041c4c3a603281257afd259cb5f04d57c715f835667e4496b039f387d8f34e38843ed24db4e940b0ccb5168f7964342b3a9e50150ce0dac5181140e35f2e22791266ed564e7bfb7de4c6176c5e8aa2e7a4d6ad9e15e16ca7bcd3604ed7fce295682aa1637280160d2b47ddda947fbe881e9dd20100abcbba1686abdaba4f77f7cc1fb8c3b0ee5681fee827cb8a27156a903ec41f67f80cb0f11dbead45dcfbaa24d695ff6e5b5d5f94e08011f2c4f3850a409da9d9f101bfae9035a87a6cd8442a48be6d892e1fc072c2ae28e249dc31ccf6136a6f825eba18dd5b0f383f75f5b9261d42acb1e34d449e6f472a8d53ad0322ca0b02a19f3abfcc8a014fc5961a522cd179950fb20f61cf367de73f1a969f130d0f2f6f6390aebf6ea2fce88f00e9cc7a9e355b4b371f1bbfb492995e51a0fedee2822334e793f42d7be95c0c34b014c391ebf9eb943e2b42440c0b70e407ff424e6e5843afa595e1400987efde98f8eecaae6d9fdafa1053a41c6e9bdc188b31d1614e1edd86fbc478436ef0372303f0f7b91c630af7f29c8295657f682c5fbf7d944b4a0e8f3d5862cb18f33bda9cadf30235fd98aeb977f25ac71a6bd2a2ec7204e29cf23eb1b1a680684f41ceb4bc2008071f0db0d7ca990afd6cee405df57c52f04d9b6cdacb5ad3cb1dbc5c747ab92e584865c3d65ff156db2dc35d0a39e3c0760582be9bbc852f9cfb9244a0497c63f0ddfe943dad6e98860676293a95f49bf3f331612e19b2a44c1dee22c4d9f7dd435498d5aedf7d9f96e7d89a8c7ab1524741db2b4f75de436b44719491c916c303c5b9b21fd9102d4b218671f7487f5109d707912b90d4006e0bba90e358c194faa5d578a963a1be96dfb769265a2337e54811bf2efd7ddd74f75f6aba24a25672607276e0fe5486a3c52c8b74c4ffba3ffaafeb2bb2580f7bbd760340ebae74091d3e25fb6162ad71b7d00b892a97928599959f4d6fb4297554af73fe8b9b5660958d060c55075796a6ea43b7b2508cc370da5ba89e7ada58c89703ab23b50462dd95d13ccb311397304caa20b57bae43389a8660ad690cc6d3eb3770df3e44adece809c6ae9826cc8ac6b2d8791476ae755604146261960fb9543864edb900a6fa7d5333022214e8080baad8f201cef99a5e97be4a3a8c75908af6b0ce02bb9eacccc8d835c50b45d6c22594b734b779f9e4a4aa1b27af1ef4c0b33aa598ee3d3b3fddd14d96f4b3a5fac6726413d1fd8990c6552b9f1c972fcbde7af099a79507ed05179fef784310bc62d3053d183e58572d754dbd635bf0539261e7274592837706e877137942c5db8b3b30e6d12659b6082c8d0ac2e7c54d1ee7e0099db0116342fd9c08366f1f10fbcc42322f850a2bd6404296705cfc6af0f07a67427638e51cf17e70027cdac79e66ab68d83b04d7a1b663661795b214652820e30e9861f7bf159d358c0e8e002a11ae9caab9333a4a5e6dce494db10ed63a218cb0127008a9ae2c979e242ec886a14333e8060f9469cbb025d05824789d8b1a1896688bc73be93f585af5d34c72cd661cdc7862afc8e9ed37dc333dc9f6887f9c81b6281b530df52298170a2fcc0c7655fcc8de2e613a044b45a321ab2886861f05d4c0035621e27e1c8645649f589d8d219f4ba7885129612bc6c0808e2bfb7210547f96ed57b3f90112d82d1f277131fe483c212e99a3779efc09b5bf1b703ab9fded89c13174ab8c4421eec2ae8a15dca7536de0d8e61cf433be455b1d2425edb2c471aea96356b404206fb02e0c805f6e64d7d21d62eea56199a277d3d838bc9cba351d8f52b52598574da7002a019b4f4c36d92306400a359c52fc6b0f3a89bf64903e8e2af1b957d3e9b5e04ac30f80198d192225f37c7f60a58523960fc9a58a0b052b56fd02bf566b63df05b5544796eb48419a475b55bb21a8914cf2c8c94fb9b4efa43123d6b0c440820c8bfe717e1c514055d581166b946c3528d079a40a5dd0b8c837439c4b6e10f6042a1e8bcd1ede2a75617ce1f78370c3db59f5559d10496212aeda6608c3509a06b92b61619ea104a3e84b25e52122818ef342ad82d192a03f272cfd537d7eb9598bbb16d9e2b40e573a0f17d7daaab7f529d1548d8b41bdb012c396bf8ed9cbd1888b724750b6d7ddf06e928be74c2f8e641c53910599aab57701c8aa37c77bace7f0d92012a7c644930970c2d5e7dfd921e8a4bcebda75abadcb112b15792181b57177a2e36bb57f00a841a29f57253d5ef73b394b851e15c9f10a78b3a8767b843d4c67e856728754d2432cc02cea78cf79dcdc454a4020a6324c03bad4edd3ae80ee0f80a461e08643c47e6ce269a6de3bb664294741a84c3d46ab86cf6ced33e1090d0da2b6773ff85b39abf17cd180eaf2d4476ec6a39af9d4b0ad1079067eed92997251ae65df681d4f37cd27a33ce0f997dfdfe8edf0d5601025e9c6790fbd82cdad4db7973a2de98dd0649b5d8770f9d2ff3bea75b69bc93f40c2c0dfeb40504d7caa794aef6dd31e30390829e519db46922c4679981256fbe96f34b893c410f6d7760dabfd2b34997c9985a2cd4a3a108cc3bb96e4fdeb62a76b6cd40158e751e3ac509466b02ea376c2c1fe34682dd214275f9f2767a514549688abd340d962f6f70594bf5978ff12c95705541c4f1b643421506581f6d6f6e752be13167e2083aab3f8c642125b3d90ef7f93a750b6bb43f44f88f37477b5fb2807a20df0051346ba2d34ffbd09c6a578d444b3d29d3c99716c5083d09859f24bcfa7d7b6aa4ad9e26bb6d0a48cccf3027c1f36eeff6931e9ff8e3f8a745d69971cc00764c945f01959485a29d7a6435dcb8f220ef853579550819aa07532c9ee222bb8f4cd9fbaae61cb0fee5558f9d1b8eb5cce35fecca11abea3be082259d9799af9f24dcb008f557b540e0fea5e06bea3a9bd5e1a42b2c9546d34b02a2cd298bae4e095b0f26222dfb5328c3db14d692858155d8e3bcb3c32dbfe00d7139251ee96fab28c89b795e9aa3076e015a020f2252872eba5e56d6298fe669dac052b6124dd0127322a19a3e3b8ad72884358f060798b7cf65ffcc27658a32e87ff7d521277f01f3ad7c5b8d43aa5e51256b2e417f6ed153443e7d5f45ade8ebda5b47d1c8e21223c0b5beef5f76ac8a3ce558b35feb766ff1685f846eea1b55ecfc42bd6d5352c380155712c7ec7c587a69b3a9da3d587c0d4f27dbbd2f22d30982fc5d4927337088a029a76c75d518db258ec5d15e4e6a9856c6abef75725256879919f55233fa72c70ebecb6ca359d8f77b3978518e72b06ae5941b72fef67e37f2ce0285ae01cd07e1ac5a04b105d42a1d109c7ffca1fc1f35fd01c702686d7a0545439b562cd461150e866fa288c4d9b53a5d64b9d4873249d134954f7b63c8cd177f5091e5b7099e1dd64930fa1ba2a197b4e4dd996c1d8e62b7f18d9724edd3aae10a786550ff8d3ffb5bc90a9f1116ed63a4041e428ac66085be9791c73c3435345b7404872d56b6044fc95d48edf8508d40e52e1fb6317a66fbe265ec6e6f326d10979d7b1fc104e2b99706ea32564a6baaf0cb7c5ecf3acafa2e240b07a546842bd0dbda2e6f2bee66f5dde9396e38c02c94dd88bf7d637c65a34dffa379623b2d5cc599ea4ba096a7cba6c4b2a5ca22eccffeb692552a25188fdd9d4cbdc8f61b8c94b933511fd5caf14c7a4454cadec685056d8e0ffd378e52847984e6539cdedacc459c6882634529e1056e60eeeab0f749ecae1597db7342521d7ed0ebab06915698588403c9d70bc863f45df3dfa500704217d3fc9cc8a6d79d187eb805bfcf0fa6acc7b88cfce807fee74f30fd33de7d331690cf44046922af112a74746f6a9defa55d689848edebe01a5c860a4911e624f87c9ea19a2388c9156c02fbe1f339e158c87551a7d8c1e6c1c97bb120f3bddeee4a656dec5e9efbdea1cb84bc40272a12bb30da3687f7016b3333e92e7e52ecaeb62383d6a7b4a2c2decd7d39d4cc1fbb22729950741fc0f44d0322eb0d4016563082c9a544c02bdc2251df18f0545960641df3497b3090ac42446f713171c3182dd3ba2c9c35da64963e6be56fbf2dd92e3144f4db83de440037e1b894c31fcc84e43159da75889c6c2d0fd80348368cb60f4a242afc53654833c88401ac25d8728590d64d87af3e4a6e5680815ef319a58ff3b223bcdfdb652dd3271491bbcab8713576c4b8022902cd58d80e3cea4de03e6c6c07c52b2637dc7e56be1c6014370d77d941077b41d2ec96f379405fe4af257822c9c04a3cb316b031157dc51111fda4aad6d40637c2380b84a42f38c71fd76a9fb17e09e9b42c3a6e982e274016d44b8c3bd143e704882979bebf20dba79667a2d37bd67b5889fde723d0b976d6ce2a5a6bde3376cd7081b8f60bf9dca1adcc4b76aacb2465adde6e9d0dfb9a577a809597a6db9230bb920685b9a91ec670d684aad8ca00b3a3cc1a273d2c7cba429f64e18fe2f0eab8a7306c945f780e0aa772cc4c40e9870b01d43f1c4aeb82a1ce34fc93bcad5684d1de4f68aeb7b9042748aed2c9b7513207a5ce407e993eee1cba2c18a1625d20656874602ecc4f6b47ed0e0165ff6ea5addc9aae1829e691e4b5fd369826809c05cf7045cbfb6b6a38469e26dc0f8d8921a4bab6c2c5a24a92de0e6f93b82d9b64a2aa1d2660ea6bf135c1fb3045837fb0186d590d9f8f3d4aae1a730b86128d1fdf4b8cc134df157612cbc7539c7c27d8e1bd60e9716aae93227134775434491207662fd8e07f7625bab52c0a813e28291aa727ffc0104f5ae3335cfa6ac88999f563a988a4ba43c43ed77f3f093d6134929bae16083c1fb23a451507833496c94389e539636638a23187021fe5c575528f276339b41143d7aadfa05edcea226cf24392443a6f54030b0521cd76a060f4cddf80e709982c51fa4eb6b8956ccbcd077d4b8331b3a021348def5a3d7a5bca156d472f1a9e7d9bf65ba5a4ccddf085768d9b0a7595a7d6b885b6b251a3b6e651b34a71981541a0968618db0c77e3a8d1b464f91eb1a8188cb201045b83058cb8e351883cd9b5ca2107c7c175eb14ec3e6ad7fa155eac0cc54d371d4403d83e9bfd6301d6afa4759957d0db706fd3e5c13573b1a2286e6ccf9f204d1473f452424a364f973036b3fe1e38f6f4eaa1bd5a3125013dc56461effc7ae6a865bf435f49999ea4f53b8747792a7116ea2a6a56a4e4368986c53f249cf8a78a27b6da7f25aeadf9246f6c477fc4bf02ff559d88a5302f7f2ee87419c499a701555ee326ffb1ea2c0759fc9b7e5d5fe4a82499cd0c1c7f37bd8376687df02f7d600dc443df0c9406583087265deaab39d5166e9b120d9d1d0438cf31365a1ccc78dda7ffe0b72167c0e0a79309d642d5599a1ceaa897b9647157515833c8756ff81b8a5ad175a7e49be70f6d2d4dbc6e41f914053874d70a2dbfdca81a8fdd4461c731bbad7bbd16342fcf26990a1fa92305d46012704d08c8b984cdb6a0b534e32468db00d29331efa91a825e0fb8511acfbb194b9bd1b0e41685424667f6c7f09b2b4f9d4724359f2835abb94c7bec48af8d32d4fac1cc4e8c2bd2cd0572abe6afb11010482daa2220d118ffc3539fa3b1f5b7f435176151116584e122973054d7ffd515d9fbd7304ee653718f3af2ba3109392f2151ac138c21af035f5595eec7a2ea34a5114b936e972185d5b5bec52c24b0fab7373d368de14216bd152071fee97e0874ce75641688a82890caae0db2c84b5f072ba4ece6fbaa0188637e8130d277d385ba42da97a89700aeb2c27c0c1fbc00946cf2d67cd6b0aa18d2afbee9f686670a658c5cbb619988668fa4600fd7980c613c805a62a0eb7f0f8f8fa56f7fcf734f5ad49de4ef0fd80411deb6295aa71f987a6e448ae242f191aca0e90f423a01d41b8017bdb341a78e1b284293736e759aee1a7ce1fa5c90f30b316623179630b2b7d2691aac95479d8f3fdfd60c21ee4539fdeb176d7f1baad833b943bef1f999f4f51565355ccfa1d661a483e5fc8c3a589cb1965c14acd731718ea60be48303c91d033fe2b3b55bfd2f0bfc0baf578be108d36165887338acd4c0214841260e37104d7ebc526d461eb3bce6d3825ce547714027b1156ae1826420242606deb85e007fcccd9b4f564c33d9844f9e5c813ad934882fd1bd80b344709c1bec4e5a08f85e212bd69f4a47266292f67515ecef2d4b1d90cfd85506cdfa3e3c0b7194c9955b7b164b9b19145c65f4917c6100d46148202c3ecfdaa1cf98589af69d7b5abafdbaab9f48d9156023b07a5703778de6f66c5bda439fe053d542d9d89f8c63c2370e620845e03546e9356312dd96533858e27a949947e7d231a3ccda01ea9bda5b972df991e76ed6707e0763b5b28c7a7af0190f2a673fe03ef52aac4e6f61ecb1a76c8f3785d9a870504a75e68808585397b1f1070e45616f344d2164e216bd0743a0800e26d0300dd0b0b69b949fbf05697b8dca9be02e5ec2c70a634cf5a9a02177ef14983760700c0b30e38a87b51a88959f363f532d8b027559d2675f8bda3b6fd46077ee1ad806f178d86b7382878534c1ddfeb34c2c4375a2feed73e27c0278b926bcbc03a84bb0c4886f3d39e2d013846e5e5b005ebdc9351d6f4492e520086b20056c66eba60dd6f9c8edd66b9cd4c2ff7c2c3311839a04e8a34dd50283ff1c218bc1088518597854975cf6efd44b045f24d31c8e8e835ed9e4825279c70af1c9b6528436f64e7e11dedd0aae3d3e2a0fb96ef93d390ee5d3ad2ec004fd4a003d13e2968d5d56c8db07621bec00a0667d2bf4bd6729f4eb32c482769e48ddb0cd3ec82041f48a96b7d710df3d3b80227e6f808a2d58d55ce1b15c122e06b7feca293740f041507870e7536ac4421395156acd6bbdf761b05d65fe75a12c8c0e67898144dd3617059cf39dca04f067e1a8ece19d4e82ec814072a43446b75382fd9bba7d038ec29c3f135ac22b4f67272b113ef5448eb3edfffb76be753cd43be73cbe7e47326badc294eacbfe1bbc0acd4511a2b074a6d955affd0a596cf9d1941f9c8a883f3fb7a2dc36351004e8d364de7f31d6df9d9bfbed227eb9f79bcbe04f6c3336c9eb2c18b168a08c3cc4c6ba9ae901dfda24c105468a6099bc83fdfc42ebb29b799f7f0e9c6c45078caba41c7c71993dda7842f209ca6880d14a43e0b67885bbad3744d3516ab533d0241650fdcf2b701bfb7bb7fd163b7635f40b780e83cbb19c97946c0ed33f4470e8ea24193c8fc61d8248ff8d2147eba2310c8dc00bd2adbd2adc6c8c0324bba814eeb263f9389cb68ea01e7dd11913f37188416a467eb326f4655c4394024c5349056d23a5341464a896854d40a653878684a115e4d9ae90b258d1ef7ae17557a6aafd18d678f08273144c48a9552a6fd4d697e23221409a24b03662ef83a0436e2d3ca11f151ce58848e16097c2a1b3d5d940e85c72c2b77edf91b9d1cd3d615f7422e5317cd2c11f32475bccef3981c1b5cea6de93afe291b02f2b1085af6c403ba5749022d7624a304177c36456b34ba90651f3ba2882ab9467f04e3202323e9da4d053a7e36fb3ad9886feff0d27c413a3fa8f75c5a04205c64f2ff1196ecd36f967d8561a62e7f267bebe3b651ca986b846a8b3e72a7f6ed1a35ded3827b99850e210b29230bfd58fd04db46ba59dd8e7e833b48a21ba7a666eb77b6c4428a52a0cec2e2948c45452b3d43f0f5b24d7d82534fe2c654c6c99fdbeae7dbe3a9cf092762454f741088e6feb8db3360a95bfd0919b7205bfefada9dbc8c9b45a1119573764b5e228284af5e60d05203fab440203d5864142310cd8a6ae930bf6eff65080f93ef96ac5f1d0fc23b6838fc82299ae8a2404414989c65e98dad71b1be6f5d4be1b5ffb8f5058b800da5b07c80c14852e1f32e60397b079bf90bffb241ce0b2b1e171b6228aa4db6dce6b9c61168b2a1abfd8c9673d834625ef6a1aa0c050ac3ff0dd2e2efc36044b5ab5d3c33a24c6ddff18e31173a5f316fd268e53b6335dc157f237ae521049d011e2bf92420635462779d15f63340536df64cfb3e25684671c58ea11779cb7b65252f670feff785be01f7ccdc5fae39698c45e48520334b644e262162005c4af003c71eba464645bad5c7909ce8b4ac9a67aff3c55eba0f0b06dc53ca0369ddea6fa41913849da620127d90711fa897fa22323f7a054a3262996ac737c2a899aa3fa90af4a9607fa71b8d35087e87ad68d08b280740a9412933c3b8e2a4a810399bf868746a3cb56a27c1f2d4e4cab78e19aa31f2748c6bea83cdd77ee7e8d2a8e1cca1a44a022f99d981e5928c63ce734eff7b3edc59180c9321e5e7cf561751411e851f4ceaaf3a379009ef3c47c4f6284327467d7c199082f2f9ace72d3458a21392262cbd47c57b37371ffe516fd2c6b39ca49a3dac5f953cd8ce6d71c5fd9af18fec4536240e0f8d66abdf6b44bd658fd628e0b95c5c30a6497c085c301b0aca2896fd50e7515559a9c83b6edce7dd4dc317e4b2d4547735acd2f5936ddfa533f34f0b96a836413a8b4fa25b679baf64acd5e08c2b650e3ccb18831899b97a9a3e9b44ba96a4ac51600856e6c21b5d75ee9d8cfb80f3fc725d15aa04327f935111c099813f0770153962055be0e1d4783738ff21356b74a394e5a39a1373def6722b2e0638381ecf455b2398511deb309d59d006829883c4811da469fcfa1abde30d3d26ed18f9a159c44fbf5caed2012f46efbb72525ffe995f2311788dcd7e51ea92134d64e5a62674d25978340201765a33c1ea4adc904346df82bff56e252f17b0f1abceac5b872fdb0503c1e304d5da8b82ef0f5343edd6b7bad2431efeeab669dab93c9e30ddbe0751881fe5cfd411f79ed543659b1ad473858d5eccfc2c32dca49a88275e696cb3a5e6bb656f457ff2f717a40227fd695f3ff6ad4b96aa866016a8947cc5d8f24630bff65bab6df89d991cbda362a593d44eff44e4cb32369a3570658f94d25dd45fc63be777a48e7fe7555a93d249cf84b235285cc43619d754aaf043fed16b1cdb64288e141d6d81f0a63dc465b176a9fa2e3ce1c312fdb07074160f55420b242e83c46d3f5fd05528efa07e14e4c85cf3b52c980b7303e937df7f8788890a9bdc1ec8ff28e76e452b46408bed077d5b2fe333fb0cc2207771521c1b68004c805a97bcb44b81c068ee96acb0f4ac48332639017f93b425b7231704737687f8e69204e7ccd7352d40f0d5a56978f1d64f8d8604401192f9118bdd68f7e7d3643bb28aff6910ed31efecd87dbd3d95d2c7de6266e82115d72fff61b3f1a06203ae569892f8b404d11612b89070b4bd2972ba5f2cb839e884b7a8abb2a0d79f36c829360f5d6b78045e87dfe48c87921988f63446686286c58d9bc7d50a3932fe23eed9ba88df75ffc60d255981a6f59be2a5664d1c6b210b6e7d50eb7cf6a62c34e57a082be778dfef1645e62d1ac89585908769c15e32b99ff0b3c8e9371172e15b5928340a45849e64db1a62720e03f47b116d10f8e88c6df7fc1c4ef995d6d191dea9edc1f0b106f4543718419e33051d40198424d45449cb6e3c126a675ef0be4dea9c38dac2cf5510c2b907317df1ac21fee6b119edf9e6497d82a718be08ef6128ed66ad716bb47ff269f6e01eb696ff71844ccf424b9df1b5397929cec95e635f2dfb2bc558dac7d33d8bf107434d6a847f7ced48cc9089eb3f666616c956bf9057af8cf7593d1304951048507906912ce8b4b13e2468062ab1cabe718d22fc923947ccfdb1cb89bbace2dc002d7f14c7439a85e7ee5691a67d571b8a7e2a04e6f07c41330714c10f14651ac616afc8aed07a49d4a13f3362dc31daed7be2546658439dcc3ac3252766e6e71b0054ed2bc13005bdf542eb25aff5c2744238ec564bce37268cb6488ba09689124f682abba66ebf9bb3e7597c83b453a36cde26a86c3f4d86b0f62dd4ca9eed28acebb5db35d1d74d314a299ea152b77a52b7f4d6a458b75a68a624907c7077a0ecdfdeaa634c2c80f2cefd81fa2fb22b1f522c95d2a4accaf409c309da9fac831126a72c933a8772242cc40223195b53142c43168c8eca4f36652bc410c8c6060ddd90438b463559cb2fdfc097251887dbb999833962d0de59cd6a68037c37b3f6389528b2f1e6b3019bb9c50099a1a4930a721a5dde8d5a7658ebc70134d980482082177fbf4478293339b1face08fa0158ba03b73958b44690a8769edbe82cc6e4fb7fed643b25a392d161a9f77c0d51390aa96bd6800b865f9032422befcba2bf852056e48cfeea413d24da8a8b0216be2b03b18708a672076f8c39661bb9068f9aa38e5f3d303ba233fa0e97c1e2dfb04f407421d625ba3d1b713a4e2eca31eac46883a33cb2f8d881fade224c82a7a62d6f0ca8f5ce53359d10b0f47a38d2d16d2ad95cdce5d4e603449be7f192af29b002b39a30b6f508215ea4fa576d77a7078e129535ce2e28948ecc3187837164ce783c1b27e4d4f78fbe90732d1c2fb80bb640482366dcca4ebc7f4a0fbfb11c20d9ca8fdc5f8ce258909f89446ba35f7fdedcd24402f15bba275108e8eafb778a83b6566e6e3a085ad130e83a682b9f551f25cdc9dff69137902524d8654b9c336ea015f05b1b57dd871a1d123f1bd90de1fa98a75d201d202ef5b4247410ec213ae1d651d0e3130e38a748736f30536d877ae430c44c73616126b1a8070baa38599e84885be9a8e707396eff026ee48ba17d1f27c7d28eeff429637e464a4e1e068efb7b62a8475382a10fa9e2591cee65605a6003cad674c6f1a9ec0d03d691e032cc078993e50bf8e04af36702fd4b17851d76387c17cab945cdbb567f889baac45b8bfd6226884f6859ca803659d0ee2795e8600b560e9285532ca33581108a6252b683b0c1af9ef20926be369c75187963095ba1d3a601510a0387d727c014d74fcf3ae91b75df26053885f36c625a190eb285a598a9ebba73c06e2aa1526c49a3b666c431ac4a216bc406b33acf03168204c367cfa8c2bd03b4d45b4126ede5879db3e295ec9a437ce80f9834b408e32916f7b7eabad100bfe48acaca05bf58fb069fb090b842ee6dea1fd92960319d1c2d4b7a2fdc7315beadab3b531f3b1941cec919bffbf740c9d5c33ebacd8086f61ed0b3ba63937756c3afd2d94dd6e65bc1f91a49fe52d3ebf67550e7969f3ea5ae26a24834bd252f45b1f3b0acba50947993c78375c6920dada841e193c18ed0beaba74648c65e9bae4dabd04c2a1c81927fe3485ad7c6b4f2c4059b42a4d919d82c90b0367e996050fed6d476ab08d4163dcdf2e4adb672ab321918ea2c6865005b6f4033ade3bb36c3fb315ac69012643775f28143c17ef28a3f4d698336103778d2edfea4ab362db5ed8f56db37fd47d0ac0f7afac7b84823022a8b5c0a6b8b12116b6ca48200c7aa9d24a78409bfe34a00f3926bc951eb62eeeb5a67cbfb2a6819d051d56ea309217add9302912ee97cafd36ef1d7526c21fab36623ddc8f7cc231b9aec61c3f7b3a74e5f28fa49c81b5a4db1bab6bb84f40a6700fa8792ebe1a86e2653c142040a2efe8b6a4aadb32283a4b6ea62fad9bc5d3b7e19ebb46b99314ccc132bd879c99e83e85a9dbeb81cb29515310934284cba6009d0e10d5c796e194ea9974942e0b5dfa462b734e6c4a7321e646ac6c97855e916c7a24a9e12580d95f85caff51dc52e62b85001716ba5cbd77cb8a06f9919a4b121546966b732a7c64c416dfe9a8842c773506e7187dd8f48c30d87c843fdeb23959ab9bb8890082cc1fcf7785fa8ca6e7c606c722bddb6b6ae9a4a46d9cdc4e33ca95c16041e88cc0c2c9fafa6238de5a1c61ef6e25f93e349f65b7551252de258ef587c471b9b1cae465eb52d61249d09846e81e016026258210a73353fb6d7c312867aebb62425f547b45dd521fb127bcf01ca0ba792794d97720681452b61dbf0958c4f83484eef1ecb74e336eda7d4bf28e046687de43ffe461cae02326b1d25155bec861aa8fa6c00ab40ee85e11980f7dfa81008e4aa640afb5d219c4705c028ebd5212a6f5f5c4d539c70156442add3770210b5ca6fc439820b6c16dab28d81e263b1d501517da039c595a47216e8335f906ce601703e8cf046ff79bb1c3f3a7c7104dc50b9b61d0803f0f639ad1b61068aac4001ec304ff6593faf210e6f243e16de0874d79a7e997c62a7674d4b04f1990ccbdc48fa45c3ee388ce0132eb875a940e93d299daeb18857bcba76c5fe98333b6ac8fa9324378466091271bbbfc83a15be48b9ac9fb49fbe12e9ed087cd7a08b2311997016bfa57e54ad2e005ff0a6ea46a3110609e437b790326043efb0f72707e27153611bdcc8b0c9570b40f5ea8a1dbb43b3f36cfcaf6ced8a541f774ac2204eaaa8a935a4ec3a267c13aeebdb1f22ffeb3a3333a17c98942eabeca492931e19888e07cd8dbcd14850c934d849c089594261099ea594c228fff91bcb6f86d5c2f00d79cc62d167a9e8aebe64e28de3104534d8d34eaa1c6bbdd08b0ade5bfd8de89ca799594207fac345c34d06e5bad70ff633a495a7f2692727df1691e8017750c4875f649046bc5449af42f0cafad0666b344fd7dcdd9819fd9c60281d0ca93ead8c2d8552dbb122fb7cce0b682280c7061e043c7c6092b9f769ddb8ec697d8e6d327902fae0571416e1596a2baccf88fda378f0da130096225d9bd0106150f83bb7531ba32cda068f364a32b116062295208b0f01fd320edf079e71da9eaccb8129f0c9e38e8bedfda74d40fe36e61a74e0373ad6288e04b78f37ec4dbbba123fdfff08ec72af9d3209e933361f747adbdb2f251ac57f4ac19f58ceaadb12eb57a490d0fb2dcb85ac853b86ad5780df88188696b3678254a1616ff4590b88acdbd2828797f8d5ac37bc48b4af79b3410513b4eb9f629a43a8d2675c574c9afaba4cae5dd90aa59864155e0fdcc649a3de2fc8dd7801dd72b4af93583c40b31a88aa56e47e2c19f056488f2e70aac0551d6bc90691ba3ab02c123a33edd544b6e79c5369cbe92f2ada68d39ac08559a0d2d92c9caa412ddff37395317c83db0d65d2ae1dc01e2af2946ee113d20ef8ad874d513cd2318850e37ea2edd34173bd3991b787cb5d44cdb0ea908f6425141bc30701ece09c8fbf18775321016f882433c2d9222c87d5b49f1b72ec60ccfd3c762c7ba120e94cf419ad2dc5722e3d947b0dd56e796af053f594567e0ce015d931be8648dfbbe84a292aa4521f7077dc5ea70b26a6406c5fe42623e335f01c418808fadbcdc8ec4e88817d893e0b3099165aab8464ba68490a70ac79434b4caaa35330dcc42a02f9bcda4372b8d11693a50e6a3e2aaf2bd69a1d5abb2232c102ad66d58d02369a2d5a2ccdc7c0dabe23f2d8102052e13d9757e29c36fc4f8013b136394fdb0024e62e3b603b7177719ae1a033654d3ee1bcc8adea09b05dc21ce14431c8112a954b821c4a24ca61fc3309ed68141b64340986692ae1f8bf80ba9222f63ae416e2f81dce8406012cc02c88064f1916a8f6db1d87ceb2467faf9058ead129abdb6ebac19358ee69bc8133fc761cbc0c4e8c3361b4161e655268bf1e959c9ef03a01f7985780ccfd6697c1b0b41fa2d3fd2db69565ca8de286049cd247639d36a237da28e009f353b80627ea1af409870625ab53e05bef62d9583f7a05d82e0a0e111ac679bdfe5c0810b7e35e6d28230d981a747de9b216567dc96400d68fa5922f5a358e1adc92097f33825a99634a8da0cac70f97beecaa91c26f8ceca883c0090e8ecf4bda8369ca8bc060603acf56c4f0fad074b7e045de4feab59a8bc5effd3611302cac10bf50335a26540a44ec99dafebd5012a6622dbd2d816f1b187f07c53db0bdb3c333b2f6565c6c12f122e54ab6947072e0d96c8406d0c857b008d818d7afc1d4ff17d5159226f9c11a2fd5ea09e3f72778a919dcbaf7a7135de7ba19aeabba8fb1e4a32fe678fbe6b73262f4a4435c586f693cd5851287be736f900d2a9f851d8ed0b6799e55c12103cd2c41ac0e1a3abab314eb00afb38abb6514b946de3077ff692d9d899a485ce0e515a9286208bdecd2e597bcf3e5f656936d1c2bc849f8768735c2f4a5df16607b1e3e8c46dfc671ca1157b641cc6480dc320b49f4f521932a3efa385b750487f80bf399c2f84029ea5edf947995d806d1f1910c428af1fc00ac82c9b44eadee9d9d900ac1731764002dac1ce1ee101db24d04db55e62d4c6819f290c9cd0b54eb7d80271723bf358fc7778e69ba6dec4ada414742510fd93cfa83db2bcb5e80894d3affdddd4e7897a2df47ca7ffd558cc804ddf30e9a6e9a1b432a52ec48b5c5b4ee2f0b29e14d2762c7d5718569f97d3344591a55696a59ba0bc94b2ac412183ef63789d58271973f45963e7e3b88bb0a1b2cac2552b3fe38b3271a4cbf46a67ffba2e24948337e5cd6d1f611c166eca04b3bc310be093da12744039aa3e9c2ca3af5214d1f416bc15b5bc0de915940f3b5e2df26a8fe98b8a575a9639383e40b291e3c91c9567e9c60be5810f23b257551c271fd2d4ac7816b6cf60c497df11ce0d2566944df20eef8c963f3c2eedd6d282157cda1c8bdc087e4f459b84f81300617174a4bc46832601e3d23d30fefa85dca92d290434a5859beb77312af6467da3ca6806f9cd920355d44f7aadd2923678e2451b886a73da0a73451f24c5b3f833aa1168c43c6340927efaeec3fbf61517627925fe3974671b45c3969b7d13b22aacf2e61841d3fc71a2e25fefa6be08cceda725babbcd5369080909d8f660999588c517d8de5a65c41b13396ef314cc857c584f24b8f54bb4b4580ed2869a1038109f5b7f92134e439529db7e8ba01eec76da7abbeb51c97cc52d4f4eb6aa834a2ba5d3aae6c24d6c58abf8a8668640ce48b42a1b7fd5fe8e0c1f22fa603a5bb7ad045d735263d24eac7a9f1be80e9a8094facdfefaec6da716c99b0bc7e36a4da6fc72dd6359d95c9191127b1ce61640ec5420fedbaa574cd2ffe45a6c9a66674eed39fb46f31308183eb5efab32c0f85efc206f602ea1752c5b4518dc950a7162fbbb05058752d57f1db3751b29532a5c7c781959e3e61a2d67b926d3f5c6bdbe469d3332432d815adfe5167e0904dbd8280f8d34dc24f6e91bbb2913fe8880854033fc678c653ab3d702efb1c4fcb93528296dd79650647f933f78fb66a93c679efdb124b20410afeb9e23de1fcc567149d6e68617587e3962e65c5ab9afc88d0c11b56ebc3de0c9d0573f843f9ca4c9013a3ab3149f3fc244a4ad311f87c060c79c548f9de234484235a7071ad1bed5becf4e9fc544e74d7f6b152f02f9e726f66743e7c3962621e69abb6474b6807aa648186275c76840971f2a78bc2bfe6536df9ffc45508038bdb68b35258ba64846497590d8a5b5ad7b9111fb2a8ed3b1c3e34178d905134bf86fcae609e10c59cc29a7949f92b43a95e220c9a39583da3206b729a7698178733ddeed1fc7b6451d686fcbcf5261420c18b5dea3de7442315e0ee1eb9cada239bb89b7eae5424a76f6d31d92d9e2e15c199bf088f30f92f800724e1d600247c2e4b4f768db44f75243afeae4ce77e04fbcef0f164c92d07f43ffddeb8460c4189bcf12aa94065350ca25c6a92892bd67b9a20d7edd5a524b073946f3fa9f81962b9f77063d62aea6532c3907b34724335efa92271611cda668792e2364f4afbe38dc903ab7ca13e9992cedb1ae0c705b7e6adb801cbde2075df2044a73f6016fa61d29a32ed17c3821ea7a6d83e3e59f4da3161fe6b9939db19b32c1be858a3818a55e7ebcf907347de3367dc6fbf1689b70b775962f8520faadc00d7aac6030b24748bc556765bd60f70d8b3009ae6c5a8e5ef4d4c0049bb54b56df528964f67bdbaf4c6c5e50021b0a1586d1c3298b7d10015b4f1c318319b0490d1ede6145b1541d9b43f5d8e467ad3e0bfdb0b14f8d741d7ea7b2fa6476e96eda176af7e8f84c4ea66d1302d4093b81b5da945885cea8b743f1ce355803376a58b99c73bcdff3cca86d7f65008798292b9510bf678fd75b5ec607114830fd4c9efb8011559639d591ae946531039e108e40e90fecfa4c5d10a33afb9af638b1cd349fee34d49fceb35272a0001ec2ec3a6321868a1a805bfd1ca99674298406aacd66672847a013d04c198cd0c6e1949730ed996343c55762b2df92acaa614717c9b65646f8f04310c39ea157231ee72286474cdbb57b20f01feb4f71553db2197b4bcdedfe0b0fa4f792f9d5cd1c672852595ebe019a42088b4eb0e8066ac3d48e99f99e6e3ed0d5c2a563493e7d643b1ed2cfe5d0809c28cc080b7c87fef2a6b93ddcd0f3aa4f5c6364b8d5d2517dd837f2d3f384ceb4307640cf84413da2917714b943156bccf3f7405d8311be90cfdb69d99aecbe2a219a7886f64f883e83173bbdfcb68a0a8fa30c94c771154d8b79d4f6eb89837901a30fa5c9e8128d9d77449e053ee0f62f16aa52f140f6627f203b0b313666babf0c59a4247e702236a3f67414710fbcf0a237b3ee3fe5ccf7922ebdc15a21cde0257e9cc5a02f61b07c94f4f4d2bf9c8c3a43164432cfccadef3a4828ee8eec67a8750afa44b620ce6c5843ab11f2af5adaec113f13f135254c5e4abbbe3f3187bd8c995b2803ee1d3a50977ee41e651799753c74235e11aa67e8c59a1e5e67480163c8adc55477db79a7029186de3e260a15ff6d68f2220ec35981af16f012b6650961e137a61db297b100c72f70ae6cee9ab73f6607e84fe45787253042e010d020d9a97133f06317fc93ec87100b7e1bb74b996d8d2d732160af4e7f5dd7492bea6ed7d80666848d8503c760bdfba9e7c3d112d16fcf98ed63e846a31c9b4a280582042cdaf8eb29a9f2aad312f5db303cacd76c1a16d14b7e60f540e644b7819466afe22e533aa0d08ce70eee5ed22432ad7365bb356c6bb667ca170e233389f9cd120c10fd04ef598bd66ca7e6aa27bbc9a137a1981167f4c3ac7cc8049a597b68071a08f7554ea6572a9cd5d72fc65c066518785a3d91c4b92335ea00aaf8315f3f0b40ac524049bb63b2ad6216ce67437c15979850a2daa9577b5954853ba9e4e656c2e6757821de413667e66fc54f6c7bab27177fae0bc2a8785c105d7d5be04ab7a481cda4e80df1576ccbe60bcec9f07fde10ed6f77d9ee0d96688be651469a2d308744b4cdd2340b3107084806356de1647e043092d38d20fd41c6b59d8de29a6930aeefb9492c2975616401e344e17f656fa7694f6248a9ea3d00fcce61bb1a5548b52ef7981eb240a4e5290b15fc4f3b6733160d1da94664b73078a1e4204e8e84ce91081f68b04ffc851cdd7af4ca48c0bab5fbcd6a0785424228313c92eb82cbeab6b04df128b65a83c7c97a049070186b23ff7104bb7ecf5df2ae4b7d771353f4c7d7ac8b70b0d07f711a56ed2cbf45c1243fd87e240b288edf5df9fab9da3156ef83a920446ef8a6d780ff816a7c29ab378a782519830add7976e6dac9376fdc0763c21da40bf4b80960b3e24dab1d7103f425be656741bb188c5a5427c62cb5d5d60360e366f02bbbf4c4c5a2d24feebde7d251197caf157f40e636c01e7ca651bca1f69220d307156248841db5df1761c9b59b802b501670853ab88f92933f81fe0a670c7eda677b5411219ac9fdf616b3b5cafb29478026d40135e56e50714c94cc998231f09992c45735164db1470b3068d1cdd170c9122f901a4d19d8e2d343bb75eefeda07cad97f8431d0d1bfdffecadba5baa9b73086e89f93f73fe5b6f1b4e4834c967631493a83338a16a3316c4cb526ba58eb2a1dbfcfe71fcad96166a41bb5c4655b8ddd4125a07d2944328cda7254596ae40558a11fa03c4a07a26f05ba9ae5fe192e64b89d5650e5e440fa2dfc7be6f597c14e9c2f916c7151ed848216482c66943082cbc50e98f36b1bf178cc957cad74553714efea25e65390d71c952392a33f2df4f73b7b6607d7338a507c4af4f01139e614d5f8389153987ca05ca34eb058a6921f8e90c33bb7af77eef82f78a0fd8d7128454b5d9ebdd47395034375cde30fb48cbd2eaa615e99196678547011af1b9781277ed30f46b53846a8f8ab10cf5d388f36d52c61996731f4305bdbb5bd05f5b2280d500a12227d2c1a64b36c329a73017cd047301fb2e289e973b04cd10376e36a3af8862fbe64259d02fc082ee23ffc292345e7c22e7dd6b4af2f8c61473e5734756055c0af8d8d65190240982a7d7a871888f3af7cb8a461c4684bb5f255525dd7c37fb78b2405f3dd6e9b7b0fab8737c962d672edf33913880a1f2d4a02107bbe2be10d27bb3f124db38032fa0dfe53d7e202a1b720027153b9e5949e58ef491a43f9cc87071a8891d97704d12f5bef3e45d2eb563cadff5a07edab7e95a54aea73026fd7cd5bc41fde236276c469ae587b6b9ffec989f36c17a5e746e373ef5591d8015b0ce80b3b0b1c16ce44aeebafee2d8bf1010a36c12ed91cdaca2d4bc0776d4452d1b47f219218a374be58165a40bfb79284aec8a5e9a90f1432f6c13b22f8d26363f0e6e06a934afb4a02fc963e972eff096ae85e2203e6e568867061791b8d0067249c6501c54dc374242ea535755a88e2f7371e5dd3bacca63e47c5a4938ab30191214e81ba41fa8b872bb6a68b2c5728312d50a88951a60939638010b9dcaceba50142a0edf86427f5ac9c8bd58c95681b575b9a427aed5dca797064ad31aae5740ed1b2320baf95e10a9486a4fc1cada06683d170f6ce221c64f3e8a9f0c37c464bc4b78ea2356033ab551b65a2b971538bb188107d5f06548e21f700c74e8698ff37bd06bdf6ed44c5a5041633ecff91572ad65c6d4dd88eefa1ef039dddbee4e4e3d841730cd19bc6840a7f6982fe66fddcc2b4539751b3d168b491176fa4f0c3b1332f4102f7c762b69f22bd18fc943b2eb72cc4cfc6c910784aedf6f301fc49bbd3f40ae67c364841cd8726e11bc6850180cf380579f2dd4a1d4e7232f6e78b991a2707a2b5cb00fbd098244a7f87d0ca35960ff714a51c62a2e36c13313adc7692e94825c7746ce599f0ac2a891c95868b0ee2c07def109ed47c95efda14ef7c611e1666ac9d486faf845ca2fc4002cdb84441b6f8a9eb6eecf7493ab88f8ec4d138f3c1f9af633a0a3719f7ebe7bd7739f4e51b042b9f5fc418b07952383d4959d481cad4d7af42c4db845f2dc648294ff14920bc2960dd2861a2e525c71bf1e6c45650b2a9cfa0aaeb77e8cd7ba62a1987a890f238c8b703bebdbc0699fc512cfe9bc85e02e442600229a97c49b0a00fc73a617f10e1509d4f361bfba4451cfc80f9e2ab1802c3b862ec6bea41c712eadfc61e01bb2eca11a999dadbd5b2c0f061d1c54b8e2f6ae61c482652177157aa9c43426a1706dff3a67d0952e0afaaad6b11faa78a520c7454593f1863e49ff6738aa5d0af15feb8561411ba2d20d0e2454f7b48933089508a3eaf524720c6d8cd371b1eb8e313f2c1bbf220e337d2189fc27688c960a0b91993be2ffc606063e62674a426b55a1e67bae9ffd67d8cb031180211ed4c2e2fc50f75fcc005aeba11da49f05242fcc933c90fb18442bb7b696be884321760266302228913c4c64347f0e79952090e0f507331d7a7aeb1afa1c586c2288226231ac624f696cadfbebef2438a46461d44e98ac22cde41ac5c160edeac07720213f6a4a08f2593acad3804e387850dea7cc74f3d998778f79eaeb99fc088214bbaea5b8a46f6be52923ad2097b839cd93c01594458c8b14399b510d14b285e934dee24fa4ac4cdcf6ad041fc4a14e6bc3c101db6ed01e359c67514442226d4726a17ed7e198de366b777647aebdfd31c815f159e0cd65616927c4f79496fddeef89aff47ccb21046a06b711cbce2fdd3448f35cdb13e98c9dd8da1a69e8dd9a0550ddcdbcfa6f4fd93aa8b7ba7617162c0cd3ab191206b2d93d984df4728e18c75054c9f4ff0a8046113859954e66362081d40de909067a1a9fb4835524f24eceff046629cd4654f1aba70364abfb79bcda423b6c57018991cb302f768316d314d3a2e42136fe2004eb9ceb3db2dc085ad8336657ba8542a5e8d1ea1a6f2f1b162e5d682b681a03bb33e8c98199c8ef67ec1a1970d2bd6317450bb7a3475030acd10482adb00df1fd26d61762cc17f0e923ed6063c558fdad6f42a2cbcf13a9b4df25acc683a64e9e6939ae25399bd5f4a8ec009fb1be9861f013f243b9a0ed556caa380cb7445540d2bc96b5515c80187aa642a09d03da73d09b878803a8fd9319b76e1c7cfdf3cd7cd54c92e6822216c910ffd517f4a37dfb7c3c1e2d354ffcc2518d62e4a7a082465e33998fa4d4caef0da8c96473be34fdaf62846a316768cfb4219c71d65daf11ac789e9515037fadbd5a29414533cc84b96ef70f9644d8ea03669a82b1c76437c2bd065a918355f7648b5c31188ce2fb434948b714c62481f5fef54917ec2e29b057728511a22b713f368972f34ca3d2d26a0031cc89a877218bbc25f176714769676072dd21b90d5384a6b0a4bb666727c4998683550ceab989142779b872926079b1cb4396166a648519fcfb83c7fd58aa082f1b3c72eb26bb251bfc08d3dc001474b6b994d3ee6423559d7f366b90beffa95ef392ea9c94a615dbf7bd89dcde5d1422f61da32bef17dd1337ed92ef1fe7ce7cc16bd87da7ca2f1e9bd2deb34d2821e6503c3dbbd41c7f37886ef433ebe7538b8021dde469b186bdbde2ad628399b8b2036ca258e62a15a5be04ba7eff0d7d16865a16aa9caf545173487a57939fed8f289eef509118e6751b40deadece0e89ec228e07b8f2cbc68a08b7ae83a0dfb05828581685bda5236edbc825eaeee165e557104d7ddd27635ce4a06925eede9359a25623ba07b785015822ce9969b7fb905eaa1cb95e4e11a7324a1939d47b9a688ddf3fa18a040020efbc56a0f23d3b56d5030d014f56feff9a163acbecd4c14968f6c8d1f69a7c3334cb389b99aeb6b6f149c32a2d0d36b0e3e9d90bc239159682e6109b0fa68cfde1e7fb840201787513eee2438d5317db08f1d244cb55d89f0cf0040910e093fca199eae41e535bde22f4708d085204a5aea5e05cea03ea28d7ee689bccaec0306f9e8de63325e7a49d603d3a31891e9ede04945275e6d9b7f62038128707cb8f82cbaeb919750b647ca9cc075d01e7352ebf40f1cfddabe44f5cc366d5243c43687c79227538c1f190733b6ee8486087ed8bb6171cc550d67f5a71583e567a3f9ca12b7c2b4347398a1f2b71a882651f7230526fb567eecce1f583d0e6fa19b6fd323c3ef6407c6f2b2227b0dbc5d1acd34e2df7855828266362739efbd89caed21eb9ecfb103352b3f44abbe576c1c6e1b3e5a42e255ac2cc3c9e6085a00c168458841d7b1b709211b82faa5dd835e0506cc7aa568d9b0d0a7c74f4801f4b1c98bab61bb662ab95376af2413752fe120fe49025b158d57717c4715f6c2b4ccf56866618cc0f897c981aed771ebab2b3f461b50cbeca136d47e93238a2a607009f0be11a3e74e8061b5a87ff587a9ca9fd8ee040ef25cc13673a64dc3f0dff4f8270b99a6985c1d3581d525210a8263c84c17aacced2f78367402a01bb366fdca120c8bcd16a3826ff4c42871b7a2086d59e24ad771540c122a8a85516589b5b4dc38ea86764196b5a4b96bb73d3352799b0231caf40260ebac93ab135d1468bd1d9002b50c55986e4d9995911cd86bf341d65f28439dd8c61f446d1aab8ac88acf0539841476cb2692e307d6afbe2440bac0f3f201efad9a00ea7e264427718a02717071b44b75af34d6edcf8e842fed3c963ac459121894e9acb18853882b744a392e71e39ff9456dd8b901d8c414998290b74b426d8fda02685662c0f926448059db90998823c826d820e61136c6c8903bcf016139ba78a4435ea977fd82f1635f4ab4b4194f87c6da48163323f42e53cb65d53a6c07a7f321e05c49fdc9272cf630a8fa682197b1b6a6ed692f7d104b2c07429f5a5c27ca07ad938c1d8df60e8b4ec5c752716feda1da24d0ba130e8c25476c316af1c7f20c486ae778b999c85e45dd639e06856172f640741f89187064d8e9fd939d966de3935e1cd7b4cecceab8e212b4cb58de64c83225f13e5b3373629270216bd9cfc9f513748dcb45bfddb0f5486f2d2469f428121e6dddec390f7b15cfa32954c16080b10e6dd72ce1751b0cd4dd4f8a98b88cd8eb380d85e147edcde4a67d42df6663f2ae22cf56f8ff485aab0df7d3497e5cd324398752c0c37c6e5c086b485a8f21ed97950df974c2b342bdc81c829ca81dd74d389039079ea6ac74bf4070feaf79dab756b81ddb18fa0120aad8d38e6bbc069dca28635d9f4d4ba3952dbf678e51c170e4a89b90d652c4a791594ec258c7cd6dda8dfc45bdbf080037531404cd8d938fa07268d3b37b4ca617adb464197e09e331529735868770647924a78763f769350344f03d9a5fa0210b3293b970b8b08ffb8a36863dd45fe8e97c49f4a530422ac91540ba11814f51d435153a084abd3961d0fb950723cded9b30d3cf6b5207150c8fbb98d3b68f1dc86aa2b9ccd9496ee66242212fc0f04abd5590e8675509c3234b3b52f59fa05876042c8324fe9ee5efccedb48c30400781f68663cdccaea0aabee65b42c794eda98f85c75e5690b40a552183857b8cdfade634e5b5a47517374bdd9908eaec0165f1236a280bfa1830e418514c8607465dbbb4084a2d3c360d5f8376946cec9395115028b47249bed761fa5d16dfaee35ba397084421497ae7dbf1f731c45b6886e46d9bdb4e30564b62464f41b1272c5259948d2480496fa2a634db737685c3a1c0318962645685d746c70e1259326186e6e451f0e727e20b9229bffc35a277ef8fa6cfe74edb38e82e9bac43f75c862b38430e332ababa2a49c367b41202a9d7d63be42043ea0cb4df9e0dc8db7575ad062f754ca05d8dc7d4b5c730b26456ea89eb63eb2cfde5eb9fe7be9a46d934c55ad392c5367ca074881ebc32c53c1ee6fc571b2b8b1eae6b28983f50f0682b29be68a933629446491c626b7ce56ed40a7061e143c56b2a32b31efddea088156371808c8687a326c954ac4f8b379d439940c7e302883a4f5897a13ba5d0f8af2671c6787ac95ef1c62496841949488827397ce996d4441796bdba8a664b6a60cc1fd5efa6af5196a2bb61b3151c04e7784aa89237a5e5e40aa1441157b17618c309ff526e2c8fda8b09e67cc6c96a85f95e11326ac77f95b324ac0fc41f5b49ab99973511b49c4f22cbfa4c71ee97b146f1df3b7ecbc7ac8d7255ad3a1a310c63111ef6a839e6002e83e7580f3dbc10830e577001f2d91d107263f722e278461d0b0f19a3ac7cdcd575333f8b94889fe6c087f27973553999aa41aa9dbb6d52891907e523c86b22da1e2c0c3738c910ddfef38e1a593e5c2242d4e4c27c366724a246bf23966caf6fe35ad1e769bc3287de39941198dfecb3b3a2017747d57bc204f8272cb58f3d71170d3c355f7312b2c34b8ab99d8fca329e492e1763615d7bc730bc5c5afb8f6c34c5781572fbe9900506627dc1592595ae5260d7aff2305a5fad8a8c82fc877e9d56bfa959602a6fa08b69e54a405b12a5334c3050115e3a2af87ab0ad0e8fd0da0b6ed7dfc5eda5bb056eae1d66a11dad8e730001d47f5eba185b98b3f76af7c21384dfcd6855bc45c583388bea6e11083d0c29f65ae1d3d6cdaa92aa92e09441a1fb90f457a514fe185a313fc83e69a0af885e47f4100293090071ebd50a5183df79f320e2c168f51d203082f77312ddd6a613ffea8d6026f7606ca78ebca077e221b45596e4c896d20cb7f0741341eb3f2dfa8a18743c21d6f8e41152f1db9b29a0f914caf2e243da1e77c233fd2db7f55e1525ff2dcf22488c3a1ab01698f3ad2e349305dde622fd79212683a149aeb63097e2f5eb7934e44642adffec2563d8a3ff9af11c32e9fb1c4fbdf0815c813bc32d1e5133ff9173a34cae4b09dfff9633db40cac484042c51f5bbec0eec183d092bb8d7056bbcbfe97aa23a11ed9b8f915891802372577e2901a5a8a4be2a01f5c2ef62795485a89212a4941b869e5136184257cef23c0f0998f7eb5bb882e4f3e0004b7c9b8ae59ee3703bdee7efa54b2168f4adebcd64880fba14def615fd68ddc6afc18484dbcdd968ad3e9bac58cd1ce15cb3b6576c1cd813749f5ea27599ab7e79684926dfdd342a7dd6e61407fc9364229df9d7fa46d66efac598c394b9c382a96fd77d27c46ec2644cb9edba98cdc9a8953400d339b68ef076791bb67fce240f9a6f6e54335f2f45a47aed1e07e43635df856dbc21ed7a7eb3794fc475de9efa1547df76d6a0d7276ac3aa1c6fbb99c2491430765ef32d79bef1d8ce9fc64785421a4099f20cf7a79d4e1ec515a89e76341a91bab3b1b75c87cf18bd8bb0005f61a37095bc6a9b3a3e84cede38e7b2ebada8614a8d560dba52baef4a31135abc080a16e49e9f4c29cb4e39249b29132c9105b460e77f756e7ab7f6fcacef7948385e451c4847a7d9baa261fd66ff184fa8a113e55db532f7d5dfd46b5f8b3e0547354ba727f8cd3b57f3615bd49597041175adc1c9273409b91e38e4342f95cc23bad7f156fbc63bd1ad4e1c4c05d56a6f95c793c245712041f8bb07fc97eef9f14df92e94e5f1901befc84e3a3369aade692553dc61a4770424c355b3ce1e6c09f7261ca4336f8cf78e81e37282b2d9e89a3bf16ec40eb88791e5e3908cc387850f25e2bdb3b2c7e93395ee121961c8e6501abf64387749e22f70dd9ea6fc590dfb38c4ca10feba43fecdfb2ed9d33ebfe7ee3679547f2d94bfe61bb48ce1e8dbc21e8f3f375c7025ebd417194b87930c0558e83ccabdedba5fe9b5170a976d5ac52ff4601b824b963f51329eb879915b318f464a43a4a384b577054031396b65fb658abdee0f43e71c2c2f1b28123e7daee3215b4d7a3596e604cfbcf12d669b0edd0bef78b208c725d3887537c184a654d08b176ee42581d37b1d87b8fcc14185b4fc78119903722b6b8c24734809cf84406da8fc6a758733985552e6b8ea176731d66b148b1cbb023143424045461fea0472b8351b6be3f3f75451fe27a23d1b18469baf26daa55c12524fecc77e2d73f536033578cb676da8db5bb59b59db9e9f69272cba1e8d2be809dd2f080da115adaa26b74e23f17a99de759732260e6ca9f78fe513f011ac9dcd9f24a895dbcdd14ddd9d461ca08f09d13a1fa2a5ccafbb22155cfaa19ac1e88d9323927e5d306add272bcdd2bfca6a28accc6cee68ffd22b67596ae6564a08ca40423ca46e1a86fb575b2642966aef57021b4e98f52aceeccdaa5c04b0f57753f94ab0caf21f68043a393aa51731fa8ea40c04ac237fd4fd1bca087708fe1c70be00ddb60ceb7d078adcada615c5fbe99245975319f448c239b131141d2b45b4447643e0a7037c604d28be514fbbdef48b9daa6d24ecf8f5caf539f6bd3c9fcc7c4ef9fc7f3a232a53195d516be891db7e66dd50980d338395a3e49d0d45c83b65d9b910773ca571e0ad9bdef046830c5177098516511d0b1a7473ca80524600083efc13906692de934913dcf7350ad75c6458a8a878d0407cfb4253c4697ef162304d1fb07d193482170bf7c3dbd0f0fa413d0c9666a540535468c4421c9fd13497e743fc107ce2790ab5ef720bc90ebb280eb1786fa20da05e5422815e3855edc485c42fbbab9aa487b32b321ee4864352278f5522ba1a8bc16e01d6347c1e49f9b3946c27469ed3b0fe18767473fde2edf6dafcc37bce5b0100c1b011dc9cee082303ae519703f837383d5c3b2d292833d6c2750329394253b4a08017f5905595d9555967d69fb574e99df9f98ca0fa981311e94d6f920ab98a83257bce004aa63b654f439f71ca216e45caa6caee60aec771d073aa0cc19194285d0e3411957b7e30adbbb36e9c5011ddedfe7ffc82a950d399862e5045197c91bec16adc34200a8c95f2841c0acdc39da73363700c07ec06d98519cb0fedca8b992f73a6524cff38cf11d704a37d366b2a48fbaa82b8a34ff07ac9a4d2c4b08532018897e4dcface1373793ae906e5813118ac62967e52e51160b4435af7ff110a0d816882803adf339e83953796f3d5c03f0351f51b8b38a4a2ec4b5190dbce7aa1a9bbf546aa0d36cabd15b0775813852a214f31d6ab83626833028ee35a7433911103abda56c305c474761d46b320c69a5e4925433ded50f6b038b90281c0dfab0dcb2a29993e39cc5db73598f4aa908b8aa0dea96d536b058ba2ebc7c579e03963546495f17ddd63265fe8d30cbc7d0b47484b18bd306be19decf4889f5dce09157764d65a189b66134b513db8257a47d0c8fde1da9e06f44da564505b3ae1bce0221bd14c6ea788afb6d888090a582c601ee1aff3985fc40890184445f8222fe8fa83a52cc11851421af54f6d54c924ecac885da988b2fd8f26e256aa48df14c9edff3b50495da48550a7962820e9d2b94e4d00c7b9d0b5714bf69e7e9764f1b2719eb7696028b72b779a8e33ff37c1a301686fd55e24988139bd0a4fac568174e130361f68069194ad00cc92313ca58ea2a727c96f0edfdc32967282fa80569bf8c6c1d7d843da3ca9f9004c3254ddd3024c483578d9166fcb405057ecef88f0537b882ca81a806fe87ae8e833e29a7a0afeaca1abaa06719d325fb5326bce69342e63e86907e403287988d097cdbf4811ae7ed5dd32bd0a6b2ccd913cbf5f2a7593cd09ff463345b8ebb2eb7cdc4a890c3f5d1a6c4a1a084fbbf40ca40a30ca65723d258700b4d1cae64170dc1a66e1301f971c1d83fd4d060686407bd90c764ad739011e1f455792534425439d9421ad89863c4ef0e110a65af19bb9070dd45a13d14589648fa52b2f72f54cc460596c43734ea0925c8995fe6016fa7778df5ecd11ebfa791d1f9b2025008c30e6786ab0adbcb9506019a96e88b7a6e648eb17a1f5c99d6bd22da9cff3f28d44b2a5759c674c0ce1ac02ee1216a49ef914886ed8c1d112e3c6497ba7884801403c9d78ac2ddf2b3548e2c78ce089d63dc49361c3d611417f760756931e81c2e73f04c1bc8382387a4282bcc22a26df46dad7c8f818509737a843fa20594890bb0488b3efa2631eab6cc32c69482807649e6bd4090f20d46b6ef55de987a8e6fb8d55821604d6ed57f2a12365a0af26a914a333fcd82ebed9b37d96b85db8cf774bc46649ab0deff49a1647845d2412eb16b895c824fdb5970b416268dc8fb15485684ad310e52aeba4430d3008aee688249cccde270c3008bea146bed99b0a0595e28a435ec2bd5b20082b7cdd571e42c6a06d56c8802d68bfeeb828d76152255d30f29fed4d9f33f7e7f64f8dc9731934ada7bfad8ac290d48f41f9d21098d594da3eb415dda171493b83da3d5a779991be10bccddd148feeb2f17e74b6c22790f35f50192018c322c920fc25ced103f2cd05b6ea49254449b379decac7da5a10c7df834f0690865f682544a428fdb4892880aae265fa9701b489e949c23bdab95a18f5d35e45d089afd20b23551e7cbeb447280366f7432a31469791d1deedb86b4cc5b5035dab8dcc01f24088f58c69fa5ab8267e7440fa4ab46ce01a4f33c0658bca484e65b73addf2fc5b65da591a814ddd3a55f43168ecb8e7c46dc8347f303942788d248a4cb9f836fd6c52dee2ac219636691caf61a13c98aa13d95cf1c188fd107a8a91a64ae266f6ae839e9e593c68403be6a102432171ceb8df4cdd07cec34436c20b4bda87c979d55be0c1b7c0362b25ecb644b969af1d86ecbcc88fe58e1164e273680513c312cf6683b40aef33775fc75ea4b2c4ef386495e9c2e7fd77958eef2c540274e085ad8c1069786411f0b0b63c693ad43af9cfe7db49a6864decc5bb1727c0ab9e5b883e16bf7eb36f86e7621ffc22971f37764dc3cb142e14df7c3fb2245b12342bf40143de64a901c5fe323c7e6b567a983df96293630bc5ec39c39eaf649eae89df74610846bb7bac53d67358a3a0490494312d2ad9346de24ef785a167d757680aec0305d75992f427487722d4b6c99f71483a9d8f9c3feaf62f5b73917d2a6f2d12ebe2d9d370e76617f295b675cb2ed291a598c06c8df7705b35038d6be2f59f0efc34354a1b91ee26efc9b36ff4b6c6bcbb019228cf1d3e4a1458d82056a96e5524de3f9859f5414d4df649f261f3abd285b3789fd51e2fe7b33912a4fd48932fa6272499f4b77a3fee3506764b92f4d3de03a37a491249337e69b288f9f3d9d78d40cf00d1fd0fe11d9ee3d6171efe9520bbd28efaa508a0a239e4cbddab5c69b994e9ec07b1805ec447c64346a2680129a6cca196c838b6982ae4681b67d89f91bf88f68daf647d666d29775e9dd4ecfc9022215b795fca6fdb4101fa2a8ae251eb42015f4a7a7586397778009e82646bbea56ef41f9f99f613a6817b933b2671fc1881542feccc2312176953432bbeda5f80ab74e0edb8f42bb016d2cef84765595d54a24d53e6e82716c53c8e8ccab4b7f5feac94acb3fcbe57d118b9bca01022b432f83f2a27be6736119069f990c0e50e32be1f5a04f502e8340e7f06c54c879228c071532250644abd95ff7c9cc9dac2defc30c22a68f04347e2a80949907442c2ab76ca5c0df0c9e2b20170f2491d5b2211654132befc433f3cfe2a6412ef295745c932483940139876aebc6b7c3272d6dd1e2e147ce910a6cdce8deb74de9aa758d09504f9aedc9b81c4807d513d103a6e2c1df87587560581e59919b4371ac9a8baf02a0413a41d9230170490cf65c77687dcc6bd86104dc0f11204f05c256274ece62c10977a7f875b96d691d51059e0014266df1c9d21847642ef8dc5981dbbac9f59b0bbf24984a800e720c32c0cc755c6bf8fe078290793c382247d198c6f123618e05111675723d2c7e8b9804959d88a6d7771743f478c01f686157f7c6bc6d99ede1f3b9cad84b67edcb24e1b5e756ce72b8def8a58258133c0868bb2098e649677a5eef23fd593839090ef38c2dccbbd896ab8ac0c438cbf767fea81ac7ea3df5fbbbaa06035aa8aedeab7487392e06b04d69846dd1f52d38c3871dd1c36e8e5dd1cc6e1e8babee12b324bea7b82ade72a06c6b796068bd7e04bdbd635aeca66475fbb86edccd23b4ba92d78898bf72bae4d3fecf166bd6bd4f243db2344820f52469d9dbf26a43f50e0e9a3e9df90bd64f3fa4ef732e024b50a8e0f2f84af1b49baad4174414b0101b3ba14343cce50a2882f27d0d8949f936f9d57d14bdfed63c3e9f5ff3287bc214b8077f1f7a4e9b084a19b984e688ed1b73ae3bf6f64edf10f71c82619ce68244377b5a1e988e96efcb12db58997cb28ec5e836b2a2550880c12b83363e244ce2885adb41f4f1515bd78ecfad6f4576a8054edc2fc4e15de617531dd3f4a9909412ed9329ca67da40496efc9ecfd88f16dec2b9adfc192d15295546440eec6bcb83d5cfa4d16dadc9cdcad53f068b76f2e75d561ce047ebead05b4b7c4d808814a3b1c8957aa159aaed2c8087a7063bd7c0172dafe5d612ad08becaf39368e1c99bb335140b1eb930686573bd4f297599462c9215d807816320cf18c5a3a7938a27b073ebac6ecd6835576046f9a0ed85c910b6109546854a0f410d9250a64dec751f9f452261df4096eec2bc7c2d620cc173d632b4523c2db757ac93406064f703a9d87a5145027c52c049e3c72ec45c3eb9dffd6c9af570707a63784e6857a7957a667bc7f51db3e8bbc49602a31ad0687a222e420233d387b5ed9609f51f9f1eefa9bd57c2b868853da6f119c8691da32de62b9648db694c555bd6bb66dfab00176031060604e4f24f8403b89fe82a1f911039de1ade781422ec767efe3d23558f7642e9ed60f6e152757136968f8b3d98eb3a807654c9a49a43e8546fe6ab266e4986e189443b0b6e3c8ca48cdf0520d9b00ae329b844301c06822d86fe4d43495afbdbe77bbb7bd02f73dcf2964ae58590bdda25b7d120a7608f9874d8e64e222668b87aa1d5568e1cb78dd63977e8f8a75c6c11576383d9df7f20efe1d0bacc9e1f8a3d18787b5df5ea4d0c1efaf81c523edfb31d80ea64dcd12381d77e14be60f531a4d4baa0a3adca163a6c7b2f39391ae8522ee75d83fc9857c16e7a3d6e904aa5b57a70561162c82e6024989afc682c99eafdc449dbe3c5e182e94209d7d9a0538fd874f4f8bc3aa10dc09954fc8a1a0362176b77bf5db440e937ec992b7679dfdcd033d414a1e75b6ec34acf458f4f10fe24eb0e7593a579993e586c618f3afa36abe14ec756c964f48548d921957a8e1f32a0c60e4d268fbe44091d2c7409e6729fdef751718d1f36ab0c961ce724dec4fed3e06184c4fb3e1f0403c896e858ef89f9adfdc64dca69f32e9fc27a786d65498b99c530bf62f1b99c9911dd83f17944ab2af5098c70dea7597db6685ee9053aecb1330648ec28f0ce594435643468a6d90d589055b83ae959db1eea79c4a4641aa3e8ab0290e69ceb947a55491665ecbfe3356cb2a88446b7ca39f632af9b19be1c28b71c02345e36a59c3f1a52a03a15f09576d811a9afb7732a964a60f01b0ce23227b3b4e9d2d8901914fbb22b1d0ed25f34844704b856423b4ccfe3ed6b404ac8d46720eb6ead3cb683c03df566074ad80bb41e0a81e1506dc6eb38b6df3f68ce699427bdd4fa3d4592e46151e4f746bfd37e06e19dd28e1007dac47722fb60fa5e101240c449fa2ab78036bf08962eb67330702cb7e41cf08ef6068bd921e0e7e9d8d2f1f9e9e4c1d4a6e13b1aa6b1039730887928beb5d8d05ac869ed2bd067dfc43dc3aacc4f6e5b494028369a01d156ed5164a44905d961e8e7ecdf773be1d37c7caf0f08dbce24ea9cacf8a809cb560eae40d59fdf87862366af73e1fad9a1392541e50aa51d73a9fa9c15c08c6fdb8705b82737ae15c0627199ae96b443dea4ab892a09ecdf3b9ab9d458f29ca8db4a55773c1ceeda46ec8118d287e5b256c60121fbf3bc4d39f457c55a2e1104a3c39a1fc6941def6bdbcd8d7baadab6cba2878696170258e0418cd78f549e305fbebc6dcdb9993e6ed2974722cca178354982c4c719930401c32c45298762813b6b31382351e9b7eb45b9d281b71eed958e5ef0082ea67d89af88c450e91eaeb656e62c7cdd644d248e6bae5b509d5c7a5446a5de0a4ef5128c24c72b5f55ed7720cdf60a737defb55ce69f4a2acea65f2dd90f5b534e80e9c5a350096b9b5fe7b74c66cdd38d3cda9e5e1d2b8047adb4f3c287318946355fa9b78c3a968ecb42a41f20bf4334b917174a87bb6763b6a80462615bf0c41dfe161e9e9991ee0d2f461d428591ae415f8c0c865ba2e447edea07b0b2c39b88f4e2cca8e13f5a48b98a189d073c5ed3867e6f1c1e58b158d24e274f73433da23fb3fda97dd124f7bcf23c6c0f5924fcac7cb9c2293237c6b269eec88f9e7f690b63eb239d085f6b00bb3382ae5f17418f43b5d3333e0a89fb8a37bcfa13c64150c34c85c7d530d84e17a1fc5d0b46c4993b8dbc13f03941fb02fad36e76bd20db83ca4160107fc7c38119a7dcfdb60e510225f3140300a0e0cc53a1d1b45ebd51968ae93ebe71e8ecde7c18b1dbabf47d79da5a6213da40f879ae76e58dbc774ff9a8a1152883d66f0e96693bdba0673931c2428d2b9ab30a57e3d2759cb69e184933b19b1d2d94a3ba7a2dd377f549088d9c7a417e3dea3e157322abc83b5509c5d9e57f943e15ca406f2a33860113b76475ce2731c61fe45724f9b179c7faeaa005b6052a3c2532c545d2a1e2d9a6e4610b0f00867184b4bc0e8e6e862b463a4e512c31de989d3aca68742fcc833ad12f8133a8143ef5deaab1824ebab851d4a05132549c97744b6a80fbbde0c093979319847c55a786389afe1584f1e844f32a98c0cc9c49aa3c6445d4bc2564a2b6a622483ff910f057c04beb7fb4eaf8419c17e87c75d05a661c291d155b662ebea19d0e08ac36bb61787a55feb70ed588013e1f257347b6a26e252b8ddfdeb14130bfb1a9488081d25a0ab2fc74e66ce8a894c6f98235d5ddec453e46603e95d53e04a97577a65e5c0da24be6152a3f477325e30d755453a9eb2e2ab89bf270d066471d708408329041c00884e61f234e8c7383b05153c2b338d272d24b4881dba5b5fdf796506a1267e03937733b0d5370ca188801de2e4b403ac76228067e05494476415115ad9475ccfa53335304fbf8d26b8a4ef7221ad3c8e9d48f65b52ee35544d8e0cb098948d3b9b29b6b87604463661f6a3789b73f96c0485a9dd42a4073aed0ee53ef3fbb2e44f2cc0b92f2c790419b29b1245d7467f73616798786481c101457039a269f1ef24dcd298d0bbde1b7352753bbcd64118da10914d8847279b898aac5370abb3a0ce19315feaf477ea9ee92e7926f050f85089c43b9840577ee98f2506beba55fb481ee30aee7ab08757f2e3e2efd6908c80525786becb1bac11bd154883a6b4ca9e1dff861671b5102ea901a98c019288b9ffc73b65a07b89cdc839dc31fadcdfbcd9fc0418984430393dab21421364e09667b0822eb2857f23b6ab988b98c6c39469f32df13bfa9aed0012bfb98cab45f65f9349916c73830b9024a462576bbe540d15a01eda6dd5e3e178b30f12a10c61dc62ae2ebe1457838e289fb4cad9dbc54ee8f49c0bc4fdf4122ac73e23a0e706cbb80c75e86cc4a76624ae058b976976b56d2c45bbc20a280eb11d6bc2beffe105b9c67ef148f2ae68ca5d0b3f8e048e50ac4bf3a029c6763825b103f7e78b350e54d24f33f144370a09e2acaaffa8e7051acc7b3c4462846e7de757f5853066f1801e50f49220db9b4a243da5fe88429eafd93ed3d8368b6a8557a34b9f544ffa56ed12459b966b63b054d70a684f38b305e1195ac8023c6932894d86097d121ac7f9008f41edb3026eee5fa756823cb8258d425585a78f561ee997cfa454bdb574d11699773c1727e192428751cc2ddc5e6fd21c8abc51cc8c5c6556f4b0a3995c99af86a69c13be8c7bffc2cf0c9e284474c8f614fc68ccc41c4b5252ca5f9f6be907ccb5369ae27c9178d0d2c49b4bce0013b59d697ed1f963245721231afe2cf2b799f14e5918ad879fe5c6ab9c504b13455864c2caafe2ab964e7fbd68c81785572db2d0e4d776cc25fa179bfd2728d2e9f4217dd1319845f3983dcfe2ec1f66ba35efc00a04e7daca0079869a1e28fab9e3e9dc411fd3b4c44dad38fa92d25f30a0be57ed01a7ee87006e9b4c13dc5c3a24c0acb509b48d0039e37bb381eeb342e859889b9c29110075e2d2c1b58ba2ffe565c46a0286dbfbd2c9e5bc39f75a83c169bd563d4fbaf87315962ef1bfe5a475d29a509bbd99b829b9236c2ed63eae5644851224f46067c1dc3abe07a663281788b3867bd8e91ae51b0edf9c4bbb4a05cbd4d62cbd2d6f9c8214360af22cc4f4326d38b604d3e5c2227d172c61ca76eac705ebc85f37fe925d48795cf7f6773cba6d4b8b046348263baddb25b4c62f25f41d1ac0a9a5c738b261e1f59113dfc7b4833e659189090c2a51059fe22741ab04a3deecf2bcc1d4c1ea09598d92955c601583ae9471e69865bb57b0793aa6b5fbd236b2a6b02f2c58c461c0804064a54afcf65108ea37b2c808c04440bcc7f9d0ba980b9e32616885ce2be8f848edee746527a6d3ceb81841b1c830f5a8b22e3fc5c24b194ab6f38930a6382274e0e0121ffe8107a511142b018ee98d26615ea62e129a947802ecde12ff811c309697b06648e827bcbb4656f42a826e319b843b78769da93dfdd6310a7232c085a01f7f20000780390c8cdc61369beba9d9cdf099bb65522b9eed52183f0b0fa2414d68116c085ff4be5131983acaad03adbc387ac524d985817cf0c256b660f365b516a17daa68ea30a98a37e79cc51098bedb46fd01c87c6b325b31ce4f98e348483cfebf1407870f02103c491620163d521a88667b6ffee82eabdd5ed888ca9d0827b35c9600d5f9e3aef399e99b527c5c1dc5aa7bc6f36a5547f1e4612090db5021cb0d45f374b3dfdb6031fbe74b3d6ae73842f4f8c41d88e56a5ab21acf075dcffe7ffa1e06c02936977a75e23530f8923a39e2dc00e993f82f74f4e71818a81fe01076ad8a412c770fc2ee994f574f285e7d3fb44f75d1fd11fcf1c651812aea781d3acf5e81a489d762f82158f718d703be04aa059697055edfd165201c567180aa6334873228958dc812b62a491ffd1be92fa077071fce51567b7d5485d727f37d765e989340c2fd98ac5bc3c439e2768d4768b1dec3dfeb14d2210a34098b5382792793d63b536d1ad38b69515e62219c47cf151e93d6c7b97e4fac59362b21491aa44ca08d8e69023245b35230baa004a995222bb4c47e347c933fb903fbb040a548654e0bd3ad4f062856a758e64330ad4b93d73fd2214c81884e134c84011b5c75e475b1532947168ae1c05afbd983b86ae6c0ea0f173fc54c73149df8eea4bba09866ce20d071a7e38618e2b560f94e9dbca46cf38d2fcf3a5bb342ac6b8d509120774871c3806b3b23347db89f8043dbe565f4e5f3a705310a6250a051beb38320d54db8bda40f30fd15f0a39fedb54061c7e81e71de616772840e1c7367dac4062d28783a508ad289384affcec7061c0b7b3f5ab0e9b8130812bdcb85e9c471434c688b0ce87c69f39f5c71f7339a765989e00fb5f87a7429453c96a6ed5f8bf5c143e039cbd083127e15e98e5e74d0a2a26b0ccf8cb48b37f2d9ff1f053bdc34acddd59633f178e130ffb12a095e7179c3eb249462665623299e19c26a137718e56c276ca720b83104f097a5fa16da569f3274cbbe166b80f58be797ad5b4f069d7a86f2a6f59ce742a7dadd8eba7cd586feb5714574b50685a89edbe9fc4236cd0c532529e2c6b7b03c645993dacd013bf93da6ae44023f86fb58cefb721ed6aa048bd73d406830f703b6c700f5fca5eeef108d5b2626220bb158dc969917edad9dbd6c91cdf435f5aab7138cc407fbf7c74e7f9d1ad752c2afb1d1791cc8e5f00c20c6b86d56d9f28c080516b98300a7b6c4f514a9a2908a206d62de5dfb22491f34abfd740706600d490ad285688aecab0c92054e68d3b3d81052030b8e2f8f7ac7fd7e437e4478048dcd1e0222ecbc16cbd5794af94673fd4a13dd22e63c69be4d07adae7387daec0de46328b657ec53d6cdef9332c2f5f0adc865ef47665fc5c17472ccbc551ff231e01336998585b383250efac9ba975e0447561a0e882b183db4a8a115692feb7938d52091434ae7b29bef14cd7de8fe2bfac7ba5772028e742fa8ef3024e36c4f671fedf382e35552c5d5d79990a77342306843457400d90e5183fe13d87bc47cd6ea748dc0a382c7a20068e723da5c70f20cc74f46f3491d23028bf35c13b8bb2c3b03899b7747a0778a20f8a062fa7b4a88b3bf9eead17ceac2a510782a0a05672c0175f4541bff3f9f3bfcc592721180b4598aa2e60f761e364585db326788fa823964ab3ac3869a74432270a362941735dc733b14881fbc72ced5081fdc962454ac5c5ee28c1851bfe1ad4b85d4b1417f4460809fbeaddb93d75f317723e7353daf035a1471e01238f05b1bfd9fc48dba36d5e92f3447ef6330dd9d16094c579b841e3701472a947acb9f2c3a3849726f3da36bd362c3985e36a24e1a6c4bb1383d382adf20d99fe5cae2fc4085a28ebe577e8285037324a553e68d460485584d9116a58ca59e952cac0aeefad25cbfad55656c1dc93154bf68190940d9619e8a68a53374b97576c817b7311d57725a0324b09e4acef63ea9201c31386624e8dd5575e36cfa20950048c81244f996fa60f3e7ca64bdf9859d2653c221e2761364b694244e855269c9cdbce2d83438c08b1fe8f14d709d975acae1c792882ed2fde259d79e06e73f1090da28efe1ee867eadf95841d35069b1953744e67eedfa9f73a7f31abb45cc9418f55b1eb654026c88f23ef232890b0823fa4c1c83868badc77e9103dec1fdbf5da8c6174c618dcd6e511d5fb6997472d04f1a98702fbc7c971319acacb3ab9e033749174e0f7d07f39a62a09d11d0308076eea548240e592f5de6a79f8b975f4a6bdd46f0a8fa43c126331437499c20b0e5c66ca03899f68213b187baf1c5b087a3ae1db25e966f71312791fd5e59b1fa8b3fcfa9590a3719672bdaf9fe14b9501083a03e323ab72fad523fd769639df586960c2d771160903d539dbd6fc7ce830cf0c970143170ceb2bd1022fedd3381fca01c8636b775db0422ef97e1f346b24d6343ed03cfb901e354c87a67c0e134aaa5c57ecd0411a834dc5c0e07e421024a7004ec8718db7d4cd1c28eed537635c25529e7bef5c21647462a85da4627be7da114568a9a2685ead927907796e2a41f38829e354b660be454b924f633ef7ae8bf18576a843c59a6045fe817af370449a02d84b2a765137139cb1d3868b418cfe5a00a3db85ccbfa3073249c346ff22c830ad296421ef8aef57ed46ba75af6ac4dec42c69aed8cca7cb61cbb93194d852493e4cf3be7e12bbf9da62416c93601ba2af6128acc82b74e165136383ba16947e34b33c14314492f992f5d824f6d28774fce18eb120379fee514a74dfa7fe29ee63b458e61e463df3c89ce2e97042ceb8fa2e90764ce54ba96a14f720eee095b31579105a523b8cf32295dc1be738de28452c3172153b80f4a31d67b3afadc266f1112b3160c6d1de5e50ea2c6096a3b5288c823ac74dbc92a9908be04ac879e0474c526a31005057284414c5168d4bab907b631f30f5f10d8c25e6d28c67e7b72ac774cf25b8840036d9eeeb885e21b2fb4e1415d0444653166acaabcf64c95d0a1f966c9972a6e6c64b89426c6b64175effacd9a049d90d010c90c792fb93751856c3452d4a23b3d993778eca1f65331efd2356b86ed33873ade607840dc2d951e872c554cd940e896ffd577212302a3f8cb1591aa1d815e440a1d16a7ddb674e51acb91ebf361a247a776aba1fe4459b4a50a62c9902575cf868c6a48d3dd352cedd951a9f03122fb69d2b728f316e9e84c0147491143d2e1fc62d35421d6d6a7302585f13f71171ebd6598bfdf5819b9247e7657e39f0c08b157deb277ddf017d2a8e200f67495a3c05348b9f8d5fd0a7260e576db4a60cc5cfd39950bcf02c9a43ed3492174c5cfac4b3377b331146c2e34767680f0596406f39b33d75a270a24439fe5797bbf270564c3fce06f00f8f72300da228cdbfe1d254f0d8e69bbfefa2f46e36ee9601278a2edffdb5ebb7c1b1bdd00da215403d65b8378e01f220b0bcc779b9873946cba7261e27b72cc61360dbcae0d2e1046519713e75ad6dcd63e1d95bcf4deacab345994ac9052ca37da1c1d9b1a42de4b2c6cd748c485678732ba4cbae05ff929a46eb45f8fc3924421b00b74e1ca1f790804149e5ed51702ca0ff175ee1e2d67c33ddd31c47b76b56c52edc74038451e02ad2c8fd52323e34de448f0e670420ec80f335f80f9c80624dee6feaf1e3d67233edc78575d546359df976bbe57cd4db567179d69ca746238ea099ee590190f7912517daa9cb680a716ff20b01a1631284a7166c7dfa7b961b470b91d524ae9b1f69d5256c2bc5f4353f6215d961d6b4470c8fc9d24bfa733f064b77e8dcd7cd872ba11d25e3224ffaf4ac78bb556d60906b6f9d3a1fe52bce7902ace3b68bc63ce5f1bcac33ab88d787d33f8c96f9e1a2062d4e4660ffa54e73ec3439e98aa23b6dcbfddae502705e9521dad0113d46bf9e662b249b7544b8e732480a9c9ffc6c651c2e012f9c80fe9b58e774f2c4bd197731d60c6926f73f64ab6a924ff642ad2ce41e3b4743d285b9d63701c19203aecba418993fa0447fddb6b5985ea025259dcfe0a5ed097e26c811e68f1f0beab47c759aaede9e0236547bbd30cd93a0c10d8b8d29af79b04f1c022fc113e128ffb3bf64228a631dc5cd90188c786883c981442e054f9ea49f814fe6291ae635eca703f3d9cc8f5467d554d6093fe121dac4bfdf32937f3b00ef6cb2512765ddf650e871971f312252678bd043939c2eb50bcdbd188c3de5ee7f85fa993c680af38d241f545796a55f084f839142269ce757bfdaa926dea928efa1de4fc451ea99c84d6d33552c41f125582339b2e277d49b9323e4b405ba6dc9c58cdd1f4886a03cca4d72dd0b58359984fd3c1223a96153d4a04c5fc362f7ec876ecfb5c430d8fe07d9de11dece103d0cf8c0098aa48943dca7d66385fe541d4557b3953ee2690779ddb39929a819e2048dfdb2338d4aac3ae3f020bff6389838b1c24bee37c7078c09f9e18e6813df09d8c44bd5e6c01014535471ed21cb6fd6ee2d92855f251bdc2e811c9502895041db1403e644d6f3823a5d130d71c4a7064412600bdc25d3ebb964e577ee39b51a25ecf52be4f6a51ac87a274961bf655f7ead06dec21aefea28ce807b032b8dcf838f02e46372f01b5980524d46da9e1ab6b75176312d6ee125820df212f4a391995aa00bb9ffbcc45d5eb2ee499e5c1c1ddf5211aa012388327fd2e8462a016e3ca1f960eb5ea808a97a8bc100515978f108ce89e3eb6c13e29e199e6ddf9aaf55059250bde7419591fae9db25edd23b038b7336485f01cacc1257560967113037f210cd07a2567056402d2c2ddcb8fe0c2ae1be2ae0c228b570a85f8073786c0314fe5bd368e3d912569386ddcf1476bff2efb542e5b6ab40e27ca8cd90081af046618acfbb971d5442b78fc795dbb3a02a703db77a59df59eb8f8a443b2ca144d250883bca5f5e61c3b281c624ad54fe83c835c4cb70ac7902ec9ee2f1a3cb53c06503db0473e3d7eff7c20399261f78f4ace0824bd978e341557a5b41037eb3c13c50c069ecd5df7ffe1b5ac9bd3104d150ee3a0cffe8f9618857317817b4eeff03ad4fcfbee9ed2f007619b45531168e8a4f7df4d51c1911458c50b7055160a0fd434a262286623f5a23bcc763821bc459f36861a8e40d2b75ca52e4158292a4af69ecbaea78af402e3c3b873da23ea60a8a2c258d1ec2147fb75ac5932779e3d3f13808e20ae9fb7dfb6ed14d12b65a312b20421a16737bd2689548a418fdc7a43547a2b0686fed8204afeaa47fe4a9fbc7b4e7840996c3492f1d4b47ce56db43d1531a18e936c09ebec7715dacd18fc3399baa3c453016a5ccf837f27481cb05ec0efd1afeea478f790b60f924c16c71a02a1c9425d186708cba83d77439fd58e09bcd609b6ddc964dbfdf19861832f71e0812121f1becbcde3e21db929f6eef998e651aaccb39cc5ffaba21ef6a4fe8d82117185bf2d14903afa2c4e0598d4d2268a9df0b899bf13af94dd61dcefc79c6114eb380ffbbc3c4b08c9272c38fc4f92f5fc932e1cd7d6ba4f41efa6aba1ad55af6bfc73c26748b0bc853667bf4bd4321d509052c936ca2000c1858ef8162ad60f798dca2a5d79dc044a7841e8c67f4306fc660fe20db5fd4fe8c7ec854e4f3b801df01e5e3c4749e6771cf95cd5c9c3a936f0a8e04bed6f66390416196ff504a4c693c32dd840c534ae2bb786062039f418ffd0f8966e6daca627282482ca3a248a2e83f5e55af4c9d2abe56001bec6a087bbb5f723faa49544340773662ff3a02cad78229e88e67a79b2979f80e529c358f6d43ec362ee8f6e40ddea912be63cd7795e836e875d835d69e703a262f78a1bea7febc3e9b024715c3c5faa19df90bec8c70aa040b1bb06761cb27080439ba51794ef1aa47c4281434e3047a52cb47a75871f2df38f3b9840bdfcd44fb2fe6d9add5abc80a5a4489a693359b7c9c50cd4dbb054e188892c5319f94b71f80dd176467b2e891f560ddb2c02b9d7655b5ecb3bcc2076c4408192399dd7ad47423120ffc670d0296df5c5105d828cc8810dd1fa407507d91ab2444f66c5fb5fdeb9260cac59770a65b48658d5c1ea27c7c98eabef1f9c545eb01b1fb1486c11249cdbe80f556fddb98c4cceaa9f3059c54399e56567927bf4fb563f689149801af6af3c952659f6945dbddf0482522b25d71024d6b57e6d87dcb7b8daaf88573128588fc032313521c78f8a8781720a6d347ad53014692ee38ce3338ad595ad5d1b5009a5800b82d8523f837b1f90f7d484f695989287b1b6edb65641ccbef93b6a9bb9484c0e50363a01ffbea2e1dd5f4299d8ee62480630c077824113936769400f66a6816576ddc878e9f3b8032b9fe7e4849c816449c606d460ac67ebd4b375c8c32b2d469642951f73ac87519168a7219afc9a8fe1d15a655bd1b9fa82e73e4ddb071f5f8679cd068a5f2a8d436504d943408988461564f884fd766ece55990484e98e0e4a2e67600cddcd3548f1055abc52f446f5415a9077c99ec03cbf7b2011d6081d9fa5003869874a72374046336c08e600fb7c9fd68c0c91e9bd91d53a590e9a51a372f85bc06a799f012f2bcd3300064e89e26fb0f6856e86dbcabfa912df05524a1f5661bab9a1fd80e63fef1c9b8c58fb088368be7fcf2ff5d18e90ac2a949a1555c95a23947f96c61b58a6497388dc8869ccb1f912653f7196271d1759ff60847aa835bdfeb48cff48486c762fefab4993977ec797fab10bb4090e97a4f3287cde9a905814218d1713155aa2a17e218eb839e5f27e56a8498eca1f8843e2f477d5d59b602a0ebc95b8ad10d4935f7bd5c6a8194435174f041157197bf564e5306c1f51b440ae2a1efac58047dbc78abe7d332fabdfea33b08e057a3d17eadc610e2d7632c197f29986063e59b500e4a67876405d86083494e22edc29c65b2dcf6c5fe44bf218affbcdc17d51011230147fc3d197158f7cab739a389af647513bcf71b6e4042c6a37c03c23d758e088a19df66b4488a59d0a8c009bffdf27b4046328fa0981d6f1eafb15f568683643d02d681b2d17f1b0befb792a9350049436c26d9dcba5a06b2b39614a844b4173f82d5cb6eb23601a68129b9cdbc131a602cc95ee3f17013c1a94c73b21ea16ef4682133cc1cf665a78564e772bdaa91ed2aea708a4d577b5eb729074d51afadad306c455108308202bc6db6b66f456526d7ae10d0d7b8f897f040b44e3224c215ef5563f0364a04338b9b16303732db05a3847f7467d34e74ca260fc4bd4272600f3894449ee34db8d4400c97c77e120281e04f4615347f8de3a31ffbb8cbcc80bf3d0a029d169ad6bfadf9917b734367ae8acedf53842cdfafaf581fbadd80189c85918ae5a992835a4bb8cd2f4180ebfc3798ba414921aed97e2a31257097bee1c441c1310b18dc68b5c6c3f9f0b3934188bccab42c72cbf08203c817931fb3a9787d7e4faa3cd91ab32296b5c93098af3756088156acc079f672a92e6fddbad08dbcf828dce91ff6d014af51c67a80a02a2b84b082306e6d854dbc877cb9138dd09a7b854c1146122ba9c56c795a0d5a6ec07a61316d3d5007f968e7588aeb559722ecf6f9277520c3745f5c7a9aba105582fe0aca71f17a29c51facbd70d75fbc53d07a8cfe918896d0453af891dfd838f892f7f1a9c2996bc927adb2adb034f6edd0d47bd4ffa453afba36b48f4711af2e4351ea5a73ad5383323bf1684a9ae2366c1258d751f9ad5c07f1cced3db79f04211f01d7f7de7d385f5a8e9451e96e1b6326a0c500eecda42389896aae866043c993f008cc29df13326cf033941013af08a847da2a22dd043c1d29b478d7dd0579f022271f4f804798cd74db78bd13fde3a2461b6a5a98163848981a638079dfea6932d8d12b13bf14500e55aaa051c56ad6da8549f8b378ae1e4e269574ab1ce651b4369aabb83c4dd7e2b3e020d61f7d24d8827ddd21e35b5d35de106ecc9038741b84a2c518ab871cc0bd36b1b00fe64c2a4b654af9969cd378509dcf8bdeefe7205a9f9b1928143974d00ea28255cff0d204bec9983b0821be81c4e2e3d5bf8e31f42daa2b12d8bf46a47a8ee46102a24c70818417dee67c8b68e40406cb5808b4055da26f0176763b2362e69770f3a6bfe4795a67dba6080aa30b10db7ab492f5ee25a7567bfd35d1a5602f988f74877ec426abdccf72f5835bfd14b7f1ed4aea3904864f8fb21eea4ee22cc81bccf02d9f09f718cc79affe7d7904937bf258ea78337b8da84ad3fac9024d40b2a8ce41a35b615da270d70c30cc00f3cb24fbe4ae51de7082ce928fbb6e57d6fadfe435255b1b049f167ec6d373414f9f8fde517af5f37e37cf46980dbd2f4426d39a13231f7326a13770b4905af679eaac2d93848e0e0b9fb93e08af207e64057d60669e0c7bc90fa5d5f502f15105a05f574f2909a01af5cff9361cc8a325303e325f3c41925180c2487ffb293efc4c1e28998c7e474ae3cea5a9df5ce413e6b0dc774f71decf454a1e55bc4a40b032aaa417c9db1bbf8415974ce8ab8cbdc09008540f2ec73513bc748635de6bdaecd0f956b166e22e49f5784e1e19165da4815b3475068885402bb0840166fb31b4455cc7e3ded88b3b60990f7cbe89f1fe7ef613e48c41d92c2ed02fcdc2b172e6d4c8ab47e8a40bda91e566a890c4a71569dc0fa87c1d175338938db19a6287613387682203f3a5b4053b6d0e9dd538ea0a6c9b2cc57513b46be2b3aae72089acd2220b0d51e7c531c8ef71f4584f3d3897c0e34bf01ae8cf82510bcc5683fecf62b18a2de0ecf4ff90b89e3b38f1dc3eff59a090729bd1473d1cc43388023137c8f48857c89843db905671e4ba429c5f266a7f01d72c63572b4c2277d2b1cfc638435fcc3359ab66405109564fcfec56725bad0adf8d5011cae65a16c7c9bc9c68304149cbb1a3921ef74096303f62e8e6c0e00a75dd6ae487433764ab91a4ab1283919c74993919c673d92a56c70e8a5a83ff7eeaa6382146ae1796b10a9e46309801645e22d38a14262dc0a52194179e10be3c7474beb474ba6b398d6b1cde692fd93879d22def688fdf012c7d709b339b95d2a82fb7986226c61eb5a6f404ca4766051a8bff291875ff45634ef350f0425d638028f2aa18e732c0cda5055c30306dd8fea5c08ab13d6feffc3beb48c047a20e19c920081957ae03bcc8b2e922cbbb5393fd375dfb0a39cfcd21e9f033f00fd6d1fda813d7a3c9a6c49e086b1b4a6870d21ccecb5f0b252431a70f8e194f9d45d9a5c52cdc050ab50e7d92bf2fb75950e0feaea1332a65baa80a8cee04671e39f3194ec4904639da746e999ff41626c21a10ccf7a8bf5805f81a7843de494ec660ef7261fe74717a4ace2fcc21bd9049840928b15814eedb6d89d7b296fb14e8658f9e9b8a9d9dc4f228be0f033c2e8b77c93fe0044e2d8402fedb02f8fd229b0dcfe539c8b6d61a2d5e5222110440bcc593d6bd19d2b44469fdb7768b4026d91ebf756a93cab642e6cbe1f758383dfab8cec8ae067928bb6b052f9c5ce683689e07b45d2ffaacca7f9972f235d579273738664632d8863d80dc3f56476e97f606fee6c018541025044418c536068ce30749b300b5a5bf0edf902e89bf81b0254cfac9530ab492b54c97471a0fd1d535c914ac1f52c9eb3f29d64f7bbdd3e23f90b3be3696665c671e8e34e5e5a0d331436bbd48330dcd6c73026bcf6517ddd0812e69055c14048057bc85faad81e5914e4a45206752489e5a4e0f0ebd1091059c0e984007611dc39565cd213d0c3acbd59482cc2e59c524ca9473fb0853b4066df293e8377d7e81d1c5b407fed9ca9b384eed0c7f81a7b7a36ff0a8cd77154f711a1b7ffe8cc8eefbbe19abc8f943deb316f2131193adc11798479a7d823a4f5f06055ef16cd607cf2d38d68584fe54cec9f2d3b983b7bc5160e6eb970921101a10592e696c8750a27415efb3e4ed43efb55deb7f240bca8605bcf6c64b932893819d325305f248cdc33b1bb2b859eac8c1840572fedd41b5f50eafcf2390b7d21e2f6424b047262bcbe8b75c1688b83d84ca38ae632c005542b2879435c80f1911a5790c97e151773421ca6c4fee4e07b6d67a06a170eda799f6b39ab9c9d94d200e39fa99eb0ffb32138270da53b7957cb0ba7e72675755649fe91fd79707163b742e0220a6392160d25b0eff049f1f04043d0e5e6c4cf4401f042aae206f2c1e964632891645ea12ebb8e489258a3fd6cfd9d46da5f122cba54ff5729a6db85405e7342eb7041c980768b35c77dca51b6754882bb972f74d4898f82650a46035d1ea7526df0f97d0ae985c01669e3a52d16f5984e027010d4aa1795c867a642d5aae980b2a482eb17ee8ab9e85babc0861b2134c968efb533004674ed51c0fe9a3712c1698ab548f0defd3dc67a67b754c3a42172a01ec4b04c455ca9840bd3c35fab807f4486000118c7f3ad2366a93f9e78e2a65ae7a40d1192ead54e8568ed232dea82187dd022f18a0b373682b47e330a1d4ae3baf217edc380fb4c7c22bef741d67ef19005689ab5a8c4d2adbf96ad06bf59dc99750c33c23956e917c41cdf1ccd39e1a250d466fc5679990f422f3cd40dd41ac2388679e91cc67a7f47929c0576284e7f20071aec351c6304d362faa4f92f5f6465d6eede2204654ec37d717060c76896a5619783d9fd16f85deeb7a18d4d6ec33b171f2a2fec004f3215c13003c85745ee160a5991cf46d432a61efed7f04595598213061abc83c3ec52cb2a73bdf433804e225693b29ae9d0f9f4c90329eeb0d6ba05f4bea5b8652199c71f3136a8544c9323d431182af37692735c7a5c3fac368a98dc7db220eebc12a5c42cc78e54edacacdaebbab7d3218d2923d07479a1ce2c4da1e6696894049d347bcdde56c5b500c5da2cd070bde8baae20ca93f8ba3647a1e3f15822a6e11865478e11c2c38db9e2e1a914559d0bdc1963d3538407d48ac126998142a349c1248f198bf6d51f669c0462e5cba6ec600dbba7a66b225ae8257ecac11c26219c1e61cfff45b7fa48e96eddea3891f02c6be5d0acf48dc17818bf923760c49ce2d985b5620093083e48dd7af44909728ba58c35025d5951a6ee6a60ad3a660a840abc753d02a93950fb2669315a0801378a05f113889bd0b344529d0c733c7299b653fc6cfffd0c82e1a938d760c4b3680bb926a7d4973ec0de59f6ab3c916c80f1e178aae041179bb9d46c6dec566294c9d21bdb17800e3f89e574a59d04dc729811f3a09f8a5ab4ac9d402a3dd439afe3dec3cca80beaff5bafe227ce1c6f6933f7bddcbdf742d205fe894d37f2892ecfb1a144a5ffd3a7a1787145badebcbf8cf4f37eb234cd13711e35f2be42ec69a477a2c89040f9e7c6d304605de537e9654b454f7dcd49f728972437f568be4781cb5710b76b4dfbb3104cafd4e1b6e46b07aa29343a15f49d7e100b5bfb4d241a82b5551531e0ad86cbb40fc19fd5767572f7811f3b8025f151f377e098095fdb0d2c14695c227059185c4e2173c16e3f115612739bc3f7127fa2d4fbbecf61c1c0cfba7f3f1e02d8d7de6f4187f889c515e5a27f4bba50f3d96198f172867354d1e051c18b833ea692e63fba604e438493de33235396899395eb72059f6b8ecedf9d479b0f0db02269293c914d5ee9b233382830ece66cc793f872879b3eff5a8dfc4a175c6840ea34c22d64f869a5b8f1ce526768043e601504c30d6b79ccf9a4a9f2f74e830024294dd810198ab3cbb6770d6563c12a2a7ca8f5163379d378cee943c2c4a2ce31af2b07402c6476a1475aa8bda181046f854904e946afbace33d032f2412c8705243c04ec6d4a852dea5ae2ac918a954b0588e41170cb3d1b9b795fd3c04a5e96faf84e49ae6549bf7c47611e98018eaaf4d27f6576dd2b58d35e8fc8321dfdfd5c4c2870d7c7e37939351e7f31f920f0592fd025ddc1bf21fafbde2a15d8a815c864a89d71f295055215eca21589f98010c4312c1661febd8ebe37947ab115475635aebb0621448cc6faed7111b50fb4d65196f11506813ba349a6b2fb131050218c5a6e4943f56eff253f3908fe5fa2d3911789062c733e76f2ff7f2e4effc29e4466abd3dea6364fd3559c58216a95529d9c602120fd80b71f11c7aec1fb76e21546fc10a01222e518f75dee6dd67ba1af68eaf9463faf139e1a6d711e8f62c6e8687df79be1a3e67d3d3c9c5d80bdeca70cd4c0ebef5a891bd12f0a1f6fffc208a4270e362e4d3e3d4d674dbff7e28634884ea7f76390de2d38675f93607e19a8073189776bfc16aab6c3b7b961296e914ff671fd87055a3faeab44d95093f546f907facfe31b4776b490ff9370476342074c665a8d9f5c92d07c5829fbf68d15fcd5efe3e5e3340b0eb166007a60b0d459f4dcd62729726c102aecb9d73e703c637f27e02a3a4b238491edc01b9f9789801f3d0a33bcac8576ef2fbec2f173c2afca885ec74cf3fb43c43829b43dc882ce1631c77c08a5cf394428dcd83806fd088dba405002077de019d6a391996336878e577c63990dc6db9b46d42664aad71c86b314ae445961f90717c8e13f776ce83365d74b98a6c16d351f5af1d4a43693a5a73b8d52a9737b73f83d46492cdda07901c11088a8e5c655a3d8c04c81c0e16e9afeb642a27a09f68a66a60da3ab73f4cb155a1d85bb7fda147eb4d8d9803adff0429c982ff993e1513cf0420284136fa8b1b013ce30a0fcd21ba166b1a2cc0f48699ecb0fc6a3d14f3724aed161cb3e71301bdb071397180c4d6f8d872955fd2e3ff252f20f6e5aa35f06394491b034a0f2c431cae7d0d58381c8092451f05219def7bc3e4834deea925bea2bd139ec755b644938029b64b9a83a669c767f51acf045b1003dec2551c5aef2796fa5dcc4166d3829500f2e7ecdd9d029d64a7538a444c13406afdffcf7926f82bcbe48a35f5a91129d833e0e1217bfd716de04b4683ebf64cad72cf45122fc34d03805710b01d90c763fc58c60dbe627e6991538e30f2030152fb1b7391e5b7e6be64a31cff634b029e146a492cf6726a268fb497b645774ba81df1fa5756e7ab47e78f399ab8ebbd037873213907b80a91324dbd6890489e45fbb67a20a718b8f6768ece46a9ebb8ffa5ba12b1c535277d4338359d420f45d78317e40459afc01d217f8b68057f0e3d3266c59c98fc1710f17569a620a2bc7133f822af0b480e22e7fd569e96a22c07c332f4b1c9ed6854d3f5114a95c7f33fb8d64cf577c285c6300b6c849635a4d2f644ac34ae39223da16197e89466c342bf4985f3a1719847b59c6f9d085a82075c23a3777e5b031d4db9b109e36399c958f7ca74bc73db7c3be9c331035723a5b86d94c23959a55a203283d2af9a5f2ca697dd99de7573e5b97c1b9708fd23939dc557276ec0a568d40018d9640b748220e541dbd4ef4a1746abee6c88fda8e80b315f8376d3d008406f5011bebd8faf709e3996d23f885c68fd2cced8917dbc03256bb663ec9d77efb62881e3f06170a4419a4ef845b82e1508dff02709a0620b0bcfff1d75e42c53461c10c7b29cda664ba26ffdb45b1260de92c8828d78286d16dff094d207f0441f1f142ab557d399624b60f32f6b31cb8d2782340f15f2528d1dcf41b5755d03cd40aab1b8a3c0c74f8863f5d3e5e214b2e27a61df77c5bc13d75714cdb4d6de2f72e4d48a84603f533cff3c43322bfb9c4097e53d879b2787549b039598880fd019ed6c09bf5c3beb9c63c6ff35f0bb30484f3079e90d361059ed1ab9b5fee8b7b0126a17a9d73aa4314b3b53737c99f0fd52fbccc158894c769ffd7732ea6d558e4c668a409dcc163f7ec302e0b8ca49fcb38e0451605fa41acf47dc8958485c704d78e0e6f3c75b4c74721e21671c2fa91c781e34832525a6de5fcbfaa3f372eb437c9f5618648a39a85b60c9aa779d000225a975f6649bcb5120b82c55da90ffe5f705f7bb7b783d6f5c37ef7efbe01fb4e73e54e881604e214c1d1e8a5d61ab9d28bb44cfb45666a8ceb76a2cb89676ebf49b5732e261e41d8b9a4a227c020296c78fb349859473b2e032ebfc3bede9a410061755a9e9abda0da4cabccb77672d787da5cd50a3980c60792ef0a96859e148a5c1a5464cd8be2bcd26b194dcbbae709778b7df77c986ea8ac538a1b9f289debacfae4a88f52dde03e858dce2d8b3400129e545a6f3bc61063816ec236ff5eb483ba07b9ec7aa8eef35db45c4f89f65244743ac0bc36a3acdfd8789694030cc4b024d5867e3b26bf14e7330d8d3d978c9b9e78e78b97ecfb2e939fd46caec9954bb40c530b9045bb2bca17d3bb5521fd9269aa94727411e55dda26c39d982bcf64268f94a7f516a1f782890a95077654a2b7536bfc0fef39f66750cebf10a682fabbbea35c8b11e83f0c1193a1c8037b20794da9c170f81d527a2d405146bbe210eb3c75fb6e36d829ff4047d8dff02c1664974a2dc1270c5c09a28ce4ab003d19e739f7610e3c3676fe7fa38dd37799c85bff860c76a43ea35a3b3f597bfb2151360b6946455f0967c992db39972990a27f69032ab7ce8a66b553d50c11ff4fc158d2c6064df5b2b2d8a1382c562ddef9e2d47384ca35f59ee2bda8910db088a8b2bd42a0e979098fecf70804de0959c57fd01de3dab55f29cfbf06e148fa631a3703b2da65508f0ba7d7ec94147767beab8955b20f996e4da09194346ee7818d23663be0518e098eb0f6ccce49a3f11f8e84afdfaf8f30a42a73496aae0d241f3a0d1bbe3672081e8d9e3ed57deef3b914a926313f7e1bf76f8bd4df034cf5955bacd0aa12a66252a06f33ee3ac851503f4328eca76de73e74a24e837e41b1d07c2b254cfc0db6b36c18a09a900ebda097f4b94c652aadd2c611fa40f15658ff7b22af697e5e8967feafdb0b716ecc37ec72eb590cd64de46c47cfc77e71b9ff711983bd5eed0e51b9e6bc238e9561b43b9ca79d0fc3479d74e750618de3af238f467440bc0f54ae07ac43a2a0a38b1e4718c0eacdb14e6ad7028c0b3b596130fb3fd6294b3a2f5a8c14e76240fa3a13727d0ec546d2e6d993d6b7a3f749ae08d435ea814863bfc9c20f69cd71d06d36f9fde4625ee2833ec6f70974fbd745e9c4d25e177b0081cb8f462ab9cc8e7bedc255046e33eb9ac58cc56c6b10e60ad62fd6527582798591f84624d8ca829580ac187cd804dccba1c6637005b1b3f37eb2a723ec8e42b49309d40e5db71e24108e2acbcb98424b468869ca31bba6ec8abf32369b2aba7f98f6afc431307593719f487f9f3cc69b78f6ebce193ccea69aeece393914b104b95e08333e876724f7947d89170ba7db9b2dbfcdb3699ee7d5640771226ed64d0d49f34505f461533b77b1974c9a4908aac7f6fb21ee73703f336365876f392d0c974d653f0fffafc7ea8f0cc2ac50785eb20bea24d9822a20d38a7df05043f3c7cbbe379f5814e4d42fa5b44a35b6e9a385890bb2d5e61133b2155286a8b6b9d382f27991003beb37159373aaed5e412865b1617f3c12cda19c1c82b5cb257ff2018ec1f3ba7f85d21f9dcc56bdc662a526791a5e6714c7088d6784376abbb2f05b884dd3f6c30b0d6f316bc7c9472336cdd5d1657c3f4f773dc77ab286576d52785f5e0a85997e7e8378b1f89f6a2a180bae2c6682568a9eef98c1b139c71e55d058c3970a6d3efe09fc4ffe71e4a4e7571c7f9e0b1e41c3d38c3851551da014d0365485c0b0ff61836b5abb0bca19a19385bd2b9c0c0d975cbf10fd6ac842cb9ebea3a1b0ecafeb1e88a9bb6b5fde2bd08bd3a8da34a905c90f7b40c2b6c189a7ddd003fd3a3ac7ee123f298eb4cc8d4a69982d6f572ad7a3a0dde137028338d75fa5d9984f81c94daf1cb13167c59c453ed40733d70284c38a327f62d97cf5118397068f497c71aa19be61719289598394b31b5b3527f44258907b297f68571371c11aaf64fdd82fd185e879b34cb4c44fc201e62ed62acbacc4e39e5475751c5b3f6e6126159e9de512a9ad44fe789d918aa9014e6c9dc212d60f5b24924ab1d3c2fa2dc5919e071b9110670fa390d9e315ba04b9c99c92e459f7820c1e5e1b7d818d0f5415b67c083cc2aaf5c5555ece002a1049f68aea7d2579eee3d9df90643b2ce35184aa9659c7881c8973f7b59e6ab8363143996229b44fa8dd17bc9d68d559187092711c86865a1b3e8c1fe75071271e385275364c4f044fff33bb6692e10395c2d9e16434a9935f6df008d733c819f4332090cff472946dbe415d0e9a54c6100cbb75fe697408a2d8e5578248736fec3a7c14f7a690b8030755c9d3f0229c9ceb7a7f50e19717e0f312d24fbdd8e61c4a831935766a33f3fed3e23e65d49cb4d858dddfb2986795619b4d10182be1bd2ed2daf96cf7e05d5ecc675708d7854d96a0f1c9375eeb814d745984701727410945b3a163cc2b65ead93a9b50b01e5828150f9bb2b14697acac8e41628b2564e425bcb881bb518b6cb2b199d0ffae13f77a78aeb253e075468838c4c1ff302dae5261704c7cebd9eb730775c3de2293c5f555bfc973ee455c6d0b7c43d237135f1cb69d82352fc14880314c8325e5dd7ce15076fcb8a16cb6c067cd0c6e6390c96b810586f2c3c14fd94b714aca4d186aa3b91ce1eed86cba3b0dbc0ae2b47ff3000bc216b8f0dc41f2224a548b5e63c35e5d8361e38eef19121687c6989ccf3d9cd3cff8fb091bb3610f500d8a96659973aee2a9a122c57bb6f2e3503d6b5f6c41df4cfe325842d60b31dabe1c9c8134372f2a8e535af19d8549bdc790b9030d726d55039c6a63345737558e483ccba18ac60dc34f46cb6fae8b7f4d8c1839d4db83705653f46252c632d4fd242d28afd5ef1ce9e16bb1bba2416d814af59451522acc06b34092cf666dcef0ff77396774da1f0dc96a225d5374cbe542f1bc38ec16784a22f0534798880ee0492493c44a4c9c198ebc9cff14dc7de3078f48732ee96698f322cc09a226981656b5b0a6e56718c060f42cf903fd5134756b9a7f83ff10d01d5e3b19d8e6b4f1ce8f5e0a3ffce36f67c589d22efe278edb30d1899744b5ffae784264557b5d9608c04cc0d7aadb970e91d4376e68330a162f9582ba0f1814fec3f749df8a46a08e749ef1004c787ad677ea52b549d013aa5d77e8a57683da2bca82eba32132f843cf35636bc0fbee952fca1a18729f9abe07d08d2b6d8668a0f968c73f23ca80fab21f65c64d3e08f40b9d54bc70dc3492616c88f5fec14a48926a1e8ba1cfc6555f70b0605fcee60370472f8d808f3e9f56897043c13e94c5eb577201f038ecc4ce0a17598b22d21d39b1e9e49fe5d6be2792b53193525b41563fac9d02d3b535834aca536314521445ba28e4a1c728987fad750c10834adc0937c289ba48eea68d7d366b6a0a2dd26a9cd78f22b8c013260115acd3878e62e4352d49058f59be451c9937d1827ccc50dcb275108f3e2ea8c5d6015577c6c96a3a170423e1414e2fa9324a392a01aa938d592c4e3943050f6c6beee157aec8a7732359e12b48f897e5c3d3b655586ea1ae8c5b3e926685df1fc6f687f18030a618af8cda9236bd13b9d736cfc4010cf8fa81d30c0eeeb14bbdf378c4f2c425a74ce4efe48ac3395419d56ab47e2392c1490cadb8929cfd2cbda79e9fdf71fcd7f1f21fa7f8ce43c6db61b85c6119456b3a8cc63ece30166d9391526100be7d9f9db610f19391b70a6e036b0acf5b3dafd82ee81b088b23b773c6c99a5aa7d6bf1655ade9cd5e6023c07e091dbdc940d6d62adf9ffc662070a533aef8dd980b135bbe82712832a90df27af7d16fd015eb0a6755c2d3cfd07dbdb4adfbba8f469c50b81006be2d2b40a266093570e94be85d76c5ba6071272e7ceaa757f19d6c2ced2447d0846130267528b517adf0c17013d1497f20a0de158dfb50054083fff8a5103c14b54929d067927a69003d979798769a296c394a495238ee7ec91d972e966eedbd062b4c048ad7ac4493e463b4336dcdd5ec7100511009514e35706548d4ae4e13d1891cdba4d19ef70a93ab7aa011cacad360b24f076a738840d9303edf68e486b8d4799ddcfe1d2b5466dce35193779a21be3c3df4e1c8d8f9a92be7951c71eeffe06b3851d95b6841b2261b9b33e00610a633a68d227e4b60e8768ec629af28c3a8cb1a82b298bcc3d951e5708a8dca8d9ce754f05ac8284f435d5216a032686d5bc0e574661184cb6c072f8a371d7ff250fa37e19a93b15a8cc3add8fdca0ad7289e5adceed8f5abd7ae5b168820b41249dc584e3baf0fa9c02572f98c7c5d6e079821191584a328dac636281a801afe95a195dc2c153f9a7bde043f146018b0b978f4509297cf93a2d4b6f5e2c3b0de756df198eccbd5dbc260f6abb7c4d6f5abd59a4ece9a6ffbfeee1b7f6b84572487a2949d504b09c8b4bfcaefc7b2d88630f8bd9fcc3ee39b2691de58bbeef0f93e025579c18ff68fcaf5c22491e07066096a4f2b07e11aa9629c8c528d5e95d1cdb0ff8dd044208e9818c174bed618695fa0b8b7b488bf7b83d8ed8e86e5648693fe5ffadc0d2638eef693ce4171f9e875493ae5dc02fe73a8fcf80547e45c330fa44f4b38b5304461b478616495538a87b9d8c2a16774f2bc1e0118d6700a02827ea942f63376c13b61ec536cadd79f42a1af7aed8fb536c850c88235e630fb8bbe4cf146f90290f2df17b9f780f6abcc05bd01464d523e4d81800fc59dd0eb47011bdd347ed862e5b54485831f5dca4767b10710ff01860bcdb84319015593c01a19098ff1585bd34fcff48b0508470d5b8b2a5673a697ae478adad068261e261d402ecad033373a105210277446d74e6d91b2ef6b56be2409d252d5a426f7b6c09f87892c0f3067b6ee529730f5050e794df9ed925fe9f5854841dc1b06483b26e2db41714799c4e01e6d8680adcb58a2478a0b26c67808482190603701882addfe1d75aa496e4c6bb5a28812bd50bf5c3b085372a77da09fe3481573a3d901da22265f6cd1d72633ca382a2ad4167032ea669d94ea3a54898a495011ca0b9d69028eb1a9e56560168c45419836d8e71af0fbc830224ee97f97450dae20e0d2367521f67675d77b2b1f4094b037fe02de7ef76d82e6718e87974331a68732979fea07e88f7a895236d70139443b1f6290ec4d4e53c38ed5f2a0881771e946012a8528f1e2b685b41ec1a676f87ca9912467bf38619a6574376c516a4d8f7f933c39631a7eaf7009075ee6aee4a7b5c3eadbdf9f2733b6cdee7e7c6e64c9fc867702c8a955d6a2ce2cf99d664bd9a7461bdfdd3346f31e74946737c3950cc6d1587db62d26d4160dd84cb8803de73ba76807ab8145d0dca0eb7c3ec11ec5a5554330783a99cfa9f2a5ee8488fe8824cda9f9b28a1cc8587e3ac229d043adb13f2ef6226b0b36ff8d9c0bcff090ebe85f08ea992fd10baeb537414c2908aa7ef6511dcca5c5f41639d2088de8eba996f69e8a3ee47866f7ff2df047a43beb42e8d756a544c35046762effd045954c1a6ee242d4f3316d499482910608c7f1f223b200b7a5e64b0081ebc01a98f43f4279bc044187cf2f3f280a77297ae353f01c51550693e69b9a10e5b17c592ad318167a1c1b832a1855ceaf2f954062d4bd32833ddf86c90091e6db6b606abd4fafd3594f4e3847a3b49fab169a6ce2cea4aee84ce647365766112a6315693f693e0cc495130839c03c51017a53349003e4b871751f90c7a989e6f8fa265140095bab7b0e8b9c50441f3c4db8946acd0d0835f51bf67c634c40a11a0b7a7cc1cd410c3229cf5de5b132cb08f627507bb4cac1f3ac9758316e90e3d5301fb019e7e7a6fa96e49006987a8dba744ff82e2d262b191db8482a3eac8e1b02cc11568fb42fb8c4d58de1a8604eab411b3581b39b5cc5745e1ca3c6a57a27df78fa64db41e54ee13c312633325b3e6340b6b3f77b0809d2558dc195313c5626c6caa405c9b914c0a0cb231727f85d514d5c9b6bbcb90a99b2b7279dc27380080801dfcaea9eaf8dace7a99f29fdeee985f2a6f4782d1bda4453b6547e525eb1f75261aee41a74d8a939de108229c055e55f422587334fb6d708e173e8f163f8ba8b1ebf1091932033b386ca6bdd4085c256e02aee225dfa8f9e74df81d42987e3a09768a8be5db043390b207bca5bf31c9c82a2614d6b1ac78e25174dac45d35b2a937e99417fe570e684ec47a78a8968251d11b42db275a14cc2321d1dae7dc1573f9a13b6a49879fbe053e9771cc746703ba60e74af3f62f39294dd214fa63d00ace48c0bff26acca7d2f92c6dbc10ef9b0255fcb31e2787d86c95e815760088f705fcc03f89f1d397a8656392b1ff1f2e71359ce43c902654e55b68f09df16f2c4c75e1046ddcdeb663ae5dd65d5988c458b8948164d30a90aab33e72c4c0517985fe744cb07dbc8a20933f0a43e79c85d6a30993164090581dc2369f4fa9e882d86542efc6e08480be7dff09ad3d515fc4e6118ce6c6dcdcedbb28d3555c0d713a191f30077a3933ea60d404ad1ddcb26c10f5fd6eaff218040a1cf77603bfddb936c13d6048c0f3b9db1dedd4d0ee7e221039ad5e5846d3336d58b4c08f44ad64719b7455b186f29a3766a789229f5f94f6f93219cac9b91741f9fef929ee7a2c9524d23b8a604fa944072ab2779f511adf2336eb7800be8b50727d6224f2428ed06e362eff6dfb048e8e576dde93790710413236865779fefac7fa24cd2242eaa046ae9b9b7e7fd14f653880e7fc412bdf5cd430264bebcdb8d93200e29c527bbfdde2aecc7559d6cb91b4d62424f1001dff6ecd44844a0e432e6eb4ed5bf5a9c5f6f1550614dd20123d3e8c98430554bec6024a4eee0c94d348d5dfcac74a89685df229b9e84d34a2d26710b4f80b387f7c3f609d756da3bad743c41abba9b57d37d0965477164214cf451251da4caa3b771ba12ac3989dc2b41e58cd0a5f828ea3d93cc17ba2927b927b993c6cafd5ea2cb4ef944ac6e49a4b143e01b02b6e8ac3d34c40fec081a9abbfad90383393140a2be225ad11c11130a5b948abb362b9a3e98990e0716dd62c9e3affd8dce9d2d7d9ed36052b831305d56a68a2d9c9f76eb6846bfe28640d131f228e6553b0de9889de9c8cf1dfe6cb2897d375e307dfdd09d8bba168415ef9c6c3a5651701f420d320d891d8b45a8d0d8f31d2ccf9f8026f609fafe20b558b43ff06391f31c172dbf74a2e15a32fa3b6bd1f2b89ee893d03bbd0e02c7b5de3a236a33d8adecc4c22c8c9b967e15194e4f954d93511adf522cab488336d602947666b3b5438c982e689b47004380269865ec08c8097a3f36ba879a3dd829b7d29adacef06ef9036aea72828c3286aac25174d990f493637f0e2cfa0af12788e60ab30fc1afdb39928339010a3b61f8b577223b379d9db4c1765f23cac1a58493714eb387775cb20039715f0c7c621d5f32eef6378a80700a2f25b2eb5e40cc0bab53ee035a159dda7bc06760f610dbaf35bb9105d0403d97cf2d9f21dac9a82a4e4027cbc4ebc07b4d6f9da0d627b4fdefd3bde09017642c0aab46c8390f9efb3dd23a8a4a03b8201bba933d60c59e25c5b0ce2ac1789687172f4fa066c63e7e7300617dbd8d808576fa679a8d254c8020bef988dfb9fe48fefd827dc256d2275cc394bda79d88d674ce14bbf2ad58aa5b996036557c52c33ebd87d047f43f9d958ea067c3d7e99932d41f9131fde442008f39ca63d239fd973ebb3ac7f3da9f4310e7fea2a2730578bb5fc096cc445066230b95681ee4b1d89aa057c58008589c0ae7ff9a29bd9ccc605ed9f8e83df89ebf8b1f63368f6c0997a53eb64d9812f06d26a127419bdd438e9c7372181d040d1abcc9fdf288ebb91d33000980d6ac38560a022cbcae6f93df7858e55aa1dd48944948b4791c1c45dc6e75eaeab9d0f658e69b11fdaaeb94240f467ea82902b9b775be09590fdd717f2e6591fe8b0bacf3ce6c8fc67ce6a024bcef34090f52d041201b946e0cfa2e813e9f2338e97b9f4cb440b21439e2539a67a450e778c8cf8113b99d9a4cd5ec7cfdd179dc07e7f94397af997f3a09831dd3f341251f681459312bc9d8c5fc7d419730eaefea9f1066f3b160c7ba81975c546c4b3227da097f0e9037a28db9aa10eacee086b7f0ad790d9ffa15c41f8deb0a40cc8938298688512dd08370953ee28359f137faacdb447c758ce5aded0abcad6a87bb2aaaef9a963cc8e976481d6d8e895762f0efaa97f6fb173f4bdf2e5a73e5e78dad86b6e2043b7b4821caf150556344a159e4fcc801ebc90f0fb37335518cd9d580bcef3d039c59c35ed80c6b6bb8126f3f8358c6969f7ea12c44b0aa94ada26c22ff25ddca5aeed2716c72e8dea005b68478f2b627783c40ddc74c556e97ff1f181589a5af33a4b47371a9e982f3ec0c1667a6f7347a24de76483b4e6bf18df893e82aa81b28b778b69dd0243398357f69cd5a117c2c7fd54574ca2861c7f340b3a6b92ab8a6a2607769e372a143dd5774d1e9b8313434662a728cc75991bbca2c3449974ad8086ee2e08f7c28307db0d0c8df8f11043c700e536b936f9e251041de15cec135b4f0547dc50f97878d75b729fdbe0585d589e56cc55d3eada90d5769c2ed9df32fd5643e343269be646558fb85494d0dcfafd078615986a0a794de4b9eb51d04257deb041fc2656b7d26ebcb32055e68959a6579c9fcd1a02117293e29c5db8e7ab39062272a8f6b64bba3b83af9f7b689b80ed0fe309f5e505aa1c5f35262c5ca8c79b11b1e5f1dab4391169ef3a4e4d0e3d5a9457a59ac9e12b6cf437970ec56810a46870c911b386d29e4ece390b0be0bd7f3d4a39985b5139f6c0e1c8918a0d8fba75a35b769e1ba5f35ba867e3cfb80a94da36bee6afe283b6e149a61fc7c60a1a9737e389a351bd0bd36f00009ca7b4dd39c854fcb1dd7105c7e9069846b8d77ff27a0827b04af8788aed97fcee43b3e1988661bee6b8d80d4ff59779ff7b642b8f4b494f119314f4fe033be91cbc642f9833c931a91116a3562877319d733575c79e1132a38e1fece60608ff35b01f87eda1e151415b671a0e379233ad631f743cd8e267af08b199904fd81864b9e3b72e3229493bdf95d8746ca8d5a84b33334f5f6e81d7dc60fd16401036d439bf791fe61f0cdad48a69a42dacaf3a6e66089ea2910a3e2b1f12a952f3e55ce06e39b747a3112566e02161f29e37113dcf35651556e8c3966efc6c627a5d5d0d8b03b64bf7f4f5690d133e3cc8cc1c91bdf97e4c4c3bdd612f58ab0cccaa57d98fe6661cf73cf2617fe91b50de075c6f73ad228fd0cc2fc117ab7960fc68bbe721cec120c242019481fea628955aecaf55bf6f2fbfca230c5df808534677e2c385f212cd21e1559a079b28bb22528a6253fb30f79fcd68992e8d769c2e7513494c74b2b9379cccff7e621d2dfa3dcdc5697cf30073d86c17433859e26ec8e3309e3eebb48e4f5407988d47c3eceb9595f1ec6136a887c17ac8007ec167f02f40e27c17825ffc4f32b9d97235b5073ec37457897446ff9b054cb214f0262474f6875fb116cf2e628fc235bc49b69cc0b5f347781a1de9105793e21ef93ea549b00e81c8ed1dfe022ccc20fa219d180da74570181f55c28cfcb74dac73635440fbb17e5e0db994d6735027f8871b1b846050be37164420fae15a8c0ebfd30ec9df0ce6d5cea4b0efbe20bc15e6c1cc8d3c5fa728edfd8d416fdb40cc9367234066341d28c9e41db025cacd50dd03c180c7777ffd3af3a0fe11565e0335f7e2f1705f03806ecf3479378ee376ec2e7480bda8bab85e8db4c0f9239ad2f48122f200964013a217448d0e23b837a0eebcf117668a2438cd7ea83d50fbdf68e17b4c6a89ce34c946890bd08b9b120de1f69aa257a889f9167c758583f9e0e2508e036e1f50042a6925a1247dfe6fe12b17975c9833b19328ccb9e00b4bb9cb695a8b92b26230b40a650445080d1fafe73fef60fb19db1095510729baad9cb891f28cfe8bdfa69dc17ad6ff4d7a82f074b9ed6da2b43dbb3f1637a78792a63a4109710ca1536259a5e00fa4d7192927f4157a35e37153a638ae5d89e16dca9f3db8eecf8ec9daf9b7eceed8ec30b58b9db0f43cc0b193cf9862fe48930bb4e526b5b6bc8869b59e63cd310e70f0ddcc3e66e9c40524b4a02b2bb2a1cd0fb844b67deab6724d7a019a8533da3c391735b68d230ce947b5d8b163fb9ffb06c5ff06c05e33f4968d702e4931f3717cc4a0a4f43c7b9ce2c5eba91cfac1701b1614ca975a64b8a500935c470468de50afaee982a9d84fa1bad2c9b9ee73a988b14b779e3feb7b28dd57c1a77dbc8c4305a726771e39d94dc5ff6ed2dd5a0f70b2dd22dccd9d8459b2d0c666ecb55090f98330f9abdd84ac9a3307b7b2477fc98d18efd9853e212a15a5bddc3bf9b45cde25f7bbcc2e29c2d42c88b4ffa5aad0a77200c4f6d291e1e107294fc12d41149fef70cd573512a51e97f48b7315a22569e64cbcf84a7c83333eb7d3fd04d4bd81f1505cf27bce5e63128ab37af9ca963cdcffb33581c6e96b5b78c22475e457ea72b29bef1400479be2c9423003097dce382e9ed02f84b1a653e56781d11433515d919bef4b9456aeecb6a4a577da801ca488ecac152c2122f7c6a1c7919cc2eefbe27f7e7a6a4095831a107ee850db3c3ab31500efb49f974dbee47b0564d39a8f69ec9da4b225a8e9dc18eed2f58906863c0e5b276acfd285e814f30df33a6cad6dd7e0386922e66443fc139be83e2c110fefe591cb99b1833e396f8aaf7a702c065f820555d87785c0c48dd7b0c4d6b9d58540b310e4ed9844d8b1622a95745497468c45f1096091255706b9c32f38718c2f931463178339c607c39c5fd5b2c686870ce0246b2fc9aaad1288d9d74a2458fa00f6692ec7cc074a9bfa6c24097abedc642672ede637ad055df96cfa72f42bc26fa1557eefa4507517e1f20bd9568a5f6fef0df9108781657b821c4176cfb7f8bac65f1e6f16e805b334124a666609757ffc77f6612f39b0964960647a330cb102456078716d3d16d532c36d92cfcf8e001ae2aa31572ae670ff76ff4ed46aee9a118db82a654c716242b0c8e3908199f1b70fc0782326d3f7172defe7910ace6299c62210d94de136ce412d318992ed36ea1c706bdf382b3f639bfd81059a3cf72dd2048823827ce1ef5ee4149065b4f4c4916ebd5b40044465237019097c25c6fe59377de99a13c77bc69e479a07ca38049a0c696552799ca23d7eeb4f57b9606b87adfe5e2ddfae3657d5c524ce605fa4282400be5e0d29e9f3867db02a69291033c1e0a95dd7356c195757b276c804255f3b05ac72c512cd4510d2631577928ff5192ca1ec378b703e42cfa26f15a52cd1918b7101fca9d2dbe94c6f44967bc414c8a3c5b5e93cd8051d8d34fdd2d1e037b55d303c3f50bac19a9b6de11995a71b52c1d8fb76741b1cbf63c879fdf56c78efe2cc5a0bea84972796431b4d0cad443bd0e5e78b655d37e75b1fd024f06f3fa4ac2e33cffe8f6935118ea6625e6819f9e4914ab37157658e80a39ce60a72b5206c812a7140fe28d1d7cffd33d9f86382ffe2d4202130118472dc0c4ce5205ae0810f23d6072a25e88a167c44349f8f0b1a4e30405e7b6c3b999d2f0957ea0d1537b9cb4357b5b3da241b57e298f3db21d17672449f5e7951023f469e408dcf9208a55c402f776fe1deef613ae6507de0e0cb8006429b9305fd4461becd077bb5aa8fdd5f132e0aee3521bc7e15aae410799da264d21d6d74102652ad05e30794c71f5e18e51dd3dae8a5ace8fcbd0d54f744efb9e5ae2c17232645a1c5173f74114bad37757d71cfa0203fa623b23f32ef791d5c8149e40a35a93903043e29df6b4d7f327b4b4d733ae911af535f0580980c628c780963e515db937fd930e26be9e9e9cb29b0bf7dde5f474bf25e700d26e240ec3dbf919903e25b9ca227ee7f52d24b98aef8d276c7c8510eea9ad5d3bd2db49f1559595bdf96bcae5657fd8e71fecfddbabc0705ffe8733ef0769bce8b25171aa5fe145ec237f10fd3e4e4cafd1a17eaad75453b05d50d80f843d8d063f42f5d6af2d4fef8cee8d6d9ecd7085bd1e97ba9c17d2c06940b7237a29746cf8583570bade029dde51877d28c1b2fa5b4bc590eea240bca6551afb06115d878ce5e5983651a9c3dd9fa362654e4722c94636c2302cf2f0f6e9c5c38c7db1161362c370d763ecf1a6d7c9aeb6e36a04024f11ef6f98d7ca67e7c2176fd44f32bd5ebdac25a08606972cc34a7364e65dc19704ae2716b1e7dc5025fa072ea4cb9ecb3dcd6021ad81217d285d3c64ac8d88c221423a5dccda82662d71d9dd191c1837d8ae53cee7bd4d4fd175d7c81ee5175db2130b9715cc830b6282e21367c187ac1a6f29130fcf936ce0bc4a7ce18a96ffe2c676a28966d9abc6df5da16d07c25a218226c1fbeafdf1496cf24f50254a848f9e10d47117ad34b50e1d00dac12c56d9e155a5ad9d4efe4f6b7888e4cb72e860666a48e551c6a77f37b1c742efab765087b8f9297626de5b9b511acd19e6760c5149bdb60b6e905c1e02735bc58e1a0d2be6bf28eb338ad52444ff8df48e8fe71efc3f3b32ad4aa8bf76004b58bc34f4b6a73fa25108acab0a94a291d13b1f453bbb65bd7561604273777f978a61b91eeb96e68f77b226d483cc2148f02acb39ad7acbf13f130d48809413075219c4a6db031e8c4d6861c8e6775dc9570f0a5c6b8cbe0a3e11ab5bfd1cdb177861ecf5fb44af9cd9a5d07a5193ab3c5fd252fbf5cda3da1cb83369cc00e678e200d944a64e26ff9240ebcdb49fcc02d2f52fa29d3f7ec09047bc4d839b58f15443e81fe1df7b237fac29cce1dd98ad466412d5f1e94e50f034fbea0135534010bc36da55f0ca328b3b35e121ffe1bacc75e1fd45657722ddfd23547af280e6236028092aa1a3eecc42bb6cf91e101e830b5744f0609efea4b7943f32a1b81eb041c2c5e5f33db056c44fc6948ed967333e2a5df4fa564711c38dd76512a49cc29cf4f4ab7530a38b2e3820bec1ec35cdbbfa11a9ca74a8345da552e07c93b4b4d60b5102e15b32282d614ccab55abb6aaefcc471f3f920d868869ace524ce64e492aada1202c05905c030153c2ac3c1aa70d4b598499020dfc66aefea92e137079b70dc04c082c4b8f46f779f1cbf06d318a431508f394bb0685e9caf39e4ad5608d6effed26768f950110f1b7be09fcffb8a70dcd776d5cc52ce1e4f91581a0a9e0d6edfb67d797208f2efc84777ff903bbfd1ca54009e3257abef9d24e6e15f73c46b352c8d74e7292b62f4b103d1f44af75098a8836de5b24371047739152cac25bdbe6cd5b36938d22ee60e9b053777ce9296bb7a779306d3ed3d1fd43cd4f06be11948a1eec6f3eb7a0eeebf41101d4e278230ae3c012cc45849ac4f3c1f2d081f43630fa798d66986858953a209f7e83acf909635514e8727269a5c9609fed1b399544ea88965a5a653200da875c79c1f3c1db84ac2cb290f046eef4bb084947d2395e1ec66ab85994799d79e3de0237bbf735ba527ee449932fe5db561296bf6c491e3e09af4d82ac65f463a04b0fd0cdbf3378921dc0c559ce096042b7440ec2333c6c1020cac00f2a2560244744799153e8be66bb2f6a6db1caa5fb892beb2eb2add7a37b79895e9e61b62d1f94a42b62ad29733b9710c3e65f795571c6ea71885b87f6fab12f96735bdcdfe828f832ba8181d5d421201e5405d92f6535f945e30224ff6635181edf4e5e1d0308c7cdf75a5d2231f4e7798d49952c97c6ceffed4f944e36c25f87cbb0124a31cb47790846e1cac17fb21db71ca019d1aced60df26dd68fcbdadc63ea263b30986b3703355232023acd34db32489bb030b8932b3058ec8568dac6c84c13824a92c5883aea366b422b43cc0880e9edf34211b27ed7150f8555b559bbcef865fdba120a63fc44e93345bd7d7f6640f254acc13b96b877c3398ccd2e90ea8137a320b93d18e886149e854beb6cf626a3f3ae58ecaa5144e80c90ba5241b2a6c592e7e9fde44e19f982495be9a23d17ae0e0383f79dd09eb000e003db7870ba522b13289752fd581a3b7310f3daf9a741f5416676c7d2f14edd89633e65696f9d3810818f7e8bcbf7ff8c5e4369dc2918e336ecdc1007bae09e3ed4f7914ed62ae99a6f65338d82190138ea52f739cbfb2796c4e43c483127a84f882051ed840c5a23141bc6e59a94e77be8654d038571ec2e82f4420f37cecba9d62042d1ec42abfac118dbf86d1e93848ce3bc0a9216760261d5188b775a48a44aeb76e80262c13e83cefa11d368a843766b0be369a5096ae3bc6ad461c8e92c6f1eba6bf0bb078027e487edbc3b5cead1368d475dcc5539865841f6ab5bacc1c6161d1ab5693e158277ee0fe765c2da7c46787095bccff07ff952d7358316fe1ffcaecb67ab7d3cdfe6179d65d7be8db5e9c68fe100299d7ff1c0da3487ee3f580f9d6c5c29ceedf3b1cdb310d206a8c81ad9e8c036abbaaf4c19f45b1538dd652595cc3c52da6e9220dbf142d45a155856e12c54b77e601c0c1ca826cf37ae6aa5aa44a5b8e6f478af07a9d1c9629be7b004a8f52785b96fd5a2c404de8a40e88ef4a52716967a905f520039b4e5a195b66703c608a9208bfeabba57c2649ed0bfeed7751edb762a44906dde8b647643869bb031bcf101fb039a225424af3470344331be675c9d295d3c17ef1eed06665a933d9f18f6a244866058d0b7efd32aae708d58f05779d81d93476d8b4043f8d9d19180b401b22ef9ffd3f226ed06dd9fdb40c100a12b2fe7cbac817bb4eff126cca414ef883bcea88883d6a6e285be3a69923f381b971e4ce9ea25cb85c5549b5f75980a6230b035ab5e0cdcbed80cf46bb4995444f919330d96464cfc018eb5605c67cc39346a5bcc817458ba26a2fcccf5d3cbd3070faad4145eb4a9c79062bdd3c267a91d7ec16feda27f0e7e1683cf33c763da9792c6829a5bfb35d347ddbc0275bf63b15a993953d823daf4b0d1d28e6e761671fe08a76a202c063a001397474e51482baa6222e2e0f966441bac395decdee6dfb0c8ba5332b496191d7e4760339656c4a35dbc6e289a53136ef28467cb3c627d3a50e4dfb22210888f8ea2a31da2b47788fcb870b877b204061c4917e939bcfe48ccb7cce5065dc7e931f2f5859f9d0cba49d6ca4e7ecb806503ef9fa407284169ce06529c1bb8acd5e1047835a3ee9fbade51194299d7d630f3cadf24a7df7039940a932959af956e75e1e20495253508fc6815a2f2672ce4c2689b54b23e46705ceb6029871da82c9426804f8aadba824f9099233517080fcbcb8d77681bad2af1cc6f8fd6132b5fb417affe2bb4ad0036278ef34b891364ee099d693860ba83ec46d760d29af0753c43e0c4e11196bc561750a5ec724cdb4f492c439ab09a49079098ccf0298502446b776912aa55a5fed37d1cbd9683bf16c3ae505c22ba1986f019cdd997f60f40a7681bd1ec51657bde449718d0efc92aa1b06706721d4cccfa82561baa76e4d39c31687af2e3c0b47f5676ba61304255acd98e3014bca7e33170d9630bba323d7695e91800216643685eee9084d9350f2f4dd61091fe55a630dd5a53218c4992985411f771c32c61a13091e07752f952e7ec337c7067ac037b809039c821747b27a618e977ba7bddf98c544a76d009c1c50c9d5149d0e5883371ea57a66210b413cdd67b5b9e8f0746d9995aaac7df9fe15e01eb8c3d562c90e57bddf920d054cea14d4479e536d33b7c1fb89848153e229fb3a88929f931689d2157bb3f24d2bd1abde73f7cdb829da3350ce174e45a34098d169c928112e2f66678d4c11575cd3687d754527f765bed1270b067dd17345e0a0920df6a253ab4c526163baf4de01f739da6ab8d1b1bb56bf720ecaf5627d24a243249086e6793cf0e5a4da94265d2acf850fdc25fa68fe1714c314ee4a517d13b113f4d303179ffe6d287aeefeec3c1d2d19e5d721b37392e76382660bc991463e9ca2b1947220bed18bb8d22018285c56d87d19fc9f627d209bc204afc61021780dc649bbe07b0d1a9cfc7b7272cad6505012df6a3ca5d65a98b73744ab1240b97ba6f641ab306cfeca45ed1f9e78cfddd7cc3c7db874a64dbc5e82a052f900ddf3b064e3e446b7f4857a32b7d1d6c5524390f6999aac33d7ef4e461ecaa50600b3147a4144a509e170ad7694622cdfb4095cdf1efb1b0b3311e628da79052a125891b6c675b93bcb4b8f9bd35e9a61e6fcd16842ae9b36bb9136991c1fba207a71d5277480aa78e69ef63cf6260aaf4b5795516a5f1234f46e744a65af53ec002b2375cd4c646e203e8da15f7b7f51cb028361d2cf91b11dc4c6fc96d19512f84223b01bab09787b96f2e9d55c6eab6e006fc8bb2d1188b86d0140743b45c16d2d211ada7400c01c8fad107625cf4e73c8bd943707354da494fea42df30f35c0aec79a964255c70c096c694a6207ea50e87b087042ff1c6be02eb0386d03b8db0a6a35ae3812273341748af188522e801436bd587a9530b6796c747d74945b1e688d7b95fcaed3c513760abae65ee95f1239905556da15570c9fe002e74ad2fabe615845954bb27d210ef0b6452db98e3077081e78626c29f0fcd9b15c2cab6824510814f6bb2436f436bcd1d9ae90613d3285123cc98dc7fa4ee62aec4457e226c66ac85cf611c4230ec5d2c7bfbd7bd314408f8295fc8329bbfecc50c10f152b78812d6772f503d288ae2f100f7f32670a63e094649ebcea6cadb04226f3ddbae8bee5d29fde1a17f0729b1580144045d2083453130a54888c179004c08ba4da09eb428b152dd1cb2ebde94ed3a6997a934f847e4baa487d1070f45a3022c2c7c68339daf5891de7afcc7e78166b61c800b6222344d860fc3edb8891729b4e6cf141b5b7d4bd8b7b292da549b8e2ddf8733941188fd6993ac617b544ab9eb9d532d7c379b7d6c3baaa8de023dc58eab32bef8873c6bb8fee20147a43097b03bdd090833a571e1315ea37f85b48b341d21601ff8310eeb7c2f013c02806315f0ac7b98f5a8be5a08fa2edcd965104d43d94087a18bde8899c379951f1c1f5555a228e50649c4c1814bcdb598f60d03a60429916516c0bf0437bacbc01b14b8168aca995c5ecbda0853310254ec7f591f67bfeac23940ea58b3a526da9b9154c190752fa63eaacc9eb953ea63431dc5e8095a6ed541dd8dbfbe065e5b0cf3d53356485a8b863f5ca499781ca25409ce8fc0452a6906daaef7aec253bef706ea548227a036dabcee71f24a3eb8d4bca697e441406988d2c0ba78a2568f04e48dff38e33b7fad0b48f1b28a81868ab74015e1cfb8197b5881e24d5df6f2e3041d74bb45fc33903d5bb9638e812b41203ac6c841cf9b11569010f41e335d100f2eb89ec4db9345add9c9ef3d6e9c8203d8cb3f3f4a456b85e61863b9eb41ea1f8b072d724d92070d19ed6354dd23e3cdc67e208e43e93fe80cc73389f4e5fe1a5d8ee824ebaab6c17497cd165166e2a22bf156be797c1f11e9039ca77b735727937e764281461613c7446b6f630deec2a7c43ce4dd0ab763275618447c002039b6b9d9716dfa292fbda3364bdcc0191a7d59363630368cfecaa11e3b2b8806eb4d59e4b1f70b9bf1406e694a4c83be16f7630c97ee29c944720f2d13c0690ec4ecf520c74902ba7fb65749a7ce181242ed54d32b8461cecb30f87bac2a023ec6e804a16ba002147eefc8791dac6f8d49a6723ea1019be79c1f74a08b4f4cb7f7cfdd40df561510562c0fc1eb86fc0d75e0ec790b4ab2cc5b8359489020a3913ffd042a65757cce63ffaf7ca396ed28ffa7031d5afaa17b679f32f6dd4995e533b41aeb901c06f1865d890c2d06ef5ee54ec6cb54c9e56cd5f7727ec46cda32bd2ea675259a31044676d8b4bbe5e8de0a1ffbc296fcc1b32e5b035c38e5eb8bc1b51c0f8bdc7cbd0aa6318e4eead32ae7f3bc7e4391ba2f1acc1c1644959a70d90867ba6eb97ac9cf53e15b8d5fed720c199a79749e5dce2f3409539a6e47a0912c9fd69f440e29ce3ab8e69d4eed5a3ce227f41d3c77402cf1dba61418164c4f4fcae465ff967fb7ea51d5629fdd0ba0b1064d18d255582b12c411408d552660f72e9fea9ce3f269cd3f39fbce7916334293f264778ab0220656ec4aa253b4bedae4aa153323ace0b21af995a72a3beb47326e7d4d75b380c29a2ef02607a70143077dc3affe208f04ffdf5e609baac6d94e54d9e008f0620f0200eeb5e39b11cd39126d271087a6b2ea56fb22bbe4c1f460cc6c9ba530d3540b63a85fce433e2539ab929d652b563f73218bf95536c58b2875025108985b3e5ea4ce1cc0985bbd6f88cfbd0996e245d7a5f0566da5ac01396fb5d59015be5860ff8634af447f4099dcb9d69dad2e2de7fde1afa7eb072b34214be36473331fe22884b82af8c71a926642c1ff9ee7119affd2d93d419ffe67b568edde2c5eb3f5a41a7235c80a51ffa3bbb565bc2343430099676b2a34b0226a2fbde96b6572fcae86952c50f3e9c41982af8341ac0f9ce20f5e94f366ff65692ccb11d6752cfd89162c11a3efbfe1ebdd430d1f6d3c06c8a7b59a84d81f263e68a72ed4733e1caa5ae0e3e4f223d0f4b7c694dd2da23cffe28300de67d4c9c8415eb6296cb3fbd5fd22ee668d023cdb7ca70ad95369a37fb4f9641d326cc15bae38491f625cc51bef3595a8c66f48c772f7c515f6513b483b476c984353afd10e84e92f0e297e7665a2b50ce89b85039d0941c0fea002240d6f53bdda4f3c2a50b3e3510a2c317862bdd80385e0f1e5f4400826e07d649c85a2d22e52346547773fb1797cffe60c3ea668d1f34ca84e14e803bfabc66f34d461fc716a73d5ff98597d803e65adeb58850abef4c303258f943a850cb34fca078e89d5156517cc1431089f91f08d8873f2444563ead0d9d059e4b9524e410422e9e5f0296593075c293f3556dacfc9f8794d2e81a0cbee91d815b65d28f7854ff86eaf4974987404b260482caf4a0d43a98245f803ff3e868de775136745b600173e9cb7f33916576d66454e4a04494162cc4ce4ad90b2e80c3436064ea76200cf5aa341a2320787b2fa05d4c1e8a27c698f03f35e425aeb747f74e44754c02616fd5cb4aa7f39aa9e043831ad400b8d435fbd49fb22789b92a8c27c1c98ac4f08669ce5d47b875fa8a9fafdfab8fbd4d8a2093d81af6f1d1246b197c3dd4f901eceec608d143d0c2bebe3441c32f9474d8cc826bc01b798703c622bd676b2ac4be696227fc42f4137d48a417bc5732419f2dfec98ddd5688c574d017186039b9539bc9419de5412387ed5b3b28fc2e90f2653a093b08354574975c5a8ea3c1881feb89ed95888f8a429d33ef42e674c3af842e08cf4c17a83a7ccf086dea88867356fbdffb0d8aa6668be21aea9028cebda959524366dc5f6c5ff35113351ec124b9777a909f4d9b1a5416f4e17cb8f17b8a1a1742fef9a489be8d171e40dd4898247821f67eb8a300b967abe7b574fda3154562a959925d0e6419afb35c1a0936a4c06d085ff4d2a4b3913187ac889afa3596f11a10249681973d9e31383c5abc617a0749f55cd52c410cd9d96aa8086bb35162420f35acebe5cdb72869c29bcdf81586267482b0b56c4ff33c87bdafe1fb602574716e8708afa2e5c674d9528ca1aa64c99efb562e466bbfa16150f6d3c39b86ec84642d46da1954b7083fa03e97f01b9fcfff0f67d88c9931a1fc5413b13b2b6c077619f8a2db928c582a69da97fa70726a141c1b62cb1a17769ba9758fba5087011981761162e187fcf5f0e409d83f2f64ce1f3c8aa9841b1247d57635742bc3a44db8f14ab3e955dba64ea5783add7c65d9576adae8d5d177069b411145b16a2d28e42d50ab6decfbdcf9025f3c043d57241f02d3d8a2dfd8c583b982ffd8707cdbfd0ec0fb659fb3e79b288fab041005daf6caefec0f2fbc9a76f04bf52a0c5c869795ce101a1a605061442a610aa9fd42d0a7bd4cbc355b2f964e983301f726b4d2a7f09b0f9deb7a7097d0ce90411d0310baae0992b192467a322a4faf1d0b4c00907aea95c879f4e7c2b4ec5c124b69010f453cde5581c4ca11ee0d05d3e36c27707346a587d53b51f1e4dc26143f2bac2499b1b2019a9ab39528430c43e79ffb521f8247f90bb445650abc3fdc94ab0924c0eecf90af9835c7b97ab1cfc30d2865c8c301a44f2642f29ab6489961a51ee16bcfdaf66b57b83569ee0a8e044828c25932221c5453f6dfe8d30d1f916ad4cd9ae7ff6e516d27634821b86dca55bd7c9d48ee7113be6f903e8cde348fd6f1391875bbd476877c2021260aa01f9cfa220d33a9a9b50b0febb5d277cd3eccee82852ca7c2493d6981a7433290d75f333ddbe1c8831b41886ef96a700cee76ba39f7838862c42dcbe52b30bf0aa30ac02f13c0b6b7069ee5bb6628a5e55a3385e5021533ed72dbafda44bae2ae1b7d2613c4cf612894fe5ac66d73981d2e4f41a6860703a8762e6218bbf0b1e2b14e04827ef88ae11df76c3a4c0c6a4f0775c572f3c07b5df8b549fbe7e3349b3d606ec6a2bbda4a32fc7528768a771b3101a095c3d88a72bec153237e4c59c1f7df22051d148fc1e666d151818ed5bda97ea4dc624ce39a3e2e7df6fef43470e1984e5a03ed6395d34471f8a49d5f24437a82b8ef0ec399e84155a5b6f8d024212c76de870876ddf6f9d803cc2849e61ccdc18e5fa6d2034f8d0ef926ea93ca80110bcc88a5e8398e176e4ab35daaad545e82a05180d6eb2c183d72ae1183141a7a92e38c76f369eb6fdb3c5989e250d51f27535acec933507176f4683e91dade1bb3fa06b7f69a4a1d21f31c0a44218bea545485a3f72c1b70f429e02597d67cc480c75e18cfa7622d56da49b7560bf26654eef39a27b3353a33932e58787c4782fcf72fa8c1a18753347e2620f055b03cc32d06b74c249029e1bc6c1ee8ca3df7bb4aa0e8ec90cd53a1ae92fc3cf50276d7b035993e8f0b0f2a668ae6c41533f94e4c81e012c1806466230b7193219501d530882aa56e5ca13ba0f69d869ae7e5e0b070d38a1b356fd4ad12fa18953bba9bb660900f68f2464469403b972a39048776a84048d16561fe998ea01fd4ba2979d6792e78fd4bc5fdadc0215c819715c4c8fa0d9a2106ebf0eeb97a135578a0d295b09ef1355c02ea45d253c39e35291b527889bbfe5660db06dc60c0bd8e2ce7a15b99a02f97f4cee95798ffc2145bdd9619cab1ca2a13fd4a3bc03adf984997f6e8c3c8d4d5fa4b200785131e4d7bd7d0488aabf8c9fba8abd090eac864b825b05056c716d0d27fe75e170ca1261c16d44364b203d4a4196a3310c61eb792d9a1867a32bedc4c54648b683d0cfc3879460b767707200e3b4641098569c23d6bbb3cd729d3c9487ae411d7c77e94ee9ae520fadd63e14117c5dff4d1192b8a6d85d73780c4204d308f25357601a66402ac3b1d3e30b82890a872ab918d462b15841a33e0cc43306b5cc9d8f0523893923e38a3d8e1499caec68f35901989507c6721f884824efe7da1485c7913330a96a2bc599134ca5a1fb3b7f592a1064233b916c1d0f483199c1c0e501c80399da19b3d0ae732b331f0d8220360c0690af6ef778a2147e9a27a3a695e6ee57e18262d7800d749923cee4b326a72237300a491dba9a3ad7d6ea09712b55e2fb8e571d52f12875501d4bf7a6a469cd280e3c6649ec0489065af775be449c9f4d61bd5575e76580ffe1a3d5c17b82ddd27f5f5f39820bc35545be8792a12424f55306c7c0a6face0920d8651b4bf0bb17068f3fb8677bca511b41b6a4fb4b5fb277e649362b43b34b33009d4e98d5ee0945fbf0db03267f1db8d18c450f0d793470057112041747075826b797b387c6b7dc7f06f7bb27eab4b3aa16451e5a1c0699e79ecda79350ca44a355285930ebb852d0e63cb504a3fbd928090ce9ff36304de83fabefc44ae96e4e958aa57fde496c2e51dbdb99e67058831ce06da4c3b85422eebc49056adad6088423168f2fa66b44cb88c348f7a599886d727c82a4115b90b01c980307bc5a299a6d7217f81eb7107f2cbfde43ca828d070e7b9b1c4850f1cf02f324564bd5459f0745eec9d368fdf5ac3044c5d5574e3273146e5d2b661402d8bc32cb0f4006031110112cf5902e862af3c2d61a8b4222b4a5fc975446a2e507796283efa056df8e8886ef35c12a2a98fb86761da926b718bab379717cbfafeb938a13153995dd0e1794076deb8b9b2513d3c417ca259c0629f7c9a3e79bb9d95b6b79ef834ee7fe0ea8cf54e9b02e6bb5b5bd07b618e9efee5063b8d6db7e8afcc64e12dd5b0d2ad065778865e606b1dca00856da8377cfa7dadd89c7b624bc24b5d0e6d6523b7e65661dbb39aba525e85caf32bf7b5bfe38b422b1d9074762a552660b1d5a0b4c246dbd2160504362469bb481456289422890aa740a1cc1dc8aad7497fb582d3b62137d6c35ccc104e13c742d060b2b8a2842fdd80ae00374c1d48eabc25fe9eef0f48b4d86e13dcf13e7dec531a2e119339d6a54d9af233df1c43dfa056e50980d21ecf1f141bec2b8d9b9cad32f7b28e53ab988296331ea7fc1c4e605c2662c1e29e32f5394f469118811106e5fc92bcc0066c3559d85276a89e3bf84ca4204b2928ad5bcaace559d82a4a6817e3a2b8cbb9e7e797fc50735d2778cc149eb5868532e0fd1c14d5086301aaa2bab1728c6e3bf9bc6ed242e040b87e0bc6e810c3a2bac2ded3445f28e75d2dcdf6ab2718c8390636785372414a2c7046a6d94f1d77d797f55c379a6f1e70ddf70682ea14ee69d4197c04542a7eb979bee6c051d89a422581e9792c215f60ae1bc8bd69a0ad7adb2592419554c274bbb29929b9c7505dfecdd6dbbe56c004063c5d42f297db4c669060752340154fb9453b704d7aeba11462c76ca6e2d3b889a0f588a7de1e89e5eba7f2caf5ec0e00c6c26051b9d7be8af3ca4d2a03ad8ccfbfc8f64a55975db7fc600ba2f7b0cb9f3a68d5077b6ce131a6a17474b64379e29916722a86b87160dc398ac6fbb609d8423f0ba49fd60a15aa6f41612a12c5f21011c77fe087d116c84cc930de51fb4a93111b31a4a6c6854baa53611a303fa5967f42f5227ff5d407de781c8557add5601c17bc6b1494379f7421141b9b40a357f1a1eab0aadef685832dd1f089e84395e816e4c4f2d6abd2cc44846a27099eab03e85e122e0312b8f60556cf3f09f711db3fa3d44971f4cee8165dc97702100855281c99f7e2118384204fda4d300c67156897eb215e0888a1c040704dae348548e26d088502e7ca961cd1125852f45acbd8651d1362ee12ae8f488ed3e3fe20e05525f1ec84edbe79371de5abc3e716e9c554d55e6949ee365a489e77a29f8bdc2191161e2c21ddd08a229c0cbe781199b9a56fb886008bbe7716173a194414c650952fc1dc2dc828962b2dbaec4e6c5f9bb772e8d904388653093c2218bf61a6c6ac939b2132871da7505b4d22e295d9e56f119cd7efe134cdfe74efda4808965bda5b1da4f3c068460048860bc2239cb2d0df7d97583377679140d9bac1a8e82229f78a73c2d98b1ac4cbab6ff4481335bc4aa772f49bab6e0089a7dcb9c0d93d8e93785dc18f79a4f9e4acbc507f4f90305109eef67aaa7d6809674d4379d1dd7e7ef511e967055617091fec792801f5d754f30fd3ac27b7d91400820bfdd7bbb63a72528c6256a1e6ef6096b15bdd64ac3a45d2f3de9ff796a2373019ccf192779652ba9284891e7885a2443ff2e58f2c4b7ed79dd49ea681a056e2379e6527e2ed49a655742e352ef89be9fde2e05357fb639ce29875e567b1fd2b7ba2a9b33d3104782146d6c2e6b6a61730263c90a8256e21d13e70c22cd4e2f4e3f852acf5abe870e0c932e9116a846b7b914db0eb37f9d5e2d05118f816057fd318f5a282f9265119b6c468661fc49d232cec78c812ac62f9629ae8eea5f2be4390b243bbb8b66f4d47adf60a4a1200e06cf5c8477c874955cd43697c6091c40ed025bc39b277460e352460a0d42d2632d618dc15b61afee1971aa0d1b613e387177b12f2b49382c540360fd204d16f5653458ccbd27fb8ea766eb0507576021c0573e2f408517473395ad24a8cd8f0755951eec8633cbf5492d16620dcbaf8bfb1a5dbfac2fea4b985f5719e0f43df12e1b41cf9c2cfc73867ff5afcd8dfb34d3f8f05899a131d984884be71cf12713080d7bc03a7a9301ce6ef1a3069c33d46b37c5b8574d8dde0f38ee8f10191935a765c31c765a9c78ca640004ffb6c2899b527b18902beb76d27f9176b201454cdbca0300cfc0281777acb5f97b78ce445ff7059f177e8f27858c1b6245f0bc1ada55f407b9f666937933700e54f8d188ee599a12bf92ca3b7b3254ce80939ea0fa53692785e210480a79116c2f362b6c65e203ad88608de3786e4bb407cddc48aa309cdda05ade023831ee7e07f94f85f78a1bba55c1fb62d838770f9b58a52600c17f59e24cd541c004ecc2d67c9c60b8846f6bd7c7cd50f5c85534056a441eab09084d4533b6581d856cf1821cebc82c19e36c5cb851227243f623102d76e8ece672a8169c4c6aafbfc2466119b839529ba1f566d83889263167831c2a690623fdc916019bf9329779002032dac157c1f99926b9f2b7116c214e90ef3b0f8324636f229e4a8ebe377f19c94a7ae00902dac00722aaa95171b8751efabadd04ad80437ebc89ede006ae37d2c53c518ffa17ede0433c3fba9dd6ad3fd595589cf0c9b4fbf0022af7002fbab71ecbc4e73f776b835858b84a5d2899f410495574d0384b407168380a854200c275dad0224d792f92f40dbff2f82b996bced73e4d62dca8ea70f1b46db82ef216d548ce6c34b1e7c561a8ab044ceb4d7af73dcb84ad4fa96588b2f11691b60e5dc4b330ad9391dfc0d13588ba9a5e810c2aa48e59fb2ee54667350d632e34379fb12917c1131e14a1e3389be3badaba9a0c92843b4839a1c2ef34839a69839cfbcfad351f2287a9ad281bc895110167456e66e508a7f69d6f4d081e63b6f2320bc9a75c9c33fda64f488cea4a93a5250b81c5ef47483168e9336bf42416675d3976272e51fca63d7cfc966c285ff8fe0a2495b460ea5ae500c44bb8cb977e2db24bd9ebee60aca951f3b449431304001a6b7b0ef5901cd11d15706080672aba8076e14239ada1c259b45911eb9febed1f6ffa48c1f03a8c172e54a0e22fd6c934bbbf43cfbdc79aa9965cf1b2330da57d3eb5fad412d6982c108bb9d4ee423964412cac092c7bc5429b442ed847f0f6249226801a97be78109dda84a1c8bfe4db9963743f3248bf19fe22b925a490161b36ca00c838f104ded9061dfb9ec32d9136ff97d7c80259357ebb4d317f2ef62eee6a7f6c1ed863afb40c2681b2fc0504020bf3f05fb60f5701745c3109f1339b14ea94384002061b1849e0d7dcd95666760b482c062fbcd0db6849e9dea8032e297a400d70aeb80744202b3de17eb03660eda1ae705ff7f61ba7d744c40e9bf9a58fb1096f1184282ae35af8c6d1501e7c898041daf32d0fff3f879e2af266a99cfeaf17e39ab0cbed8e4bbcf67f200892d5b73c89aed09632ef175d13ca6f5db957e161ca6877cb8693beff6e249cc72d9230fcfa5a8f2deee891b8de9ab4155d0822387862de10e9dd88eb034247e4da681bb700993a83d4e7c1c98a3a2a078cf496d52c172f97271a28e74808ed26bc110cb22ad4fa8f3138c3d45472af3e5f83b165944bd61847e13e484cd14d0d28f67cfd221ccd585eac5dfb5b376f5baa48a3fb46bcbe9d962ab9e2b3b3e89a2df30174bebc3857db746b2d31744d3bf9fe22b0f290661a97e17472c27b3baf35474b967158ee945892576923fccba470498c5c48556c3ee1d810c7780cd14a42852bf66973dbdd3b6d01b010a83ad01da649787445d01660147d0eca193043324c83a8af3eb6984b44b43af26c9a2804c8369327b777dbe3491e0ef718d7b1bfe65590cde605c008c2824980c3142beaab32b3833148ce15a7e4e7a130b6eee568653c30c26b9610e3a0fdaddaf13a6e92f15624c4966dd0bd70bc6da298124906336991f7b864f0a3baa269c87e78159b853d2cb90da826d8984d97b56d623cf768c2582cc49a25a4e554d49a736d935a3108b0192d224f4de3fb7ad7452bdcc6e15c7244c9be95e290adb175f69933e0ee1acc41eb63ed6d7cce6ddece04d3c7fda99d8df31a939b25c5796bf272bee8d771551ec6503359ed6f1b2340c32fd4899715c55f396092c86ca13af2e43f6c77c4409a2cb215946a11bf2f0a6c27966dc5cf1af3d5de1da54bb2ec69b6b2aff29765bdb6b96abb4682c90fd6ab7810cfa12b7330202cf9c6d09d6b84f7239df426a9acf0aa134d41c2d57aea3c6084f68f28f9653177afee6840dc54257d68e620b46dcc8de3c19363252b1bc3ae29b782f600e13a38a875a09fc3ef4a259cdbf7e29905a4d1c714197dff41a82e08c800ad962d640d25b7de418d8529bf154e55a0b233a4bdecbbf4e4be0ffbc4c7930ce81c644947545e6bfd6c478e7403386b6a3feb3cf8581b9f8a4a33360c4f7d7e843945e81394b67a3e70f72c72e10321b4663190a44c35c5dc7a9422afe722a6864ffffa801432965a15f2fec8b3b98c5a4e2e68ab01ef9f704f6a8a7a3cf7a1d36710c3c330193d72ce8e2736b9ce4cb0d2db3191f7a82f3b021616e6afd7d215d2cdf3218aa5699382f0c6a6c0ab6726a89c34cb520605804166428cad87a4bea1978ab2505aa1257c253d24d5f97386bd5566a8be29edfb740db959ca4d4f9a92ac22d65bd069394650ca2011b4120edc19e4ffed4efbba4d9611036fb1098fdfa3973eeb6c5511864a5ef25f80ac3aa2838a133324ca12a422361e2f7edbca4927059a4258d6fefcfa177cbd65214e81bfe7c7733283ceb27d7f8b486f1773869bd5f012abb091309f8cac9925e042dd90e1da7c95f4c86f21807cc58151eccef799f56b7497f96d1310baf029fa124e033e0ce75160d615cbb8b539d1676b3c3cbd36e71bbc8dff5693689ddecdf13a8158725737c02ea6911a2990f17db724b59a23754e58e91859ebae2611ca7046a9250524151b6e335dd5d7c25fe2d2ea6c59db4ca2d76a2ddc1929eeb407d45e928c794f7eed826d82ff088c398e043415f508df3a55cd570b9c0ad35f565f8cb8ce3df92d138ea84f6bd09a87df4a207415474566ce77ed368f51eba14f646e9fbef92cc55e3b447fd9fbe42ee16f72f17697c4ac391c1740859e5ddf94cc05062868d5e6408071355c358a21eb0f5bcef919821c9a2829ccd387b821abf52f8be11ab0fbeae8652fd50fa53f606d5bfd7d76f6be08388184829af3a224dd5cd3318a6a78c2f8ebcd63c7bc528a791b5943c546256fcc319fe4f4ac2767b6afac04e37ad0ffe076cb770cbfead477bdfdb83eb99c6a7a65bec6f2607f526e3aa28db5bb21e11b9fa02b870615602d126c5628c33bf2cec8bd35649bb4130464be4ceb702a83757dd1c8bef6452445a0568e9185f173e6694bd41a3fce24345eb3b355821a841124cd6d057fd582a701b310982735c2d61cc1ceaaeb76abe0a3d88a9c608106b403b28fcfcfaf05ade148e23830bb84dce965b82ed6b14536198f46423d5ef09029e2e22f031d4e66f5901b1f40456cc90368dfd38aea1e790a0297c688de759d7f8887c3063527381db0063b0992f20d9ff8c89cd3cd70be3a09ecf3b7fc2e19f97b985e8b2ac317ec2d986a4a71ea590495ade29f22269f685b1ebb1d1b926f2db2e1cccca107c40d363cabfb83a8d345fd20080aa7285de68e1e43f5d73a396f9fb91415d6d7ad8d51189fce3f2564ee46f77a8648b6412162267cf7ed4b2b1fcbe9e6befdda785c82abc818fa90eaf746ddb7cc8986b26fd6914ab4554a908320a83ba9f894c71e48aa0cd42a24157249a0f7bab7e8abc817995d096eac023b6ff33bed55b3709f936779d8c7ec15071df2ac7d0d5f417bd5b07e50bcd4887d1a5903f431ca3c4064d74f8762a20546c74744a51c9b3bf7eac8908b320dfba13aa7ca8e1594a93b2c7ceab0683718169feb7ac34234589c5977d6a708df93871b9e91eddc4cfb4b78fddfa1cfd680a3bcba895d140901068565f25a27fbcf000e40ad4b622235235d60c008c19061abb40a5529711b161099faa2079c9c4cdb8511fa8b613d7357ca01b893316a2d99b53b2be811123278c8df24e686cc23c0fd008935af76916b59fc7ab9ee5d4862bcfcd511c28c198793e48fa2ea279c4fa053bd01385518f9e8b8f921c63710455e2a55084e7d37656f2eebfee2604b83c84169518a649eee07ee5703677dc81167473cfd5990de90399676b67aa60ca651182e9258ed993639216d27e175f241128ecffd875f5fe688dcb1256f895c69d1078717a7b58bf1cac5e0c708b1bd6ee78a1172b0464c2d146d4955e98b72d98d26803e1b6d30573e37af1b3896172be9fa27526e5cacec5eec6083b8452ac1faf2c8cc02a69d1939b4c02eafd9d1e033bd8f76cef190b1b44480235342d3dc9554a1cdde100ddd1de422bae3ef3ff1d8e5e59efb2fcabfce326df5660018e2e107dd9868e8e2e7e46d48a34bb85c2f487d88bf2066d00a46b2d6a8afe1168704ab2ac6eac7bf7182aeb421f3841d52444c7df35b41bd5fb1d2cd2f4f74a9c2e6c1ccd7000a1229918453ba30e3e68847aebfcd1005063cae256d83ad5e92e06ab895a40bb7d035d05dfa5fcef9521b115a7d7cc69ac416bfaa81368cabf7f5ed006087a0dd434799c756a95f41cd1f345950b026385ca64e9eb60c307e0a1e3855f59ce57239b270341ab68864da051bdc81ca9cb13e1a2658919422f0594f0a866ecbc606c039293f8126e1c0669b31bfbb651341607a626931eced5b852d7ef566741239cc134ff0b890045c55445b9c5162930e520b889f751cce7427efdafc4f37e518e0460d969f1c0aff9a815c9cb802f68c9b9c9089058e3d388b6365490f573a0f4e2ba5ca1ebc8cf9fe11e70f66a7cafdc6ec63d9c1c20886a3278c2479a9565523d5c8f4e7a1a0a9e9085c96dad3b99bc5fbfc7da3816b302581da8fe92784b42e4ed905838148307e88eefb62380c0b84a81f451daa79c055056ec7f39b453aab94ef53829456755d8aebba013bda1dab65afc3a6565f28e4fa59fe3361d23cbc5c9bc6249fc5612a9fe006008aa15798be62d2a67ae414f5e18a026b52cd91ff55f9f82b5d410e2c2652f1adaff184ebb4bc4c405d0f65c1d5e60b53bd3e476ee2c7c3567d12db0933ae97e184a41c02f796c1c72439112e39a78b213cfe41236236441d118ee13bd648990827c627c4436e5b106a9fe9475ed4740aaefbcd069338c65efd330a59de72565ab518ad96342eea0093e2dffafb181f9a73097da3783b5438fc5a8012e79a2351a0a602adbd36d9c29ab5337e03e9dba0700818124d530b59aa72599390bccdff099a612c9173fec56882ad9f29109dba8b52132084ed46042db17160e7fcb7b061307ce3c4a39cdf466122048cb11d6fcd830a25bd47cfed32f1f80507afd64cbdd42b18758f13085f291d96d8dff0f0c8354d16c5f2c6eb717501db7c07d3c359075408622f567eb5f4642bf66326a2e789ad2ed8d1e0e6295c4abab4620fee4575bf4aaaf5df0a3753bf9f624e55d118e87ea4df04e8c4d51cb53b5d03d55807c125fca1038e5b487053456205642a45d566dbeacca76c6381d2316b6f5160a7ac67f449f8d15aa0a0808218eb4011e030061f06fea2cb884a43118999421481b0ba39e140b0711e84c608b22001b58678e3b80cd517913221e8124b1d30b82aefdc4abb0888ea5863b5d158f03f17aaa28cae9ef08d9522ae46b155fd277540200f24006a1ef80e95ccf356647e1159934f08caa0f1d03f6622efac84d9b88c5a74fccff149f9fcc4bb2822ca43e897307c1273a08b1269dd9f38d64f0145b4abfe4a378cf0f1d98f35730bfe9eab79b75a8c361c97643e896d93558bdf8d59f5746ca04009dac013529c6962c87ba8842c5d340a56ba1366fe3aaed1dd8502a2e86fb30e59de0a71c3342f4fb32e36fc2beb8b960de2e94cda7bc4e0099a4be1fd22f0d631c2c3f11a313e536fa651a454009961361b15276d6647a42688581868b67d6974ab35ea14fb2ffe98d17c7d2b5a9cb6447dd7e176e9fd01982afab1c3bafd3e3dab4c9b84d169e99d5ce80c22dc7de3f7f0fd7c268c57c2d35ecb6d609c1389f4e43a404e9ebe8b8ac2554b6fd7ea1c9e481c8130fdd4650deb01f2c50d9ba00dbf357c2f47a0fa8feab4e90440ac75e7acc78fd7b82d0c309bb49ab05552e5e82f5170181c66242f44d7ceb84a88a02b307bd9675460a2fed2dbf347c9a6c6742f38af7b2ed4fa93faf5a418e16b6d4b564f36f3e3f20d8ec1bb519815d2110c112f7dc80d476670b51d1250665a02ea3270cf512752f41fd2e84ebdef3d93c20356e905c22e7f4ec0d34fa0525ab6a9f09e31c8e8aca2895baeef32af5c134ce8a62179d96c30f8996010090e42c982d712b395fa5f769f35c9e47b9f91f054dc0e25c07bbf4665cd6fa57f13b87a740d8e927a21b040442820401938ef15d9e60219f7f6475845ea7e7bfa816ecdf433a18103d7d7066da59f1b93b085ad77f0e82143ac44bc0533fa2ec031318742d5aeddddce9d56db2fd65103090b31a1b8b889c34abd9b2856346ee916bb509c037500a46fe84793bb94c78b5399d68940ce688dfe7acb215edf88f7c6c71cd0d69a2d5286276f67b1753c41f0b0b3b52169c4b14ea93d86b4ebf5b043492edbfa1e4a041d4d640c1e9f229381505a12bfb773f59ef9bee91222a67fba23dc184d1a40b7f0a6f80c2665a24d52949242984a0a543ade730beeb91e8a3c67c6075c66edf58701d6e6f4389b5443b9440b23fd83ed6dc1062f571cb523d18ed91cb698af1f0525a5668044aa99a264291b005a6dd258081f5f8816ca00c9e64202452fc6d098251e1747c213062ba900e676a9a3bbe202a2d0571bb3be5379fbbaaa9de62ab3d95b31d09eff751f413374651a29d6e897571b2bbc03bf8304292469c015608f38ffa02a0f9353d906115f094bf438aefb14a49c897d9abc3f0d9ce298fa5d124a2867315c6dcd5d789c1ce19d91688be59d5f42a68b3a1d87e2bd426ffb58a82eca0ce810d86e80fedb8ab2fc5382fbdb84f4b318ab945754b4969e28da663dc0f1ad8146944fef909d9789324537da8f8df8f6ed4c449dcf6ff2232e212d34a82f793fc687e69e226e0e1826b8caf0442758f203c62d4002773df39800b4c6062b308f143562c7b9de1bfef78502c1c5c1b6d57bf90d5d110b82499f09781280366e09093f6b831f44e2ab45f57978ed4c1d0e2282d8b0a78f893ee390f09b771f28ba9cb56a7b25d1bf28bdfdb6085885e4ff5afd36fc09816e3dcd33d12239f3c9134061f3f596187e985d56980dde5b34748526551591f1af47b04e5dbe8959611a762ca4901e7b36b80b0c81adc66eed64c5ed47d89a548531aec7d5fa99df4a8463d21c6463b5178ef70bf4976b6d30cf24975fe8d10a8e199cff402c6fd7ade351d7375a88b430a7dd80b9471464b1a509040c76a955a6986c796e012da74edee6434b5e2280acb8605ef42365f15399a83d8b8a810041ba1cf9872c9bd85032cc1ec73a9c87fee00c9e77488cd016eee3289c6d841673520621f676cbc19ce20666576ed377de67000b828480021fefa42aa5d0367386220c2fcf28d76e437b1d052e776c554ef768f68d3102518d7c2faf4e4a061f0ba5b9183b714b46dd3b2ef8a94e348e8e32f55c52fb54631d0670f8a97f4b29aa1551fc946830a4f5657092e0fffc3327bd9eebdca42ae9c9be1d6af222320388cfc2645c984eddf5cd405ca6ee5db85f9c84f6c95226811c94231969c6fc88e622be928870990a40eb78404b7dcf2dc02a1d684e4624a51deba02c165322c1da68b1acfc71f41bfd83a797a836091a40dd1428118d7f07958d167443f7cf481e6ba55984da8460b10a83bbecbddecbf831b86dc70d4651f68e8a2cfb8d4de1dce98f9fcd7018f4ba35c3f3010b5cb8ef58da5336700c771a7472a2eb4a57d315e907cb6cc8e1074850ff884fa035d8d9398f48ff22b03fd1eb54bfe875e6e33813e66f6d92129811fd9a19309ece95dfe4c6e58f51c266ea698f4a3785153e52033cd709262d683ace19121692a4600594809930c2a57935af296e347425c5a970cf852e33caab4545c5339dc9820db4b4dcff4363177f32f6167d11875c90f80c8eaf356ba61475e7d0f57c312258a36444d732010d6a17f2da88770644960902cc30c3616e9c7727eb4442243b4b8cba7a6080226927e2cb8ad9ab20fd9c3e0843e25c93556087a7158e7243c5e13901defe47194f1b70b8e41f72071b8b67f9e4b41ceb599c0148dd0cad6f19dee9dc9dc12ae87e2241389c4588001e838a0d1fd66d28c67b0914c38e1d847d7800c9779e922fcb1276a59660889bfb5b37469d86e551b83d58d08929ef8e0179b2a70eab5dc1994385112779251089522129953f9fe2e986b08796abaa41b1beb64d42f80be665847b1d0438ebb75f793ace4e02d00510de51a4588fcf1cf85aafd50a50db775e1471c7908f3fcd3eda273fa79f6add73abc3be1dab6b2e8a4bc9d42ed6b35790cb43837bf0cd9bce0931db41672f5183c9f9696fec70d71498afcf40ce5123a4f8b3f2f1f34b7a96bfbe857d765a68dc3391c2eeaca8c359aec0ea72851e79b1c3325f4c908c99421a7a46b932b37741c2d5b8f2f42b4577bf6702b169a0c007ff8bad0dc061f1562cdce0f62a167b509deadde48f68e2f8909c5a2e70e517fe34baa70caae2ffbcdf421173cd06c1466a0c85d30f66b89053370fe170e20386d64bc4fbb460bfb7b8c5181cc95e0d50bc55f4fedd3623ac18a3dbcea7d13c27ff4ec5e243f507691101bb5b7827dca708085e92fd2d2c793ad15800aa72cc3d18a9b0b05725fb2cc71c507f992979705a9dd595945f2cd191d7315772d94f708b3d734f097af9ea5ef625cd8dcb79c5d92823374c0bdf62eff38c905dcd361556947b9aac4e730a6d0304bb4565481511bd821fdcd17943696630d53f797e337141ae54895f13cc31049968cbfb9fdf972adab8fe6e3b34361a3fb0f6a09e3ae7d733474c9a35c37cf4213c862cc9eebc1a8e25f54e6d3f88c374a84ff31ea8324e37883f2e2656d0fbf6d2dadfca40dfc6f5759a36add0f931cd8bac37dc5d6105c370823c3507ac5b25fe0db9e369602aeab7657a578eb7d9657f230e3a749f7032f0cbb62b9d517b212b9e11dc76bd398ff9e55e67d1169ff97af8e79ca03ab9a2eac6ee9342bd90fb2e73befbd2963b48b2473df1a4176edaecb4e617582cb3dac9157b4c68d4583d5e6c252e50a379ea8eefb8905b06338d56473b977e5d5593fde8fed63e2991c13b26f5f7e196e03209f9e36ae06c8a72f4d0d53e40d9cfe9869587e8aeb45c378b2015fb026f6d46ff4272338a136f848557d21bc1c02efdb2e987bf37ece78dbac1f51a3a302d51d51d9ed5381665d12b218dc5c87e26e02568146d58311989a073120c8c53cdcaa7f883489364db9120ceee12f00cbf6838be7b53a21cb6d1fea4db63d4b7e5fc13ed54f88e93bd4552e8387906af8dc0d7a9a3333099219d53709166785ccc8b254170e4f575b82daf296cea787d6a113a169a737f6c7700e5edb84b712d00518576397d3a7d2c8c369a6f7c6a07a924c425f71a40b284bba774c2220bac4217d6f1e13e4366fb830d42450ed67d4509fd299ace08071df0825af337816a355cabc6d0c142b0db4f66e01e121c71309dec734abaab2d3d143193d38a5dc36827a04f388626b59f95d4289d80111ed9faf4e1b32c7d17bea183b794820c4ba83690977b72def40108450dc024944e1726686fa6811ec04b2aa9658505f3b5d57fbbce7486a5e7cfcdd4ee06cab8e29ab9398bb0fb89e20ba69fc10712005708c02055e914eed1141cd5020a170e50481b0b4f7ccc5dc77c6ef5a43387363c7a39f98481a3749b38ea7191ab926f98a223fc539c4504b0ce1bf31ba58c7739d70afab427cd7d9b066aa4dcc215ac86c73437928fe99f37ea7c89cc7a1d87204e01602bb7a93a7a681f05364b237f8e148692fb80d628e8013d7e72f40e25f121b3af2180146cb1fa73756b25c80ec0afb159de2e5056daa8abd0c030bc2e2efd8fc23393a4f351efc5d33d5cf4e2e9ce9d20af57cb7f0b0e4bf1ac6f6b7103de763566e93013b56351a65e7802a9e6638c3db373f0e9a4b941b9c417cf5ef126dfe285b5d4421989d36d14d65a54d7255e5423811d31249756e7cbf0ad101edd3afa898db13f8a895d9c3fcf059af68d22cec7251c34a3ba1f545a97c9d08b84fb65cb454828727a25b29e93f3758404c5383af490872453c14e4d0b5715073bd5fe29e06a63088b9341ee6b99956a4235b6d436ab3b2721fc9ddbe25171e13bd03ab0b11b2b443507a7cf368a139498a84763a6ff695fbed75d99b1c47e872ba68db0844a3de2bcf631f648543e0fd97f236361f7a712dd2b0642f46b494663c9aa2b2d49097b58bd9aa2a6aa158fe8cfda63c6f67daeb46ff2bbf7d4fe88a42c7beb1860a0ed3b4b7990358b6337fa083a708b93a475ccdfd4f2a1e7858d84dbe4b1d2d3c4667eeca239aa03745e2a383151018c3fae3d351f5d2f45b83a5ee473da65648683a9132d902ac54b9400dffa1e0512dcaa6b46f7833526571b9b93497bbe5874d45214aadf8ae2dca5195e13e9d2077470001687864e861856876153de4effed2bd2e129d749ea6a62cb12a1f3e833ba447dd786ecc8c7ec23600534e3034b215fdde934142ed78e42d0e1b6f16f7a5a61fe524292c5629f5644e0f5a08ff21bb961260b15124b3c6909e8609706826dd13e9994ebc04ee62f77ae6187dbf860b5fad9d5e02e832c928ca5b1d9cc8252d393620a238858d8ff268c429c5d5e89d8318a3651e09aa6de2d031b7b5a73d5b444475664c35b5e33ae89aa54b181f5ef9d443c1dd3ea3f31c45cda16e9f15d22afe695b0d5b9945437edb6bbb0f3012f334abdbcf81a8477fd776e07f9f8d719fa0c815d20176a85c37a3c1f675b67446999c54fb3f92a0d4973dce73129e85551fbe3a6c9250a261a65964cc7839e808870e84b8c8e45f84618836af125afd014ee974105bf5d8ced3db90fb75e0fe8d6a1052ea5bf3f139b4bb22c5a05e63cf3794ab087d9bece50149c970ce294e66eaf94c0518df7e9daa77068054573f69a763ef0fb19c8a36c7eb9bea21e02c2a8fbf6db4bd6225e3daa235c0d0e536d659e5a00ffaea77899c567ac79bd8fb313354bf9a4cd31bbb6387d1149710a185aa828eb835f40cbab3274a924fc06d26bbfed76910454a386638d35e4955ce93c7f12c8f3d9d00c91762e9e19fa2e9be9c069d2a0f4e9a033138ce563ec8de5bfcf5d6eff4db624a8bca9ed94446ff47f93ed97d0553c06a906f0fd6c2752cf997c6a199ca2aff8187eb8332873265a25b176ceafe5547c5c9ac7bb08c70ec19ff6f2d649961e25c5d4bda0b02f7c6a9fe196c351baa7e835c0cbf1aaaa0a896cfc7a3f6a9bc35c2105cf39df57eedc0c458292904e24555474a8cc45c9b882bd4f122fc4010a7bb8f3dc1de5d89c5c64777ef5c1cf8df5617c1c6348441873778f4936397b0ddf0237270107c8524f337980bdd8a08468fe2844c9d77d954edddede05d6b03904ccdcf754d11b170829d513df4864f0a6888ee0c473c6cbe97b42c9df61ece1e273d0f0f72763e01543da8c4e88cc284a88ce8709f6bc79f78558e81c0d6398e11e8c464f588c63f8ad88ccaab91d281accb417798225fced454079417774672f61d1662ee3bfdc31f4b195df09a9100e59fcc625d828a30f7a729611ca32270584b688dc801f6931b9c58f81f94f9260fde89109f9f2b25ec11a5ec7fb9b288fc2a216563fc50e71d02975998120a52c27611a05299ff7b0b482083bbb1009d416ec023d9380672fde7d5bb73dd3a87b2525062a537980bb7aae75b50612ad26c8d76c85bc57129941a964a8a2c3caeb6371831e6a7f8f6373a0a45889da2a188360e54ff31f8b7ecb4bd66b65246e1ff8ced66b2e13ab09c3ab02ee55a6157ab5be4c40c6b3b5910811dd984d9d7c9028d4dbccd7ca864f2d5b2bd0a0a01fe50611f9f449bce291d7f6e45ce00895dcd343483d55ddb72512ab98cdd5e31bd212c5ca1ef1d0ff199ca209385e12ce84fe585b483d59b763ba33f367b0253ee19cd93c33751a19fa1dfd0734c813f43fd289fea89adc6748f411e6d8c233a0c9b53297ced69df1be63b59bf6abc94d1bbae46f4b3a3bcd4b190bc52e81daa1e06ef24ac1692e36f03e05860128297d0afe460b838714edabc7a075b32762539057e95502e76045a551139a271c67d413a90aec281ba0bb81d15faca9a1996800f90591ec8dec603b2bdbbb88d2d1922d5890f78c20c7792af0be57897ec9c106d0798b5250ee24d4114e98d08737c3ea628de1d9ab14a84c262c99a8ee1c3ba6139cc1fd16fc3307f89f3714646f1f04d16e5ac447f3e4694697be82d38cf74b2eebc3dffc7ee730b28618cb194245f0af22f4158608a4d3a78e1625085f6db2795637c5bc30bf21a2df4b1573115781ba43f1b26c74313a5e6068fb523b08c94446932ba42dafd7b9956ef4e943eb0dda4b9a3095c1851bf7e1b6ff97572e03e5fb04eeb77c6b89b32fc9836362522769b48468bdceea05cdc4ef69096df060d39ece69fda8cf7c56e3f469f4989dd9431a9d472361141c02a5be9339ad98d73e6c133f3d87f7001e0003927172457542f301234dc62af790b1e4a88e47c74b1ed155d7f473a495eaaeea25d8acd7891c6e7fc37da6781bc5645844fc6857439a722816fbc89396891c14837ffa9c1064d4aa7b679fe0b1c597bcc83bd4c7ae598d03a11fbc8903523def79483da370e444e37d71b1a1cf11334cc506e9edfc9c09baa78dd99a8d66d74a3290507f89be417fb0ebac9e122bc231ce2f6238c427c11bec6254e91cae4436c95311337502c40d1499d8816611b1ce13b78ef1f2375f1068e2673e13cf83f8079fd6823550de25e64a1c3137231cc6a36104c6d5c18a07d7d1f4004fab224ef3c8e79845dd36e9dd868868ad0d5e81b4350a30c79b9f5c36198b891862865b9e5bfeef89aa7c0bd6105108bbe1d10492dfcddefb0520984c6e9b9f8113814f8fcc6f2ea71a08d5addaaf35f1b1d4b49713223532eb763238892e674b100c2b6f4466bc721a7d761b275ea836248b99d8765291311e4ded86ecd67644bf0d8d71e7c4723cf607c408bedba15f0e854da233549c9f1d9a341fefec83b48d7eeaadfc29db676d3c1102940622f35bd758a8af22e91906670c60906be8a2d2cdaf20aa1867d676708b69cb7973e411067937664dbd7ec3abc1e5c34dc350aaeefc9fab1ce6df3267f2180c07357153f0e8fe9a59f0b9891e9ad5cf93c4581895f481a48714bdaa931d82ed040e9199491304071e149aef923ce0e907e60ae81d7c62017d0e64c12c1f5eb35460ef5f67ea69e84ab65bfcf84ac781240c175d72b903cc4a796867216f0dc527a9b48f0e80dffd416fdd5832907e83f6a48bd46a0b523523af021be0732adeae68423a1c8aff6327896f26e506fff15efa32587365365e0dfe52487d3a339cf78ded36420c281a8f1b633510a61381b498fad96fa14e7c1095268864a69c31385bd1d865a0316dcf10a0cbdacb66b8a7262bdb528d3edc3617e4cc7c7efd22eae9444b0a6e6fac173c9c1c6932b3344f058f48cad2aa62906567944c2189ad27f406fa0d6f5a161b2af340d7fde9bfe839494137f5a0d1ce0180d909d5ea5a96a00a3d55debeea77ad63b586d8428bd029f0e9bf89a0b6a187ce7a7e5906b6789e12a4de11fdca9c043334ec215310cca2b74b9ec9bc4808af28796f71178d181e4e9b55ea90c2f319d0de72d7e4eab50c97df28ee1acd1567340b9e49e5cc9169e6b07f592ee12254b919a2e8d8b5c2e12f5989ce57066363385a9a170ee28513c90968b3a003e444cebee4b174e20062832e8b3f96bee3f0aed3c5fefdeb728e3d1cb6f203d95d83ea8d983b847de7238f2f9d019e7ba1cc09d7a8a782290f1a7d929b6a3029d05a693df36a026666e1a28bb52ef6aac26d8c94812505cd996d5c4f47999cb9f8ce0225768fecaf9ceeed929f31310c218c0826314c550a0ab8a2ff90ac478245a090f8ff4be2e77ce6eee377ceb375ec127216d6760ce40f17ddf72523733417875cc31bae4e2362e9dd56d3f15aedb778ab25b193dd1c646b1cf88807c49ece9ac435d490f16b5c8ab9e6dc1d88f0ac62c7ba9f623d0eea3f8622742b7e6b5417eb7697058332c52b174e6cc61b4f91ee512f010bebe0507ad33edf0251dbbb269a25612a512f2e75eed6e93a13f9d6c091666c9ab55a51f445f4d22b3d4d831e209be2892eec319cca2feaedde2a3ee4663d0d51bbabb034b514e779c238183cce966a45b0c915b3ddcf975d52a341f36ba943c65ac351cb4ea9af798fe10a35bf4d33d9f647b3332da9e08462c8cf198fdc53a533f14d7d458c6a6dd02909b8bc7551ae155df3644c1e54adbe6a42e524e55d167033a7823d131f7889d547bc9c9a84a6e21afe1b1d0f1c84d76eb7b30c51cc06f23c70260a3c7ff136384ed0db4e6aaa104235ceb2313386b5db824c75391b1af2d7fa232abdfb374c56e1fe756a3511f932be46816a1481a0866fc63c1165840105a4ab2326bfa9ce3438af67c4b34aa1dfc28d800163f2daa8e670c6cdadd52e083487ac29e54979bbfd3bf68e4cef3f0dc47af964c372a8b9356dd82e56f2e1c2c9a09c7bdc22003f88bd393d9d2593e4c30c8fe01b63f82379517702e286f0f76944bfb142c4e2f33dd66404a3a4250ed6e6d329be7e61d84d249c2a3313f95e40ff93b105d68551dd70ea4e8a9754e83433f880df66c8031c739d8eefa180b621c8469e5003b100ab625708294ef20138c224200cfd7c39a8cb94ab3b30ce8e161efc86587cfeb45e5ecd5b0b92e92dc657546fb47a80816d67f123fbdd3238e21f0b7e52ac93ccb16e6cbf63e9fd5a0368e122622c4b851404bf52b384fb74141d23c9d2352634576157baec7c6e96ed1e597c8ab3d7757fc7a0b78ce90db7441763a80a25c9176b82b9bf51d679ad96e9b82d9a9bc38da29401bcba9d272fe7f6d4e79a8441a729768fa920bddf7b93ca3d399911969a86c2345ba7c4cda0b68505516cfc83d3d6243646f147f170008067ea53bfbfdfe1885436911837b7ac9a0289775f39f3ee51b53f480065333717da3f8efebbd3f9171145ac56990340a06dd506e4d48d144c6902bbaf09de6abee16275df349b8d42ee46fb58a3fc488f9f5edf1c9481a32367a3b64754c183a83cff43fdf4b897a725c111742a6a21edcb68c23819c024e0637b28b70d73300a4d69562a59e0a0a3881ef58cba4c9424a12ba764cb1a5e9fe3007e904ec9af56d23572d90e1c3a9f7cc9a3201c43ad8b8ea20f380031434c02e3d5d2b9cd34906fd95b4690d1fdb3cdb2f8fd391260fe42391095c0deecd30dd5d04233bf6dc225beace8be886bcf686af86496565ab6c75e56d4e9e463ab0c897c577edd88b190c1dd78177a81d2cf55e7817643fa0804eb8b105bf17112f268f77c3a2ca4333e1b7851f6b55e5a33d85279dd1f2683caf266431bf9a328967a1068e67e473c9657e7ea3001e9466668611c765c8c3f3ec516e43269cab707e33f2bce5845eb46fb8d5680e4f6a9168955f03b96e7988b8ce567cbed0ba2816dcc10d618a78cc60da328f04e84e9cf3bb6c1b049ce723f323f40a37276b3cf7a4ed77b9eab489841fdb66727562445eac2f71297b2b01696e965c138ad9fd774820766ddd53a8782d93988df2efd07d2e28b021c64d9fb4ad4c806a11d48d0bfb14889897a365dc679de234e3c6e937d73788ad21ea15b5f974b09f6aefeea32a97e01a15cc52ff3abe09107902555fc7d295d7155a69ba0c641d95c39acd6dc79a590f9a08a8d8be703da9f08fb30fa4faa91a499d2009e49de279fda9e82de941bd217d17861a3b4ef331f313ec47f67390382e36b0483ffb518869ad94d38f6000ce14cf4fb7983cc999f6d4a9a7c78f6fecc1094fd1138c7a58f0a8bb5e74d6d5d6845920a2de83d725ca839e45235f3052ab8071e5d3ba30a15df02797556787a63996672e0395544c14d057eeea3b6bad78c9a5f9b9c48202d55d76f38cbd70bd90dd450bfecf06f2a8f6b58cf8a8c46e4160fc54796e5ef8d3c1e77f14aa7c36dbd0b204e011f10eeb9be6ee2dcf5566231438bc2c7c9297f091519b77ca73ee38298a127e596a52c3e07ce9e5f2055afecd737ef97b5f1b3e5ae5bd8f969fbe08a1241cd3110aa111c330e97a662caa9095f473c1eecd7fc43dea533e82f7ac903ecc6fc597d4737cd21579b6119350788f140dc49d5a332798943035494048e809aa8ce6a831a51ebcd83f048614c7f2ad811bb2b4f06a36e9126726916a4bfeba8044e184f5284b4da4ed8bffd583f9a78aa70146f0a40dc93e2edb5ca4d030e0f2d625d768831b861cc51500aca1031de5bd1843bb6d48437e9728704b34205269671fd66c3cbd9c0580c7ac0a09f3d4f3ae7f639552ebac43264ce9fc63a8c613338554785058bea6056571a3b763c7aff182b26f1c2ab34d36595be847d28445c1f2241012f7ade046fb6734547116bedd28e8c081281c61179ca2142299f48f9f1a0b192b8420daa4693b8fcc819875ac4d62601ab27e8ee50b115ac0444ec81a5b42f3489aba347f0a9678eb5674eea5d5a8b97ef8d26e2932742e59c41cc3fdc2d985b6aa503db4b5bfe43edd42e10d91c273cbd2a5a5de6af8ec36555d55fa59c8cda6cca239a40127d6f931f05fcdc0f31ca589d8407b75c6fd14bcc608ef343e1716831d2f1248e9d71b51dfcb050b5de6ad6ad82f1fce892acc14008ce68dfca2f42eaed285e367200a4ed058319bb3f37e9cca273d92dff166e1c6b7c8d746e65d275234bd11030e0a07279e6edff62e9f8b0bcd2abcdf10be6b62eaed94a9ddfef223f11acac28bb9a6234f4c0b2864dd79ba09d1949684cd4c103e67a79505ddd191fc5b1db867d91cbcdc7dbacccf6f652b20416461d13746fe29008e7f16390f999c946b82ca9e11b44d4d436ce7cbf1c0076ae127cb2d71ea671d95e21fae121545e85485add356d9c1877ff256890d6d1afe377cc842f07e29e325c42b2b5b0709526b3dc4cb7a97ca4ddba6dfbee20ebf25f4b22e6ae8cb300c26864f7ebeb143dc89320e8a2ff220ab35730d91bee6fbde433ed1054cb918882f5c917343fd8d5ddfa0e22fcc97f0df58ddaef5758f86f3b4481ee12a76b67b4f5949662910bfc19be703028c77def2f79e5cc880e4dc01db2a030cb2c17d4dd131158c802bccd9094cac1b5b7c7bebf8cb898fd10f033401f94d59918ab95cc03e6707331b8638b14f2603e10137f02831eaceed6f6b2252f7d5e8394d608a8c861bbc6162b805b861fc41ade976d5c6b74b3bc48549d9f3890a9c94195096cfdde52877cc08011ef48229ead63ebc20dd7910e840a8d5f58a0007f5a1975c77e32c5bcd283fd6668fa8d1c39df7a9be8189b1b5f0be270556568b48cff44e632355b2b8cc86bb8d653b4f11618890084604f97fb6cd4e18e07611810b8eb0a49ec89015af4e8ef1ae057cb31440bba06c939af0dadbd0856d3a641ad1ed032ecdab518cdc82804ae1570162a80299a057d63c57d08044aed6b2991c4e1e32f2105de07eef7cc7826aa970155d6bb5e2ba6bac056a19c2b844b2005a91d85fcd29f14af9d26659e31a87ae8da8d91f40db1fc9dfb7bd654adef960f804f33af35a03069f51869ac660c07ee686c1b4c5168a24d3eabe1c476cb7ead3c861ce4eff0b751dd27805f6604a664c413ba8cad9b652b28449bd3c962677db0bc423c21cfac3bb3a73626baf61c666c75c9aae009d3e8eea4b0ee81ed1539c4dbe34f668bd6fafc104f6fadaf56442a3a0006980df4c4a7398de1a98ef0ad9990d643eccac39fb80b5edd18b0a59e00fe1338040bb31183b51bcd6b1b375059951842b3b61850325130a61da2cc2bc4f5741ef0c5f9505ab0d8aa7ee2e5d55e8d221648d539ab2b25ab0f3241fcc3a737eb29a4ecd8e65e7d41f657fe7d130c238b47b23d1774c9f57b5a6c0d82409d88baccb2d31d9ce1701c19d3464fda57d32f596d231294fb62254e283ea2f093357ebca5a414cd006dfa4a85a023b2fd49febd66fab54e7ef4247c0bec37ef78438a0a1fe76f4fe93457c92ff2177a8f2cbd1a467e6f8c48056fdaaae921d1d7f34165bea5b6ef4690d37daf7134a277ae4714c3365614ee9ac803abdcc36c18ac1e177a0ea8d87b0fbd605495ec5206a0098fa6378361fe66aaad3e535fbc17571c742448502743aefe99857b44407dfd1c35b7ff30edb1bacc70a9fb4712545377ea7c383778ed89050e8c4b9a7e34d9254d1798fb257ee4cecf048ef30222b996fd1c9531fefbe4846e243a543cd98c3866d64a5bda27d15f1d47a667dd34a9217dbae6ab3bf5f8c4bb44395863ae392577ab9f78351f4fb4fd9b8d53b35495e328711734737f11c3c6e46438ebdac1026e076c6badddc07920579aba6d091299a37e86b5006182594d375ae41abf24f1b90fce9ebc76bd0b99c3393e647de95f91dd57a18a031fa91a65e9573a07ad458ca95355f287041d938428d25d0881d3878a9bfc0c7038fab0ce4a824f1f2e134f2306577f6fef2a164b05c5116737dc05a40e23ed7350178b728aee7a66e3f132ae64fbdb4b2caf9715e966286b5597268f978dacbcef6d7ef6c255597a8754762700a17cdcc632a9da98fc7b34ef47575b6d7235e2602f27bdda2924f03d9726de49d2683497d54e79c0d13f2b1ab5f3f8aa1479363b1f951823a071c824a9ccd31fd3764f76d5ad4b32e1fdd06305a72069a7a45eeaed0a5b3020593082f71ba68430954ac45c9f0bf7a7be593a7346b25135bd1682638b6d9acc5e2a2a7cc15603e8632be631f99045849abe63e7a1731ebeedb74bf767a4d0376be28006ce6c17649d1d5aaaccb5b0ceb23680af6f9ffc284625ac69c96382c0573e6881781a10e54479dd08fe89d413ef04c36abc9a151ee69da37ce1d2f4c9d573f53763614525c89d486ffe2d40b3b9d38d63d2a3e1d7966285d10a57eac1fef014641fb9a981794f0b2c6b12dc6c2eb18161685d4bd94a9845b69d268b1f368edac11e117bc00ac140fa03983274078edb88c3e667b5154d95411de5e927947f2d426ffdb5feb021f295a6c213a795211feb05f85cb0046eea3e90e17b7069569388a70a954286c4d92959acc4c2426bf183e84dcd4192353ef71e629fcfed65e7c4c815b535f9014cd211e7c0c07179462f15646d6cbd0f532538b7c7b9b30c4e8c8fd658cf8c7cf22db0b2ee3c55aa5a30c76bc825a03a97baafe9848bcc8670b12fbd4c59900363ddddeb40e92cac2277e384a4807723bc8d4f6b10e131dcb73788e6d753858b9248e2b155823a0893498ed8ead3ca62a8d8bd394018076a125047238bdf7fa1947ccc513e0522a72190c6155d2d898b8234cad7c3dc30ee5048a672dc66b7e77852b4aade3679ff3be4a60e12d024d136a65c4017e9cb83167be377d1518fbd76ab4e3765e3fbb1274ca050135898dfa6f2135850dc1793ffbdc61b96d6f4ff87c6ed86bdd0331715bfbbc48091aace41dcbe7d0317d0cb505839bb4505b1961e19aca13ddc06368a7f2e8e77060bce670293340924f7c9f38481d974b8fe16764f80751c61be29a21ea874ef469fd8290fa1e686ad45f94b96c2afa23ce9ef5c4517a0107df7dcd303eb41961d12c6bbd1f90f55fae1b9f3c4072238f3df82e6a3517d9f2369b21f07669ab955af39b3a4dddfd08ab91b00709eb9144e31e5195ae24642c69d52406aedcd7de95338d42f5eee673a3a667e7e6e8b783274065d87295597fd5d37fd70dc7b65edbd40619574c9302c0b686a71af808870c7a363db5d3ab5410e487535f3abcd9618402e8a3358e6fc5a88a3f003cd05583d701552d030fb6c3f46a8b2167628ae6d05a7a172a1151b924498b2c62c16420a3b6be1c86b5906b524dc1fbaf9e0c994ed4777162f9ec473f2e7ca0dfe023c10a881586c16d45a97e6b7478bfbf98098090f18e25339807d31c2f858534ad8de5d03449a566b6f2bb8f6b28bdc6a982f01158c175d8f8658170b94555fa46f1608aaff32e3acc30c7677ff34ecbd9d5cc555f65b5ce6df56b0c337c70496d5c0c8f449adfa773e8098894a8dc2ea1d08ae523775a27f2ff5571c0e7fa6a367da8f75de13449f2c74291a9ae4f61e9307712831acb459a7c648ac29ff662d1c48a06bba1167f6dd3669771247cc6e0672a2efa2a085692dd05157b1b6330244c980c2cde38d13df763c905e21ba95bb2fd17ff0ddab48767555c54215d7f19efaee8456aed944922bd98c66e89dbd09a5b112c18bc6dcf026049e2903f084c535143ea00c8ec1f730a0dd6bfef1048dab28818b35aa81144777a3312a9c1467a726945507667859e9e327dabea85e5f1c16a1b5e91e28ff159a78ef41276260fcd887579bef2cf683e7ed173264e04933d5b5daa7b122980031953e5454a20dbb415b5ece364027fbbbafeee57e8457d4e8542485904451fad2d553c5f4bf6458f0ea10cb4c5a0f4b4266391a55d444ca64e3eb90fdc26603ecaf5a807a05224e8aa941e379f6fe41e2ecfff7afe631fa368e15821327abf58bbc31358ab01ef08e3db919b0ffc8b176e06b01a0503bf97ec4d75a67875c20a8bfcc5aadabbc90a0cdf48c58e20b601cfe6cbdc3838b5b084d3f82cfcc33716ff47458c6c5c37aa212dec0d9c0d10292cea7f553f287467a91d0fad165821d8359cd64a16b4bf407cf957a7cf28f2eb0fd3d7c73e5fae44d4ee4da70eb5e01c640e89802ba8eaf002d345da4b3a691d610eca10dfeb5347ab468a7ad23dd3f51ed22caf96a7807272c77ef973c5a05ed4e651218015916c1c1d9bd2d8db32539cb41cebb47db16e61aad7dfde2a4edac88c3ff7fee4b2ec50d67906c9acdb16120e7473077abb3754d9dce95033378789d9b94eec2ebbf553a1100a10f6791a3083e0eaab9d1799c3315c96d247729827789049ac6cf92a61442911af26e44772d6d0f4c281e9b48fb7a25ce93573d92be51f3b00a70757146051b4fec08172db1181a246c16202bca36fefc1c0cad4a250a63b0491fa217fb9187af986c5ac1e9c036ece7d57925c769ff41829bca022d8882f17dda3dbbb7296bb1f371c2d5de8bb473104f266d99eaf2894b0af5eec54e7f2fb331282960d6b50d68e5d6fef74bf6ad7df5363f078b39b08a28e08c7e44ee7ddaf8c9260f4849813652dc8b173dadf8f4d0ee4ee7bb0be3c48677d65f224351c1b187fe0fcec882a90b4a8a1e0def7f83fea104ae4f30c9aeaacf1bb2fe0cf79961a3ada179ed19211d46031343c3e6b58856ae60ee299f4ba82386afabf0836d75de381d8749783cbebca5425c76f2d7e91a5f6cf6f6acc2461439bc5bf71284e6c4b099ea00c501b7b59468782508302269f47db7da46c85958f5a6e421ef59b1c46d6a5a6173c6dec29df956ca9ecdc753ed5f0e9aa9f7ba3da1114e9c7368ac417143f357e55a49e895b1661269a036a53009261786ee8a78b6240278ea8ed93d8a0f246fb7d4b78c442531b920463275f3cabe18e9472faa7783bdbaacf3e335a2286968fb89a55367aebc786bb4c222d2f5aed1b8526809a934bcbe2d9b608d3a3f7007047fc1d1ea28df0dcfdb13cd74060f662ac1c6f75e3a0bce7a61bb3562598eb1ee4d741913986de13d7aa43522c81bd8b3c461d0f9f63adb1588852efc2eef9bb16ff18b56b2dc0f230ec385ad5df9896397a843e9efdca87fcae512eff484ed90cedeb21319b28876785f8835bb344cbef14bc0b5a86d9334f70a3cce799f69823225d9586cedee53a60f1cbcdad06f1a2c8226ae25b774d2081481f373b45aede04520905e96d6c6068810d08aacde27782d4cc27466e3938d097e7a84d47427e4651f12420a81512026fdf58bc1a74869d88f64bf773aa8792b38c4d33c5190a3d16fb5db15d1f4bffd64a86b14764c6bcdc91784c508edc0e9bc31c771c09c9b31dc102e5dde685e7afb6109be37b306115444e8200eb1400ceb8d296917b1ddaef0f08a043dc0f1f3a7db776730e1b9015297bb2ae4eb7251357c1752ea21ac320f9683c1959ea001edc6f73815847288a5253a8de6b70a9228f31544654e11451ad1317bd66a4a789fe554383a90239f0993b0fa527626ea9b7d87c0c4ba0d591812d964aec2e6fbf8c2884d4bf3d383323721edf4f83feace131fe57532eae3c9fed7a1db66f25aa4db5f1fc2ffc50b86ca75865aa2ccdd65095acb37ac435c79da37b7c43834b635b4ce7af5d8feda08c6ade10de59bd6b6a46df26f841731eb1597d4e6fac6c4deedf8fc27a2a0e619be72ce48fd071c28ababd49ac8662efa84c2ac893e19a9f2dc5017dab6b89c0d7ae9bf5400b0072ad76ea64dfb71e4efffd31b0a79a1dad7fbf1ccaa24bfb20fef87ea7fa3d4aa6a74589c62e7a19b03f6fa2cdfbfa85cc569b48270a4bb6a6a4977df0123f559830e8573174e2b4b0bafd62d527ec928330db5f9a6470edfaed096fe331c1fe68f011fa0f47a7d8d396545d85f6fd23f721259ab0a84220796c3c663a0c2e3f0a83d76fb1ae6c15b69f34bd24c7b5899d1fc2542497dfb8e5947593ecc4f48377aaa1a0657196f25b34cf301327f2451625dc1542f7f3ace1e821f07f9db35ddd5e2283ec7d3b8bff217a29a9e7b4c0c07780abbf159ce58f093c47120b3bc91047b81efc2e16c76ffe0a5a2adbef75d89b24acc3143a513803c79dc2b73a8f893a22992fe3c89172dca1a783e55ac919ac7a5fb37b755c239c07828706c6a8d8dc92ea0a7d982b1357b570eeceb5729a392796354b946e694b724de5dbdf0856c8fcbd0b26b6f41476fcdbdad40e997aba5e7d705c528fefa6834487fa111a24748bf1b6fc50fca6f33057827b05c55c248200ba95d1ba134141c0b96ea16b87f88d09c0113d5bc88f8dc6b2930e48703825aac3bf7edeeb374ef1035d53196ecb06b3d328908c649a729b862b46e934db9a1761aa8318c01007a01ee3a8a9afa9840da821c788d1ed8a60d04c9b0b15e5ff525bb31bbc71bd8a45b29990858169b2c8e944e9001f42e1a3c18944d4a1382a1f63d5f8f4bc168de5d4f9c2a15f7ec11c94da767f175588e8f1b096b08931be779932167085f230d547372ccbba4c28ed5ecc9e3c66c2ddfd55e8e71ff7f16106e79142c5724c8e87ea3fb0f57be29ad40657340aac2b5a657edcd8d7ef485edd2103191425fbe6306ef2303243e4196a1e05d584b8dd6f56d3ee88cced367fd1ff487e0f730de79b3edabdf4e0beb1beb2bde6a702148d79eca9131b60d8d380970ab83e117c60a4423f55f7346838b9e6bffbd6b769772bea5fc2dc228946b22ec4b2e0be42f22980623e4ccba78a390474f8a1c11e20aedcec5254fe40ac2a9dfe2964add2996ece8b711a2bb756feaf8785f47371472e8de8188d8660aee2f891ada5d213d15a58056eb1a2b08efd89a485eafbc4227634f9548aa3622d32f6aba5bec6a4864b834c1c108038cd9a0875b032fb89ae0ec91e61dba35787164e754e43a2674593dec8ae918b055d5dfe2d3e906ca7fc1888eba2977777c70ffaabc9fb4056622976abae1b4ead297b05249d129cc19f6e358e8d80a65833fb6d9940ef2c7618cb5c2a465fc607cba105102212013b1eceeedbf2d2d3c79e6e3ee5efea99a38e8acd999a9d106f5c002277c802d8d5a5a2641901ddf0afbfbc096755b2a1f68e4fb8c24286a6e73132b59f8207a0d2708acb889eb563d498cd0740cd1850b3be43ad1d7a3dc5529a50e8a109b12dbcbdf875941154a8b45750104aa203383de12d1bbf1f06b9e11735178801d41d6f8f41ce50299e1e8c4ab6e89f144364d8fbbcc9fb0933149e7e1547eda2917c0c3c69bb4c9bea381916025c6fe138d9ff94aacfe4d70dff3c45eeb68194ad4b6e4b6ab379901cf069b25b61216a2fbb729d4692de18a1d8b580a5f544b884c3f6a7f30d9bf26ddec43ba8ee74d50edfe9de1959c438992fce80e5a9a022d03247db155a13e98f69960a90d5e71b1304c9ce7b60903d3f4fae0d1065e5d651085f3b5875f3edc332da367ccdb24961a34acaa81b00c36aba4e7e8781a12c18394f648b335cd4518f639f081f48aa014b19be74e4ec64d674f729b4c6a8f9d3453879e7b590374e35be1288c64fd2f55aa9185354c24292bda1ebefbb6ea1cd9d59a6aa087af81c80dba770f057e659244a1f14df7c01e718249f7e7e607f7c589830c61336769f92327af014d60d0a074dd27aadcbc768ba304d7d10973bfd0e4eeacadcb83401026efa6022cab26799369cfcd9d1047b1665bd23eceb3dfc46023831dcdc43bee02b71efeedd682fc606f24dcee73ede4b2be935a036c065f6e59115db49c38491ae86183c6867a3cc7fecab31b2b42d5e48158857f9475740d611f3ff49e54475f2c5c1c080a2a056d145040f21b4b7a4f087f4e958bf9f13ce75aa861888f4488d7936499c6bc59dba01602f2056af1164cca9b0c58f0811e95824a610222e525016ee48bf1f94dedc90fa6e1b62f31058b7b6749e905df5244a1fd54646d1636a2f018bec835d0fcdb6db0efe7816f00c36f8fc2cd00f51e8c8c5bbe9b3c9634df829381543b3d6ff72d6f91a9375014661dba24deb0840aba70694079652ec415fa642e442ee6ab692fc777367d2208c10d4dbcabab41edc40d59d7b7ed78080f01f109d817d1898349a185f3ba8c1f8fc23edf12a74f608472ae1f4781d09b6206b34e7b4f1435a19a378d513a6dbe036194cd2118eba896b5e2ae39d7e8397180ba4bb377a549cd49761f676cbeed4659bc41c5af958cb09093c48a396272cfbabebd7a261cd6a687188733afc630e8bc8e4260b1ee033a9a3a8c6c634a2e256ad47d6bf39ba62caff01407f64ce6635bc7d0289627f1fc87296dc6f6ed09c99efefd76d8a3c88ac80cef29ff19a8a81adacb6da77f0f8cfacf84739e9ba415b6166957a2612cd59b4df6a567730aa96235ec275d2f43583d15146d4112ef5d5f245b85f281ab5394253fa812a8844d6aac5a15b85323a6027c29de5f352d77e8da86412fb332af80385225c1809804cea6907fd3a4a5f64f79024f081a09d839e8b24f09418b775026ada57dc9baf536f1feb16fc3c1beacb250ccb18789c816a78bf5e98775ae85a7e6809e91b9da296c0597b019e87af96d334a6c78cdc821aa49df894053db0fccb70a7676873a86b19c975609fb695e8d017156e21f86331540e56382d00f65ef16084d75cc5caa80e5b8a6edc88831def81614e9e8382337079aa8aaeb20fba28de2b73fe5b70798cfb968da77994c828b75c40c4412780ca17649f9d90cd9f7cd4d999d94a5cdbbec6d63d199cd56ab41b6c468c07e22b58575c797b4797269774b8b76e3ca0b945db9eefc6108b00167c91446f7f6c5d480958939ef8782812ed0aa55ebe602621ebb51c9e008e0c5b02bf4cb30b5a9ae69a3e6905b06d4da9f0158e81bc3d5bf65ca42d50ee6147aa31901a362ec74d0979b9230dac76fbfdd1fb1a64fc9b60e637fc61ecd84b2571105cfed6bd37a1ef51ad38b5dba42f6035d9e12171f361bf4010dc28db0794116e2329e012fba456cd4377aab7964e5e972f877a226527aa078871fe604dc6435eb1f4147f0a84b45367f42bc3f320ea4fa1d7b5e33b88d0f167e26ba9aa0c911e2204c62f207731fcb2009bd91d6c7b527c1e447448cc942eee8a15ae2788670440d306c13d1bb1d62c74a18bac08b489904f863d8a33a38015c78ba66112065648bee7d9f1b6a7764e3031731a8b1a643e4e6652ab35e80f896b2b4e224da207e1e05d27f0e42bc873804aa091fbfc60b774428e244f81783ba9a35cdd7247c401136c476c4424ae3114a1daa65d027cd42da3c348cd725c8aecefe2a93958dec2d35acc29663e530768cbde17c8f3e6d0d24817b8638400ecebe033296899ee98a69ba883573e9d934c46e27084680a4bf31170b5b854866985244297fa4e81ce861105998a60066195d528f27897f44d25885d14ba701bf4e7fe8888fe585c75e46658e1a30907fe23b2a438055680005be49bc2d0760477deecc44cc8eb955d9b8d549226b4969585d842db2b2b428f98e093db56d29c85e3a4b86f45beb5b161a84ca5d6d15276702a27b4e10933e940452663050f105d9c5bed00600c54550820d57a0819cd04f8671c86f3cab5c65c0aa8740ff9f3b8a2cccf8906c1cd6bef424c77a6f305e8fed4c1f32aa97bb6abce6e2753204def89110f6e80c1386af5ad6c7fd4ccff8a86bdffc9bd766203fdfd42779cb001da8b325274239aab4dd60dc747be99b98c73b399eda824a92ba6d57fbf577ee20fe201754504bbfc6093336d125ee1e644fc3ff55839a199b83f60eae91a8a284085e5fcc8e506c952d2eb270d60546ae10589ca432a956f958ae241011634e0bc33d39e2c8f588a775bbbe47efe388e11bd4550a413bbf90b8ba35f6b32469ca3d65c4e977a06d08d1a98b329488cd65ddf6f7f2079fb838e6c72059bfcce61276c456f1e8bcb39638920241f6f22154aa65f1751aa60ecb16bdce70d280923bde90400d02217fdff79ae1214e0dec52b4f61fc9f25ad594b0ac678ba3c08ee56664ecf2f675ac115a015563b9bb92caff2af29eec5a4769078400f455b1e4bab00ea301d34ce49a289634e03aea89a640cb89ffce9795810aa200a218bc277286773a04e3228cf9c0241e89b50f8554a1bd7a72090de191d00af21be5a115e580195cd9d653cd76d5a7fa73f89e0b004096adee2c1e98c75ca90bd67c6fe91f0fcf0bf0720ba8b541c0f0476fd78deae33bc2bea35fc28493eaad8e80cffa408e38edb63b7d6e45ebe7abe071dd43175a998e9f139e89174b9dfe0a53ed68849d02cd1fc5be6f8e594a632f94ff5c3525d2add505a1c3d17795d41d85ff1a9b1915bc5bd65024cfaea1b45b6ca967d7ec693b129ebe089e3eea0c08fa8b6b52cd26990865668bb842b510ccce8c9ca6f89ee7e529c409e3d85d48e99411dbc115da4ec6233738e66f2922ce46c8949db4ca09555fabadcfa287824aec1ad4a3cccc2590b8b5c2a8f2dba15376f6ad7ebaeb1f46918ab638ebf5ff90bfc75739f057f495d37c736d540799766da33b95cd15682b3bb02132e0263d53367ac23e01974be4444fd27fff096ce859ad6a6a99e23d2d1200ce4a05fdc5085d69ede15a813a05e93c9b753b25acf9a4910f07a2e17a1ab2dbb402e94726f775fd8f43e3d9ddf34f5c21f1da6b71409a5d5e9a951dc887b5ddfbd83548844b13b8cde1f5d889b89f01aa3722b8b462d112b2424acd4d83d0212e45e8a71efa7a8910713cffdc4f3a130086b00369c30cffabca200a6e474c7295d302994458bf1596728ee7110f8419839c5f18491b6e6f991776bc54e407ea481f5fea5449a510259d212ec2e3cc039b03d3c9fad8d92be320a181cd81d0ce99bd32ea44da1bcc18b64949bf1c9cab266547aad17395e0bd798728d4a19644d68c2fe7a67b4c3e1fe261e7a1c29c591a1759bb7058e9255a53f6857235f1a22f84b554572fe6f635cc4486fb3b6b4244c8acd138c2a22b63897634452c4601b6510cf55cf5343ed986dbed9768d5ba42bf67aaa1c76fca599fa526b29250d6e4890944f3bfce9e8909307bc6e8b748dcd83394cee25094e82554489647bfd0cd9cf722cf1cc23817afd0796d5343ad6f64d52375515b95f0b18b847848d77205992e92b6abd3107cbc2516970516443f41e1e86964bdde904e89eedf0c3044d6f25c4e655fe587452f390fd95f7e520c8a048898d55c171b3cce096dd9b77e3b9a209e2022a2a0eb0560734d0afc045a58b1748645671f1b0fb2a7a5758b22f87c13684259654233c519d9cb5c3acc84ca664ac866fc42c0780ced580f1cff559ac05847b1af84089a75221173580a023d25473e366912071413b2788568879aaba9fca5f4fc526c6ca7146068ea6d668ed839f88ea5b06fbb9d2f6ed8f2e0222d934ccde5ce25027aa57489400e911b75ea409da7bde80d106d63f251bba7b441ac9d2f193e5cd602ee59de6cff244afd244c9cd692864ab0e2f2728b36127ce4f533e1f3be7de0511aa108e79a9400a5d398afb0c865052e5866d4c0d293cb52e8fc0f93ffb6f267a14aa07aaa54dacdcaee10deec3428965933311d466901fbb16d720631b853f76fcb5fe31acd216a79a212b9d6e21286b8fa51cecf12c5e3a788eb4de96e284ec7fa4537c302532bbbcccc6ef2caa18629ed235a45054abf989f34ae5ef28c9696e6aced99ef1c3d571a62f8692ac9289498a3e8fbc2928a7ecc4c5b27c264d7d53c84e78d3861802f11fb3c1281e83c80c007fca209a8c729f24ceb5ba391128d909a2bc16c339528b3f6c98706038087eeea117e66476e85d65efee3114766ebbd743a689332b4ee96dabbbfc2b7e4bb73a93c33fef4532d75ca14f75ace52ff5c1e6a9cf177b4e16859916f348fe0dcc5418f9c123475a1958c50c6b8394f1fcfde9a396e1c2eb1a807cb908da270ec813d32ee15ca7ec3601752ffdcbf277c23f6ee19dd153e31ba71da09a187853cc6f9e2a80c499331662b59d00fcf1856ff6997184199e2c06cdabfd607acfc4640ba418252a9984a502bf1e0903a704e9de39d135c9a141208666e7679a2655d130f3b2d89dc32ae6bc04b87ff4a51a3b3ea339230f3a0c3f55f3b9d766f336f4422210af2db7bdbb75b51d2bf0361b1000838758b49d4b8b2bf3a83cadec4f11b61cf2eeca820863e04eeff984c6be3581306d0e138c859f91dd49033f981348742a86a7d1fae913b1f1fff26dd770d127a930537e2d52003114256708deb68a8123acf2994d64107f4938387a296026a699fb40d7ae2cc2cbad455fe611e7dee4f8029e6c518e64df46975463956915e87d8dbc087e21d2fa6bf85f0baa2e10b8da43bd62c16bc2d819f2bf1a7c7fa50bb6131507826acb6182de23c1565bc7115f6d3ed9c0296f5c14d1936da3e354e74f017ff6b5b36ed0e75b14d81d013039ffedeb157fecbdcffe2c0c52c8477fb94aab0e840a3ca4e39056bf8373f54551a3a7d7f8f1c0466a0b00b36fe14977dc8498025f43e8e4085c937eb66bcdabb6de34862e10cb2809199d14a2b23c96d9c5c581a4134d9308bec8bf02ece26216cf088c8d13195c0365e4a1791ac5d6420260499fe6eb9adb78a008bd71c0fff1dcac67194c365736c65686a70cf7f042e450ed26f59643c37380f6261ac7afbfd5e8f616a7096c1b2eda967c48d8a1d4f58ea84cbdfe7dcbc6d2a2b222327959bbe1f8b0377b09498a985da2279b34c32543c1322070bff7f494a82e59cffaca00f1c52b29d9a14d0bf21ad4c0b8548814ff14d4f80092074f16116e08e96275034f0657a00e0b48d44e48fa80a7a8d9b1d1003be746f395fd9f4735e9a197355a233deffb10e24d9c9d0cfaa960f32bc9c6857b524372379b633ab20a1cf6f7c1b217d60f2866a842fc266a96dadb030043418907163ac6ccb69a465cdb1a4c6ff17bf4ed53d94accf29dc633cc9d3bdec4abd56d79875d5b565fb5b14eeecba22987ff3b1bc13c427f8c5d2f36b5addc7c0ffeb110addf6f78a7ab4ec518b470503bd71b880a2902116c7d3da4dea4fb293ece1a40252ad08142823d699a6bb2081565d17de74054cf21f49d9af549a362928370f32d6be4a857d6e8eab21f72861cfe106b0a3f5f88a60cf187efec53f15f4a04b5d6dfe979ae691119059180fcc5186c5b05c2d16c3e91e58846f4e19d27f708762e6ac2bf2aaada2f3a36118f72afd458f2df1acc95d729b0646a0b9114c19632d407e8059304eb6cf6a542c73e24de7725c10e21bdc0c5ef2335c0e595a922827c8da37b4b21ea7bcf69fd70fa449ce6e853ccfe1fdf7640b629c5e648c644843bc5b47b21cd7307d7e6ba4c97549bc93c10a4faa49633c41c1bf29d57a201fe4b85c8d2fff31b5b9fcd51fb497fb9e109f0fc97482e3bdabc1d3bd983a51a72b04a94df0bfb2bbb2f49b81e8a7e4f8a3d1541c3e719bb74754332b5989ae30c6b3392f3143f5cc35360a328ffeccf0d3d9fd9a9ad2fc895c8652271fc4347d1c8128f8e863c835eae2e6cf04046de4437ac517ba06b8538412b6752d4c4b6dd78bf5ab0a0dccef9dfcba8ca7c5eeae9a6cf3eec178359f6e13a1314587d34f4b5d91b9e3b419408a0c2a7caa2d2474b3cf84b9c993be61e1c9e2834d250f9177904f00b39bc3737c24241f16a2f862d44e56b057fd80555e290dc0902f04a7bc811b1fc3d26e082c6a69ab49d2f4f29b5bc2912960057ec4b3f7890acc2b0ce89bdf3bbb60cf6de5fe8dea3ceb603d762980437b70cff6f9c3fbceca63d30e4e99436872600499a96b6ed15e92974cac6d29e602ac5a810e1d258c1f4627e569bf5a26fe1860b836bcbe40f82d3a9d98172b7305adf41d92b35686d72af1833a5d6f9ebc45e59b41ac478f4cad75256f9e3e130843384557b84ac4681ba6e03e7f81bb6cc5e42c1bbfb4b1ca85e27fba824e9bb56b5f7cb88f892695efe5ef41c07f10f2ec96477c203441fa9ef31518d833c0dc4b291edd6cebb09762894f1760607c922cf7ce28d0869e3b930b4540329e62830aab38bdea1e6a3181c4363f30a623e86b9a0e98de35e7a4e190109058c7e109c15c4a7b92c179d478a680747164c22193454cbd19cd7fcf00900bd733acdbd901cb95f556ef06c8ba2752467ec66cead68e9f3572bd3a3629e1806b59ee9cd524444f548df76f0c850b6ba727cae99e27377a9b9316d6de9286b75097f9f9f5a485cd91fcaa63c43141d84bc8cdf16cd7ec5b1b25ab463b4d09e042ad5936a24e07606193c3ec7d183f9cb</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
        <tag>加密</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Number of Islands</title>
    <url>/2020-10-18/Algorithm-Puzzles-Number-of-Islands/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Number of Islands</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given an m x n 2d grid map of ‘1’s (land) and ‘0’s (water), return the number of islands.</p>
<p>An <strong>island</strong> is surrounded by water and is formed by connecting adjacent lands horizontally or vertically. You may assume all four edges of the grid are all surrounded by water.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Example 1:</span><br><span class="line"></span><br><span class="line">Input: grid &#x3D; [</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;1&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;]</span><br><span class="line">]</span><br><span class="line">Output: 1</span><br><span class="line">Example 2:</span><br><span class="line"></span><br><span class="line">Input: grid &#x3D; [</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;1&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;0&quot;,&quot;0&quot;,&quot;1&quot;,&quot;0&quot;,&quot;0&quot;],</span><br><span class="line">  [&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;1&quot;,&quot;1&quot;]</span><br><span class="line">]</span><br><span class="line">Output: 3</span><br></pre></td></tr></table></figure>

<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><p>It looks like a typical depth-first search puzzle:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numIslands</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (grid.size() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        mSize = grid.size();</span><br><span class="line">        nSize = grid[<span class="number">0</span>].size();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> island = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; mSize; ++m) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; n &lt; nSize; ++n) &#123;</span><br><span class="line">                <span class="keyword">if</span> (grid[m][n] == <span class="string">'0'</span>) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    bfs(grid, m, n);</span><br><span class="line">                    ++island;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> island;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> mSize;</span><br><span class="line">    <span class="keyword">int</span> nSize;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&gt;&amp; grid, <span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m &lt; <span class="number">0</span> || n &lt; <span class="number">0</span> || m &gt;= mSize || n &gt;= nSize || grid[m][n] != <span class="string">'1'</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        grid[m][n] = <span class="string">'0'</span>;</span><br><span class="line">        bfs(grid, m + <span class="number">1</span>, n);</span><br><span class="line">        bfs(grid, m - <span class="number">1</span>, n);</span><br><span class="line">        bfs(grid, m, n + <span class="number">1</span>);</span><br><span class="line">        bfs(grid, m, n - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="/2020-10-18/Algorithm-Puzzles-Number-of-Islands/res.png" alt></p>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Puzzles: Symmetric Tree</title>
    <url>/2020-10-25/Algorithm-Puzzles-Symmetric-Tree/</url>
    <content><![CDATA[<p>Algorithm Puzzles <del>everyday</del> <del>every week</del> sometimes: Symmetric Tree</p>
<a id="more"></a>

<h2 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h2><p>Puzzle from <a href="https://leetcode.com" target="_blank" rel="noopener">leetcode</a>:</p>
<p>Given a binary tree, check whether it is a mirror of itself (ie, symmetric around its center).</p>
<p>For example, this binary tree [1,2,2,3,4,4,3] is symmetric:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">    1</span><br><span class="line">   &#x2F; \</span><br><span class="line">  2   2</span><br><span class="line"> &#x2F; \ &#x2F; \</span><br><span class="line">3  4 4  3</span><br></pre></td></tr></table></figure>

<p>But the following [1,2,2,null,3,null,3] is not:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  1</span><br><span class="line"> &#x2F; \</span><br><span class="line">2   2</span><br><span class="line"> \   \</span><br><span class="line"> 3    3</span><br></pre></td></tr></table></figure>

<h2 id="Solving"><a href="#Solving" class="headerlink" title="Solving"></a>Solving</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSymmetric</span><span class="params">(<span class="keyword">const</span> TreeNode* <span class="keyword">const</span> root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> isSubTreeSymmetric(root-&gt;left, root-&gt;right);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSubTreeSymmetric</span><span class="params">(<span class="keyword">const</span> TreeNode* <span class="keyword">const</span> r, <span class="keyword">const</span> TreeNode* <span class="keyword">const</span> l)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r == l) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (r == <span class="literal">nullptr</span> || l == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (r-&gt;val == l-&gt;val) &amp;&amp; isSubTreeSymmetric(r-&gt;right, l-&gt;left) &amp;&amp;</span><br><span class="line">               isSubTreeSymmetric(r-&gt;left, l-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法题解</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>SSH: Keep Connection Alive</title>
    <url>/2020-11-13/SSH-Keep-Connection-Alive/</url>
    <content><![CDATA[<p>SSH connection will automatically drop due to timeout if there is no operation for a period. To keep connection alive, we can config ssh client to send a <em>keepalive</em> periodically. In <em>~/.ssh/config</em>, there is a parameter for this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ServerAliveInterval 60</span><br></pre></td></tr></table></figure>

<p>If we set this value to 60, SSH client will send a <em>keepalive</em> every 60 seconds.</p>
]]></content>
      <categories>
        <category>随便写写</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>printf not working?</title>
    <url>/2020-12-14/printf-not-working/</url>
    <content><![CDATA[<p>Sometimes we noticed that <code>printf</code> will only flush after there is a newline in the print string, this behavior is caused by <code>stdout</code> stream buffer, which is line buffered by default. This behavior has been mentioned in ISO C99 standard:</p>
<p><img src="/2020-12-14/printf-not-working/iso.png" alt></p>
<p>There are few options to make it to print immediately once you called it.</p>
<a id="more"></a>

<h2 id="Option-1-fflush"><a href="#Option-1-fflush" class="headerlink" title="Option 1: fflush"></a>Option 1: fflush</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"test"</span>);</span><br><span class="line">fflush(<span class="built_in">stdout</span>);</span><br></pre></td></tr></table></figure>

<p><code>fflush</code> will flush <code>stdout</code> immediately.</p>
<h2 id="Option-2-setbuf"><a href="#Option-2-setbuf" class="headerlink" title="Option 2: setbuf"></a>Option 2: setbuf</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">setbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"test"</span>);</span><br></pre></td></tr></table></figure>

<p><code>setbuf(stdout, NULL);</code> will disable <code>stdout</code> buffering.</p>
<p>It also have a secure version:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">setvbuf (<span class="built_in">stdout</span>, <span class="literal">NULL</span>, _IONBF, BUFSIZ);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://stackoverflow.com/questions/1716296/why-does-printf-not-flush-after-the-call-unless-a-newline-is-in-the-format-strin" target="_blank" rel="noopener">Reference</a></p>
</blockquote>
]]></content>
      <categories>
        <category>问题记录</category>
      </categories>
      <tags>
        <tag>日志</tag>
      </tags>
  </entry>
  <entry>
    <title>CMake: Toolchain File</title>
    <url>/2020-12-27/CMake-Toolchain-File/</url>
    <content><![CDATA[<p>When we have a build system like Yocto or Buildroot, cross compiling a CMake project is a simple task - We just need to create a simple CMake inherited recipe. If the SoC vendor only provides toolchain for you to cross compile a single CMake project, CMake toolchain file is a good approach.</p>
<a id="more"></a>

<h2 id="What-is-CMake-Toolchain-File"><a href="#What-is-CMake-Toolchain-File" class="headerlink" title="What is CMake Toolchain File"></a>What is CMake Toolchain File</h2><p>CMake has a variable <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_TOOLCHAIN_FILE.html?highlight=cmake_toolchain_file#variable:CMAKE_TOOLCHAIN_FILE" target="_blank" rel="noopener"><code>CMAKE_TOOLCHAIN_FILE</code></a>:</p>
<blockquote>
<p>This variable is specified on the command line when cross-compiling with CMake. It is the path to a file which is read early in the CMake run and which specifies locations for compilers and toolchain utilities, and other target platform and compiler related information.</p>
</blockquote>
<h2 id="Toolchain-File-Example"><a href="#Toolchain-File-Example" class="headerlink" title="Toolchain File Example"></a>Toolchain File Example</h2><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span>(CMAKE_SYSTEM_NAME Linux)</span><br><span class="line"><span class="comment"># specify the cross compiler</span></span><br><span class="line"><span class="keyword">SET</span>(CMAKE_C_COMPILER   /toolchain/gcc-linaro-<span class="number">7.3</span>.<span class="number">1</span>-<span class="number">2018.05</span>-x86_64_aarch64-linux-gnu/bin/aarch64-linux-gnu-gcc)</span><br><span class="line"><span class="keyword">SET</span>(CMAKE_CXX_COMPILER /toolchain/gcc-linaro-<span class="number">7.3</span>.<span class="number">1</span>-<span class="number">2018.05</span>-x86_64_aarch64-linux-gnu/bin/aarch64-linux-gnu-g++)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span>(CMAKE_FIND_ROOT_PATH /toolchain/gcc-linaro-<span class="number">7.3</span>.<span class="number">1</span>-<span class="number">2018.05</span>-x86_64_aarch64-linux-gnu/)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span>(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)</span><br><span class="line"><span class="keyword">SET</span>(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)</span><br><span class="line"><span class="keyword">SET</span>(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>CMAKE_FIND_ROOT_PATH</code>: This variable tells CMake <code>find_*</code> commands need to look into this sysroot.</li>
<li><code>CMAKE_FIND_ROOT_PATH_MODE_LIBRARY</code>: This variable controls whether the <code>CMAKE_FIND_ROOT_PATH</code> and <code>CMAKE_SYSROOT</code> are used by <code>find_library()</code>. We set to <code>ONLY</code>, so CMake will <code>find_library</code> under this path only.</li>
<li><code>CMAKE_FIND_ROOT_PATH_MODE_INCLUDE</code>: This variable controls whether the <code>CMAKE_FIND_ROOT_PATH</code> and <code>CMAKE_SYSROOT</code> are used by <code>find_file()</code> and <code>find_path()</code>. We set to <code>ONLY</code>, so CMake will look into this path only.</li>
</ul>
]]></content>
      <categories>
        <category>编程相关</category>
      </categories>
      <tags>
        <tag>cmake</tag>
      </tags>
  </entry>
</search>
